<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>基于github与hexo的个人博客搭建教程</title>
    <url>/2024/07/24/BlogBuildingGuide/</url>
    <content><![CDATA[<h3 id="前言：跨出成为cs人的重要一步">前言：跨出成为CS人的重要一步</h3>
<ul>
<li>当我们从头开始迈入CS学习的大门时，都必然会参考学习网络上丰富的各类资源。无论你是习惯于查阅CSDN、知乎，还是在浏览器中直接搜索，都一定会找到许多前人之鉴。很多个人博客文章，都能给予小白莫大的帮助。</li>
<li>然而，随着CS学习的深入，我们可能会发现，许多博客文章也许并不正确，亦或我们自己也找到一些很好的解决方法。这时，我们可能会萌生自己搭建一个博客的想法，以便于记录自己的学习过程，分享自己的心得体会，甚至与志同道合的人交流。</li>
<li>因此，本教程将简要介绍如何使用GitHub Pages和Hexo搭建一个Window系统下的简易个人博客，并使用Butterfly主题进行美化，同时配置Picgo作为图床以提高访问速度。通过本教程，你可以快速搭建一个属于自己的博客，并享受写作和分享的乐趣。</li>
</ul>
<blockquote>
<p>本教程面向的是和我一样的CS小白，也会提供一些我遇上的bug我解决思路。并且我需要强调的是，如果你有更多的精力和资源，完全可以选择购买云服务器，甚至可以自己从头开始写一个博客网站。但如果你像我一样，既想有一个自己的博客，又不想投入太多学习成本，那么本教程将是一个很好的选择。</p>
</blockquote>
<h3 id="所需工具网站">所需工具网站</h3>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407241217735.jpg"></div>
<p>
<ol>
<li>
<p><strong>GitHub账号</strong>：首先，你需要有一个GitHub账号，用于在<a href="https://pages.github.com/">Github pages</a>在线部署博客，在Github仓库托管和发布自己的静态网站页面。如果没有，请先注册一个<a href="https://github.com/">Github账号</a>。</p>
</li>
<li>
<p><strong>Node.js和npm</strong>：Hexo是基于Node.js的静态博客框架，因此你需要安装Node.js和npm。我们可以从<a href="https://nodejs.org/zh-cn">Node.js官网</a>下载并安装。</p>
</li>
<li>
<p><strong>Git</strong>：Git是一个版本控制工具，用于管理代码的版本。我们可以从<a href="https://git-scm.com/">Git官网</a>下载并安装。</p>
</li>
<li>
<p><strong>PicGo</strong>：PicGo是一个用于快速上传图片并生成图片链接的工具，我们将使用它来配置图床。我们可以从<a href="https://picgo.github.io/PicGo-Doc/">PicGo官网</a>下载并安装。</p>
</li>
</ol>
</p><h3 id="搭建步骤">搭建步骤</h3>
<ul>
<li>参考<a href="https://zhuanlan.zhihu.com/p/60578464">一篇知乎专栏</a>、<a href="https://hexo.io/zh-cn/docs/">Hexo官方文档</a>、<a href="https://pages.github.com/">Github pages官方文档</a>和<a href="https://onlyar.site/2024/01/11/hexo-guide-1/https://butterfly.js.org/">一位学长的博客</a>，我们将根据以下流程搭建个人博客。</li>
</ul>
<figure>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407291104549.png" alt="流程图"></div>
<p><figcaption style="text-align: center;" class="center">免费个人博客搭建流程图</figcaption>
</p></figure>
<h4 id="环境搭建">环境搭建</h4>
<ol>
<li>进入Git官网https://git-scm.com/download/win 下载对应版本(此处以Windows为例)</li>
</ol>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407281150467.png
" class="center"></div>
<p>
<ol start="2">
<li>进入<a href="https://nodejs.org/zh-cn/download/prebuilt-installer">Node.js下载界面</a>下载安装对应版本(仍以Windows为例)</li>
</ol>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407281159724.png" class="center"></div>
</p><p>
<ol start="3">
<li>在桌面右键点击&quot;在终端打开&quot;，输入以下命令检查是否安装成功：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">node -v</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm -v</span><br></pre></td></tr></table></figure>
</p><p>当三个命令都返回版本号时，说明环境搭建成功。</p>
<h4 id="创建github-pages仓库">创建GitHub Pages仓库</h4>
<ol>
<li>登录或注册GitHub后，桌面右键打开Git Bash，输入以下命令设置用户名和邮箱：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;Github 用户名&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.email <span class="string">&quot;Github 用户邮箱</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>输入以下命令创建SSH Key：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;Github 用户邮箱&quot;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>按照提示完成创建，默认保存路径为C:\Users\用户名.ssh，用记事本打开该路径，复制id_rsa.pub文件中的内容。</li>
<li>登录GitHub，点击右上角头像，选择<code>Settings</code>，在左侧选择<code>SSH and GPG keys</code>，点击<code>New SSH key</code>，将刚刚复制的公钥粘贴到Key中，Title可以随意填写，最后选择<code>Add SSH key</code>。</li>
</ol>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407290942095.png" class="center"></div>
<p>
<ol start="5">
<li>打开Git Bash，输入以下命令检查是否连接成功：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure>
</p><p>输入<code>yes</code>确认后，如果返回<code>Hi 用户名! You've successfully authenticated, but GitHub does not provide shell access.</code>说明连接成功。</p>
<ol>
<li>Github首页点击右上角的“+”号，选择“New repository”创建Github Pages仓库。</li>
</ol>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407290908296.png" class="center"></div>
<p>
<ol start="2">
<li>在“Repository name”中输入你的用户名，例如<code>用户名.github.io</code>。</li>
<li>选择“Public”作为仓库的可见性。</li>
<li>勾选“Add a README file”。</li>
<li>点击“Create repository”按钮。</li>
</ol>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407290915320.png" class="center"></div>
</p><p>
</p><h4 id="安装部署hexo程序">安装部署Hexo程序</h4>
<ol>
<li>打开终端，输入以下命令安装Hexo：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>打开资源管理器，选择一个合适的目录，创建一个新的Hexo博客文件夹，例如<code>myblog</code>，并进入该文件夹：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> myblog</span><br><span class="line"><span class="built_in">cd</span> myblog</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>初始化Hexo博客并安装组件：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo init      <span class="comment"># 初始化</span></span><br><span class="line">npm install    <span class="comment"># 安装组件</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>需要耐心等待一段时间，可以挂个梯子加速</p>
</blockquote>
<ol start="4">
<li>成功后可输入以下命令查看博客：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>
<p><code>Ctrl</code>+左键点击终端上的<code>http://localhost:4000</code>或打开浏览器，输入<code>http://localhost:4000</code>，即可看到Hexo博客的初始页面。</p>
<ol start="5">
<li>打开Hexo博客文件夹，找到<code>_config.yml</code>文件，使用文本编辑器打开。</li>
<li>修改以下配置： <figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Your</span> <span class="string">Blog</span> <span class="string">Title</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">Your</span> <span class="string">Blog</span> <span class="string">Subtitle</span> <span class="comment">#选填</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">Your</span> <span class="string">Blog</span> <span class="string">Description</span> <span class="comment">#选填</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Your</span> <span class="string">Name</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">Asia/Shanghai</span> <span class="comment">#一般填这个</span></span><br><span class="line"></span><br><span class="line"><span class="string">···</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://用户名.github.io</span> <span class="comment">#或是绑定的域名</span></span><br><span class="line"></span><br><span class="line"><span class="string">···</span></span><br><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/用户名/用户名.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>
</li>
<li>保存并关闭<code>_config.yml</code>文件，输入<code>hexo d</code>部署网站。这时候访问<code>https://用户名.github.io</code>就可以看到你的博客了。</li>
</ol>
<h4 id="安装配置butterfly主题">安装配置Butterfly主题</h4>
<ol>
<li>在终端中输入以下命令安装Butterfly主题： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i hexo-theme-butterfly</span><br></pre></td></tr></table></figure>
</li>
<li>打开Hexo博客文件夹，打开<code>_config.yml</code>文件，修改以下配置： <figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">···</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">butterfly</span></span><br></pre></td></tr></table></figure>
</li>
<li>保存并关闭<code>_config.yml</code>文件。</li>
<li>按照themes\butterfly_config.yml的路径打开配置文件，根据<a href="https://butterfly.js.org/posts/21cfbf15/">Butterfly主题的官方文档</a>进行配置。</li>
</ol>
<blockquote>
<p>文档比较长，一些不想要的功能跳过就好</p>
</blockquote>
<ol start="6">
<li>重新部署网站，即可看到Butterfly主题的效果。</li>
</ol>
<h4 id="绑定配置域名-可选">绑定配置域名(可选)</h4>
<ol>
<li>
<p>去<a href="https://cloud.tencent.com/">腾讯云</a>、<a href="https://cn.aliyun.com/">阿里云</a>或者其他域名注册商走一遍注册流程，购买一个域名，如<code>yourdomain.com</code>。</p>
</li>
<li>
<p>在Github仓库下创建一个CNAME(别名记录)文件，命名为<code>CNAME</code>文件内容为你的域名，如<code>yourdomain.com</code>。</p>
</li>
<li>
<p>在域名管理后台添加CNAME解析，将<code>yourdomain.com</code>解析到<code>用户名.github.io</code>。参考网站上的教程或者搜索相关教程。</p>
</li>
<li>
<p>等待解析生效，即可通过域名访问博客。</p>
</li>
</ol>
<h4 id="配置picgo图床">配置PicGo图床</h4>
<blockquote>
<p>由于Github国内访问速度感人，现在配置出来的博客访问也是极其缓慢的，这时我们可以考虑使用国内的图床网站，如腾讯云COS，阿里云COS，Gitee等，利用PicGo软件进行图床管理，将图片上传到图床，然后在博客中引用图床中的图片。此处建议搜索相关教程，我使用的是Gitee <s>(因为免费)</s></p>
</blockquote>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407291151044.png" class="center"></div>
<p>
</p><h4 id="创建博客文章">创建博客文章</h4>
<ol>
<li>在终端中输入以下命令创建新的博客文章： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new post <span class="string">&quot;Your Blog Post Title&quot;</span> <span class="comment">#hexo n</span></span><br></pre></td></tr></table></figure>
</li>
<li>根据<code>source/_posts/Your Blog Post Title.md</code>路径打开文件编辑即可。</li>
<li>写完后保存文章文件。</li>
</ol>
<h4 id="部署博客">部署博客</h4>
<ol>
<li>在终端中输入以下命令生成静态文件： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo generate</span><br></pre></td></tr></table></figure>
</li>
<li>在终端中输入以下命令部署博客： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>或者直接输入以下命令</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d &amp;&amp; hexo s</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>等待部署完成，打开浏览器，访问<code>https://用户名.github.io</code>或者绑定的域名即可查看你的博客。</li>
</ol>
<h3 id="结语">结语</h3>
<blockquote>
<p>至此，我们已经成功创建了一个基于Hexo和Github Pages的博客，并且可以通过域名访问你的博客。我自己在搭建的过程中还碰见了很多问题，但都可以通过搜索相关回复解决。这篇文章只是给出博客搭建的实现思路和简要教程，你仍然可以通过Hexo的其他插件来美化你的博客。希望这篇博客对你有所帮助，祝你使用愉快！</p>
</blockquote>
]]></content>
      <categories>
        <category>博客</category>
      </categories>
      <tags>
        <tag>github</tag>
        <tag>hexo</tag>
        <tag>博客</tag>
        <tag>学习</tag>
        <tag>教程</tag>
        <tag>网站</tag>
      </tags>
  </entry>
  <entry>
    <title>P3-CPU设计文档[BUAA-CO]</title>
    <url>/2024/11/04/CO-P3-document/</url>
    <content><![CDATA[<h2 id="p3单周期cpu设计文档">P3单周期CPU设计文档</h2>
<h3 id="设计整体概述">设计整体概述</h3>
<ol>
<li><strong>预计实现指令集</strong>：add、sub、ori、Lui、lw、sw、beq、nop</li>
</ol>
<ul>
<li>R型指令：add、sub、ori</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">rs</th>
<th style="text-align:center">rt</th>
<th style="text-align:center">rd</th>
<th style="text-align:center">shamt</th>
<th style="text-align:center">funct</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">6</td>
</tr>
</tbody>
</table>
<ul>
<li>I型指令：lui、lw、sw、beq</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">rs</th>
<th style="text-align:center">rt</th>
<th style="text-align:center">offset</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">16</td>
</tr>
</tbody>
</table>
<ul>
<li>J型指令：暂无</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">instr_inde</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">26</td>
</tr>
</tbody>
</table>
<blockquote>
<p>其中，nop指令为空指令，不执行任何操作，add、sub不考虑溢出，故实际执行addu和subu</p>
</blockquote>
<ol start="3">
<li><strong>实现功能</strong>：实现单周期CPU，能够执行上述指令集，采用模块化设计，顶层模块包含控制器<code>CU</code>和数据通路模块<code>ALU</code>、<code>IFU</code>、<code>NPC</code>、<code>GRF</code>、<code>DM</code>、<code>Ext</code>共七个子模块，预留了J型指令的<code>NPC</code>接口</li>
<li><strong>顶层设计图</strong>：<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510976.png" alt></li>
</ol>
<h3 id="数据通路模块设计">数据通路模块设计</h3>
<h4 id="ifu-指令单元">IFU 指令单元</h4>
<ol>
<li><strong>定义</strong>：模块内部包含<code>PC</code>程序计数器、<code>IM</code>指令存储器子模块，负责根据PC的值从指令存储器中读取指令，输出到数据总线。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Next_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>NPC</code>模块输出的下一条指令地址</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">stop</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停机信号</td>
</tr>
<tr>
<td style="text-align:center">RD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>IM</code>取得的指令</td>
</tr>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>PC</code>模块输出地址，传入<code>NPC</code>模块用于得到下一条指令地址</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510974.png" alt></p>
<ol start="2">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">复位</td>
<td style="text-align:center">当reset信号为1时，<code>PC</code>置0x00003000</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">停机</td>
<td style="text-align:center">当stop信号为1时，<code>PC</code>保持不变</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">取指</td>
<td style="text-align:center">当stop信号为0时，根据<code>PC</code>在clk上升沿得到的下一条指令地址，从<code>IM</code>读取指令</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510975.png" alt></p>
<blockquote>
<p><code>PC</code>通过寄存器实现，初始化为0x00003000<br>
IM`通过ROM实现，取PC[13:2]作为地址，减去0x00003000后读取指令</p>
</blockquote>
<h4 id="npc-指令地址生成单元">NPC 指令地址生成单元</h4>
<ol>
<li><strong>定义</strong>：根据当前PC地址和控制信号，生成下一条指令地址。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前指令地址</td>
</tr>
<tr>
<td style="text-align:center">instr_index</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">J型指令的立即数</td>
</tr>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">I型指令的立即数</td>
</tr>
<tr>
<td style="text-align:center">rs</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">jr指令的寄存器</td>
</tr>
<tr>
<td style="text-align:center">branch</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">是否执行I型指令跳转</td>
</tr>
<tr>
<td style="text-align:center">jump</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">是否执行J型指令跳转</td>
</tr>
<tr>
<td style="text-align:center">jr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">是否执行jr指令跳转</td>
</tr>
<tr>
<td style="text-align:center">Next_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">下一条指令地址</td>
</tr>
<tr>
<td style="text-align:center">PC+4</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前指令地址+4，可用于拓展Jal指令</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510977.png" alt></p>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">PC+4</td>
<td style="text-align:center">当branch、jump、jr组成的control信号为3’b000时,Next_PC输出PC+4</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">I型跳转</td>
<td style="text-align:center">当branch、jump、jr组成的control信号为3’b100时,Next_PC输出PC_jump</td>
</tr>
</tbody>
</table>
<h4 id="grf-寄存器堆">GRF 寄存器堆</h4>
<ol>
<li><strong>定义</strong>：根据读写信号，对寄存器堆进行读写操作。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">WE</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">写使能信号</td>
</tr>
<tr>
<td style="text-align:center">A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器1地址</td>
</tr>
<tr>
<td style="text-align:center">A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器2地址</td>
</tr>
<tr>
<td style="text-align:center">A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">写寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">WD</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写数据</td>
</tr>
<tr>
<td style="text-align:center">RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器1数据</td>
</tr>
<tr>
<td style="text-align:center">RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器2数据</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510972.png" alt></p>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">复位</td>
<td style="text-align:center">当reset为1时，将所有寄存器置为0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">读</td>
<td style="text-align:center">当WE为0时，将A1、A2对应的寄存器数据输出到RD1、RD2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">写</td>
<td style="text-align:center">当WE为1时，在时钟上升沿将A3对应的寄存器写入WD</td>
</tr>
</tbody>
</table>
<blockquote>
<p>A1、A2分别读取Rs、Rt寄存器，A3写入RegAddress（根据RegDst选择Rt或Rd），WD写入RegData（根据MemRead选择ALU的运算结果或I型指令的立即数）</p>
</blockquote>
<h4 id="alu-算术逻辑单元">ALU 算术逻辑单元</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行算术或逻辑运算。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">操作数1</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">操作数2</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">ALU控制信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">cmp_equal</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">A、B是否相等</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510968.png" alt></p>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">加法</td>
<td style="text-align:center">当ALU_Op为3’b000时，ALU_Res输出A+B</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">减法</td>
<td style="text-align:center">当ALU_Op为3’b001时，ALU_Res输出A-B</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">与</td>
<td style="text-align:center">当ALU_Op为3’b010时，ALU_Res输出A&amp;B</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">或</td>
<td style="text-align:center">当ALU_Op为3’b011时，ALU_Res输出A丨B</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">异或</td>
<td style="text-align:center">当ALU_Op为3’b100时，ALU_Res输出A^B</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">低位补0</td>
<td style="text-align:center">当ALU_Op为3’b101时，ALU_Res输出B[15:0] + 0<sup>16</sup>（实现lui指令）</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">相等</td>
<td style="text-align:center">cmp_equal输出A是否等于B</td>
</tr>
</tbody>
</table>
<h4 id="ext-指令扩展单元">Ext 指令扩展单元</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的16位立即数进行零扩展或符号扩展。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">16位立即数</td>
</tr>
<tr>
<td style="text-align:center">sel</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展选择信号，0为零扩展，1为符号扩展</td>
</tr>
<tr>
<td style="text-align:center">extend</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">扩展后的32位立即数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">零扩展</td>
<td style="text-align:center">当sel为0时，extend输出 0<sup>16</sup> + offset[15:0]</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">符号扩展</td>
<td style="text-align:center">当sel为1时，extend输出 offset[15] ? 1<sup>16</sup> + offset[15:0] : 0<sup>16</sup> + offset[15:0]</td>
</tr>
</tbody>
</table>
<h4 id="dm-数据存储器">DM 数据存储器</h4>
<ol>
<li><strong>定义</strong>：使用RAM实现，根据控制信号，对输入的地址和数据进行读写操作。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">address</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">32位地址</td>
</tr>
<tr>
<td style="text-align:center">WD</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">32位数据</td>
</tr>
<tr>
<td style="text-align:center">WE</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">读/写控制信号，0为读，1为写</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510971.png" alt></p>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">读</td>
<td style="text-align:center">当WE为0时，输出地址对应的32位数据</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">写</td>
<td style="text-align:center">当WE为1时，将WD写入地址对应的32位数据</td>
</tr>
</tbody>
</table>
<h3 id="cu-控制单元">CU 控制单元</h3>
<ol>
<li>
<p><strong>定义</strong>：利用<code>ANDLogic</code>和<code>ORLogic</code>生成控制信号，控制其他模块的行为。</p>
</li>
<li>
<p><strong>端口定义</strong><br>
控制单元需要读取指令的Op字段和Func字段，识别生成对应指令的控制信号。</p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">instr[31:26]</td>
</tr>
<tr>
<td style="text-align:center">Func</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">instr[5:0]</td>
</tr>
<tr>
<td style="text-align:center">RegDst</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>写地址选择信号，0为Rt，1为Rd</td>
</tr>
<tr>
<td style="text-align:center">ALUSrc</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>ALU</code>源选择信号，0为RD2，1为拓展后的offset</td>
</tr>
<tr>
<td style="text-align:center">RegWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>DM</code>写使能信号</td>
</tr>
<tr>
<td style="text-align:center">is_Branch</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">I型跳转指令</td>
</tr>
<tr>
<td style="text-align:center">ExtOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展操作选择信号, 0为零拓展，1为符号拓展</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">三位ALU操作码，3’b000为加法，3’b001为减法，3’b010为与，3’b011为或，3’b100为异或</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510970.png" alt></p>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<ul>
<li><code>ANDLogic</code>模块
<ul>
<li><strong>定义</strong>：根据输入信号，识别对应指令。</li>
<li><strong>端口定义</strong>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">instr[31:26]</td>
</tr>
<tr>
<td style="text-align:center">Func</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">instr[5:0]</td>
</tr>
<tr>
<td style="text-align:center">add</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">add指令</td>
</tr>
<tr>
<td style="text-align:center">sub</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">sub指令</td>
</tr>
<tr>
<td style="text-align:center">ori</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">ori指令</td>
</tr>
<tr>
<td style="text-align:center">lw</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">lw指令</td>
</tr>
<tr>
<td style="text-align:center">sw</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">sw指令</td>
</tr>
<tr>
<td style="text-align:center">beq</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">beq指令</td>
</tr>
<tr>
<td style="text-align:center">lui</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">lui指令</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510969.png" alt></p>
<table>
<thead>
<tr>
<th style="text-align:center">指令</th>
<th style="text-align:center">Op</th>
<th style="text-align:center">[25:21]</th>
<th style="text-align:center">[20:16]</th>
<th style="text-align:center">[15:11]</th>
<th style="text-align:center">[10:6]</th>
<th style="text-align:center">[5:0]</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">add</td>
<td style="text-align:center">000000</td>
<td style="text-align:center">rs</td>
<td style="text-align:center">rt</td>
<td style="text-align:center">rd</td>
<td style="text-align:center">00000</td>
<td style="text-align:center">100000</td>
</tr>
<tr>
<td style="text-align:center">sub</td>
<td style="text-align:center">000000</td>
<td style="text-align:center">rs</td>
<td style="text-align:center">rt</td>
<td style="text-align:center">rd</td>
<td style="text-align:center">00000</td>
<td style="text-align:center">100010</td>
</tr>
<tr>
<td style="text-align:center">ori</td>
<td style="text-align:center">001101</td>
<td style="text-align:center">rs</td>
<td style="text-align:center">rt</td>
<td style="text-align:center">immediate</td>
<td style="text-align:center">immediate</td>
<td style="text-align:center">immediate</td>
</tr>
<tr>
<td style="text-align:center">lw</td>
<td style="text-align:center">100011</td>
<td style="text-align:center">base</td>
<td style="text-align:center">rt</td>
<td style="text-align:center">offset</td>
<td style="text-align:center">offset</td>
<td style="text-align:center">offset</td>
</tr>
<tr>
<td style="text-align:center">sw</td>
<td style="text-align:center">101011</td>
<td style="text-align:center">base</td>
<td style="text-align:center">rt</td>
<td style="text-align:center">offset</td>
<td style="text-align:center">offset</td>
<td style="text-align:center">offset</td>
</tr>
<tr>
<td style="text-align:center">beq</td>
<td style="text-align:center">000100</td>
<td style="text-align:center">rs</td>
<td style="text-align:center">rt</td>
<td style="text-align:center">offset</td>
<td style="text-align:center">offset</td>
<td style="text-align:center">offset</td>
</tr>
<tr>
<td style="text-align:center">lui</td>
<td style="text-align:center">001111</td>
<td style="text-align:center">00000</td>
<td style="text-align:center">rt</td>
<td style="text-align:center">immediate</td>
<td style="text-align:center">immediate</td>
<td style="text-align:center">immediate</td>
</tr>
</tbody>
</table>
<ul>
<li><code>ORLogic</code>模块
<ul>
<li><strong>定义</strong>：根据输入的对应指令，生成其他模块的操作信号。</li>
<li><strong>端口定义</strong>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">add</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">add指令</td>
</tr>
<tr>
<td style="text-align:center">sub</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">sub指令</td>
</tr>
<tr>
<td style="text-align:center">ori</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">ori指令</td>
</tr>
<tr>
<td style="text-align:center">lw</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">lw指令</td>
</tr>
<tr>
<td style="text-align:center">sw</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">sw指令</td>
</tr>
<tr>
<td style="text-align:center">RegDst</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>写地址选择信号，0为Rt，1为Rd</td>
</tr>
<tr>
<td style="text-align:center">ALUSrc</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>ALU</code>源选择信号，0为RD2，1为拓展后的offset</td>
</tr>
<tr>
<td style="text-align:center">MemRead</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>数据选择信号，0为ALU_Res，1为内存读取数据</td>
</tr>
<tr>
<td style="text-align:center">RegWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>DM</code>写使能信号</td>
</tr>
<tr>
<td style="text-align:center">is_Branch</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">I型跳转指令</td>
</tr>
<tr>
<td style="text-align:center">ExtOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展操作选择信号, 0为零拓展，1为符号拓展</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">三位ALU操作码，由真值表生成</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510967.png" alt><br>
- <strong>功能实现</strong>：根据每种指令的对应操作，在输出前将指令信号进行或运算，得到其他模块的操作信号。</p>
<h2 id="测试方案">测试方案</h2>
<h2 id="思考题">思考题</h2>
<ol>
<li>上面我们介绍了通过 FSM 理解单周期 CPU 的基本方法。请大家指出单周期 CPU 所用到的模块中，哪些发挥状态存储功能，哪些发挥状态转移功能。</li>
</ol>
<blockquote>
<p>GRF、DM实现了状态存储功能，通过寄存器存储当前状态，IFU、Ext、NPC、ALU、CU实现了状态转移功能，利用组合逻辑电路实现状态转移。</p>
</blockquote>
<ol start="2">
<li>现在我们的模块中 IM 使用 ROM， DM 使用 RAM， GRF 使用 Register，这种做法合理吗？ 请给出分析，若有改进意见也请一并给出。</li>
</ol>
<blockquote>
<p>极为合理且正确，IM模块类比于是输入，应当是只读的，DM是内存部分，需要大量存储空间，因此使用RAM，GRF是通用寄存器堆，使用32个寄存器可以提高读写速度。</p>
</blockquote>
<ol start="3">
<li>在上述提示的模块之外，你是否在实际实现时设计了其他的模块？如果是的话，请给出介绍和设计的思路。</li>
</ol>
<blockquote>
<p>添加了NPC模块，用于计PC的值，实现方法见上。</p>
</blockquote>
<ol start="4">
<li>事实上，实现 nop 空指令，我们并不需要将它加入控制信号真值表，为什么？</li>
</ol>
<blockquote>
<p>由于nop并未对其他模块进行操作，因此不需要添加控制信号，只需要保证CU模块对于nop对应的Op和Func没有任何输出，就能保证不对其他模块进行操作。</p>
</blockquote>
<ol start="5">
<li>阅读 Pre 的 <a href="http://cscore.buaa.edu.cn/tutorial/mips/mips-6/mips6-1/">“MIPS 指令集及汇编语言”</a>一节中给出的测试样例，评价其强度（可从各个指令的覆盖情况，单一指令各种行为的覆盖情况等方面分析），并指出具体的不足之处。<br>
测试样例代码</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ori $a0, $0, 123</span><br><span class="line">ori $a1, $a0, 456</span><br><span class="line">lui $a2, 123            # 符号位为 0</span><br><span class="line">lui $a3, 0xffff         # 符号位为 1</span><br><span class="line">ori $a3, $a3, 0xffff    # $a3 = -1</span><br><span class="line">add $s0, $a0, $a2      # 正正</span><br><span class="line">add $s1, $a0, $a3      # 正负</span><br><span class="line">add $s2, $a3, $a3      # 负负</span><br><span class="line">ori $t0, $0, 0x0000</span><br><span class="line">sw $a0, 0($t0)</span><br><span class="line">sw $a1, 4($t0)</span><br><span class="line">sw $a2, 8($t0)</span><br><span class="line">sw $a3, 12($t0)</span><br><span class="line">sw $s0, 16($t0)</span><br><span class="line">sw $s1, 20($t0)</span><br><span class="line">sw $s2, 24($t0)</span><br><span class="line">lw $a0, 0($t0)</span><br><span class="line">lw $a1, 12($t0)</span><br><span class="line">sw $a0, 28($t0)</span><br><span class="line">sw $a1, 32($t0)</span><br><span class="line">ori $a0, $0, 1</span><br><span class="line">ori $a1, $0, 2</span><br><span class="line">ori $a2, $0, 1</span><br><span class="line">beq $a0, $a1, loop1     # 不相等</span><br><span class="line">beq $a0, $a2, loop2     # 相等</span><br><span class="line">loop1:sw $a0, 36($t0)</span><br><span class="line">loop2:sw $a1, 40($t0)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>显然强度是不够的（不够暴力），在代码数据量和覆盖率方面都有待提高，并没有测试到所有的通用寄存器和边界情况，测试数据也不够全面。</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>lab</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
      </tags>
  </entry>
  <entry>
    <title>P4-CPU设计文档[BUAA-CO]</title>
    <url>/2024/11/04/CO-P4-document/</url>
    <content><![CDATA[<h2 id="p4单周期cpu设计文档">P4单周期CPU设计文档</h2>
<h3 id="设计整体概述">设计整体概述</h3>
<ol>
<li><strong>预计实现指令集</strong>：add、sub、ori、Lui、lw、sw、beq、nop、j、jr、jal、jalr</li>
</ol>
<ul>
<li>R型指令：add、sub、ori、jr、jalr</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">rs</th>
<th style="text-align:center">rt</th>
<th style="text-align:center">rd</th>
<th style="text-align:center">shamt</th>
<th style="text-align:center">funct</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">6</td>
</tr>
</tbody>
</table>
<ul>
<li>I型指令：lui、lw、sw、beq</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">rs</th>
<th style="text-align:center">rt</th>
<th style="text-align:center">offset</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">16</td>
</tr>
</tbody>
</table>
<ul>
<li>J型指令：j、jal</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">instr_index</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">26</td>
</tr>
</tbody>
</table>
<blockquote>
<p>其中，nop指令为空指令，不执行任何操作，add、sub不考虑溢出，故实际执行addu和subu</p>
</blockquote>
<ol start="3">
<li><strong>实现功能</strong>：实现单周期CPU，能够执行上述指令集，采用模块化设计，顶层模块包含控制器<code>CU</code>和数据通路模块<code>ALU</code>、<code>IFU</code>、<code>NPC</code>、<code>GRF</code>、<code>DM</code>、<code>Ext</code>共七个子模块</li>
<li><strong>顶层设计图</strong>：<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510976.png" alt></li>
</ol>
<h3 id="数据通路模块设计">数据通路模块设计</h3>
<h4 id="ifu-指令单元">IFU 指令单元</h4>
<ol>
<li><strong>定义</strong>：模块内部包含<code>PC</code>程序计数器、<code>IM</code>指令存储器实现，负责根据PC的值从指令存储器中读取指令输出。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Next_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>NPC</code>模块输出的下一条指令地址</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">stop</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停机信号</td>
</tr>
<tr>
<td style="text-align:center">RD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>IM</code>取得的指令</td>
</tr>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>PC</code>模块输出地址，传入<code>NPC</code>模块用于得到下一条指令地址</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510974.png" alt></p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] IM_Reg [<span class="number">0</span>:<span class="number">4095</span>];</span><br><span class="line"><span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">    <span class="built_in">$readmemh</span>(<span class="string">&quot;code.txt&quot;</span>, IM_Reg); <span class="comment">// Read the code from the file</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>实现从文件中读取指令的功能<br>
2. <strong>实现功能</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">同步复位</td>
<td style="text-align:center">当reset信号为1且处于时钟上升沿时，<code>PC</code>置0x00003000</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">停机</td>
<td style="text-align:center">当stop信号为1时，<code>PC</code>保持不变</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">取指</td>
<td style="text-align:center">当stop信号为0时，根据<code>PC</code>在clk上升沿得到的下一条指令地址，从<code>IM</code>读取指令</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510975.png" alt></p>
<blockquote>
<p><code>PC</code>初始化为0x00003000<br>
<code>IM</code>取PC[13:2]作为地址，减去0x00003000后读取指令</p>
</blockquote>
<h4 id="npc-指令地址生成单元">NPC 指令地址生成单元</h4>
<ol>
<li><strong>定义</strong>：根据当前PC地址和控制信号，生成下一条指令地址。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前指令地址</td>
</tr>
<tr>
<td style="text-align:center">instr_index</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">J型指令的立即数</td>
</tr>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">I型指令的立即数</td>
</tr>
<tr>
<td style="text-align:center">rs</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">jr指令的寄存器</td>
</tr>
<tr>
<td style="text-align:center">branch</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">是否执行I型指令跳转</td>
</tr>
<tr>
<td style="text-align:center">jump</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">是否执行J型指令跳转</td>
</tr>
<tr>
<td style="text-align:center">jr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">是否执行jr指令跳转，读取rs寄存器中的值</td>
</tr>
<tr>
<td style="text-align:center">Next_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">下一条指令地址</td>
</tr>
<tr>
<td style="text-align:center">PC_plus_4</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前指令地址+4，可用于Jal指令将地址存入$ra</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510977.png" alt></p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line">PC_Branch = PC + <span class="number">32&#x27;h00000004</span> + &#123;&#123;<span class="number">14</span>&#123;offset[<span class="number">15</span>]&#125;&#125;, offset, <span class="number">2&#x27;b00</span>&#125;;</span><br><span class="line">PC_Jump = &#123;PC[<span class="number">31</span>:<span class="number">28</span>], Instr_index, <span class="number">2&#x27;b00</span>&#125;;</span><br><span class="line">PC_plus_4 = PC + <span class="number">32&#x27;h00000004</span>;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">PC+4</td>
<td style="text-align:center">Next_PC输出PC+4</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">I型跳转</td>
<td style="text-align:center">beq时，Next_PC输出PC_Branch</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">JR型跳转</td>
<td style="text-align:center">jr时Next_PC输出rs</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">J型跳转</td>
<td style="text-align:center">j、jal、jalr时,Next_PC输出PC_Jump</td>
</tr>
</tbody>
</table>
<h4 id="grf-寄存器堆">GRF 寄存器堆</h4>
<ol>
<li><strong>定义</strong>：根据读写信号，对寄存器堆进行读写操作。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器1地址</td>
</tr>
<tr>
<td style="text-align:center">A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器2地址</td>
</tr>
<tr>
<td style="text-align:center">RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">写寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">RegData</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写数据</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">写使能信号</td>
</tr>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前PC地址，用于输出</td>
</tr>
<tr>
<td style="text-align:center">RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器1数据</td>
</tr>
<tr>
<td style="text-align:center">RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器2数据</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510972.png" alt></p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (RegWrite) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (RegAddr != <span class="number">0</span>) <span class="keyword">begin</span> <span class="comment">// Register 0 is always 0</span></span><br><span class="line">        GRF_reg[RegAddr] &lt;= RegData;</span><br><span class="line">        <span class="built_in">$display</span>(<span class="string">&quot;@%h: $%d &lt;= %h&quot;</span>, PC, RegAddr, RegData);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>实现输出寄存器堆中寄存器改变的信息<br>
3. <strong>实现功能</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">复位</td>
<td style="text-align:center">当reset为1时，将所有寄存器置为0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">读</td>
<td style="text-align:center">当RegWrite为0时，将A1、A2对应的寄存器数据输出到RD1、RD2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">写</td>
<td style="text-align:center">当RegWrite为1时，当RegAddr不为0时，在时钟上升沿将RegAddr对应的寄存器写入RegData</td>
</tr>
</tbody>
</table>
<blockquote>
<p>A1、A2分别读取Rs、Rt寄存器，RegAddress根据RegDst选择Rt或R），RegData根据MemRead选择ALU的运算结果或I型指令的立即数</p>
</blockquote>
<h4 id="alu-算术逻辑单元">ALU 算术逻辑单元</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行算术或逻辑运算。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">操作数1</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">操作数2</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">ALU控制信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">cmp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">A、B比较结果</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510968.png" alt></p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">parameter</span> ADD = <span class="number">4&#x27;b0000</span>,</span><br><span class="line">            SUB = <span class="number">4&#x27;b0001</span>,</span><br><span class="line">            AND = <span class="number">4&#x27;b0010</span>,</span><br><span class="line">            OR = <span class="number">4&#x27;b0011</span>,</span><br><span class="line">            XOR = <span class="number">4&#x27;b0100</span>,</span><br><span class="line">            LUI = <span class="number">4&#x27;b0101</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">assign</span> cmp = (A == B) ? <span class="number">2&#x27;b11</span> :</span><br><span class="line">                    (A &gt;= B) ? <span class="number">2&#x27;b10</span> :</span><br><span class="line">                    (A &gt; B) ? <span class="number">2&#x27;b01</span> :</span><br><span class="line">                    <span class="number">2&#x27;b00</span>;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">加法</td>
<td style="text-align:center">当ALU_Op为3’b000时，ALU_Res输出A+B</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">减法</td>
<td style="text-align:center">当ALU_Op为3’b001时，ALU_Res输出A-B</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">与</td>
<td style="text-align:center">当ALU_Op为3’b010时，ALU_Res输出A&amp;B</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">或</td>
<td style="text-align:center">当ALU_Op为3’b011时，ALU_Res输出A丨B</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">异或</td>
<td style="text-align:center">当ALU_Op为3’b100时，ALU_Res输出A^B</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">低位补0</td>
<td style="text-align:center">当ALU_Op为3’b101时，ALU_Res输出B[15:0] + 0<sup>16</sup>（实现lui指令）</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">相等</td>
<td style="text-align:center">cmp输出A、B比较结果</td>
</tr>
</tbody>
</table>
<h4 id="ext-指令扩展单元">Ext 指令扩展单元</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的16位立即数进行零扩展或符号扩展。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">16位立即数</td>
</tr>
<tr>
<td style="text-align:center">sel</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展选择信号，0为零扩展，1为符号扩展</td>
</tr>
<tr>
<td style="text-align:center">extend</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">扩展后的32位立即数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">零扩展</td>
<td style="text-align:center">当sel为0时，extend输出 0<sup>16</sup> + offset[15:0]</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">符号扩展</td>
<td style="text-align:center">当sel为1时，extend输出 offset[15] ? 1<sup>16</sup> + offset[15:0] : 0<sup>16</sup> + offset[15:0]</td>
</tr>
</tbody>
</table>
<h4 id="dm-数据存储器">DM 数据存储器</h4>
<ol>
<li><strong>定义</strong>：使用RAM实现，根据控制信号，对输入的地址和数据进行读写操作。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">MemAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">32位地址</td>
</tr>
<tr>
<td style="text-align:center">WD</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">32位数据</td>
</tr>
<tr>
<td style="text-align:center">WE</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">读/写控制信号，0为读，1为写</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">同步复位信号</td>
</tr>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">PC地址</td>
</tr>
<tr>
<td style="text-align:center">DM_RD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">32位数据</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510971.png" alt></p>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">复位</td>
<td style="text-align:center">当reset为1时，将所有数据存储单元置零</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">读</td>
<td style="text-align:center">当WE为0时，输出地址对应的32位数据DM_RD</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">写</td>
<td style="text-align:center">当WE为1时，将MemAddr对应地址写入32位数据WD</td>
</tr>
</tbody>
</table>
<h3 id="cu-控制单元">CU 控制单元</h3>
<ol>
<li>
<p><strong>定义</strong>：利用<code>ANDLogic</code>和<code>ORLogic</code>生成控制信号，控制其他模块的行为。</p>
</li>
<li>
<p><strong>端口定义</strong><br>
控制单元需要读取指令的Op字段和Func字段，识别生成对应指令的控制信号。</p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">instr[31:26]</td>
</tr>
<tr>
<td style="text-align:center">Func</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">instr[5:0]</td>
</tr>
<tr>
<td style="text-align:center">RegDst</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>写地址选择信号，0为Rt，1为Rd</td>
</tr>
<tr>
<td style="text-align:center">ALUSrc</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>ALU</code>源选择信号，0为RD2，1为拓展后的offset</td>
</tr>
<tr>
<td style="text-align:center">RegWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>DM</code>写使能信号</td>
</tr>
<tr>
<td style="text-align:center">is_Branch</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">I型跳转指令</td>
</tr>
<tr>
<td style="text-align:center">is_Jump</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">J型跳转指令</td>
</tr>
<tr>
<td style="text-align:center">is_Jr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">JR跳转指令</td>
</tr>
<tr>
<td style="text-align:center">ExtOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展操作选择信号, 0为零拓展，1为符号拓展</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">四位ALU操作码</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041510970.png" alt></p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">parameter</span> ADDFunc = <span class="number">6&#x27;b100000</span>, <span class="comment">//</span></span><br><span class="line">            SUBFunc = <span class="number">6&#x27;b100010</span>, </span><br><span class="line">            ORIOp = <span class="number">6&#x27;b001101</span>, </span><br><span class="line">            LUIOp = <span class="number">6&#x27;b001111</span>, </span><br><span class="line">            LWOp = <span class="number">6&#x27;b100011</span>, </span><br><span class="line">            SWOp = <span class="number">6&#x27;b101011</span>, </span><br><span class="line">            BEQOp = <span class="number">6&#x27;b000100</span>, </span><br><span class="line">            JOp = <span class="number">6&#x27;b000010</span>, </span><br><span class="line">            JALOp = <span class="number">6&#x27;b000011</span>, </span><br><span class="line">            JRFunc = <span class="number">6&#x27;b001000</span>, </span><br><span class="line">            JALRFunc = <span class="number">6&#x27;b001001</span>;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<ul>
<li>
<p><code>ANDLogic</code>模块</p>
<ul>
<li><strong>定义</strong>：根据输入信号，识别对应指令。</li>
<li><strong>端口定义</strong>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">OP</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">instr[31:26]</td>
</tr>
<tr>
<td style="text-align:center">FUNC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">instr[5:0]</td>
</tr>
<tr>
<td style="text-align:center">ADD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">add指令</td>
</tr>
<tr>
<td style="text-align:center">SUB</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">sub指令</td>
</tr>
<tr>
<td style="text-align:center">ORI</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">ori指令</td>
</tr>
<tr>
<td style="text-align:center">LW</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">lw指令</td>
</tr>
<tr>
<td style="text-align:center">SW</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">sw指令</td>
</tr>
<tr>
<td style="text-align:center">BEQ</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">beq指令</td>
</tr>
<tr>
<td style="text-align:center">LUI</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">lui指令</td>
</tr>
<tr>
<td style="text-align:center">J</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">j指令</td>
</tr>
<tr>
<td style="text-align:center">JR</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">jr指令</td>
</tr>
<tr>
<td style="text-align:center">JAL</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">jal指令</td>
</tr>
<tr>
<td style="text-align:center">JALR</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">jalr指令</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
<li>
<p><code>ORLogic</code>模块</p>
<ul>
<li>
<p><strong>定义</strong>：根据输入的对应指令，生成其他模块的操作信号。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">RegDst</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>写地址选择信号，0为Rt，1为Rd</td>
</tr>
<tr>
<td style="text-align:center">ALUSrc</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>ALU</code>源选择信号，0为RD2，1为拓展后的offset</td>
</tr>
<tr>
<td style="text-align:center">MemRead</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>数据选择信号，0为ALU_Res，1为内存读取数据</td>
</tr>
<tr>
<td style="text-align:center">RegWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>GRF</code>写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>DM</code>写使能信号</td>
</tr>
<tr>
<td style="text-align:center">is_Branch</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">I型跳转指令</td>
</tr>
<tr>
<td style="text-align:center">is_Jump</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">J型跳转指令</td>
</tr>
<tr>
<td style="text-align:center">is_JR</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">JR指令</td>
</tr>
<tr>
<td style="text-align:center">ExtOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展操作选择信号, 0为零拓展，1为符号拓展</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">三位ALU操作码，由真值表生成</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>功能实现</strong>：根据每种指令的对应操作，在输出前将指令信号进行或运算，得到其他模块的操作信号。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> RegDst = ADD || SUB || JALR;</span><br><span class="line"><span class="keyword">assign</span> ALUSrc = ORI || LUI || LW || SW;</span><br><span class="line"><span class="keyword">assign</span> MemRead = LW;</span><br><span class="line"><span class="keyword">assign</span> RegWrite = ADD || SUB || ORI || LUI || LW || JAL || JALR;</span><br><span class="line"><span class="keyword">assign</span> MemWrite = SW;</span><br><span class="line"><span class="keyword">assign</span> is_Branch = BEQ;</span><br><span class="line"><span class="keyword">assign</span> is_Jump = J || JR || JAL || JALR;</span><br><span class="line"><span class="keyword">assign</span> is_Jr = JR || JALR;</span><br><span class="line"><span class="keyword">assign</span> ExtOp = LW || SW;</span><br></pre></td></tr></table></figure>
<h3 id="顶层模块">顶层模块</h3>
<ul>
<li><strong>定义</strong>：顶层模块，将所有模块连接起来，实现整个CPU的功能。</li>
<li><strong>端口定义</strong>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
</tbody>
</table>
</li>
<li><strong>功能实现</strong>：将所有模块连接起来，实现整个CPU的功能。</li>
</ul>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] PC;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] rs;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] Next_PC;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] PC_plus_4;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] Instr;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">5</span>:<span class="number">0</span>] Op = Instr[<span class="number">31</span>:<span class="number">26</span>];</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">4</span>:<span class="number">0</span>] Rs = Instr[<span class="number">25</span>:<span class="number">21</span>];</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">4</span>:<span class="number">0</span>] Rt = Instr[<span class="number">20</span>:<span class="number">16</span>];</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">4</span>:<span class="number">0</span>] Rd = Instr[<span class="number">15</span>:<span class="number">11</span>];</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] offset = Instr[<span class="number">15</span>:<span class="number">0</span>];</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">4</span>:<span class="number">0</span>] Shamt = Instr[<span class="number">10</span>:<span class="number">6</span>];</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">5</span>:<span class="number">0</span>] Func = Instr[<span class="number">5</span>:<span class="number">0</span>];</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">25</span>:<span class="number">0</span>] Instr_index = Instr[<span class="number">25</span>:<span class="number">0</span>];</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] Extend;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] ALUOp;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] A;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] B;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] ALURes;        </span><br><span class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] cmp;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] MemAddr;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] MemData;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] DM_RD;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">4</span>:<span class="number">0</span>] RegAddr;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] RegData;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] RD1;</span><br><span class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] RD2;</span><br><span class="line"><span class="keyword">wire</span> RegWrite;</span><br><span class="line"><span class="keyword">wire</span> RegDst;</span><br><span class="line"><span class="keyword">wire</span> ALUSrc;</span><br><span class="line"><span class="keyword">wire</span> MemRead;</span><br><span class="line"><span class="keyword">wire</span> MemWrite;</span><br><span class="line"><span class="keyword">wire</span> is_Branch;</span><br><span class="line"><span class="keyword">wire</span> is_Jump;</span><br><span class="line"><span class="keyword">wire</span> is_Jr;</span><br><span class="line"><span class="keyword">wire</span> ExtOp;</span><br><span class="line"><span class="keyword">wire</span> branch;</span><br><span class="line"><span class="keyword">wire</span> stop = <span class="number">1&#x27;b0</span>;</span><br></pre></td></tr></table></figure>
<p>通过<code>assign</code>语句与三目运算符实现多路选择</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> rs = RD1;</span><br><span class="line"><span class="keyword">assign</span> branch = is_Branch &amp;&amp; (cmp == <span class="number">2&#x27;b11</span>);</span><br><span class="line"><span class="keyword">assign</span> A = RD1;</span><br><span class="line"><span class="keyword">assign</span> B = ALUSrc ? Extend : RD2;</span><br><span class="line"><span class="keyword">assign</span> MemAddr = ALURes;</span><br><span class="line"><span class="keyword">assign</span> MemData = RD2;</span><br><span class="line"><span class="keyword">assign</span> RegAddr = RegDst ? Rd : is_Jump ? <span class="number">5&#x27;b11111</span> : Rt;</span><br><span class="line"><span class="keyword">assign</span> RegData = MemRead ? DM_RD : is_Jump ? PC_plus_4 : ALURes;</span><br></pre></td></tr></table></figure>
<h2 id="测试方案">测试方案</h2>
<h2 id="第四次思考题">第四次思考题</h2>
<ol>
<li>阅读下面给出的 DM 的输入示例中（示例 DM 容量为 4KB，即 32bit × 1024字），根据你的理解回答，这个 addr 信号又是从哪里来的？地址信号 addr 位数为什么是 [11:2] 而不是 [9:0] ？</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041523155.png" alt></p>
<blockquote>
<p>addr信号来自于ALU的输出端口，因为DM的容量为4KB，即32bit×1024字，是按字引索，故低2位没有作用，地址信号addr的位数应该是[11:2]而不是[9:0]。</p>
</blockquote>
<ol>
<li>思考上述两种控制器设计的译码方式（可以记录下指令对应的控制信号如何取值，也可以记录下控制信号每种取值所对应的指令），给出代码示例，并尝试对比各方式的优劣。</li>
</ol>
<blockquote>
<p>第一种（记录指令对应的控制信号如何取值）</p>
</blockquote>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">case</span> (op) <span class="keyword">begin</span></span><br><span class="line">        <span class="number">6&#x27;b000000</span>: <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (func) <span class="keyword">begin</span></span><br><span class="line">                ADD: <span class="keyword">begin</span></span><br><span class="line">                    ALU_Op = <span class="number">4&#x27;b0000</span>;</span><br><span class="line">                    RegDst = <span class="number">1</span>;</span><br><span class="line">                    RegWrite = <span class="number">1</span>;</span><br><span class="line">                    <span class="comment">//控制信号取值</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">case</span> ...</span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">        LUI: ...</span><br><span class="line">    <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>第二种（控制信号每种取值所对应的指令）</p>
</blockquote>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">    指令信号置<span class="number">0</span></span><br><span class="line">    <span class="keyword">case</span> (Op)</span><br><span class="line">        <span class="number">6&#x27;b000000</span>: <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (Func) </span><br><span class="line">                ADDFunc: <span class="keyword">begin</span></span><br><span class="line">                    ADD = <span class="number">1</span>;</span><br><span class="line">                    ALU_Op = <span class="number">4&#x27;b0000</span>; <span class="comment">// ADD</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                SUBFunc: <span class="keyword">begin</span></span><br><span class="line">                    SUB = <span class="number">1</span>;</span><br><span class="line">                    ALU_Op = <span class="number">4&#x27;b0001</span>; <span class="comment">// SUB</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                ...</span><br><span class="line"><span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        LUIOp: <span class="keyword">begin</span></span><br><span class="line">            LUI = <span class="number">1</span>;</span><br><span class="line">            ALU_Op = <span class="number">4&#x27;b0101</span>; <span class="comment">// LUI</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        ORIOp: <span class="keyword">begin</span></span><br><span class="line">            ORI = <span class="number">1</span>;</span><br><span class="line">            ALU_Op = <span class="number">4&#x27;b0011</span>; <span class="comment">// OR</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assign</span> RegDst = ADD || SUB || JALR;</span><br><span class="line"><span class="keyword">assign</span> ALUSrc = ORI || LUI || LW || SW;</span><br><span class="line"><span class="keyword">assign</span> MemRead = LW;</span><br><span class="line"><span class="keyword">assign</span> RegWrite = ADD || SUB || ORI || LUI || LW || JAL || JALR;</span><br><span class="line"><span class="keyword">assign</span> MemWrite = SW;</span><br><span class="line"><span class="keyword">assign</span> is_Branch = BEQ;</span><br><span class="line"><span class="keyword">assign</span> is_Jump = J || JR || JAL || JALR;</span><br><span class="line"><span class="keyword">assign</span> is_Jr = JR || JALR;</span><br><span class="line"><span class="keyword">assign</span> ExtOp = LW || SW;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>记录指令的所有控制信号怎么取值，能够较方便地追踪每一条指令对应的控制信号，从而方便调试和增加新的指令，但如果添加了一个新的控制信号，需要修改所有指令对应的控制信号取值，比较麻烦。<br>
记录控制信号取值对应的指令，可以很快找到控制信号取值的构成，方便增加新的控制信号，但增加新的指令需要修改多处，可能因为遗漏导致bug。</p>
</blockquote>
<ol start="2">
<li>在相应的部件中，复位信号的设计都是同步复位，这与 P3 中的设计要求不同。请对比同步复位与异步复位这两种方式的 reset 信号与 clk 信号优先级的关系。</li>
</ol>
<blockquote>
<p>同步复位：clk信号优先级高于reset信号，复位信号只在时钟上升沿有效。<br>
异步复位：reset信号优先级高于或相等于clk信号，复位信号在任何时刻都可以有效。应当与clk一样用一个always块来描述。</p>
</blockquote>
<ol start="3">
<li>C 语言是一种弱类型程序设计语言。C 语言中不对计算结果溢出进行处理，这意味着 C 语言要求程序员必须很清楚计算结果是否会导致溢出。因此，如果仅仅支持 C 语言，MIPS 指令的所有计算指令均可以忽略溢出。 请说明为什么在忽略溢出的前提下，addi 与 addiu 是等价的，add 与 addu 是等价的。提示：阅读《MIPS32® Architecture For Programmers Volume II: The MIPS32® Instruction Set》中相关指令的 Operation 部分。</li>
</ol>
<blockquote>
<p>检查addi与addiu、add与addu的对应的Operation部分，发现addi与addiu、add与addu的区别在于addi和add会在溢出时报<code> Integer Overflow</code>异常，而addiu和addu不会，因此当只支持C语言时，MIPS指令可以忽略溢出，addi与addiu等价，add与addu等价。</p>
</blockquote>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041523157.png" alt><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041523158.png" alt><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041523154.png" alt><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202411041523156.png" alt></p>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>lab</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
      </tags>
  </entry>
  <entry>
    <title>P5-CPU设计文档[BUAA-CO]</title>
    <url>/2024/11/26/CO-P5-document/</url>
    <content><![CDATA[<h1 id="p5流水线cpu设计文档">P5流水线CPU设计文档</h1>
<h2 id="设计整体概述">设计整体概述</h2>
<ol>
<li><strong>预计实现指令集</strong>：add、sub、ori、Lui、lw、sw、beq、nop、j、jr、jal</li>
</ol>
<ul>
<li>R型指令：add、sub、ori、jr</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">rs</th>
<th style="text-align:center">rt</th>
<th style="text-align:center">rd</th>
<th style="text-align:center">shamt</th>
<th style="text-align:center">funct</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">6</td>
</tr>
</tbody>
</table>
<ul>
<li>I型指令：lui、lw、sw、beq</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">rs</th>
<th style="text-align:center">rt</th>
<th style="text-align:center">offset</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">16</td>
</tr>
</tbody>
</table>
<ul>
<li>J型指令：j、jal</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">instr_index</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">26</td>
</tr>
</tbody>
</table>
<blockquote>
<p>其中，nop指令为空指令，不执行任何操作，add、sub不考虑溢出，故实际执行addu和subu</p>
</blockquote>
<ol start="3">
<li>
<p><strong>实现功能</strong>：实现五级流水线CPU，通过F、D、E、M、W五个阶段实现指令的执行，其中F阶段为取指，D阶段为译码，E阶段为执行，M阶段为访存，W阶段为写回，各阶段均通过流水线寄存器实现流水线操作，通过转发和阻塞机制解决冒险问题。</p>
</li>
<li>
<p><strong>顶层设计图</strong>：<br>
整体架构参考了PPT上的设计<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202411261112087.png" alt="main"></p>
</li>
<li>
<p><strong>命名格式</strong>：模块命名采用<code>所在级_模块名</code>方式，模块内部信号名采取<code>来源_功能</code>方式命名，顶层信号采用<code>所在级_模块名_信号名</code>方式命名。</p>
</li>
</ol>
<h2 id="数据通路模块设计">数据通路模块设计</h2>
<h3 id="f级：取指fetch">F级：取指<em>Fetch</em></h3>
<h4 id="f-ifu-指令单元">F_IFU 指令单元</h4>
<ol>
<li><strong>定义</strong>：模块内部包含<code>PC</code>程序计数器、<code>IM</code>指令存储器实现，负责根据PC的值从指令存储器中读取指令输出。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">D_Next_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>NPC</code>模块输出的下一条指令地址</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">stop</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停机信号</td>
</tr>
<tr>
<td style="text-align:center">F_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的32位指令</td>
</tr>
<tr>
<td style="text-align:center">F_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输出F级PC值，流入D级寄存器</td>
</tr>
<tr>
<td style="text-align:center">F_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>PC</code>加8的值，用于分支延迟槽指令</td>
</tr>
</tbody>
</table>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] IM_Reg [<span class="number">0</span>:<span class="number">4095</span>];</span><br><span class="line"><span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">    <span class="built_in">$readmemh</span>(<span class="string">&quot;code.txt&quot;</span>, IM_Reg); <span class="comment">// Read the code from the file</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>实现从文件中读取指令的功能<br>
2. <strong>实现功能</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">同步复位</td>
<td style="text-align:center">当<code>reset</code>信号为1且处于时钟上升沿时，<code>PC</code>置0x00003000</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">停机</td>
<td style="text-align:center">当stop信号为1时，<code>PC</code>和指令保持不变</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">取指</td>
<td style="text-align:center">当stop信号为0时，在clk上升沿得到的下一条指令地址PC，读取指令</td>
</tr>
</tbody>
</table>
<p><img src="/2024/11/26/CO-P5-document/.%5CP3_image%5CP3_IFUdetail.png" alt></p>
<blockquote>
<p><code>PC</code>初始化为0x00003000<br>
<code>IM</code>取PC[13:2]作为地址，减去0x00003000后读取指令</p>
</blockquote>
<h3 id="d级：译码decode">D级：译码<em>decode</em></h3>
<h4 id="d-reg-d级流水线寄存器">D_REG D级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：用于在时钟上升沿将F级的指令和PC值传递到D级，并在复位重置寄存器值，并在停机信号为1时保持不变</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">stall</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停机信号</td>
</tr>
<tr>
<td style="text-align:center">F_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的32位指令</td>
</tr>
<tr>
<td style="text-align:center">F_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的PC值</td>
</tr>
<tr>
<td style="text-align:center">F_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的PC+8值</td>
</tr>
<tr>
<td style="text-align:center">D_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级的32位指令</td>
</tr>
<tr>
<td style="text-align:center">D_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级的PC值</td>
</tr>
<tr>
<td style="text-align:center">D_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级的PC+8值</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1且处于时钟上升沿时，<code>D_Instr</code>置0，<code>D_PC</code>置<code>PC_Reset</code>，<code>D_PC8</code>置<code>PC_Reset + 4</code></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">停机</td>
<td style="text-align:left">当<code>stall</code>信号为1时，保持<code>D_Instr</code>、<code>D_PC</code>和<code>D_PC8</code>的值不变</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">当<code>stall</code>信号为0时，在时钟上升沿将<code>F_Instr</code>、<code>F_PC</code>和<code>F_PC8</code>的值传递到<code>D_Instr</code>、<code>D_PC</code>和<code>D_PC8</code></td>
</tr>
</tbody>
</table>
<h4 id="d-npc-指令计算单元">D_NPC 指令计算单元</h4>
<ol>
<li><strong>定义</strong>：根据当前PC值、指令类型和条件分支结果，计算下一条指令的PC值。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">F_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前指令的PC值</td>
</tr>
<tr>
<td style="text-align:center">Instr_index</td>
<td style="text-align:center">I</td>
<td style="text-align:center">26</td>
<td style="text-align:center">跳转指令的目标地址</td>
</tr>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">分支指令的偏移量</td>
</tr>
<tr>
<td style="text-align:center">rs</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">寄存器rs的值</td>
</tr>
<tr>
<td style="text-align:center">NPCSel</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">下一条指令PC选择信号</td>
</tr>
<tr>
<td style="text-align:center">CMPOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">比较结果信号</td>
</tr>
<tr>
<td style="text-align:center">D_Next_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">计算得到的下一条指令的PC值</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">计算分支地址</td>
<td style="text-align:left">根据当前PC值和偏移量计算分支指令的目标地址</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">计算跳转地址</td>
<td style="text-align:left">根据当前PC值和指令索引计算跳转指令的目标地址</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">选择下一条指令PC</td>
<td style="text-align:left">根据NPCSel信号选择下一条指令的PC值，支持顺序执行、分支、跳转和寄存器跳转</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">选择信号</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">数值</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">BranchType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b011</td>
<td style="text-align:center">B型跳转，与CMPOut共同决定跳转</td>
</tr>
<tr>
<td style="text-align:center">JrType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b010</td>
<td style="text-align:center">JR型跳转</td>
</tr>
<tr>
<td style="text-align:center">JumpType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b001</td>
<td style="text-align:center">J型跳转</td>
</tr>
</tbody>
</table>
<h4 id="d-ext-指令扩展">D_EXT 指令扩展</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的16位立即数进行零扩展或符号扩展。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">16位立即数</td>
</tr>
<tr>
<td style="text-align:center">ExtOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展选择信号，0为零扩展，1为符号扩展</td>
</tr>
<tr>
<td style="text-align:center">Extend</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">扩展后的32位立即数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">符号扩展</td>
<td style="text-align:left">当<code>ExtOp</code>信号为1时，<code>Extend</code>输出符号扩展后的32位立即数</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">零扩展</td>
<td style="text-align:left">当<code>ExtOp</code>信号为0时，<code>Extend</code>输出零扩展后的32位立即数</td>
</tr>
</tbody>
</table>
<h4 id="d-cmp-比较器">D_CMP 比较器</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行比较，输出比较结果。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器1数据</td>
</tr>
<tr>
<td style="text-align:center">RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器2数据</td>
</tr>
<tr>
<td style="text-align:center">CMPOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">CMPOut</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">比较结果输出</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">相等比较</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BEQ</code>时，若<code>RD1</code>等于<code>RD2</code>，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">不等比较</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BNE</code>时，若<code>RD1</code>不等于<code>RD2</code>，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">小于等于零</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BLEZ</code>时，若<code>RD1</code>小于等于0，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">大于零</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BGTZ</code>时，若<code>RD1</code>大于0，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
</tbody>
</table>
<h4 id="grf-寄存器堆">GRF 寄存器堆</h4>
<ol>
<li><strong>定义</strong>：根据读写信号，对寄存器堆进行读写操作。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器1地址</td>
</tr>
<tr>
<td style="text-align:center">A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器2地址</td>
</tr>
<tr>
<td style="text-align:center">RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">写寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">RegData</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写数据</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">写使能信号</td>
</tr>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前PC地址，用于输出</td>
</tr>
<tr>
<td style="text-align:center">RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器1数据</td>
</tr>
<tr>
<td style="text-align:center">RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器2数据</td>
</tr>
</tbody>
</table>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (RegWrite) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (RegAddr != <span class="number">0</span>) <span class="keyword">begin</span> <span class="comment">// Register 0 is always 0</span></span><br><span class="line">        GRF_reg[RegAddr] &lt;= RegData;</span><br><span class="line">        <span class="built_in">$display</span>(<span class="string">&quot;@%h: $%d &lt;= %h&quot;</span>, PC, RegAddr, RegData);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>输出寄存器堆中寄存器改变的信息<br>
3. <strong>实现功能</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">复位</td>
<td style="text-align:center">当reset为1时，将所有寄存器置为0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">读</td>
<td style="text-align:center">当RegWrite为0时，将A1、A2对应的寄存器数据输出到RD1、RD2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">写</td>
<td style="text-align:center">当RegWrite为1时，当RegAddr不为0时，在时钟上升沿将RegAddr对应的寄存器写入RegData</td>
</tr>
</tbody>
</table>
<blockquote>
<p>A1、A2分别读取Rs、Rt寄存器，RegAddress根据RegDst选择Rt或R），RegData根据MemRead选择ALU的运算结果或I型指令的立即数</p>
</blockquote>
<ol start="4">
<li><strong>内部转发</strong><br>
当<code>RegWrite</code>为1时，若D级读取的寄存器和W级写入的寄存器相同且不为0，则将<code>RegAddr</code>对应的寄存器的值输出到<code>RD1</code>或<code>RD2</code>。</li>
</ol>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> RD1 = </span><br><span class="line">        (A1 == RegAddr &amp;&amp; RegWrite &amp;&amp; RegAddr != <span class="number">0</span>) ? RegData : GRF_reg[A1]; <span class="comment">// Read the register1</span></span><br><span class="line"><span class="keyword">assign</span> RD2 = </span><br><span class="line">        (A2 == RegAddr &amp;&amp; RegWrite &amp;&amp; RegAddr != <span class="number">0</span>) ? RegData : GRF_reg[A2]; <span class="comment">// Read the register2</span></span><br></pre></td></tr></table></figure>
<h3 id="e级：执行execute">E级：执行<em>Execute</em></h3>
<h4 id="e-reg-e级流水线寄存器">E_REG E级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：存储E级流水线寄存器的数据。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">clr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">清除信号</td>
</tr>
<tr>
<td style="text-align:center">D_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级指令</td>
</tr>
<tr>
<td style="text-align:center">D_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级PC值</td>
</tr>
<tr>
<td style="text-align:center">D_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">D_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">D_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">D_RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">D_RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">D_Rt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级Rt寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">D_Rd</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级Rd寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">ALUOp_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">D级ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">D_Tnew</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">D级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">ALUBSrcSel_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级ALU B源选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">D级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegDstSel_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">D级寄存器目标选择信号</td>
</tr>
<tr>
<td style="text-align:center">D_Extend</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级扩展数据</td>
</tr>
<tr>
<td style="text-align:center">E_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级指令</td>
</tr>
<tr>
<td style="text-align:center">E_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC值</td>
</tr>
<tr>
<td style="text-align:center">E_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">E_A1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">E_A2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">E_RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">E_RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">E_Rt</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级Rt寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">E_Rd</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级Rd寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">ALUOp_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">E级ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">E_Tnew</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">E级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">ALUBSrcSel_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级ALU B源选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">E级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegDstSel_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">E级寄存器目标选择信号</td>
</tr>
<tr>
<td style="text-align:center">E_Extend</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级扩展数据</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1或<code>clr</code>信号为1时，所有输出信号清空，对于暂停操作而言相当于插入nop指令</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">在时钟上升沿，将D级输入信号传递到E级输出信号</td>
</tr>
</tbody>
</table>
<h4 id="alu-算术逻辑单元">ALU 算术逻辑单元</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行算术或逻辑运算。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数A</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数B</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">运算结果</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<p>根据ALU_Op的值，对输入的A和B进行相应的算术或逻辑运算，并将结果输出到ALU_Res。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>ADD</code></td>
<td style="text-align:center">A + B</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>SUB</code></td>
<td style="text-align:center">A - B</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>AND</code></td>
<td style="text-align:center">A &amp; B</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>OR</code></td>
<td style="text-align:center">A | B</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center"><code>XOR</code></td>
<td style="text-align:center">A ^ B</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center"><code>LUI</code></td>
<td style="text-align:center">加载到高位</td>
</tr>
</tbody>
</table>
<h3 id="m级：存储memory">M级：存储Memory</h3>
<h4 id="m-reg-m级流水线寄存器">M_REG M级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：存储M级流水线寄存器的数据。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">E_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级指令</td>
</tr>
<tr>
<td style="text-align:center">E_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC值</td>
</tr>
<tr>
<td style="text-align:center">E_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">E_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">E_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">E_RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">E_RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">E_RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">E级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">E_ALU_Res</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">E_Tnew</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">E级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">E_ALU_Fwd_MUXOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级ALU转发MUX输出</td>
</tr>
<tr>
<td style="text-align:center">M_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级指令</td>
</tr>
<tr>
<td style="text-align:center">M_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC值</td>
</tr>
<tr>
<td style="text-align:center">M_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">M_A1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">M_A2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">M_RegAddr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">M_RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">M_RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_M</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_M</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_M</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">M级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">M_ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">M_Tnew</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">M级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">M_ALU_Fwd_MUXOut</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU转发MUX输出</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1时，所有输出信号清空，对于暂停操作而言相当于插入nop指令</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">在时钟上升沿，将E级输入信号传递到M级输出信号</td>
</tr>
</tbody>
</table>
<h4 id="m-dm-数据存储器">M_DM 数据存储器</h4>
<ol>
<li><strong>定义</strong>：使用RAM实现，根据控制信号，对输入的地址和数据进行读写操作。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">MemAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">32位地址</td>
</tr>
<tr>
<td style="text-align:center">WD</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">32位数据</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">同步复位信号</td>
</tr>
<tr>
<td style="text-align:center">WE</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">读/写控制信号，0为读，1为写</td>
</tr>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">PC地址</td>
</tr>
<tr>
<td style="text-align:center">DM_RD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">32位数据</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">复位</td>
<td style="text-align:center">当reset为1时，将所有数据存储单元置零</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">读</td>
<td style="text-align:center">当WE为0时，输出地址对应的32位数据DM_RD</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">写</td>
<td style="text-align:center">当WE为1时，将MemAddr对应地址写入32位数据WD</td>
</tr>
</tbody>
</table>
<h3 id="w级：写回writeback">W级：写回<em>WriteBack</em></h3>
<h4 id="w-reg-w级流水线寄存器">W_REG W级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：存储W级流水线寄存器的数据。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">M_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级指令</td>
</tr>
<tr>
<td style="text-align:center">M_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC值</td>
</tr>
<tr>
<td style="text-align:center">M_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">M_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">M_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">M_RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">M_RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">M_RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">M_ALU_Res</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">M_DM_RD</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级数据存储器读数据</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">M级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">M_Tnew</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">M级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">W_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级指令</td>
</tr>
<tr>
<td style="text-align:center">W_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级PC值</td>
</tr>
<tr>
<td style="text-align:center">W_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">W_A1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">W_A2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">W_RegAddr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">W_RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">W_RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">W_ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">W_DM_RD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级数据存储器读数据</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_W</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">W级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_W</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">W级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">W_Tnew</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">W级新指令周期</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1时，所有输出信号清空，对于暂停操作而言相当于插入nop指令</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">在时钟上升沿，将M级输入信号传递到W级输出信号</td>
</tr>
</tbody>
</table>
<h3 id="mcu-控制单元">MCU 控制单元</h3>
<ol>
<li>
<p><strong>定义</strong><br>
MCU 控制单元用于生成控制信号，控制其他模块的行为。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">操作码</td>
</tr>
<tr>
<td style="text-align:center">Func</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">功能码</td>
</tr>
<tr>
<td style="text-align:center">RegDstSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">寄存器目标选择信号</td>
</tr>
<tr>
<td style="text-align:center">ALUBSrcSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">ALU_B源选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">NPCSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">下一条指令PC选择信号</td>
</tr>
<tr>
<td style="text-align:center">ExtOp_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">CMPOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">Tuse_rs</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rs使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tuse_rt</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rt使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tnew_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">产生数据所用周期数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">指令译码</td>
<td style="text-align:left">根据操作码和功能码生成对应的控制信号</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">控制信号生成</td>
<td style="text-align:left">生成寄存器目标选择信号、ALU B源选择信号、寄存器数据选择信号等</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">冒险时间生成</td>
<td style="text-align:left">生成rs和rt的使用时间以及新指令周期</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>
<p><strong>多路选择器说明</strong></p>
<ol>
<li><strong>RegDstSel</strong>：寄存器目标选择信号，用于选择写入寄存器的目标寄存器。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">RaType</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写回ra寄存器</td>
</tr>
<tr>
<td style="text-align:center">RdType</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写回rd寄存器</td>
</tr>
<tr>
<td style="text-align:center">RtType</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写回rt寄存器</td>
</tr>
</tbody>
</table>
<ol start="2">
<li><strong>ALUBSel</strong>：ALU B源选择信号，用于选择ALU B输入端的源。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">E_ALU_Fwd_MUXOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">寄存器值</td>
</tr>
<tr>
<td style="text-align:center">EXT</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">扩展后的立即数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>RegDataSel</strong>：寄存器数据选择信号，用于选择写入寄存器的数据源。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">FromPC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自PC8</td>
</tr>
<tr>
<td style="text-align:center">FromALU</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自ALU</td>
</tr>
<tr>
<td style="text-align:center">FromDM</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自DM</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h3 id="hcu-冒险控制单元">HCU 冒险控制单元</h3>
<ol>
<li><strong>定义</strong>：冒险控制单元用于检测流水线中的数据冒险，并生成相应的转发和停顿信号。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Tuse_rs</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rs使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tuse_rt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rt使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tnew_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">E级产生数据需要周期</td>
</tr>
<tr>
<td style="text-align:center">Tnew_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">M级产生数据需要周期</td>
</tr>
<tr>
<td style="text-align:center">Tnew_W</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">W级产生数据需要周期</td>
</tr>
<tr>
<td style="text-align:center">D_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">D_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">E_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">E_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">E_A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">M_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">M_A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">W_A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_W</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">W级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">CMP_RD1_Fwd_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较器RD1转发信号</td>
</tr>
<tr>
<td style="text-align:center">CMP_RD2_Fwd_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较器RD2转发信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_A_Fwd_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">ALU A转发信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_B_Fwd_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">ALU B转发信号</td>
</tr>
<tr>
<td style="text-align:center">DM_WD_Fwd_M</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">数据存储器写数据转发信号</td>
</tr>
<tr>
<td style="text-align:center">stall</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停顿信号</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">停顿检测</td>
<td style="text-align:left">根据寄存器地址和使用周期数，检测是否需要停顿</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">转发信号生成</td>
<td style="text-align:left">生成比较器、ALU和数据存储器的转发信号</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">停顿信号生成</td>
<td style="text-align:left">生成流水线停顿信号</td>
</tr>
</tbody>
</table>
<h4 id="暂停stall">暂停<em>Stall</em></h4>
<p>使用A-T法判断，当address相同时，若D级的Tuse_rs或Tuse_rt<br>
比E、M、W级的Tnew小，则说明在D级需要使用寄存器中数据时，E、M、W级相应的寄存器数据还未准备好，需要暂停流水线。</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line">E_Stall_Rs = (E_A3 == D_A1) &amp;&amp; (D_A1 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_E &gt; Tuse_rs) &amp;&amp; RegWrite_E;</span><br><span class="line">E_Stall_Rt = (E_A3 == D_A2) &amp;&amp; (D_A2 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_E &gt; Tuse_rt) &amp;&amp; RegWrite_E;</span><br><span class="line">M_Stall_Rs = (M_A3 == D_A1) &amp;&amp; (D_A1 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_M &gt; Tuse_rs) &amp;&amp; RegWrite_M;</span><br><span class="line">M_Stall_Rt = (M_A3 == D_A2) &amp;&amp; (D_A2 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_M &gt; Tuse_rt) &amp;&amp; RegWrite_M;</span><br><span class="line"></span><br><span class="line">stall = E_Stall_Rs || E_Stall_Rt || M_Stall_Rs || M_Stall_Rt;</span><br><span class="line"><span class="comment">//W级不需要判断，因为在GRF中存在内部转发</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="转发foward">转发<em>Foward</em></h4>
<p>执行暴力转发，使用A-T法判断，当address相同且D级的Tuse_rs或Tuse_rt大于E、M级相应的Tnew时，说明D级需要使用的数据在E、M级中，需要转发。</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">assign</span> CMP_RD1_Fwd_D = </span><br><span class="line">        (D_A1 == <span class="number">5&#x27;b0</span>) ? `FWD_GRF : </span><br><span class="line">        (E_A3 == D_A1 &amp;&amp; RegWrite_E) ? `FWD_EXE : </span><br><span class="line">        (M_A3 == D_A1 &amp;&amp; RegWrite_M) ? `FWD_MEM : </span><br><span class="line">        (W_A3 == D_A1 &amp;&amp; RegWrite_W) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for CMP_RD2, W not included because it&#x27;s forwared in GRF</span></span><br><span class="line"><span class="keyword">assign</span> CMP_RD2_Fwd_D = </span><br><span class="line">    (D_A2 == <span class="number">5&#x27;b0</span>) ? `FWD_GRF : </span><br><span class="line">    (E_A3 == D_A2 &amp;&amp; RegWrite_E) ? `FWD_EXE : </span><br><span class="line">    (M_A3 == D_A2 &amp;&amp; RegWrite_M) ? `FWD_MEM : </span><br><span class="line">    (W_A3 == D_A2 &amp;&amp; RegWrite_W) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for ALU_A</span></span><br><span class="line"><span class="keyword">assign</span> ALU_A_Fwd_E = </span><br><span class="line">    (E_A1 == <span class="number">5&#x27;b0</span>) ? `FWD_GRF : </span><br><span class="line">    (M_A3 == E_A1 &amp;&amp; RegWrite_M) ? `FWD_MEM :</span><br><span class="line">    (W_A3 == E_A1 &amp;&amp; RegWrite_W) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for ALU_B</span></span><br><span class="line"><span class="keyword">assign</span> ALU_B_Fwd_E = </span><br><span class="line">    (E_A2 == <span class="number">5&#x27;b0</span>) ? `FWD_GRF : </span><br><span class="line">    (M_A3 == E_A2 &amp;&amp; RegWrite_M) ? `FWD_MEM :</span><br><span class="line">    (W_A3 == E_A2 &amp;&amp; RegWrite_W) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for DM_WD</span></span><br><span class="line"><span class="keyword">assign</span> DM_WD_Fwd_M = </span><br><span class="line">    (M_A3 == <span class="number">5&#x27;b0</span>) ? `FWD_GRF : </span><br><span class="line">    (W_A3 == M_A3 &amp;&amp; RegWrite_W) ? `FWD_WB : `FWD_GRF;</span><br></pre></td></tr></table></figure>
<h3 id="顶层模块">顶层模块</h3>
<ul>
<li><strong>定义</strong>：顶层模块，将所有模块连接起来，实现整个CPU的功能。</li>
<li><strong>端口定义</strong>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
</tbody>
</table>
</li>
<li><strong>功能实现</strong>：实例化所有模块，定义各模块间的连接，在顶层模块中用<code>?:</code>实现多路选择器。</li>
</ul>
<h2 id="测试方案">测试方案</h2>
<h2 id="第五次思考题">第五次思考题</h2>
<ol>
<li>我们使用提前分支判断的方法尽早产生结果来减少因不确定而带来的开销，但实际上这种方法并非总能提高效率，请从流水线冒险的角度思考其原因并给出一个指令序列的例子。</li>
</ol>
<blockquote>
<p>由于分支跳转指令的Tuse为0，因此若对应寄存器在E、M、W级的Tnew大于0，则会导致冒险，必须阻塞流水线，效率反而降低。</p>
</blockquote>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line">lui $<span class="number">1</span>, <span class="number">100</span></span><br><span class="line">beq $<span class="number">1</span>, $<span class="number">0</span>, label1</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>因为延迟槽的存在，对于 jal 等需要将指令地址写入寄存器的指令，要写回 PC + 8，请思考为什么这样设计？</li>
</ol>
<blockquote>
<p>因为延迟槽的存在，jal等指令在D级才能译码，此时F级的指令地址为PC+4，当写回地址时，若仍按照PC+4，则会跳转到延迟槽中的指令，这显然是不对的，因此只要写回D_PC+8，即跳转指令地址+8，或者是F_PC+4，也是正确的。（由于延迟槽存在，实际上能够保证此时F_PC=D_PC+4）</p>
</blockquote>
<ol start="3">
<li>我们要求所有转发数据都来源于流水寄存器而不能是功能部件（如 DM、ALU），请思考为什么？</li>
</ol>
<blockquote>
<p>因为流水线寄存器中的数据是在上一周期已经计算好的，而在这一周期的时钟上升沿写入，可以保证在下一时钟周期之前稳定输出，而功能部件使用组合逻辑，其输入取决于输入端口的值，而如果在转发供给者功能部件输出端口转发，由于功能部件输出有延迟，可能导致接收者的输入改变的时间点不确定，从而无法保证数据正确性与稳定性。</p>
</blockquote>
<ol start="4">
<li>我们为什么要使用 GPR 内部转发？该如何实现？</li>
</ol>
<blockquote>
<p><s>设计文档里有说明</s> 当W级与D级使用同一个寄存器时，为了避免数据冒险，使用内部转发既可以避免D级取到错误的寄存器值，也可以避免阻塞流水线。实现如下：</p>
</blockquote>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="comment">//GRF内部转发   </span></span><br><span class="line"><span class="keyword">assign</span> RD1 = </span><br><span class="line">    (A1 == RegAddr &amp;&amp; RegWrite &amp;&amp; RegAddr != <span class="number">0</span>) ? RegData : GRF_reg[A1]; <span class="comment">// Read the register1</span></span><br><span class="line"><span class="keyword">assign</span> RD2 = </span><br><span class="line">    (A2 == RegAddr &amp;&amp; RegWrite &amp;&amp; RegAddr != <span class="number">0</span>) ? RegData : GRF_reg[A2]; <span class="comment">// Read the register2</span></span><br></pre></td></tr></table></figure>
<ol start="5">
<li>我们转发时数据的需求者和供给者可能来源于哪些位置？共有哪些转发数据通路？</li>
</ol>
<blockquote>
<p>需求者：D级的CMP(RD1和RD2)，E级的ALU（ALU_A和ALU_B），M级的DM（DM_WD）<br>
供给者：W级的GRF（RegData），E级的ALU（ALU_Res），M级的DM（DM_RD）<br>
转发数据通路：GRF内部转发，M级到D级，M级到E级，W级到D级（GRF内部转发），W级到E级，W级到M级</p>
</blockquote>
<ol start="6">
<li>在课上测试时，我们需要你现场实现新的指令，对于这些新的指令，你可能需要在原有的数据通路上做哪些扩展或修改？提示：你可以对指令进行分类，思考每一类指令可能修改或扩展哪些位置。</li>
</ol>
<blockquote>
<p>计算指令：首先处理ALU的运算逻辑，然后在MCU中添加对应的信号处理语句，我一般会用宏定义来处理指令的Op和Func，再选择对应的信号，处理Tnew和Tuse，基本不需要改变数据通路。<br>
跳转指令：可能是<code>条件跳转+无条件链接</code>，<code>条件跳转+条件链接</code>，对于条件跳转，在CMP中添加对应判断；对于链接，无条件链接直接修改为<code>RaType</code>，条件链接则需要对CMP比较结果进行流水，在对RegDst选择与RegWrite选择时根据CMP结果判断，在MCU中添加对应逻辑。<br>
访存指令：如果是<code>条件存储</code>，需要到M级才能得到结果，对于转发和暂停需要设置D级的Tnew为3，需要在数据通路中增加一个多路选择器用于选择该信号数据或地址，在MCU中添加以上控制信号逻辑。</p>
</blockquote>
<ol start="7">
<li>简要描述你的译码器架构，并思考该架构的优势以及不足。</li>
</ol>
<blockquote>
<p>采用分布式译码，优点在于增加指令时更为便利，无需流水到每一级，直接增加端口就可以控制；缺点是当指令数量较多时，译码器会变得复杂，且浪费资源。</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>lab</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
      </tags>
  </entry>
  <entry>
    <title>P6-CPU设计文档[BUAA-CO]</title>
    <url>/2024/11/26/CO-P6-document/</url>
    <content><![CDATA[<h1 id="p6流水线cpu设计文档">P6流水线CPU设计文档</h1>
<h2 id="设计整体概述">设计整体概述</h2>
<ol>
<li><strong>预计实现指令集</strong>：<br>
add、sub、and、or、nor、xor、slt、sltu、<br>
ori、Lui、addi、andi、<br>
lw、lh、lhu、lb、lbu、sw、sh、sb、<br>
mult、multu、div、divu、mfhi、mflo、mthi、mtlo、<br>
beq、bne、nop、j、jr、jal、jalr</li>
</ol>
<ul>
<li>R型指令：add、sub、and、or、nor、xor、slt、sltu、</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">rs</th>
<th style="text-align:center">rt</th>
<th style="text-align:center">rd</th>
<th style="text-align:center">shamt</th>
<th style="text-align:center">funct</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">6</td>
</tr>
</tbody>
</table>
<ul>
<li>I型指令：lui、ori、andi、addi、lw、lh、lhu、lb、lbu、sw、sh、sb、beq、bne、</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">rs</th>
<th style="text-align:center">rt</th>
<th style="text-align:center">offset</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">16</td>
</tr>
</tbody>
</table>
<ul>
<li>J型指令：j、jal</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">instr_index</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">26</td>
</tr>
</tbody>
</table>
<ul>
<li>乘除器操作指令：mult、multu、div、divu、mfhi、mflo、mthi、mtlo</li>
</ul>
<blockquote>
<p>其中，nop指令为空指令，不执行任何操作，add、sub不考虑溢出，故实际执行addu和subu</p>
</blockquote>
<ol start="3">
<li>
<p><strong>实现功能</strong>：实现五级流水线CPU，通过F、D、E、M、W五个阶段实现指令的执行，其中F阶段为取指，D阶段为译码，E阶段为执行，M阶段为访存，W阶段为写回，各阶段均通过流水线寄存器实现流水线操作，通过转发和阻塞机制解决冒险问题。</p>
</li>
<li>
<p><strong>顶层设计图</strong>：<br>
整体架构参考了PPT上的设计<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202411261112087.png" alt="main"></p>
</li>
<li>
<p><strong>命名格式</strong>：模块命名采用<code>所在级_模块名</code>方式，模块内部信号名采取<code>来源_功能</code>方式命名，顶层信号采用<code>所在级_模块名_信号名</code>方式命名。</p>
</li>
</ol>
<h2 id="数据通路模块设计">数据通路模块设计</h2>
<p>在采取IM与DM外置后，数据设计模块相较P5有了一定的变化，同时增加BE与DE模块，满足修改后的内存存取要求，增加了乘除器模块，用于实现乘除法相关指令。</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> mips (</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [<span class="number">0</span>:<span class="number">0</span>] clk,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [<span class="number">0</span>:<span class="number">0</span>] reset,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] i_inst_rdata,</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] m_data_rdata,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] i_inst_addr,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] m_data_addr,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] m_data_wdata,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] m_data_byteen,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] m_inst_addr,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">0</span>:<span class="number">0</span>] w_grf_we,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">4</span>:<span class="number">0</span>] w_grf_addr,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] w_grf_wdata,</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] w_inst_addr</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span>;</span><br></pre></td></tr></table></figure>
<h3 id="f级：取指fetch">F级：取指<em>Fetch</em></h3>
<h4 id="f-ifu-指令单元">F_IFU 指令单元</h4>
<ol>
<li><strong>定义</strong>：模块内部包含<code>PC</code>程序计数器、<code>IM</code>指令存储器以在外部实现，因此只负责根据<code>NPC</code>传入的PC值，依照控制信号选择PC值。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">D_Next_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>NPC</code>模块输出的下一条指令地址</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">stop</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停机信号</td>
</tr>
<tr>
<td style="text-align:center">F_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输出F级PC值，流入D级寄存器</td>
</tr>
<tr>
<td style="text-align:center">F_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>PC</code>加8的值，用于分支延迟槽指令</td>
</tr>
</tbody>
</table>
<p>实现从文件中读取指令的功能<br>
2. <strong>实现功能</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">同步复位</td>
<td style="text-align:center">当<code>reset</code>信号为1且处于时钟上升沿时，<code>PC</code>置0x00003000</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">停机</td>
<td style="text-align:center">当stop信号为1时，<code>PC</code>和指令保持不变</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">取指</td>
<td style="text-align:center">当stop信号为0时，在clk上升沿得到的下一条指令地址PC，传入顶层模块到i_inst_addr读取指令</td>
</tr>
</tbody>
</table>
<blockquote>
<p><code>PC</code>初始化为0x00003000</p>
</blockquote>
<p>外接IM具体实现</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> i_inst_addr = F_PC;</span><br><span class="line"><span class="keyword">assign</span> F_Instr = i_inst_rdata;</span><br></pre></td></tr></table></figure>
<h3 id="d级：译码decode">D级：译码<em>decode</em></h3>
<h4 id="d-reg-d级流水线寄存器">D_REG D级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：用于在时钟上升沿将F级的指令和PC值传递到D级，并在复位重置寄存器值，并在停机信号为1时保持不变</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">stall</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停机信号</td>
</tr>
<tr>
<td style="text-align:center">F_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的32位指令</td>
</tr>
<tr>
<td style="text-align:center">F_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的PC值</td>
</tr>
<tr>
<td style="text-align:center">F_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的PC+8值</td>
</tr>
<tr>
<td style="text-align:center">D_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级的32位指令</td>
</tr>
<tr>
<td style="text-align:center">D_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级的PC值</td>
</tr>
<tr>
<td style="text-align:center">D_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级的PC+8值</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1且处于时钟上升沿时，<code>D_Instr</code>置0，<code>D_PC</code>置<code>PC_Reset</code>，<code>D_PC8</code>置<code>PC_Reset + 4</code></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">停机</td>
<td style="text-align:left">当<code>stall</code>信号为1时，保持<code>D_Instr</code>、<code>D_PC</code>和<code>D_PC8</code>的值不变</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">当<code>stall</code>信号为0时，在时钟上升沿将<code>F_Instr</code>、<code>F_PC</code>和<code>F_PC8</code>的值传递到<code>D_Instr</code>、<code>D_PC</code>和<code>D_PC8</code></td>
</tr>
</tbody>
</table>
<h4 id="d-npc-指令计算单元">D_NPC 指令计算单元</h4>
<ol>
<li><strong>定义</strong>：根据当前PC值、指令类型和条件分支结果，计算下一条指令的PC值。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">F_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前指令的PC值</td>
</tr>
<tr>
<td style="text-align:center">Instr_index</td>
<td style="text-align:center">I</td>
<td style="text-align:center">26</td>
<td style="text-align:center">跳转指令的目标地址</td>
</tr>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">分支指令的偏移量</td>
</tr>
<tr>
<td style="text-align:center">rs</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">寄存器rs的值</td>
</tr>
<tr>
<td style="text-align:center">NPCSel</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">下一条指令PC选择信号</td>
</tr>
<tr>
<td style="text-align:center">CMPOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">比较结果信号</td>
</tr>
<tr>
<td style="text-align:center">D_Next_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">计算得到的下一条指令的PC值</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">计算分支地址</td>
<td style="text-align:left">根据当前PC值和偏移量计算分支指令的目标地址</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">计算跳转地址</td>
<td style="text-align:left">根据当前PC值和指令索引计算跳转指令的目标地址</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">选择下一条指令PC</td>
<td style="text-align:left">根据NPCSel信号选择下一条指令的PC值，支持顺序执行、分支、跳转和寄存器跳转</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">选择信号</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">数值</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">BranchType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b011</td>
<td style="text-align:center">B型跳转，与CMPOut共同决定跳转</td>
</tr>
<tr>
<td style="text-align:center">JrType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b010</td>
<td style="text-align:center">JR型跳转</td>
</tr>
<tr>
<td style="text-align:center">JumpType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b001</td>
<td style="text-align:center">J型跳转</td>
</tr>
</tbody>
</table>
<h4 id="d-ext-指令扩展">D_EXT 指令扩展</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的16位立即数进行零扩展或符号扩展。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">16位立即数</td>
</tr>
<tr>
<td style="text-align:center">ExtOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展选择信号，0为零扩展，1为符号扩展</td>
</tr>
<tr>
<td style="text-align:center">Extend</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">扩展后的32位立即数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">符号扩展</td>
<td style="text-align:left">当<code>ExtOp</code>信号为1时，<code>Extend</code>输出符号扩展后的32位立即数</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">零扩展</td>
<td style="text-align:left">当<code>ExtOp</code>信号为0时，<code>Extend</code>输出零扩展后的32位立即数</td>
</tr>
</tbody>
</table>
<h4 id="d-cmp-比较器">D_CMP 比较器</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行比较，输出比较结果。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器1数据</td>
</tr>
<tr>
<td style="text-align:center">RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器2数据</td>
</tr>
<tr>
<td style="text-align:center">CMPOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">CMPOut</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">比较结果输出</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">相等比较</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BEQ</code>时，若<code>RD1</code>等于<code>RD2</code>，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">不等比较</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BNE</code>时，若<code>RD1</code>不等于<code>RD2</code>，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">小于等于零</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BLEZ</code>时，若<code>RD1</code>小于等于0，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">大于零</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BGTZ</code>时，若<code>RD1</code>大于0，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
</tbody>
</table>
<h4 id="grf-寄存器堆">GRF 寄存器堆</h4>
<ol>
<li><strong>定义</strong>：根据读写信号，对寄存器堆进行读写操作。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器1地址</td>
</tr>
<tr>
<td style="text-align:center">A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器2地址</td>
</tr>
<tr>
<td style="text-align:center">RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">写寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">RegData</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写数据</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">写使能信号</td>
</tr>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前PC地址，用于输出</td>
</tr>
<tr>
<td style="text-align:center">RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器1数据</td>
</tr>
<tr>
<td style="text-align:center">RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器2数据</td>
</tr>
</tbody>
</table>
<p>输出寄存器堆中寄存器写入输出到官方<code>mips_tb.v</code>，具体实现如下</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> w_grf_we = W_RegWrite;</span><br><span class="line"><span class="keyword">assign</span> w_grf_addr = W_RegAddr;</span><br><span class="line"><span class="keyword">assign</span> w_grf_wdata = W_RegData;</span><br><span class="line"><span class="keyword">assign</span> w_inst_addr = W_PC;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">复位</td>
<td style="text-align:center">当reset为1时，将所有寄存器置为0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">读</td>
<td style="text-align:center">当RegWrite为0时，将A1、A2对应的寄存器数据输出到RD1、RD2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">写</td>
<td style="text-align:center">当RegWrite为1时，当RegAddr不为0时，在时钟上升沿将RegAddr对应的寄存器写入RegData</td>
</tr>
</tbody>
</table>
<blockquote>
<p>A1、A2分别读取Rs、Rt寄存器，RegAddress根据RegDst选择Rt或R），RegData根据MemRead选择ALU的运算结果或I型指令的立即数</p>
</blockquote>
<ol start="4">
<li><strong>内部转发</strong><br>
当<code>RegWrite</code>为1时，若D级读取的寄存器和W级写入的寄存器相同且不为0，则将<code>RegAddr</code>对应的寄存器的值输出到<code>RD1</code>或<code>RD2</code>。</li>
</ol>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> RD1 = </span><br><span class="line">        (A1 == RegAddr &amp;&amp; RegWrite &amp;&amp; RegAddr != <span class="number">0</span>) ? RegData : GRF_reg[A1]; <span class="comment">// Read the register1</span></span><br><span class="line"><span class="keyword">assign</span> RD2 = </span><br><span class="line">        (A2 == RegAddr &amp;&amp; RegWrite &amp;&amp; RegAddr != <span class="number">0</span>) ? RegData : GRF_reg[A2]; <span class="comment">// Read the register2</span></span><br></pre></td></tr></table></figure>
<h3 id="e级：执行execute">E级：执行<em>Execute</em></h3>
<h4 id="e-reg-e级流水线寄存器">E_REG E级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：存储E级流水线寄存器的数据。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">clr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">清除信号</td>
</tr>
<tr>
<td style="text-align:center">D_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级指令</td>
</tr>
<tr>
<td style="text-align:center">D_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级PC值</td>
</tr>
<tr>
<td style="text-align:center">D_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">D_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">D_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">D_RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">D_RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">D_Rt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级Rt寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">D_Rd</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级Rd寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">ALUOp_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">D级ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">D_Tnew</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">D级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">ALUBSrcSel_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级ALU B源选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">D级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegDstSel_D</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">D级寄存器目标选择信号</td>
</tr>
<tr>
<td style="text-align:center">D_Extend</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级扩展数据</td>
</tr>
<tr>
<td style="text-align:center">E_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级指令</td>
</tr>
<tr>
<td style="text-align:center">E_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC值</td>
</tr>
<tr>
<td style="text-align:center">E_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">E_A1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">E_A2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">E_RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">E_RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">E_Rt</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级Rt寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">E_Rd</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级Rd寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">ALUOp_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">E级ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">E_Tnew</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">E级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">ALUBSrcSel_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级ALU B源选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">E级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegDstSel_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">E级寄存器目标选择信号</td>
</tr>
<tr>
<td style="text-align:center">E_Extend</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级扩展数据</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1或<code>clr</code>信号为1时，所有输出信号清空，对于暂停操作而言相当于插入nop指令</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">在时钟上升沿，将D级输入信号传递到E级输出信号</td>
</tr>
</tbody>
</table>
<h4 id="alu-算术逻辑单元">ALU 算术逻辑单元</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行算术或逻辑运算。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数A</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数B</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">运算结果</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<p>根据ALU_Op的值，对输入的A和B进行相应的算术或逻辑运算，并将结果输出到ALU_Res。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>ADD</code></td>
<td style="text-align:center">A + B</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>SUB</code></td>
<td style="text-align:center">A - B</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>AND</code></td>
<td style="text-align:center">A &amp; B</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>OR</code></td>
<td style="text-align:center">A | B</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center"><code>XOR</code></td>
<td style="text-align:center">A ^ B</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center"><code>LUI</code></td>
<td style="text-align:center">加载到高位</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center"><code>XOR</code></td>
<td style="text-align:center">A ^ B</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center"><code>NOR</code></td>
<td style="text-align:center">~(A | B)</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center"><code>SLT</code></td>
<td style="text-align:center">$signed (A) &lt; $signed (B) ? 1 : 0 ，比较部分单独完成</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center"><code>SLTU</code></td>
<td style="text-align:center">A &lt; B ? 1 : 0</td>
</tr>
</tbody>
</table>
<h4 id="mdu-乘除单元">MDU 乘除单元</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行乘法或除法运算。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数A</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数B</td>
</tr>
<tr>
<td style="text-align:center">MDUOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">MDU操作码</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">start</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">开始状态信号</td>
</tr>
<tr>
<td style="text-align:center">MDURes</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">运算结果</td>
</tr>
<tr>
<td style="text-align:center">Hi</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">高位结果</td>
</tr>
<tr>
<td style="text-align:center">Lo</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">低位结果</td>
</tr>
<tr>
<td style="text-align:center">busy</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">忙状态信号</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<p>根据MDUOp的值，对输入的A和B进行相应的乘法或除法运算，并将结果输出到Hi和Lo寄存器，同时输出忙信号表示运算状态。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>MULT</code></td>
<td style="text-align:center">有符号乘法，结果存储在Hi和Lo中</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>MULTU</code></td>
<td style="text-align:center">无符号乘法，结果存储在Hi和Lo中</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>DIV</code></td>
<td style="text-align:center">有符号除法，商存储在Lo中，余数存储在Hi中</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>DIVU</code></td>
<td style="text-align:center">无符号除法，商存储在Lo中，余数存储在Hi中</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center"><code>MTHI</code></td>
<td style="text-align:center">将A的值存储到Hi中</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center"><code>MTLO</code></td>
<td style="text-align:center">将A的值存储到Lo中</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center"><code>MFHI</code></td>
<td style="text-align:center">将Hi的值输出到MDURes</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center"><code>MFLO</code></td>
<td style="text-align:center">将Lo的值输出到MDURes</td>
</tr>
</tbody>
</table>
<blockquote>
<p>设置临时变量hitemp和loemp，分别存储Hi和Lo的值，根据计数逻辑在完成乘除运算后，将hitemp和loemp的值赋值给Hi和Lo。</p>
</blockquote>
<h3 id="m级：存储memory">M级：存储Memory</h3>
<h4 id="m-reg-m级流水线寄存器">M_REG M级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：存储M级流水线寄存器的数据。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">E_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级指令</td>
</tr>
<tr>
<td style="text-align:center">E_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC值</td>
</tr>
<tr>
<td style="text-align:center">E_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">E_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">E_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">E_RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">E_RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">E_RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">E级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">E_ALU_Res</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">E_MDURes</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级MDU运算结果</td>
</tr>
<tr>
<td style="text-align:center">E_Tnew</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">E级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">E_ALU_Fwd_MUXOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级ALU转发MUX输出</td>
</tr>
<tr>
<td style="text-align:center">M_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级指令</td>
</tr>
<tr>
<td style="text-align:center">M_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC值</td>
</tr>
<tr>
<td style="text-align:center">M_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">M_A1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">M_A2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">M_RegAddr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">M_RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">M_RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_M</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_M</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_M</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">M级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">M_ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">M_Tnew</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">M级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">M_ALU_Fwd_MUXOut</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU转发MUX输出</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1时，所有输出信号清空，对于暂停操作而言相当于插入nop指令</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">在时钟上升沿，将E级输入信号传递到M级输出信号</td>
</tr>
</tbody>
</table>
<h4 id="m-dm-数据存储器">M_DM 数据存储器</h4>
<p>由于内存外置，故原DM模块实现转移到BE和DE中</p>
<h4 id="m-be-缓存写回模块">M_BE 缓存写回模块</h4>
<ol>
<li><strong>定义</strong>：根据读写信号和地址，对数据进行字节、半字或字的写操作。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">LSOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">读写操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">BEAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存写回地址</td>
</tr>
<tr>
<td style="text-align:center">BE_WD_In</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存写回输入数据</td>
</tr>
<tr>
<td style="text-align:center">MemWrite</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">byteen</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">字节使能信号</td>
</tr>
<tr>
<td style="text-align:center">BE_WD_Out</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存写回输出数据</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">字写操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Word</code>时，<code>byteen</code>为<code>4'b1111</code>，<code>BE_WD_Out</code>为<code>BE_WD_In</code></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">半字写操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Half</code>时，根据<code>BEAddr</code>的值选择高16位或低16位进行写操作</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">字节写操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Byte</code>时，根据<code>BEAddr</code>的值选择相应的字节进行写操作</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">默认操作</td>
<td style="text-align:left">当<code>MemWrite</code>为0或<code>LSOp</code>为其他值时，<code>byteen</code>为<code>4'b0000</code>，<code>BE_WD_Out</code>为<code>32'h00000000</code></td>
</tr>
</tbody>
</table>
<h4 id="m-de-缓存读模块">M_DE 缓存读模块</h4>
<ol>
<li>
<p><strong>定义</strong>：根据读信号和地址，对数据进行字节、半字或字的读操作。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">LSOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">读操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">DEAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存读出地址</td>
</tr>
<tr>
<td style="text-align:center">DE_m_data_rdata</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存读出输入数据</td>
</tr>
<tr>
<td style="text-align:center">DE_RD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存读出输出数据</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">操作</th>
<th style="text-align:left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">字读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Word</code>时，<code>DE_RD</code>为<code>DE_m_data_rdata</code></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">半字读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Half</code>时，根据<code>DEAddr</code>的值选择高16位或低16位进行读操作</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">字节读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Byte</code>时，根据<code>DEAddr</code>的值选择相应的字节进行读操作</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">半字无符号读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Half_Unsigned</code>时，根据<code>DEAddr</code>的值选择高16位或低16位进行无符号读操作</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">字节无符号读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Byte_Unsigned</code>时，根据<code>DEAddr</code>的值选择相应的字节进行无符号读操作</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">默认操作</td>
<td style="text-align:left">当<code>LSOp</code>为其他值时，<code>DE_RD</code>为<code>32'h00000000</code></td>
</tr>
</tbody>
</table>
<h3 id="w级：写回writeback">W级：写回<em>WriteBack</em></h3>
<h4 id="w-reg-w级流水线寄存器">W_REG W级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：存储W级流水线寄存器的数据。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">M_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级指令</td>
</tr>
<tr>
<td style="text-align:center">M_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC值</td>
</tr>
<tr>
<td style="text-align:center">M_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">M_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">M_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">M_RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">M_RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">M_RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">M_ALU_Res</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">M_MDURes</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">M_DM_RD</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级数据存储器读数据</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">M级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">M_Tnew</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">M级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">W_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级指令</td>
</tr>
<tr>
<td style="text-align:center">W_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级PC值</td>
</tr>
<tr>
<td style="text-align:center">W_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">W_A1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">W_A2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">W_RegAddr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">W_RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">W_RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">W_ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">W_DM_RD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级数据存储器读数据</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_W</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">W级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_W</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">W级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">W_Tnew</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">W级新指令周期</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1时，所有输出信号清空，对于暂停操作而言相当于插入nop指令</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">在时钟上升沿，将M级输入信号传递到W级输出信号</td>
</tr>
</tbody>
</table>
<h3 id="mcu-控制单元">MCU 控制单元</h3>
<ol>
<li>
<p><strong>定义</strong><br>
MCU 控制单元用于生成控制信号，控制其他模块的行为。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">操作码</td>
</tr>
<tr>
<td style="text-align:center">Func</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">功能码</td>
</tr>
<tr>
<td style="text-align:center">RegDstSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">寄存器目标选择信号</td>
</tr>
<tr>
<td style="text-align:center">ALUBSrcSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">ALU_B源选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">NPCSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">下一条指令PC选择信号</td>
</tr>
<tr>
<td style="text-align:center">ExtOp_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">CMPOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">MDUOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">MDU操作码</td>
</tr>
<tr>
<td style="text-align:center">MDU_Start</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">MDU启动信号</td>
</tr>
<tr>
<td style="text-align:center">LSOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">存储操作码</td>
</tr>
<tr>
<td style="text-align:center">Tuse_rs</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rs使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tuse_rt</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rt使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tnew_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">产生数据所用周期数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">指令译码</td>
<td style="text-align:left">根据操作码和功能码生成对应的控制信号</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">控制信号生成</td>
<td style="text-align:left">生成寄存器目标选择信号、ALU B源选择信号、寄存器数据选择信号等</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">冒险时间生成</td>
<td style="text-align:left">生成rs和rt的使用时间以及新指令周期</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>
<p><strong>信号生成说明</strong><br>
将所有指令译码后根据类型分为<code>cal_r</code>、<code>cal_i</code>、<code>ld</code>、<code>st</code>、<code>md</code>、<code>mt</code>、<code>mf</code>、<code>b_type</code>、<code>j_type</code>，对于共性控制信号直接按照类型生成</p>
</li>
<li>
<p><strong>多路选择器说明</strong></p>
<ol>
<li><strong>RegDstSel</strong>：寄存器目标选择信号，用于选择写入寄存器的目标寄存器。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">RaType</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写回ra寄存器</td>
</tr>
<tr>
<td style="text-align:center">RdType</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写回rd寄存器</td>
</tr>
<tr>
<td style="text-align:center">RtType</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写回rt寄存器</td>
</tr>
</tbody>
</table>
<ol start="2">
<li><strong>ALUBSel</strong>：ALU B源选择信号，用于选择ALU B输入端的源。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">E_ALU_Fwd_MUXOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">寄存器值</td>
</tr>
<tr>
<td style="text-align:center">EXT</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">扩展后的立即数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>RegDataSel</strong>：寄存器数据选择信号，用于选择写入寄存器的数据源。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">FromMDU</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自MDU</td>
</tr>
<tr>
<td style="text-align:center">FromPC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自PC8</td>
</tr>
<tr>
<td style="text-align:center">FromALU</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自ALU</td>
</tr>
<tr>
<td style="text-align:center">FromDM</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自DM</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h3 id="hcu-冒险控制单元">HCU 冒险控制单元</h3>
<ol>
<li><strong>定义</strong>：冒险控制单元用于检测流水线中的数据冒险，并生成相应的转发和停顿信号。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Tuse_rs</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rs使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tuse_rt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rt使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tnew_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">E级产生数据需要周期</td>
</tr>
<tr>
<td style="text-align:center">Tnew_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">M级产生数据需要周期</td>
</tr>
<tr>
<td style="text-align:center">Tnew_W</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">W级产生数据需要周期</td>
</tr>
<tr>
<td style="text-align:center">D_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">D_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">D_MDUOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">D级MDU操作控制信号</td>
</tr>
<tr>
<td style="text-align:center">E_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">E_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">E_A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">E_Start</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级MDU状态</td>
</tr>
<tr>
<td style="text-align:center">E_Busy</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级MDU状态</td>
</tr>
<tr>
<td style="text-align:center">M_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">M_A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">W_A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_W</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">W级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">CMP_RD1_Fwd_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较器RD1转发信号</td>
</tr>
<tr>
<td style="text-align:center">CMP_RD2_Fwd_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较器RD2转发信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_A_Fwd_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">ALU A转发信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_B_Fwd_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">ALU B转发信号</td>
</tr>
<tr>
<td style="text-align:center">DM_WD_Fwd_M</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">数据存储器写数据转发信号</td>
</tr>
<tr>
<td style="text-align:center">stall</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停顿信号</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">停顿检测</td>
<td style="text-align:left">根据寄存器地址和使用周期数，检测是否需要停顿</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">转发信号生成</td>
<td style="text-align:left">生成比较器、ALU和数据存储器的转发信号</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">停顿信号生成</td>
<td style="text-align:left">生成流水线停顿信号</td>
</tr>
</tbody>
</table>
<h4 id="暂停stall">暂停<em>Stall</em></h4>
<p>使用A-T法判断，当address相同时，若D级的Tuse_rs或Tuse_rt<br>
比E、M、W级的Tnew小，则说明在D级需要使用寄存器中数据时，E、M、W级相应的寄存器数据还未准备好，需要暂停流水线。</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line">E_Stall_Rs = (E_A3 == D_A1) &amp;&amp; (D_A1 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_E &gt; Tuse_rs) &amp;&amp; RegWrite_E;</span><br><span class="line">E_Stall_Rt = (E_A3 == D_A2) &amp;&amp; (D_A2 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_E &gt; Tuse_rt) &amp;&amp; RegWrite_E;</span><br><span class="line">M_Stall_Rs = (M_A3 == D_A1) &amp;&amp; (D_A1 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_M &gt; Tuse_rs) &amp;&amp; RegWrite_M;</span><br><span class="line">M_Stall_Rt = (M_A3 == D_A2) &amp;&amp; (D_A2 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_M &gt; Tuse_rt) &amp;&amp; RegWrite_M;</span><br><span class="line">E_stall_md = D_MDUOp != `MDU_NONE &amp;&amp; (E_Busy || E_Start);</span><br><span class="line"></span><br><span class="line">stall = E_Stall_Rs || E_Stall_Rt || M_Stall_Rs || M_Stall_Rt;</span><br><span class="line"><span class="comment">//W级不需要判断，因为在GRF中存在内部转发</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="转发foward">转发<em>Foward</em></h4>
<p>执行暴力转发，使用A-T法判断，当address相同且D级的Tuse_rs或Tuse_rt大于E、M级相应的Tnew时，说明D级需要使用的数据在E、M级中，需要转发。</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Forwarding logic for CMP_RD1, W not included because it&#x27;s forwared in GRF</span></span><br><span class="line"><span class="keyword">assign</span> CMP_RD1_Fwd_D = </span><br><span class="line">    (M_A3 == D_A1 &amp;&amp; RegWrite_M &amp;&amp; D_A1) ? `FWD_MEM : </span><br><span class="line">    (W_A3 == D_A1 &amp;&amp; RegWrite_W &amp;&amp; D_A1) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for CMP_RD2, W not included because it&#x27;s forwared in GRF</span></span><br><span class="line"><span class="keyword">assign</span> CMP_RD2_Fwd_D = </span><br><span class="line">    (M_A3 == D_A2 &amp;&amp; RegWrite_M &amp;&amp; D_A2) ? `FWD_MEM : </span><br><span class="line">    (W_A3 == D_A2 &amp;&amp; RegWrite_W &amp;&amp; D_A2) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for ALU_A</span></span><br><span class="line"><span class="keyword">assign</span> ALU_A_Fwd_E = </span><br><span class="line">    (M_A3 == E_A1 &amp;&amp; RegWrite_M &amp;&amp; E_A1) ? `FWD_MEM :</span><br><span class="line">    (W_A3 == E_A1 &amp;&amp; RegWrite_W &amp;&amp; E_A1) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for ALU_B</span></span><br><span class="line"><span class="keyword">assign</span> ALU_B_Fwd_E = </span><br><span class="line">    (M_A3 == E_A2 &amp;&amp; RegWrite_M &amp;&amp; E_A2) ? `FWD_MEM :</span><br><span class="line">    (W_A3 == E_A2 &amp;&amp; RegWrite_W &amp;&amp; E_A2) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for DM_WD</span></span><br><span class="line"><span class="keyword">assign</span> DM_WD_Fwd_M = </span><br><span class="line">    (W_A3 == M_A2 &amp;&amp; RegWrite_W &amp;&amp; M_A2) ? `FWD_WB : `FWD_GRF;</span><br></pre></td></tr></table></figure>
<h3 id="顶层模块">顶层模块</h3>
<ul>
<li>
<p><strong>定义</strong>：顶层模块，将所有模块连接起来，实现整个CPU的功能。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">其他官方tb要求输入</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>功能实现</strong>：实例化所有模块，定义各模块间的连接，在顶层模块中用<code>?:</code>实现多路选择器。</p>
</li>
</ul>
<h2 id="测试方案">测试方案</h2>
<h2 id="p6思考题">P6思考题</h2>
<ol>
<li>为什么需要有单独的乘除法部件而不是整合进 ALU？为何需要有独立的 HI、LO 寄存器？</li>
</ol>
<blockquote>
<p>乘除法运算的复杂度远高于加减法运算，因此需要单独的乘除法部件。另外由于其复杂性，乘除法运算需要多个时钟周期，因而使用单独的乘除器可以避免阻塞整个流水线，让其他非乘除法指令继续执行，提升CPU性能。<br>
采用独立的HI、LO寄存器可以保存乘除法运算的结果，保证在乘除器运算时，其他指令可以正常执行，同时也可以避免数据冲突。</p>
</blockquote>
<ol start="2">
<li>真实的流水线 CPU 是如何使用实现乘除法的？请查阅相关资料进行简单说明。</li>
</ol>
<blockquote>
<p>真实的流水线CPU通常使用硬件乘除器来实现乘除法运算。乘法通常有若干个较小的组合逻辑的乘法单元组成，然后每个周期计算特定的几位，依次累加起来，采取流水的方式，每个周期计算一次，从而实现乘法运算。除法运算则采取试算的方式，每次试算一位，然后根据试算结果调整被除数，直到除尽为止。</p>
</blockquote>
<ol start="3">
<li>请结合自己的实现分析，你是如何处理 Busy 信号带来的周期阻塞的？</li>
</ol>
<blockquote>
<p>busy作为乘除器模块的一种状态，当busy或者乘除器模块输出的start状态为1时，传入冒险控制器模块，若此时D级的指令为乘除法指令，则将阻塞D级指令。</p>
</blockquote>
<ol start="4">
<li>请问采用字节使能信号的方式处理写指令有什么好处？（提示：从清晰性、统一性等角度考虑）</li>
</ol>
<blockquote>
<ul>
<li>清晰性：通过字节使能信号，可以明确地知道哪些字节被写入，哪些字节保持不变，从而避免了数据冲突。</li>
<li>统一性：字节使能信号的使用，使得写指令的处理方式更加统一，将32位数据根据需求执行对应的写入操作，无需传入额外控制信号。</li>
</ul>
</blockquote>
<ol start="5">
<li>请思考，我们在按字节读和按字节写时，实际从 DM 获得的数据和向 DM 写入的数据是否是一字节？在什么情况下我们按字节读和按字节写的效率会高于按字读和按字写呢？</li>
</ol>
<blockquote>
<p>不是，而是一字，这是因为我们的DM实现的按字读写，需要对于读写的数据进行拆分或拼接；当我们涉及的数据均为单个字节时，按字节读写效率更高，因为不需要进行拆分或拼接，直接读写即可。</p>
</blockquote>
<ol start="6">
<li>为了对抗复杂性你采取了哪些抽象和规范手段？这些手段在译码和处理数据冲突的时候有什么样的特点与帮助？</li>
</ol>
<blockquote>
<p>P6设计沿用了P5，将支持的指令集根据类型区分，从而将新增指令归类提取，译码时控制信号与Tnew、Tuse可直接加到对应的分类中，基本不需要再进行额外处理。<br>
对于数据冲突处理，暂停与转发控制只需要增加乘除法指令的阻塞控制即可，而乘除法指令本身也可以分为md、mf、mt。</p>
</blockquote>
<ol start="7">
<li>在本实验中你遇到了哪些不同指令类型组合产生的冲突？你又是如何解决的？相应的测试样例是什么样的？</li>
</ol>
<blockquote>
<p>由于P6相较于P5增加了乘除法指令，而乘除槽的存在使得对于md类型的指令，乘除槽内出现的乘除法指令将会出现冒险，而我们没法通过转发的方式解决，因而只能暂停流水线。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lui $t0,0x1234</span><br><span class="line">lui $t2,0xffff</span><br><span class="line">ori $t0,$t0,0x6789</span><br><span class="line">ori $t1,$t1,0xabcd</span><br><span class="line">mult $t0,$t1</span><br><span class="line">mfhi $s0</span><br><span class="line">mflo $s1</span><br><span class="line">mult $t0,$t2</span><br><span class="line">mfhi $s0</span><br><span class="line">mflo $s1</span><br><span class="line">multu $t0,$t2</span><br><span class="line">mfhi $s0</span><br><span class="line">mflo $s1</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>如果你是手动构造的样例，请说明构造策略，说明你的测试程序如何保证覆盖了所有需要测试的情况；如果你是完全随机生成的测试样例，请思考完全随机的测试程序有何不足之处；如果你在生成测试样例时采用了特殊的策略，比如构造连续数据冒险序列，请你描述一下你使用的策略如何结合了随机性达到强测的效果。</li>
</ol>
<blockquote>
<p>使用其他同学的P5数据生成器，增加了P6新增的指令生成部分，对于完全随机生成的测试样例，可能导致数据冲突处理完全依靠随机性，因而我在生成测试数据时，采取了针对性指令生成，即只生成某些类型指令，增大其生成概率，从而检测处理冲突的正确性。</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>lab</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
      </tags>
  </entry>
  <entry>
    <title>P7-CPU设计文档[BUAA-CO]</title>
    <url>/2024/12/11/CO-P7-document/</url>
    <content><![CDATA[<h1 id="p7流水线cpu设计文档">P7流水线CPU设计文档</h1>
<h2 id="设计整体概述">设计整体概述</h2>
<ol>
<li><strong>预计实现指令集</strong>：<br>
add、sub、and、or、nor、xor、slt、sltu、<br>
ori、Lui、addi、andi、<br>
lw、lh、lhu、lb、lbu、sw、sh、sb、<br>
mult、multu、div、divu、mfhi、mflo、mthi、mtlo、<br>
beq、bne、nop、j、jr、jal、jalr、<br>
mfc0、mtc0、eret、syscall<br>
实际MIPS微系统支持指令与课下要求实现一致。</li>
</ol>
<ul>
<li>R型指令：add、sub、and、or、nor、xor、slt、sltu、</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">opcode</th>
<th style="text-align:center">rs</th>
<th style="text-align:center">rt</th>
<th style="text-align:center">rd</th>
<th style="text-align:center">shamt</th>
<th style="text-align:center">funct</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">5</td>
<td style="text-align:center">6</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>I型指令：lui、ori、andi、addi、lw、lh、lhu、lb、lbu、sw、sh、sb、beq、bne、<br>
| opcode |  rs   |  rt   | offset |<br>
| :----: | :—: | :—: | :----: |<br>
|   6    |   5   |   5   |   16   |</p>
</li>
<li>
<p>J型指令：j、jal<br>
| opcode | instr_index |<br>
| :----: | :---------: |<br>
|   6    |     26      |</p>
</li>
<li>
<p>乘除器操作指令：mult、multu、div、divu、mfhi、mflo、mthi、mtlo</p>
</li>
<li>
<p>CP0指令：mfc0、mtc0</p>
</li>
</ul>
<blockquote>
<p>其中，nop指令为空指令，不执行任何操作，add、sub不考虑溢出，故实际执行addu和subu</p>
</blockquote>
<ol start="3">
<li>
<p><strong>实现功能</strong>：实现MIPS微系统，内含五级流水线CPU、系统桥以及计时器，能够识别外部中断和内部异常并执行异常处理程序。CPU通过F、D、E、M、W五个阶段实现指令的执行，其中F阶段为取指，D阶段为译码，E阶段为执行，M阶段为访存，W阶段为写回，各阶段均通过流水线寄存器实现流水线操作，通过转发和阻塞机制解决冒险问题。系统桥根据地址范围将数据分发到内存的不同部分，计时器通过状态机实现计时功能。（课程组已给出）</p>
</li>
<li>
<p><strong>顶层设计图</strong>：<br>
整体架构符合课程组要求<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202412111810607.png" alt="main"></p>
</li>
<li>
<p>CPU封装为单周期，CP0置于M级，IM与DM实现外置，通过系统桥连接到外部输入输出端口。</p>
</li>
<li>
<p><strong>命名格式</strong>：模块命名采用<code>所在级_模块名</code>方式，模块内部信号名采取<code>来源_功能</code>方式命名，顶层信号采用<code>所在级_模块名_信号名</code>方式命名。</p>
</li>
</ol>
<h2 id="数据通路模块设计">数据通路模块设计</h2>
<p>为实现MIPS微系统功能，需要将CPU封装，满足中断需求，设计较P6有更多改动，以下为顶层端口定义：</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> mips(</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> clk,                    <span class="comment">// 时钟信号</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> reset,                  <span class="comment">// 同步复位信号</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> interrupt,              <span class="comment">// 外部中断信号</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] macroscopic_pc, <span class="comment">// 宏观 PC</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] i_inst_addr,    <span class="comment">// IM 读取地址（取指 PC）</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span>  [<span class="number">31</span>:<span class="number">0</span>] i_inst_rdata,   <span class="comment">// IM 读取数据</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] m_data_addr,    <span class="comment">// DM 读写地址</span></span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span>  [<span class="number">31</span>:<span class="number">0</span>] m_data_rdata,   <span class="comment">// DM 读取数据</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] m_data_wdata,   <span class="comment">// DM 待写入数据</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">3</span> :<span class="number">0</span>] m_data_byteen,  <span class="comment">// DM 字节使能信号</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] m_int_addr,     <span class="comment">// 中断发生器待写入地址</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">3</span> :<span class="number">0</span>] m_int_byteen,   <span class="comment">// 中断发生器字节使能信号</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] m_inst_addr,    <span class="comment">// M 级 PC</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> w_grf_we,              <span class="comment">// GRF 写使能信号</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">4</span> :<span class="number">0</span>] w_grf_addr,     <span class="comment">// GRF 待写入寄存器编号</span></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] w_grf_wdata,    <span class="comment">// GRF 待写入数据</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] w_inst_addr     <span class="comment">// W 级 PC</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span>;</span><br></pre></td></tr></table></figure>
<h2 id="cpu设计">CPU设计</h2>
<p>加入了异常中断处理模块CP0，同时添加了宏观PC端口，用于对封装为单周期的CPU进行判断。</p>
<ul>
<li>
<p><strong>定义</strong>：将所有CPU内部模块连接起来，实现整个CPU的功能。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">HWInt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">硬件中断信号</td>
</tr>
<tr>
<td style="text-align:center">i_inst_rdata</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">指令存储器读取数据</td>
</tr>
<tr>
<td style="text-align:center">m_data_rdata</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">数据存储器读取数据</td>
</tr>
<tr>
<td style="text-align:center">i_inst_addr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">指令存储器读取地址</td>
</tr>
<tr>
<td style="text-align:center">m_data_addr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">数据存储器读写地址</td>
</tr>
<tr>
<td style="text-align:center">m_data_wdata</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">数据存储器待写入数据</td>
</tr>
<tr>
<td style="text-align:center">m_data_byteen</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">数据存储器字节使能信号</td>
</tr>
<tr>
<td style="text-align:center">m_inst_addr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC</td>
</tr>
<tr>
<td style="text-align:center">w_grf_we</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">GRF写使能信号</td>
</tr>
<tr>
<td style="text-align:center">w_grf_addr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">GRF待写入寄存器编号</td>
</tr>
<tr>
<td style="text-align:center">w_grf_wdata</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">GRF待写入数据</td>
</tr>
<tr>
<td style="text-align:center">w_inst_addr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级PC</td>
</tr>
<tr>
<td style="text-align:center">macroscopic_pc</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">宏观PC</td>
</tr>
<tr>
<td style="text-align:center">Req</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常请求信号</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>功能实现</strong>：实例化所有模块，定义各模块间的连接，在顶层模块中用<code>?:</code>实现多路选择器。</p>
<ul>
<li>Fetch阶段：实例化<code>F_IFU</code>模块，生成PC和指令地址，生成对应异常码。</li>
<li>Decode阶段：实例化<code>D_REG</code>、<code>MCU</code>、<code>D_NPC</code>、<code>D_EXT</code>、<code>D_CMP</code>、<code>GRF</code>模块，进行指令译码和寄存器读写，生成对应异常码。</li>
<li>Execute阶段：实例化<code>E_REG</code>、<code>MCU</code>、<code>E_ALU</code>、<code>E_MDU</code>模块，进行算术逻辑运算和乘除运算，生成对应异常码。</li>
<li>Memory阶段：实例化<code>M_REG</code>、<code>MCU</code>、<code>M_BE</code>、<code>M_DE</code>、<code>CP0</code>模块，进行数据存储和异常处理。</li>
<li>Write Back阶段：实例化<code>W_REG</code>、<code>MCU</code>模块，进行数据写回。</li>
<li>Hazards Control：实例化<code>HCU</code>模块，生成转发和停顿信号。</li>
</ul>
</li>
</ul>
<h3 id="f级：取指fetch">F级：取指<em>Fetch</em></h3>
<h4 id="f-ifu-指令单元">F_IFU 指令单元</h4>
<ol>
<li><strong>定义</strong>：模块内部包含<code>PC</code>程序计数器、<code>IM</code>指令存储器以在外部实现，因此只负责根据<code>NPC</code>传入的PC值，依照控制信号选择PC值。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Next_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center"><code>NPC</code>模块输出的下一条指令地址</td>
</tr>
<tr>
<td style="text-align:center">EPC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">异常返回地址</td>
</tr>
<tr>
<td style="text-align:center">D_isEret</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常返回指令信号</td>
</tr>
<tr>
<td style="text-align:center">D_NPCSel</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">下一条指令PC选择信号</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">Req</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常中断信号</td>
</tr>
<tr>
<td style="text-align:center">stop</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停机信号</td>
</tr>
<tr>
<td style="text-align:center">F_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前指令地址</td>
</tr>
<tr>
<td style="text-align:center">F_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前指令地址+8</td>
</tr>
<tr>
<td style="text-align:center">F_BDIn</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">分支延迟槽信号</td>
</tr>
<tr>
<td style="text-align:center">IFU_ExcCode</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">指令异常码</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1且处于时钟上升沿时，<code>PC</code>置0x00003000</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">停机</td>
<td style="text-align:left">当<code>stop</code>信号为1时，<code>PC</code>和指令保持不变</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">取指</td>
<td style="text-align:left">当<code>stop</code>信号为0时，在clk上升沿得到的下一条指令地址<code>PC</code>，传入顶层模块到<code>i_inst_addr</code>读取指令</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">异常</td>
<td style="text-align:left">当<code>Req</code>信号为1时,将D_NPC生成的异常处理指令地址0x00004180赋值给<code>PC</code>，同时将异常码传入顶层模块</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:left">异常返回</td>
<td style="text-align:left">当<code>D_isEret</code>信号为1时，将<code>EPC</code>赋值给<code>PC</code></td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:left">输出异常</td>
<td style="text-align:left">当PC未字对齐或PC越界时，将异常码传入顶层模块</td>
</tr>
</tbody>
</table>
<blockquote>
<p><code>PC</code>初始化为0x00003000</p>
</blockquote>
<p>外接IM具体实现</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> i_inst_addr = F_PC;</span><br><span class="line"><span class="keyword">assign</span> F_Instr = i_inst_rdata;</span><br></pre></td></tr></table></figure>
<h3 id="d级：译码decode">D级：译码<em>decode</em></h3>
<h4 id="d-reg-d级流水线寄存器">D_REG D级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：用于在时钟上升沿将F级的指令和PC值传递到D级，并根据复位信号重置寄存器值，根据Req信号清空寄存器值，到并在停机信号为1时保持不变</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">stall</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停机信号</td>
</tr>
<tr>
<td style="text-align:center">Req</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常请求信号</td>
</tr>
<tr>
<td style="text-align:center">F_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的32位指令</td>
</tr>
<tr>
<td style="text-align:center">F_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的PC值</td>
</tr>
<tr>
<td style="text-align:center">F_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">F级的PC+8值</td>
</tr>
<tr>
<td style="text-align:center">F_BDIn</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">F级的分支延迟槽信号</td>
</tr>
<tr>
<td style="text-align:center">F_ExcCode</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">F级的异常码</td>
</tr>
<tr>
<td style="text-align:center">D_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级的32位指令</td>
</tr>
<tr>
<td style="text-align:center">D_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级的PC值</td>
</tr>
<tr>
<td style="text-align:center">D_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级的PC+8值</td>
</tr>
<tr>
<td style="text-align:center">D_BDIn</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级的分支延迟槽信号</td>
</tr>
<tr>
<td style="text-align:center">D_ExcCode</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">传入D级的异常码</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1且处于时钟上升沿时，<code>D_Instr</code>置0，<code>D_PC</code>置<code>PC_Reset</code>，<code>D_PC8</code>置<code>PC_Reset + 4</code>，<code>D_BDIn</code>置0，<code>D_ExcCode</code>置<code>ExcCode_Default</code></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">异常请求</td>
<td style="text-align:left">当<code>Req</code>信号为1时，<code>D_Instr</code>置0，<code>D_PC</code>置<code>Exc_Addr</code>，<code>D_PC8</code>置<code>Exc_Addr + 4</code>，<code>D_BDIn</code>置0，<code>D_ExcCode</code>置<code>ExcCode_Default</code></td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">停机</td>
<td style="text-align:left">当<code>stall</code>信号为1时，保持<code>D_Instr</code>、<code>D_PC</code>、<code>D_PC8</code>、<code>D_BDIn</code>和<code>D_ExcCode</code>的值不变</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">当<code>stall</code>信号为0时，在时钟上升沿将<code>F_Instr</code>、<code>F_PC</code>、<code>F_PC8</code>、<code>F_BDIn</code>和<code>F_ExcCode</code>的值传递到<code>D_Instr</code>、<code>D_PC</code>、<code>D_PC8</code>、<code>D_BDIn</code>和<code>D_ExcCode</code></td>
</tr>
</tbody>
</table>
<h4 id="d-npc-指令计算单元">D_NPC 指令计算单元</h4>
<ol>
<li><strong>定义</strong>：根据当前PC值、指令类型和条件分支结果，计算下一条指令的PC值。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">F_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前指令的PC值</td>
</tr>
<tr>
<td style="text-align:center">Instr_index</td>
<td style="text-align:center">I</td>
<td style="text-align:center">26</td>
<td style="text-align:center">跳转指令的目标地址</td>
</tr>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">分支指令的偏移量</td>
</tr>
<tr>
<td style="text-align:center">rs</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">寄存器rs的值</td>
</tr>
<tr>
<td style="text-align:center">NPCSel</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">下一条指令PC选择信号</td>
</tr>
<tr>
<td style="text-align:center">CMPOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">比较结果信号</td>
</tr>
<tr>
<td style="text-align:center">CMPLabJump</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">LAB跳转地址</td>
</tr>
<tr>
<td style="text-align:center">EPC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">异常返回地址</td>
</tr>
<tr>
<td style="text-align:center">D_isEret</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常返回信号</td>
</tr>
<tr>
<td style="text-align:center">Req</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常中断请求信号</td>
</tr>
<tr>
<td style="text-align:center">Next_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">计算得到的下一条指令的PC值</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">计算分支地址</td>
<td style="text-align:left">根据当前PC值和偏移量计算分支指令的目标地址</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">计算跳转地址</td>
<td style="text-align:left">根据当前PC值和指令索引计算跳转指令的目标地址</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">选择下一条指令PC</td>
<td style="text-align:left">根据NPCSel信号选择下一条指令的PC值，支持顺序执行、分支、跳转和寄存器跳转</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">异常处理</td>
<td style="text-align:left">根据Req信号和D_isEret信号选择异常处理地址或异常返回地址</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center">选择信号</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">数值</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">BranchType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b011</td>
<td style="text-align:center">B型跳转，与CMPOut共同决定跳转</td>
</tr>
<tr>
<td style="text-align:center">JrType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b010</td>
<td style="text-align:center">JR型跳转</td>
</tr>
<tr>
<td style="text-align:center">JumpType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b001</td>
<td style="text-align:center">J型跳转</td>
</tr>
<tr>
<td style="text-align:center">LABType</td>
<td style="text-align:center">3</td>
<td style="text-align:center">3’b100</td>
<td style="text-align:center">LAB跳转</td>
</tr>
</tbody>
</table>
<h4 id="d-ext-指令扩展">D_EXT 指令扩展</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的16位立即数进行零扩展或符号扩展。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">offset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">16</td>
<td style="text-align:center">16位立即数</td>
</tr>
<tr>
<td style="text-align:center">ExtOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展选择信号，0为零扩展，1为符号扩展</td>
</tr>
<tr>
<td style="text-align:center">Extend</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">扩展后的32位立即数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">符号扩展</td>
<td style="text-align:left">当<code>ExtOp</code>信号为1时，<code>Extend</code>输出符号扩展后的32位立即数</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">零扩展</td>
<td style="text-align:left">当<code>ExtOp</code>信号为0时，<code>Extend</code>输出零扩展后的32位立即数</td>
</tr>
</tbody>
</table>
<h4 id="d-cmp-比较器">D_CMP 比较器</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行比较，输出比较结果。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器1数据</td>
</tr>
<tr>
<td style="text-align:center">RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器2数据</td>
</tr>
<tr>
<td style="text-align:center">CMPOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">CMPOut</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">比较结果输出</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">相等比较</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BEQ</code>时，若<code>RD1</code>等于<code>RD2</code>，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">不等比较</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BNE</code>时，若<code>RD1</code>不等于<code>RD2</code>，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">小于等于零</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BLEZ</code>时，若<code>RD1</code>小于等于0，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">大于零</td>
<td style="text-align:left">当<code>CMPOp</code>信号为<code>CMP_BGTZ</code>时，若<code>RD1</code>大于0，<code>CMPOut</code>输出1，否则输出0</td>
</tr>
</tbody>
</table>
<h4 id="grf-寄存器堆">GRF 寄存器堆</h4>
<ol>
<li><strong>定义</strong>：根据读写信号，对寄存器堆进行读写操作。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器1地址</td>
</tr>
<tr>
<td style="text-align:center">A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">读寄存器2地址</td>
</tr>
<tr>
<td style="text-align:center">RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">写寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">RegData</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写数据</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">写使能信号</td>
</tr>
<tr>
<td style="text-align:center">PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">当前PC地址，用于输出</td>
</tr>
<tr>
<td style="text-align:center">RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器1数据</td>
</tr>
<tr>
<td style="text-align:center">RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">读寄存器2数据</td>
</tr>
</tbody>
</table>
<p>输出寄存器堆中寄存器写入输出到官方<code>mips_tb.v</code>，具体实现如下</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> w_grf_we = W_RegWrite;</span><br><span class="line"><span class="keyword">assign</span> w_grf_addr = W_RegAddr;</span><br><span class="line"><span class="keyword">assign</span> w_grf_wdata = W_RegData;</span><br><span class="line"><span class="keyword">assign</span> w_inst_addr = W_PC;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">复位</td>
<td style="text-align:center">当reset为1时，将所有寄存器置为0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">读</td>
<td style="text-align:center">当RegWrite为0时，将A1、A2对应的寄存器数据输出到RD1、RD2</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">写</td>
<td style="text-align:center">当RegWrite为1时，当RegAddr不为0时，在时钟上升沿将RegAddr对应的寄存器写入RegData</td>
</tr>
</tbody>
</table>
<blockquote>
<p>A1、A2分别读取Rs、Rt寄存器，RegAddress根据RegDst选择Rt或R），RegData根据MemRead选择ALU的运算结果或I型指令的立即数</p>
</blockquote>
<ol start="4">
<li><strong>内部转发</strong><br>
当<code>RegWrite</code>为1时，若D级读取的寄存器和W级写入的寄存器相同且不为0，则将<code>RegAddr</code>对应的寄存器的值输出到<code>RD1</code>或<code>RD2</code>。</li>
</ol>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> RD1 = </span><br><span class="line">        (A1 == RegAddr &amp;&amp; RegWrite &amp;&amp; RegAddr != <span class="number">0</span>) ? RegData : GRF_reg[A1]; <span class="comment">// Read the register1</span></span><br><span class="line"><span class="keyword">assign</span> RD2 = </span><br><span class="line">        (A2 == RegAddr &amp;&amp; RegWrite &amp;&amp; RegAddr != <span class="number">0</span>) ? RegData : GRF_reg[A2]; <span class="comment">// Read the register2</span></span><br></pre></td></tr></table></figure>
<h3 id="e级：执行execute">E级：执行<em>Execute</em></h3>
<h4 id="e-reg-e级流水线寄存器">E_REG E级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：存储E级流水线寄存器的数据。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">clr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">清除信号</td>
</tr>
<tr>
<td style="text-align:center">Req</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常请求信号</td>
</tr>
<tr>
<td style="text-align:center">D_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级指令</td>
</tr>
<tr>
<td style="text-align:center">D_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级PC值</td>
</tr>
<tr>
<td style="text-align:center">D_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">D_CMPOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级比较结果</td>
</tr>
<tr>
<td style="text-align:center">D_RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">D_RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">D_Tnew</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">D级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">D_Extend</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">D级扩展数据</td>
</tr>
<tr>
<td style="text-align:center">D_RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">D_ExcCode_Fixed</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级更新异常码</td>
</tr>
<tr>
<td style="text-align:center">D_BDIn</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级分支延迟槽信号</td>
</tr>
<tr>
<td style="text-align:center">E_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级指令</td>
</tr>
<tr>
<td style="text-align:center">E_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC值</td>
</tr>
<tr>
<td style="text-align:center">E_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">E_A1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">E_A2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">E_CMPOut</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级比较结果</td>
</tr>
<tr>
<td style="text-align:center">E_RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">E_RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">E_Tnew</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">E级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">E_Extend</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级扩展数据</td>
</tr>
<tr>
<td style="text-align:center">E_RegAddr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">E_ExcCode</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级异常码</td>
</tr>
<tr>
<td style="text-align:center">E_BDIn</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级分支延迟槽信号</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>信号为1或<code>clr</code>信号为1或<code>Req</code>信号为1时，所有输出信号清空，对于暂停操作而言相当于插入nop指令，但<code>clr</code>需保持D_PC的值不变，<code>Req</code>需跳转到异常处理程序</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">在时钟上升沿，将D级输入信号传递到E级输出信号</td>
</tr>
</tbody>
</table>
<h4 id="alu-算术逻辑单元">ALU 算术逻辑单元</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行算术或逻辑运算，并处理溢出异常。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数A</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数B</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">E_isSt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">存储操作标志</td>
</tr>
<tr>
<td style="text-align:center">E_isLd</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">加载操作标志</td>
</tr>
<tr>
<td style="text-align:center">ALU_OvExc</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">溢出异常标志</td>
</tr>
<tr>
<td style="text-align:center">ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">运算结果</td>
</tr>
<tr>
<td style="text-align:center">ALU_ExcCode</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">异常码</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<p>根据ALU_Op的值，对输入的A和B进行相应的算术或逻辑运算，并将结果输出到ALU_Res，同时处理溢出异常。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>ADD</code></td>
<td style="text-align:center">A + B</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>SUB</code></td>
<td style="text-align:center">A - B</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>AND</code></td>
<td style="text-align:center">A &amp; B</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>OR</code></td>
<td style="text-align:center">A | B</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center"><code>XOR</code></td>
<td style="text-align:center">A ^ B</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center"><code>LUI</code></td>
<td style="text-align:center">加载到高位</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center"><code>NOR</code></td>
<td style="text-align:center">~(A | B)</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center"><code>SLT</code></td>
<td style="text-align:center">$signed (A) &lt; $signed (B) ? 1 : 0</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center"><code>SLTU</code></td>
<td style="text-align:center">A &lt; B ? 1 : 0</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center"><code>LAB</code></td>
<td style="text-align:center">实验指令逻辑</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">输出异常码</td>
<td style="text-align:center">根据输入的可能异常类型，结合溢出判断，输出异常码</td>
</tr>
</tbody>
</table>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assign</span> ALU_ExcCode = </span><br><span class="line">    (Overflow &amp;&amp; E_isLd) ? `ExcCode_AdEL :</span><br><span class="line">    (Overflow &amp;&amp; E_isSt) ? `ExcCode_AdES :</span><br><span class="line">    (Overflow &amp;&amp; ALU_OvExc) ? `ExcCode_Ov : <span class="number">5&#x27;b0</span>;</span><br></pre></td></tr></table></figure>
<h4 id="mdu-乘除单元">MDU 乘除单元</h4>
<ol>
<li><strong>定义</strong>：根据控制信号，对输入的两个数进行乘法或除法运算。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数A</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">输入操作数B</td>
</tr>
<tr>
<td style="text-align:center">MDUOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">MDU操作码</td>
</tr>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">Req</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常中断信号</td>
</tr>
<tr>
<td style="text-align:center">start</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">开始状态信号</td>
</tr>
<tr>
<td style="text-align:center">MDURes</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">运算结果</td>
</tr>
<tr>
<td style="text-align:center">Hi</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">高位结果</td>
</tr>
<tr>
<td style="text-align:center">Lo</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">低位结果</td>
</tr>
<tr>
<td style="text-align:center">busy</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">忙状态信号</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<p>当<strong>非</strong>异常中断时，根据MDUOp的值，对输入的A和B进行相应的乘法或除法运算，并将结果输出到Hi和Lo寄存器，同时输出忙信号表示运算状态。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">功能</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>MULT</code></td>
<td style="text-align:center">有符号乘法，结果存储在Hi和Lo中</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>MULTU</code></td>
<td style="text-align:center">无符号乘法，结果存储在Hi和Lo中</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>DIV</code></td>
<td style="text-align:center">有符号除法，商存储在Lo中，余数存储在Hi中</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>DIVU</code></td>
<td style="text-align:center">无符号除法，商存储在Lo中，余数存储在Hi中</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center"><code>MTHI</code></td>
<td style="text-align:center">将A的值存储到Hi中</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center"><code>MTLO</code></td>
<td style="text-align:center">将A的值存储到Lo中</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center"><code>MFHI</code></td>
<td style="text-align:center">将Hi的值输出到MDURes</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center"><code>MFLO</code></td>
<td style="text-align:center">将Lo的值输出到MDURes</td>
</tr>
</tbody>
</table>
<blockquote>
<p>设置临时变量hitemp和loemp，分别存储Hi和Lo的值，根据计数逻辑在完成乘除运算后，将hitemp和loemp的值赋值给Hi和Lo。</p>
</blockquote>
<h3 id="m级：存储memory">M级：存储Memory</h3>
<h4 id="m-reg-m级流水线寄存器">M_REG M级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：存储M级流水线寄存器的数据，并在时钟上升沿将E级输入信号传递到M级输出信号。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">Req</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常请求信号</td>
</tr>
<tr>
<td style="text-align:center">E_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级指令</td>
</tr>
<tr>
<td style="text-align:center">E_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC值</td>
</tr>
<tr>
<td style="text-align:center">E_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">E_RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">E_CMPOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级比较结果</td>
</tr>
<tr>
<td style="text-align:center">E_RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">E_RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">E_ALU_Res</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">E_MDURes</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级MDU运算结果</td>
</tr>
<tr>
<td style="text-align:center">E_Tnew</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">E级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">E_ALU_Fwd_MUXOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">E级ALU转发MUX输出</td>
</tr>
<tr>
<td style="text-align:center">E_BDIn</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级分支延迟槽信号</td>
</tr>
<tr>
<td style="text-align:center">E_ExcCode_Fixed</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级更新异常码</td>
</tr>
<tr>
<td style="text-align:center">M_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级指令</td>
</tr>
<tr>
<td style="text-align:center">M_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC值</td>
</tr>
<tr>
<td style="text-align:center">M_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">M_RegAddr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">M_CMPOut</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级比较结果</td>
</tr>
<tr>
<td style="text-align:center">M_RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">M_RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">M_ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">M_MDURes</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级MDU运算结果</td>
</tr>
<tr>
<td style="text-align:center">M_Tnew</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">M级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">M_ALU_Fwd_MUXOut</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU转发MUX输出</td>
</tr>
<tr>
<td style="text-align:center">M_BDIn</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级分支延迟槽信号</td>
</tr>
<tr>
<td style="text-align:center">M_ExcCode</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级异常码</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>或<code>Req</code>信号为1时，所有输出信号清空，对于暂停操作而言相当于插入nop指令，注意对Req需跳转到异常处理程序，且延迟槽BDIn需要保持</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">在时钟上升沿，将E级输入信号传递到M级输出信号</td>
</tr>
</tbody>
</table>
<h4 id="m-dm-数据存储器">M_DM 数据存储器</h4>
<p>由于内存外置，故原DM模块实现转移到BE和DE中</p>
<h4 id="m-be-缓存写回模块">M_BE 缓存写回模块</h4>
<ol>
<li><strong>定义</strong>：根据读写信号和地址，对数据进行字节、半字或字的写操作，并处理地址对齐和异常情况。</li>
<li></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">LSOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">读写操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">BEAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存写回地址</td>
</tr>
<tr>
<td style="text-align:center">BE_WD_In</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存写回输入数据</td>
</tr>
<tr>
<td style="text-align:center">MemWrite</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">BE_isSt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">存储操作标志</td>
</tr>
<tr>
<td style="text-align:center">byteen</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">字节使能信号</td>
</tr>
<tr>
<td style="text-align:center">BE_WD_Out</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存写回输出数据</td>
</tr>
<tr>
<td style="text-align:center">BE_ExcCode</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">缓存写回异常码</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">字写操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Word</code>时，<code>byteen</code>为<code>4'b1111</code>，<code>BE_WD_Out</code>为<code>BE_WD_In</code></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">半字写操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Half</code>时，根据<code>BEAddr</code>的值选择高16位或低16位进行写操作</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">字节写操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Byte</code>时，根据<code>BEAddr</code>的值选择相应的字节进行写操作</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">默认操作</td>
<td style="text-align:left">当<code>MemWrite</code>为0或<code>LSOp</code>为其他值时，<code>byteen</code>为<code>4'b0000</code>，<code>BE_WD_Out</code>为<code>32'h00000000</code></td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:left">异常处理</td>
<td style="text-align:left">根据AlignExc, AddrExc, TimerExc, CountExc情况，设置<code>BE_ExcCode</code>的值</td>
</tr>
</tbody>
</table>
<h4 id="m-de-缓存读模块">M_DE 缓存读模块</h4>
<ol>
<li>
<p><strong>定义</strong>：根据读信号和地址，对数据进行字节、半字或字的读操作，并处理地址对齐和异常情况。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">LSOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">读操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">DEAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存读出地址</td>
</tr>
<tr>
<td style="text-align:center">DE_m_data_rdata</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存读出输入数据</td>
</tr>
<tr>
<td style="text-align:center">DE_isLd</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">读操作标志</td>
</tr>
<tr>
<td style="text-align:center">DE_RD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">缓存读出输出数据</td>
</tr>
<tr>
<td style="text-align:center">DE_ExcCode</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">缓存读出异常码</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">操作</th>
<th style="text-align:left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">字读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Word</code>时，<code>DE_RD</code>为<code>DE_m_data_rdata</code></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">半字读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Half</code>时，根据<code>DEAddr</code>的值选择高16位或低16位进行读操作</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">字节读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Byte</code>时，根据<code>DEAddr</code>的值选择相应的字节进行读操作</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">半字无符号读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Half_Unsigned</code>时，根据<code>DEAddr</code>的值选择高16位或低16位进行无符号读操作</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">字节无符号读操作</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Byte_Unsigned</code>时，根据<code>DEAddr</code>的值选择相应的字节进行无符号读操作</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">默认操作</td>
<td style="text-align:left">当<code>LSOp</code>为其他值时，<code>DE_RD</code>为<code>32'h00000000</code></td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">地址对齐异常检测</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Word</code>且未对齐时，或<code>LSOp</code>为<code>Ls_Half</code>且未对齐时，<code>AlignExc</code>为1</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">地址范围异常检测</td>
<td style="text-align:left">当<code>DEAddr</code>不在合法范围内时，<code>AddrExc</code>为1</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">定时器异常检测</td>
<td style="text-align:left">当<code>LSOp</code>为<code>Ls_Half</code>或<code>Ls_Byte</code>且<code>DEAddr</code>在定时器地址范围内时，<code>TimerExc</code>为1</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">异常码输出</td>
<td style="text-align:left">当<code>DE_isLd</code>为1且存在异常时，<code>DE_ExcCode</code>为<code>ExcCode_AdEL</code>，否则为<code>5'b0</code></td>
</tr>
</tbody>
</table>
<h4 id="cp0-模块">CP0 模块</h4>
<ol>
<li>
<p><strong>定义</strong>：CP0 模块用于处理异常和中断信号，管理状态寄存器（SR）、异常原因寄存器（CAUSE）和异常程序计数器（EPC）。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">enable</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">使能信号</td>
</tr>
<tr>
<td style="text-align:center">CP0Addr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">CP0 寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">CP0_WD_In</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">CP0 写入数据</td>
</tr>
<tr>
<td style="text-align:center">VPC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">虚拟程序计数器</td>
</tr>
<tr>
<td style="text-align:center">BDIn</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">分支延迟槽信号</td>
</tr>
<tr>
<td style="text-align:center">ExcCodeIn</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">输入异常码</td>
</tr>
<tr>
<td style="text-align:center">HWInt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">6</td>
<td style="text-align:center">硬件中断信号</td>
</tr>
<tr>
<td style="text-align:center">EXLClr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">EXL 清除信号</td>
</tr>
<tr>
<td style="text-align:center">CP0Out</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">CP0 输出数据</td>
</tr>
<tr>
<td style="text-align:center">Req</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常请求信号</td>
</tr>
<tr>
<td style="text-align:center">EPCOut</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">异常程序计数器输出</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">操作</th>
<th style="text-align:left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">复位操作</td>
<td style="text-align:left">当<code>reset</code>信号为1时，<code>SR</code>、<code>CAUSE</code>、<code>EPC</code>和<code>CP0Out</code>清零</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">硬件中断处理</td>
<td style="text-align:left">当<code>Req</code>信号为1时，<code>EXL</code>置1，<code>ExcCode</code>根据<code>HWInt</code>和<code>IM</code>设置，<code>EPC</code>根据<code>BDIn</code>设置，<code>BD</code>置<code>BDIn</code></td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">EXL 清除操作</td>
<td style="text-align:left">当<code>EXLClr</code>信号为1时，<code>EXL</code>置0</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">CP0 寄存器写操作</td>
<td style="text-align:left">当<code>enable</code>信号为1时，根据<code>CP0Addr</code>写入<code>SR</code>、<code>CAUSE</code>或<code>EPC</code></td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">CP0 寄存器读操作</td>
<td style="text-align:left">根据<code>CP0Addr</code>读取<code>SR</code>、<code>CAUSE</code>或<code>EPC</code>到<code>CP0Out</code></td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">异常请求检测</td>
<td style="text-align:left">当<code>EXL</code>为0且<code>ExcCodeIn</code>不为0或<code>HWInt</code>和<code>IM</code>不为0且<code>IE</code>不为0时，<code>Req</code>置1</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">EPC 输出</td>
<td style="text-align:left">将<code>EPC</code>输出到<code>EPCOut</code></td>
</tr>
</tbody>
</table>
<h3 id="w级：写回writeback">W级：写回<em>WriteBack</em></h3>
<h4 id="w-reg-w级流水线寄存器">W_REG W级流水线寄存器</h4>
<ol>
<li><strong>定义</strong>：存储W级流水线寄存器的数据。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">clk</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">时钟信号</td>
</tr>
<tr>
<td style="text-align:center">reset</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">复位信号</td>
</tr>
<tr>
<td style="text-align:center">Req</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常请求信号</td>
</tr>
<tr>
<td style="text-align:center">M_Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级指令</td>
</tr>
<tr>
<td style="text-align:center">M_PC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC值</td>
</tr>
<tr>
<td style="text-align:center">M_PC8</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">M_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">M_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">M_RegAddr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">M_RD1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">M_RD2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">M_ALU_Res</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">M_MDURes</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">M_DM_RD</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">M级数据存储器读数据</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">3</td>
<td style="text-align:center">M级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">M_Tnew</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">M级新指令周期</td>
</tr>
<tr>
<td style="text-align:center">W_Instr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级指令</td>
</tr>
<tr>
<td style="text-align:center">W_PC</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级PC值</td>
</tr>
<tr>
<td style="text-align:center">W_PC8</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级PC+8值</td>
</tr>
<tr>
<td style="text-align:center">W_A1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">W_A2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">W_RegAddr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">W_RD1</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级寄存器数据1</td>
</tr>
<tr>
<td style="text-align:center">W_RD2</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级寄存器数据2</td>
</tr>
<tr>
<td style="text-align:center">W_ALU_Res</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级ALU运算结果</td>
</tr>
<tr>
<td style="text-align:center">W_DM_RD</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">W级数据存储器读数据</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_W</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">W级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel_W</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">W级寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">W_Tnew</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">W级新指令周期</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">同步复位</td>
<td style="text-align:left">当<code>reset</code>或者<code>Req</code>信号为1时，所有输出信号清空，对于暂停操作而言相当于插入nop指令</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">正常传递</td>
<td style="text-align:left">在时钟上升沿，将M级输入信号传递到W级输出信号</td>
</tr>
</tbody>
</table>
<h3 id="mcu-控制单元">MCU 控制单元</h3>
<ol>
<li>
<p><strong>定义</strong><br>
MCU 控制单元用于生成控制信号，控制其他模块的行为。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Instr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">指令</td>
</tr>
<tr>
<td style="text-align:center">CMPOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">比较结果信号</td>
</tr>
<tr>
<td style="text-align:center">RegDstSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">寄存器目标选择信号</td>
</tr>
<tr>
<td style="text-align:center">ALUBSrcSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">ALU_B源选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegDataSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">寄存器数据选择信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">MemWrite</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">内存写使能信号</td>
</tr>
<tr>
<td style="text-align:center">NPCSel</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">下一条指令PC选择信号</td>
</tr>
<tr>
<td style="text-align:center">ExtOp_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">扩展操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">CMPOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较操作选择信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_Op</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">ALU操作码</td>
</tr>
<tr>
<td style="text-align:center">MDUOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">MDU操作码</td>
</tr>
<tr>
<td style="text-align:center">MDU_Start</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">MDU启动信号</td>
</tr>
<tr>
<td style="text-align:center">LSOp</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">存储操作码</td>
</tr>
<tr>
<td style="text-align:center">Tuse_rs</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rs使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tuse_rt</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rt使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tnew_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">2</td>
<td style="text-align:center">产生数据所用周期数</td>
</tr>
<tr>
<td style="text-align:center">CU_ExcCode</td>
<td style="text-align:center">O</td>
<td style="text-align:center">5</td>
<td style="text-align:center">控制单元异常码</td>
</tr>
<tr>
<td style="text-align:center">isEret</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">异常返回信号</td>
</tr>
<tr>
<td style="text-align:center">BE_isSt</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">存储操作标志</td>
</tr>
<tr>
<td style="text-align:center">DE_isLd</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">加载操作标志</td>
</tr>
<tr>
<td style="text-align:center">ALU_AdExc</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">地址异常信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_OvExc</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">溢出异常信号</td>
</tr>
<tr>
<td style="text-align:center">Cp0Enable</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">CP0使能信号</td>
</tr>
<tr>
<td style="text-align:center">isLAB</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">LAB信号</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">指令译码</td>
<td style="text-align:left">根据操作码和功能码生成对应的控制信号</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">控制信号生成</td>
<td style="text-align:left">生成寄存器目标选择信号、ALU B源选择信号、寄存器数据选择信号等</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">冒险时间生成</td>
<td style="text-align:left">生成rs和rt的使用时间以及新指令周期</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>
<p><strong>信号生成说明</strong><br>
将所有指令译码后根据类型分为<code>cal_r</code>、<code>cal_i</code>、<code>ld</code>、<code>st</code>、<code>md</code>、<code>mt</code>、<code>mf</code>、<code>b_type</code>、<code>j_type</code>，对于共性控制信号直接按照类型生成</p>
</li>
<li>
<p><strong>多路选择器说明</strong></p>
<ol>
<li><strong>RegDstSel</strong>：寄存器目标选择信号，用于选择写入寄存器的目标寄存器。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">RaType</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写回ra寄存器</td>
</tr>
<tr>
<td style="text-align:center">RdType</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写回rd寄存器</td>
</tr>
<tr>
<td style="text-align:center">RtType</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">写回rt寄存器</td>
</tr>
</tbody>
</table>
<ol start="2">
<li><strong>ALUBSel</strong>：ALU B源选择信号，用于选择ALU B输入端的源。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">E_ALU_Fwd_MUXOut</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">寄存器值</td>
</tr>
<tr>
<td style="text-align:center">EXT</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">扩展后的立即数</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>RegDataSel</strong>：寄存器数据选择信号，用于选择写入寄存器的数据源。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">FromMDU</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自MDU</td>
</tr>
<tr>
<td style="text-align:center">FromPC</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自PC8</td>
</tr>
<tr>
<td style="text-align:center">FromALU</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自ALU</td>
</tr>
<tr>
<td style="text-align:center">FromDM</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">来自DM</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h3 id="hcu-冒险控制单元">HCU 冒险控制单元</h3>
<ol>
<li><strong>定义</strong>：冒险控制单元用于检测流水线中的数据冒险，并生成相应的转发和停顿信号。</li>
<li><strong>端口定义</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Tuse_rs</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rs使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tuse_rt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">rt使用需要周期数</td>
</tr>
<tr>
<td style="text-align:center">Tnew_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">E级产生数据需要周期</td>
</tr>
<tr>
<td style="text-align:center">Tnew_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">M级产生数据需要周期</td>
</tr>
<tr>
<td style="text-align:center">Tnew_W</td>
<td style="text-align:center">I</td>
<td style="text-align:center">2</td>
<td style="text-align:center">W级产生数据需要周期</td>
</tr>
<tr>
<td style="text-align:center">D_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">D_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">D级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">D_MDUOp</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">D级MDU操作控制信号</td>
</tr>
<tr>
<td style="text-align:center">D_isEret</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">D级异常返回信号</td>
</tr>
<tr>
<td style="text-align:center">E_A1</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址1</td>
</tr>
<tr>
<td style="text-align:center">E_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">E_A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">E_rd</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">E级CP0寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">E_Busy</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级MDU忙状态</td>
</tr>
<tr>
<td style="text-align:center">E_Start</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级MDU开始状态</td>
</tr>
<tr>
<td style="text-align:center">E_Cp0Enable</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级CP0使能信号</td>
</tr>
<tr>
<td style="text-align:center">M_A2</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器地址2</td>
</tr>
<tr>
<td style="text-align:center">M_A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">M_rd</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">M级CP0寄存器地址</td>
</tr>
<tr>
<td style="text-align:center">M_Cp0Enable</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级CP0使能信号</td>
</tr>
<tr>
<td style="text-align:center">W_A3</td>
<td style="text-align:center">I</td>
<td style="text-align:center">5</td>
<td style="text-align:center">W级寄存器写地址</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_E</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_M</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">RegWrite_W</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">W级寄存器写使能信号</td>
</tr>
<tr>
<td style="text-align:center">E_isLAB</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">E级LAB信号</td>
</tr>
<tr>
<td style="text-align:center">M_isLAB</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">M级LAB信号</td>
</tr>
<tr>
<td style="text-align:center">CMP_RD1_Fwd_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较器RD1转发信号</td>
</tr>
<tr>
<td style="text-align:center">CMP_RD2_Fwd_D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">比较器RD2转发信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_A_Fwd_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">ALU A转发信号</td>
</tr>
<tr>
<td style="text-align:center">ALU_B_Fwd_E</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">ALU B转发信号</td>
</tr>
<tr>
<td style="text-align:center">DM_WD_Fwd_M</td>
<td style="text-align:center">O</td>
<td style="text-align:center">3</td>
<td style="text-align:center">数据存储器写数据转发信号</td>
</tr>
<tr>
<td style="text-align:center">stall</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">停顿信号</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>实现功能</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">停顿检测</td>
<td style="text-align:left">根据寄存器地址和使用周期数，检测是否需要停顿</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">转发信号生成</td>
<td style="text-align:left">生成比较器、ALU和数据存储器的转发信号</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">停顿信号生成</td>
<td style="text-align:left">生成流水线停顿信号</td>
</tr>
</tbody>
</table>
<h4 id="暂停stall">暂停<em>Stall</em></h4>
<p>使用A-T法判断，当address相同时，若D级的Tuse_rs或Tuse_rt比E、M、W级的Tnew小，则说明在D级需要使用寄存器中数据时，E、M、W级相应的寄存器数据还未准备好，需要暂停流水线。</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line">E_Stall_Rs = (E_A3 == D_A1) &amp;&amp; (D_A1 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_E &gt; Tuse_rs) &amp;&amp; RegWrite_E;</span><br><span class="line">E_Stall_Rt = (E_A3 == D_A2) &amp;&amp; (D_A2 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_E &gt; Tuse_rt) &amp;&amp; RegWrite_E;</span><br><span class="line">M_Stall_Rs = (M_A3 == D_A1) &amp;&amp; (D_A1 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_M &gt; Tuse_rs) &amp;&amp; RegWrite_M;</span><br><span class="line">M_Stall_Rt = (M_A3 == D_A2) &amp;&amp; (D_A2 != <span class="number">5&#x27;b0</span>) &amp;&amp; (Tnew_M &gt; Tuse_rt) &amp;&amp; RegWrite_M;</span><br><span class="line">E_stall_md = D_MDUOp != `MDU_NONE &amp;&amp; (E_Busy || E_Start);</span><br><span class="line">Stall_Eret = D_isEret &amp;&amp; (E_Cp0Enable &amp;&amp; E_rd == `CP0_EPC || M_Cp0Enable &amp;&amp; M_rd == `CP0_EPC);</span><br><span class="line"></span><br><span class="line">stall = E_Stall_Rs || E_Stall_Rt || M_Stall_Rs || M_Stall_Rt || E_stall_md || Stall_Eret;</span><br><span class="line"><span class="comment">//W级不需要判断，因为在GRF中存在内部转发</span></span><br></pre></td></tr></table></figure>
<h4 id="转发foward">转发<em>Foward</em></h4>
<p>执行暴力转发，使用A-T法判断，当address相同且D级的Tuse_rs或Tuse_rt大于E、M级相应的Tnew时，说明D级需要使用的数据在E、M级中，需要转发。</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Forwarding logic for CMP_RD1, W not included because it&#x27;s forwared in GRF</span></span><br><span class="line"><span class="keyword">assign</span> CMP_RD1_Fwd_D = </span><br><span class="line">    (M_A3 == D_A1 &amp;&amp; RegWrite_M &amp;&amp; D_A1) ? `FWD_MEM : </span><br><span class="line">    (W_A3 == D_A1 &amp;&amp; RegWrite_W &amp;&amp; D_A1) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for CMP_RD2, W not included because it&#x27;s forwared in GRF</span></span><br><span class="line"><span class="keyword">assign</span> CMP_RD2_Fwd_D = </span><br><span class="line">    (M_A3 == D_A2 &amp;&amp; RegWrite_M &amp;&amp; D_A2) ? `FWD_MEM : </span><br><span class="line">    (W_A3 == D_A2 &amp;&amp; RegWrite_W &amp;&amp; D_A2) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for ALU_A</span></span><br><span class="line"><span class="keyword">assign</span> ALU_A_Fwd_E = </span><br><span class="line">    (M_A3 == E_A1 &amp;&amp; RegWrite_M &amp;&amp; E_A1) ? `FWD_MEM :</span><br><span class="line">    (W_A3 == E_A1 &amp;&amp; RegWrite_W &amp;&amp; E_A1) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for ALU_B</span></span><br><span class="line"><span class="keyword">assign</span> ALU_B_Fwd_E = </span><br><span class="line">    (M_A3 == E_A2 &amp;&amp; RegWrite_M &amp;&amp; E_A2) ? `FWD_MEM :</span><br><span class="line">    (W_A3 == E_A2 &amp;&amp; RegWrite_W &amp;&amp; E_A2) ? `FWD_WB : `FWD_GRF;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Forwarding logic for DM_WD</span></span><br><span class="line"><span class="keyword">assign</span> DM_WD_Fwd_M = </span><br><span class="line">    (W_A3 == M_A2 &amp;&amp; RegWrite_W &amp;&amp; M_A2) ? `FWD_WB : `FWD_GRF;</span><br></pre></td></tr></table></figure>
<h2 id="bridge-系统桥">Bridge 系统桥</h2>
<ol>
<li>
<p><strong>定义</strong>：Bridge 模块用于在 CPU 和外设之间进行数据传输和中断管理。它根据地址范围选择目标外设，并处理读写操作和中断信号。</p>
</li>
<li>
<p><strong>端口定义</strong></p>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">信号名</th>
<th style="text-align:center">方向</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">interrupt</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">外部中断信号</td>
</tr>
<tr>
<td style="text-align:center">TC0_IRQ</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">定时器0中断请求信号</td>
</tr>
<tr>
<td style="text-align:center">TC0_Dout</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">定时器0数据输出</td>
</tr>
<tr>
<td style="text-align:center">TC1_IRQ</td>
<td style="text-align:center">I</td>
<td style="text-align:center">1</td>
<td style="text-align:center">定时器1中断请求信号</td>
</tr>
<tr>
<td style="text-align:center">TC1_Dout</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">定时器1数据输出</td>
</tr>
<tr>
<td style="text-align:center">m_data_rdata</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">内存数据读取</td>
</tr>
<tr>
<td style="text-align:center">CPU_m_data_addr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">CPU 数据地址</td>
</tr>
<tr>
<td style="text-align:center">CPU_m_data_wdata</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">CPU 数据写入</td>
</tr>
<tr>
<td style="text-align:center">CPU_m_data_byteen</td>
<td style="text-align:center">I</td>
<td style="text-align:center">4</td>
<td style="text-align:center">CPU 字节使能信号</td>
</tr>
<tr>
<td style="text-align:center">CPU_m_inst_addr</td>
<td style="text-align:center">I</td>
<td style="text-align:center">32</td>
<td style="text-align:center">CPU 指令地址</td>
</tr>
<tr>
<td style="text-align:center">HWInt</td>
<td style="text-align:center">O</td>
<td style="text-align:center">6</td>
<td style="text-align:center">硬件中断信号</td>
</tr>
<tr>
<td style="text-align:center">TC0_Addr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">定时器0地址</td>
</tr>
<tr>
<td style="text-align:center">TC0_WE</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">定时器0写使能</td>
</tr>
<tr>
<td style="text-align:center">TC0_Din</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">定时器0数据输入</td>
</tr>
<tr>
<td style="text-align:center">TC1_Addr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">定时器1地址</td>
</tr>
<tr>
<td style="text-align:center">TC1_WE</td>
<td style="text-align:center">O</td>
<td style="text-align:center">1</td>
<td style="text-align:center">定时器1写使能</td>
</tr>
<tr>
<td style="text-align:center">TC1_Din</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">定时器1数据输入</td>
</tr>
<tr>
<td style="text-align:center">CPU_m_data_rdata</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">CPU 数据读取</td>
</tr>
<tr>
<td style="text-align:center">m_data_addr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">内存数据地址</td>
</tr>
<tr>
<td style="text-align:center">m_data_wdata</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">内存数据写入</td>
</tr>
<tr>
<td style="text-align:center">m_data_byteen</td>
<td style="text-align:center">O</td>
<td style="text-align:center">4</td>
<td style="text-align:center">内存字节使能信号</td>
</tr>
<tr>
<td style="text-align:center">m_inst_addr</td>
<td style="text-align:center">O</td>
<td style="text-align:center">32</td>
<td style="text-align:center">内存指令地址</td>
</tr>
</tbody>
</table>
<ol start="3">
<li><strong>功能实现</strong></li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:left">功能</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">地址选择</td>
<td style="text-align:left">根据 CPU 数据地址选择目标外设（定时器0、定时器1或内存）</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">数据传输</td>
<td style="text-align:left">根据选择的目标外设进行数据读写操作</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">中断管理</td>
<td style="text-align:left">处理外部中断信号和定时器中断请求信号，并生成硬件中断信号</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left">写使能控制</td>
<td style="text-align:left">根据字节使能信号和目标外设生成定时器写使能信号</td>
</tr>
</tbody>
</table>
<h2 id="tc-计时器模块">TC 计时器模块</h2>
<p>课程组官方提供</p>
<ul>
<li>空闲（IDLE）：如果ctrl寄存器的第0位为1，则进入加载状态。</li>
<li>加载（LOAD）：将预置值加载到计数器中，然后进入计数状态。</li>
<li>计数（CNT）：如果ctrl寄存器的第0位为1，则计数器减1，直到计数器为0，然后进入中断状态。</li>
<li>中断（INT）：设置中断信号_IRQ为1，然后根据ctrl寄存器的第2、3位决定是否重置计数器或清除中断信号，最后回到空闲状态。</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">当前状态</th>
<th style="text-align:center">条件</th>
<th style="text-align:center">下一个状态</th>
<th style="text-align:center">动作</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>IDLE</code></td>
<td style="text-align:center"><code>ctrl[0]</code>为1</td>
<td style="text-align:center"><code>LOAD</code></td>
<td style="text-align:center"><code>_IRQ</code>置0</td>
</tr>
<tr>
<td style="text-align:center"><code>LOAD</code></td>
<td style="text-align:center">-</td>
<td style="text-align:center"><code>CNT</code></td>
<td style="text-align:center"><code>count</code>置<code>preset</code></td>
</tr>
<tr>
<td style="text-align:center"><code>CNT</code></td>
<td style="text-align:center"><code>ctrl[0]</code>为1且<code>count</code>&gt;1</td>
<td style="text-align:center"><code>CNT</code></td>
<td style="text-align:center"><code>count</code>减1</td>
</tr>
<tr>
<td style="text-align:center"><code>CNT</code></td>
<td style="text-align:center"><code>ctrl[0]</code>为1且<code>count</code>&lt;=1</td>
<td style="text-align:center"><code>INT</code></td>
<td style="text-align:center"><code>count</code>置0，<code>_IRQ</code>置1</td>
</tr>
<tr>
<td style="text-align:center"><code>CNT</code></td>
<td style="text-align:center"><code>ctrl[0]</code>为0</td>
<td style="text-align:center"><code>IDLE</code></td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center"><code>INT</code></td>
<td style="text-align:center"><code>ctrl[2:1]</code>为2’b00</td>
<td style="text-align:center"><code>IDLE</code></td>
<td style="text-align:center"><code>ctrl[0]</code>置0</td>
</tr>
<tr>
<td style="text-align:center"><code>INT</code></td>
<td style="text-align:center">其他</td>
<td style="text-align:center"><code>IDLE</code></td>
<td style="text-align:center"><code>_IRQ</code>置0</td>
</tr>
</tbody>
</table>
<h2 id="测试方案">测试方案</h2>
<p>沿用P6的随机测试程序，用于检测指令执行与转发阻塞的正确性，对于异常处理，则手动构造所有可能的异常情况，依次并验证其正确性。对于中断处理，使用官方tb，检测在对应的target_PC是否执行中断。</p>
<h2 id="p7思考题">P7思考题</h2>
<ol>
<li>请查阅相关资料，说明鼠标和键盘的输入信号是如何被 CPU 知晓的？</li>
</ol>
<blockquote>
<p>键盘和鼠标本质上都是输入设备,通过设备自身程序释放中断信号，指引处理器处理相应的输入信息。</p>
</blockquote>
<ol start="2">
<li>请思考为什么我们的 CPU 处理中断异常必须是已经指定好的地址？如果你的 CPU 支持用户自定义入口地址，即处理中断异常的程序由用户提供，其还能提供我们所希望的功能吗？如果可以，请说明这样可能会出现什么问题？否则举例说明。（假设用户提供的中断处理程序合法）</li>
</ol>
<blockquote>
<p>是可以的，我们可以通过改变出现异常中断时的跳转地址，但是这样可能会出现用户自定义程序与系统程序冲突的问题，对于不同的用户需要重新修改处理器，这样会使得处理器变得复杂，并且无法通用。</p>
</blockquote>
<ol start="3">
<li>为何与外设通信需要 Bridge？</li>
</ol>
<blockquote>
<p>由于外设的种类是多样的，而CPU在处理指令时只需要处理数据，因此需要通过Bridge来进行数据的中转，从而在增加外设时无需修改CPU的设计，使得CPU可以通用。</p>
</blockquote>
<ol start="4">
<li>请阅读官方提供的定时器源代码，阐述两种中断模式的异同，并分别针对每一种模式绘制状态移图。</li>
</ol>
<blockquote>
<p>模式0：<br>
[*] --&gt; IDLE<br>
IDLE --&gt; IDLE:reset<br>
IDLE --&gt; LOAD:ctrl[0] = 1<br>
LOAD --&gt; CNT<br>
CNT --&gt; CNT:ctrl[0] &amp;&amp; count &gt; 1<br>
CNT --&gt; INT:ctrl[0] &amp;&amp; count &lt;= 1<br>
INT --&gt; IDLE:ctrl[0] = 0 &amp;&amp; Int = 1<br>
CNT --&gt; IDLE:!ctrl[0]</p>
</blockquote>
<blockquote>
<p>模式1：<br>
[*] --&gt; IDLE<br>
IDLE --&gt; IDLE:reset<br>
IDLE --&gt; LOAD:ctrl[0] = 1<br>
LOAD --&gt; CNT<br>
CNT --&gt; CNT:ctrl[0] &amp;&amp; count &gt; 1<br>
CNT --&gt; INT:ctrl[0] &amp;&amp; count &lt;= 1<br>
INT --&gt; IDLE:Int = 0<br>
CNT --&gt; IDLE:ctrl[0] == 0</p>
</blockquote>
<ol start="5">
<li>倘若中断信号流入的时候，在检测宏观 PC 的一级如果是一条空泡（你的 CPU 该级所有信息均为空）指令，此时会发生什么问题？在此例基础上请思考：在 P7 中，清空流水线产生的空泡指令应该保留原指令的哪些信息？</li>
</ol>
<blockquote>
<p>如果此时PC为空，那么在流水线中会一直空泡，导致宏观PC也将表现为0，因此需要保留原指令的PC信息。</p>
</blockquote>
<ol start="6">
<li>为什么 jalr 指令为什么不能写成 jalr $31, $31？</li>
</ol>
<blockquote>
<p>因为jalr指令的跳转地址是PC+4+立即数，而$31是PC，因此如果将jalr指令写成jalr $31, $31，那么如果jalr的延迟槽内出现异常中断，那么中断异常结束后，会再次执行 jalr 指令，由于无法撤销已经执行的jalr指令，导致寄存器值已经修改，这就会跳转到不正确的 PC 地址。</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>lab</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
      </tags>
  </entry>
  <entry>
    <title>P7课上题目回忆和思路分享[BUAA-CO]</title>
    <url>/2024/12/11/COexamP7/</url>
    <content><![CDATA[<h2 id="简要概述">简要概述</h2>
<p>P7上机共5题，前四题均为课下强测，分别为<strong>功能强测</strong>、<strong>转发阻塞强测</strong>、<strong>异常强测</strong>和<strong>中断强测</strong>，保证课下实现功能没有问题即可通过，最后一题是课上新指令题，可能是新指令或异常处理（第一次是<code>withdraw</code>指令，涉及利用CP0中新增寄存器以实现撤销操作，具体内容可参考<a href="https://lazyfish-lc.github.io/2024/11/21/BUAA-CO-P7/">Lazyfish的博客</a>）</p>
<h2 id="t5-watch-exception-第二次">T5 Watch Exception(第二次)</h2>
<h3 id="题目描述">题目描述</h3>
<p>新增异常<code>Watch</code>，分为<code>IMWatch</code>和<code>DMWatch</code>，异常码均为<code>5'd23</code>，要求在CP0中新增2个32位18、19号寄存器<code>WatchLo</code>和<code>WatchHi</code>，均可通过mtc0和mfc0读写。<code>WatchLo</code>中高16位存放IM地址，低16位中存储DM地址，<code>WatchHi[0]</code>用于全局监视使能的控制，<code>Watch[1]</code>用于store类型指令监视使能的控制，<code>WatchHi[2]</code>用于load类型指令监视使能的控制，<code>WatchHi[3]</code>用于指令PC值监视使能的控制。</p>
<ul>
<li><code>IMWatch</code>IM异常：当指令PC值与<code>WatchLo</code>中高16位做32位0拓展后相等时，若全局监视使能和PC值监视使能均打开，则触发IMWatch异常。</li>
<li><code>DMWatch</code>DM异常：当store指令的地址<strong>范围包含</strong><code>WatchLo</code>中低16位做32位0拓展后的地址时，若全局监视使能和store类型指令监视使能均打开，则触发DMWatch异常；当load指令的地址<strong>范围包含</strong><code>WatchLo</code>中低16位做32位0拓展后的地址时，若全局监视使能和load类型指令监视使能均打开，则触发DMWatch异常。</li>
<li>注意：对于IM异常，优先级高于除PC值未对齐或地址越界外的其他异常；对于DM异常，不保证<code>WatchLo</code>中DM地址字段对齐，<code>IMWatch</code>异常优先级低于取数存数异常<code>AdEL</code>和<code>AdES</code>。受害指令在延迟槽内时，IM异常记录的EPC为跳转指令；若受害指令是乘除器指令，则触发IM异常<strong>不应该触发乘除槽</strong>，即精确异常。</li>
</ul>
<h3 id="解题思路">解题思路</h3>
<p>个人认为至少有两种思路，下面简单叙述一下。</p>
<ol>
<li>第一种是在D级判断D指令是否触发<code>IMWatch</code>异常，同时在冒险阻塞单元中特判如果D级或者M级是mtc0指令且修改了<code>WatchLo</code>或<code>WatchHi</code>寄存器，则将D级指令阻塞，直到阻塞结束得到了正确的<code>WatchLo</code>和<code>WatchHi</code>才判断。E级乘除器MDU需要特判出现<code>IMWatch</code>异常则禁止乘除槽。对于<code>DMWatch</code>异常，需要针对不同存取指令比较<code>WatchLo[16:0]</code>拓展后的地址范围，如lw或者sw指令比较<code>[32:2]</code>是否相等，lh或sh指令比较<code>[32:1]</code>是否相等，lb或sb指令比较<code>[32:0]</code>是否相等。注意需要特判<code>WatchHi[0]</code>、<code>WatchHi[1]</code>、<code>WatchHi[2]</code>、<code>WatchHi[3]</code>是否打开，否则不触发异常。</li>
<li>IM异常和DM也可以都在M级判断，只需要实现MDU的撤销操作，我的CPU架构中触发乘除槽后，当回合即会将计算结果存入<code>tempHi</code>和<code>tempLo</code>寄存器，故在M级判断异常后，如果是受害指令是乘除槽相关指令，将<code>tempHi</code>和<code>tempLo</code>以及计数器、busy等清零即可；DM异常处理与第一种方法相同。</li>
</ol>
<blockquote>
<p>此题还需要注意，<code>WatchLo</code>和<code>WatchHi</code>需要支持全部32位的读写，不能在F级判断IM异常，否则需要阻塞前面的mtc0指令一直到M级结束，这将导致TLE。</p>
</blockquote>
<h2 id="t5-memory-limitation-第三次">T5 Memory Limitation(第三次)</h2>
<h3 id="题目描述">题目描述</h3>
<p>在CP0中添加32位18号寄存器<code>LowerLimit</code>，32位19号寄存器<code>UpperLimit</code>，可正常通过mtc0/mfc0修改内容，<code>UpperLimit[15:0]</code>和<code>LowerLimit[15:0]</code>存上下界内存地址的[15:0]，通过32位0扩展得到<code>UpperAddress</code>和<code>LowerAddress</code>，对[<code>LowerAddress</code>, <code>UpperAddress</code>)内的内存读写操作进行如下限制（注意地址区间范围的开闭）。<br>
当<code>LowerLimit[31:16]</code>与<code>UpperLimit[31:16]</code>1的个数之和为奇数时只允许读，如果写将导致<code>AdES</code>异常，当<code>LowerLimit[31:16]</code>与<code>UpperLimit[31:16</code>]1的个数之和为偶数时只允许写，如果读将导致<code>AdEL</code>异常。<br>
保证<code>LowerLimit[15:0]</code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⩽</mo></mrow><annotation encoding="application/x-tex">\leqslant</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7733em;vertical-align:-0.1367em;"></span><span class="mrel amsrm">⩽</span></span></span></span> <code>UpperLimit[15:0]</code>，且<code>LowerLimit[15:0]</code>、<code>UpperLimit[15:0]</code>在<code>0x0000-0x3000</code>之间。若<code>LowerLimit[15:0]</code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span></span></span></span> <code>UpperLimit[15:0]</code>，则不限制任何内存读写。</p>
<h3 id="解题思路">解题思路</h3>
<p>整理一下需要做的事，增加两个寄存器，修改<code>MTC0</code>和<code>MFC0</code>指令，把寄存器中的数据传到BE和DE中，在BE和DE中判断是否禁止读或者写，比较地址和区间的关系，如果存在限制且读/写则触发异常。<br>
看着很简单，其实也确实如此，但最需要注意的是这个问题：<strong>地址只要包含了限制区间，同时在禁止读/写时进行了读/写操作</strong>，就会导致异常，那显然我们需要根据存取指令是字、半字还是字节来计算出操作的地址范围，然后与限制区间进行比较，如果存在交集，则触发异常。我们可以反过来，即判断存取指令的地址范围只落在限制范围的一侧，如此则不触发异常。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>lab</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
        <tag>考试</tag>
      </tags>
  </entry>
  <entry>
    <title>P1课上题目回忆和思路分享[BUAA-CO]</title>
    <url>/2024/10/15/COexamsP1/</url>
    <content><![CDATA[<h3 id="q1-vector-a和vector-b每位不同">Q1 vector a和vector b每位不同</h3>
<p>a,b都是32位二进制数，a从左往右读，b从右往左读，判断a和b不同的位数。</p>
<h4 id="解题思路：">解题思路：</h4>
<p>一道简单的组合逻辑问题</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> different (</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>] a, b,</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">5</span>:<span class="number">0</span>] count</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">integer</span> i; <span class="comment">//用于循环计数</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">5</span>:<span class="number">0</span>] cnt; <span class="comment">//定义一个计数变量</span></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span> <span class="comment">//组合逻辑</span></span><br><span class="line">        初始化 cnt 为 <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">31</span>; i &gt;= <span class="number">0</span>; i = i - <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            遍历 a 和 b 的每一位，如果对应位不同，则计数加 <span class="number">1</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">assign</span> count = cnt;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h3 id="q2-奇偶交替数列">Q2 奇偶交替数列</h3>
<p>一个数列由01组成，连续的0或者1的个数分别为奇偶，则符合要求，如<code>001110000111</code>符合奇偶交替数列，<code>0011100001110</code>不符合。每个时钟上升沿读入number，如果是奇偶交替数列，则check为1，否则为0。res_n为异步复位信号，低电平有效。</p>
<h4 id="解题思路">解题思路</h4>
<p>检测输入信号的奇偶交替，并输出一个 <code>check</code> 信号。 记录 <code>1</code> 和 <code>0</code> 的长度，并计算二者长度的差值。如果差值是偶数，则 <code>check</code> 输出为 <code>0</code>，否则为 <code>1</code>。</p>
<h4 id="伪代码">伪代码</h4>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> alternate (</span><br><span class="line">    <span class="keyword">input</span> clk, res_n, number,</span><br><span class="line">    <span class="keyword">output</span> check</span><br><span class="line">);</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] onecnt, zerocnt;</span><br><span class="line">    <span class="keyword">reg</span> last_number;<span class="comment">//记录上一次的number</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] res;<span class="comment">//记录交替次数的差值，res为偶数则check为0，否则为1</span></span><br><span class="line">    <span class="keyword">reg</span> flag;<span class="comment">//数列不符合奇偶交替，flag记录为1，check输出始终为0</span></span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        初始化变量，last_number置为<span class="number">2</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">negedge</span> res_n) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (!res_n) <span class="keyword">begin</span></span><br><span class="line">            变量复位，last_number置为<span class="number">2</span></span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">        <span class="keyword">if</span> (当res为偶数 &amp;&amp; 当前number与last_number不同) <span class="keyword">begin</span></span><br><span class="line">            flag = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> (flag为<span class="number">0</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">case</span> (number) </span><br><span class="line">                <span class="number">1</span>: <span class="keyword">begin</span></span><br><span class="line">                    如果last_number为<span class="number">1</span>，onecnt加<span class="number">1</span>，否则onecnt置为<span class="number">1</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="number">0</span>: <span class="keyword">begin</span></span><br><span class="line">                    如果last_number为<span class="number">0</span>，zerocnt加<span class="number">1</span>，否则zerocnt置为<span class="number">1</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        res = (zerocnt或onecnt为<span class="number">0</span>) ? <span class="number">0</span> : (onecnt &gt; zerocnt) ?</span><br><span class="line">                            (onecnt - zerocnt) : (zerocnt - onecnt);</span><br><span class="line">        更新last_number</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> check = (res为偶数) ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="q3-序列匹配">Q3 序列匹配</h3>
<h4 id="题目描述">题目描述</h4>
<p><code>&#123;key1:value1, key2:value2, ···,&#125;</code>为符合要求的序列集合，其中<code>key</code>只由大小写字母和数字组成，且不能以数字开头，<code>value</code>由数字组成，<code>key</code>和<code>value</code>的长度大于等于1。<br>
输入格式为xxxx{xxxx:xxxx,···,xxxx:xxxx}xxxx，其中xxxx为任意字符且不包含<code>&#123;</code>、<code>:</code>、<code>,</code>、<code>&#125;</code>，<code>&#123;</code>、<code>:</code>、<code>,</code>、<code>&#125;</code>之间的空格不影响判断序列符合要求。<br>
每个时钟上升沿读取一个字符<code>chr</code>；<code>rst</code>为异步复位信号，高电平有效<br>
输出八位each和total，分别表示所在集合中的符合要求的序列个数和单个集合中最多符合要求的序列个数。注意，当读到<code>&#125;</code>时，将把each清零，而将更新total的值。（回忆版，大致是这样）</p>
<h4 id="状态转移设计思路">状态转移设计思路</h4>
<table>
<thead>
<tr>
<th style="text-align:center">S</th>
<th style="text-align:center">chr</th>
<th style="text-align:center">S’</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center"><code>&#123;</code></td>
<td style="text-align:center">1</td>
<td style="text-align:center">进入当前集合</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>other</code></td>
<td style="text-align:center">2</td>
<td style="text-align:center">该序列不符合要求</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><code>key</code></td>
<td style="text-align:center">3</td>
<td style="text-align:center">用<code>cnt</code>记录key的长度</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><code>,</code></td>
<td style="text-align:center">1</td>
<td style="text-align:center">读取下一个序列</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><code>:</code></td>
<td style="text-align:center">4</td>
<td style="text-align:center">读到<code>:</code>，进入value</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>value</code></td>
<td style="text-align:center">4</td>
<td style="text-align:center">读取value，用<code>cnt</code>记录value的长度</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>other</code></td>
<td style="text-align:center">2</td>
<td style="text-align:center">该序列不符合要求</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>,</code></td>
<td style="text-align:center">1</td>
<td style="text-align:center">符合要求，each+1</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><code>&#125;</code></td>
<td style="text-align:center">0</td>
<td style="text-align:center">集合结束，each清零，total取较大值</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>空格出现位置的状态转移说明</strong><br>
在读取key或value时，若cnt为0，说明空格出现在key或value之前，不影响判断，保持原状态，若cnt大于0，说明空格出现在key或value之后，此时将变量space置1，继续读取，如果chr仍是key或value，说明不符合要求，将进入状态2。</p>
</blockquote>
<p>以上是本人的解题过程，但第三题bug并没有解决，<s>可以帮我de一下bug</s> 仅供参考。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>lab</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
        <tag>考试</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机组成原理笔记</title>
    <url>/2024/09/11/ComputerConstructionNote/</url>
    <content><![CDATA[<h3 id="计算机组成概述">计算机组成概述</h3>
<h4 id="1-1-计算机的基本组成">1.1 计算机的基本组成</h4>
<p>硬件、软件</p>
<ul>
<li>计算机的功能<br>
Data Processing数据处理 - 运算器<br>
Data Storage数据存储 - 存储器<br>
Data Movement书籍移动交换 - IO设备<br>
Control控制 - 控制器</li>
</ul>
<p>运算器:实现数据处理的部件datapath<br>
ALU算数逻辑单元+Registers寄存器</p>
<p>运算器与机器字长<br>
运算器与机器性能指标 MIPS每秒平均运行百万条指令 CPI执行一条指令的时钟周期</p>
<p>存储器:实现数据存储的部件<br>
存储体+控制电路<br>
存储体-&gt;多个存储单元-&gt;存储字(存储的二进制代码)<br>
存储字长:每个存储单元存放的二进制代码的位数<br>
存储容量=存储单元个数*存储字长 单位:bit、Byte、word</p>
<p>控制器：实现控制功能的部件<br>
提供各部件工作所需的控制信号，控制计算机其他部件协同工作<br>
指令部件（Instruction Register ，Instruction Decoder）<br>
指令顺序控制（Program Counter）<br>
时序逻辑部件（Clock，Timer ，Sequencing Logic）<br>
控制信号生成部件（Control Signal Generator or Control Memory）<br>
Datapath运算器 ＋Control控制器 ＝CPU</p>
<p>输入输出：实现数据交换的部件<br>
实现计算机内部与外界（其他系统或人类）的信息交换<br>
实现数据交换的设备：输入设备、输出设备<br>
接口标准与接口部件</p>
<h4 id="1-2-计算机系统层次结构">1.2 计算机系统层次结构</h4>
<ul>
<li>机器语言 实际机器M1 机器语言程序</li>
<li>汇编语言 虚拟机器M2 汇编语言程序</li>
<li>高级语言 虚拟机器M3 高级语言程序</li>
</ul>
<p>ISA指令集架构 定义了计算机硬件所能执行的所有指令集，是计算机软硬件的分界线</p>
<h4 id="1-3-计算机总线结构">1.3 计算机总线结构</h4>
<ul>
<li>总线:符合一定标准的一组公共信息通道</li>
<li>系统总线构成：地址总线、数据总线、控制总线</li>
<li>总线举例： QPI/HT, PCI/PCI-E，SCSI</li>
<li>单总线结构、多总线结构</li>
</ul>
<blockquote>
<p>冯诺依曼:分散结构<br>
早期PC内部结构:单总线结构 总线可能成为性能瓶颈，不同资源相互拖累<br>
普通PC的内部结构:多总线结构 通过南北桥芯片进行协议的转换和信息的交换<br>
Sun SPARCstation20(RISC):多总线结构</p>
</blockquote>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409040804678.png" alt="计算机结构简图"></p>
<hr>
<h3 id="计算机中数的表示">计算机中数的表示</h3>
<ul>
<li>计算机的基本功能:对数据进行操作</li>
<li>实现功能的基本前提:能够对数字表述</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409040808096.png" alt><br>
计算机的基本约束:采用二进制，只有0和1</p>
<ul>
<li>不同编码规则表示的含义不同</li>
<li>数的表示要解决的问题
<ul>
<li>数的符号:正、负、零</li>
<li>数的形态:整数、小数、定点、浮点</li>
<li>数的绝对值</li>
</ul>
</li>
</ul>
<h4 id="无符号数和有符号数">无符号数和有符号数</h4>
<ul>
<li>
<p>无符号数</p>
<ul>
<li>数的编码中所有位均为数值位，没有符号位</li>
<li>只能表示 &gt;=0 的正整数</li>
<li>一般在全部是正数运算且不出现负值结果的场合下，可使用无符号数表示，例如 地址运算</li>
</ul>
<blockquote>
<p>16位无符号数的表示范围： 0 ~ 65535</p>
</blockquote>
</li>
<li>
<p>有符号数</p>
<ul>
<li>
<p>机器数表示<br>
数的正负问题：设符号位，</p>
<ul>
<li>“0”表示“正”，“1”表示“负”，固定为编码的最高位。</li>
<li>机器数和真值</li>
<li>真值0怎么办：正零，负零</li>
</ul>
<p>小数点怎么办：固定小数点 （即 定点数）</p>
<ul>
<li>定点小数：绝对值小于1 , 如： <font color="red">0</font> ^1100000</li>
<li>定点整数：没有小数部分, 如： <font color="red">0</font> 1100000^</li>
</ul>
<p>带有整数和小数部分的数怎么办：浮点数，</p>
<ul>
<li>按2为基的科学表示方法表示(浮点数)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409040822054.png" alt></p>
<ul>
<li>原码、反码、补码
<ul>
<li>原码:符号位+真值</li>
<li>反码:符号位不变，真值取反</li>
<li>补码:符号位不变，每位取反后加1</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">原码</th>
<th style="text-align:center">反码</th>
<th style="text-align:center">补码</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">容易理解</td>
<td style="text-align:center">很少使用</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">0的表示不唯一</td>
<td style="text-align:center"></td>
<td style="text-align:center">0的表示唯一</td>
</tr>
<tr>
<td style="text-align:center">符号位需单独处理</td>
<td style="text-align:center"></td>
<td style="text-align:center">符号位不需单独处理</td>
</tr>
<tr>
<td style="text-align:center">加减运算不统一</td>
<td style="text-align:center"></td>
<td style="text-align:center">加减运算统一</td>
</tr>
</tbody>
</table>
<ul>
<li>浮点数表示<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409040836844.png" alt></li>
</ul>
<p>进制转化:十进制的小数转二进制</p>
<ul>
<li>小数部分：乘2取整，倒序排列</li>
<li>整数部分：除2取余，正序排列</li>
</ul>
<p>规格化:将小数点移动到第一个非零数字之后，尾数保证第一位为1，此时阶码与小数点移动的位数有关</p>
<ul>
<li>
<p>浮点数的溢出问题</p>
<ul>
<li>上溢、下溢</li>
</ul>
</li>
<li>
<p>IEEE754标准<br>
符号、阶码和尾数表示</p>
</li>
</ul>
<ul>
<li>浮点数表示公式
<ul>
<li>单精度浮点数<br>
(-1)<sup>S</sup> * 1.m * 2<sup>E-127</sup></li>
<li>双精度浮点数<br>
(-1)<sup>S</sup> * 1.m * 2<sup>E-1023</sup></li>
</ul>
</li>
<li>单精度浮点数
<ul>
<li>1位符号位</li>
<li>8位指数位</li>
<li>23位尾数位</li>
</ul>
</li>
<li>双精度浮点数
<ul>
<li>1位符号位</li>
<li>11位指数位</li>
<li>52位尾数位</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409040905711.png" alt></p>
<ul>
<li>非数值数据表示<br>
逻辑数据编码、字符编码、汉字编码、数据的检错/纠错</li>
</ul>
<hr>
<h3 id="计算机的基本工作过程">计算机的基本工作过程</h3>
<h4 id="计算机的工作过程">计算机的工作过程</h4>
<ul>
<li>机器指令<br>
算机硬件可以执行的表示一种基本操作的<br>
二进制代码。
<ul>
<li>指令格式：操作码 + 操作数（操作数地址）</li>
<li>操作码：指明指令的操作性质</li>
<li>操作数（地址）：指令操作数的位置（或操作数本身）</li>
</ul>
</li>
<li>程序<br>
在此特指一段机器指令序列。
<ul>
<li>完成一定的功能，采用某种算法，具备一定的流程；</li>
<li>计算机按照程序所规定的流程和指令顺序，一条一条地执行指令，达到完成程序所规定的功能的目的。</li>
<li>计算机采用程序计数器（Program Counter）来决定指令执行的顺序。</li>
</ul>
</li>
<li>微操作<br>
计算机可以完成的最基本的操作，一条机器指令的执行<br>
可以解释为一系列的微操作的执行
<ul>
<li>操作性质：对数据进行某种处理</li>
<li>操作对象</li>
<li>操作的时间与条件</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409040916194.png" alt></p>
<h3 id="组合逻辑">组合逻辑</h3>
<h4 id="逻辑代数基础">逻辑代数基础</h4>
<ul>
<li>逻辑代数的基本概念<br>
逻辑、逻辑运算和布尔代数<br>
布尔代数(Bollean Algebra)又叫开关代数或逻辑代数</li>
<li>逻辑代数:逻辑代数L是一个封闭的代数系统，它由一个<br>
逻辑变量集K，常量0和1，以及“或”、“与”、“非”<br>
三种基本运算所构成，记为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mo stretchy="false">{</mo><mi>K</mi><mo separator="true">,</mo><mo>∨</mo><mo separator="true">,</mo><mo>∧</mo><mo separator="true">,</mo><mtext>￢</mtext><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">L=\{ K,∨,∧,￢,0 ,1 \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∨</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∧</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">￢</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>
<ul>
<li>逻辑变量:在逻辑运算中值会发生改变的量，由字母或字母加数字来表示，原变量(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>)、反变量(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>)</li>
</ul>
</li>
</ul>
<ol>
<li>与运算(合取) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>A</mi><mi>B</mi><mtext>或者</mtext><mi>F</mi><mo>=</mo><mi>A</mi><mo>∧</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">F=AB或者F=A\wedge B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">或者</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li>
<li>或运算(析取) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>B</mi><mtext>或者</mtext><mi>F</mi><mo>=</mo><mi>A</mi><mo>∨</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">F=A+B或者F=A∨B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">或者</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li>
<li>非运算(否定) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mtext>￢</mtext><mi>A</mi><mtext>或者</mtext><mi>F</mi><mo>=</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">F=￢A或者F=\overline A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">￢</span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">或者</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span></li>
<li>异或运算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>A</mi><mo>⊕</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">F=A\oplus B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li>
<li>同或运算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>A</mi><mo>⊙</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">F=A\odot B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li>
</ol>
<blockquote>
<p>异或逻辑与同或逻辑是互非关系:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊕</mo><mi>B</mi><mo>=</mo><mover accent="true"><mrow><mi>A</mi><mo>⊙</mo><mi>B</mi></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">A\oplus B=\overline{A\odot B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9667em;vertical-align:-0.0833em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0833em;"><span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊙</mo><mi>B</mi><mo>=</mo><mover accent="true"><mrow><mi>A</mi><mo>⊕</mo><mi>B</mi></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">A\odot B=\overline {A\oplus B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9667em;vertical-align:-0.0833em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0833em;"><span></span></span></span></span></span></span></span></span></p>
</blockquote>
<ul>
<li>逻辑运算的优先级</li>
<li>逻辑电路的符号表示<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409091424048.png" alt></li>
</ul>
<h4 id="逻辑代数的基本定理">逻辑代数的基本定理</h4>
<ul>
<li>逻辑代数的五条公理</li>
</ul>
<h4 id="逻辑代数的基本定律">逻辑代数的基本定律</h4>
<p>交换律、结合律、分配律、0·1律、互补律</p>
<h4 id="逻辑代数基本定理">逻辑代数基本定理</h4>
<ol>
<li>重叠律 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>+</mo><mi>A</mi><mo>=</mo><mi>A</mi><mtext>；</mtext><mi>A</mi><mo separator="true">⋅</mo><mi>A</mi><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A+A=A；A·A=A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">；</span><span class="mord mathnormal">A</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
<li>吸收律 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>+</mo><mi>A</mi><mo separator="true">⋅</mo><mi>B</mi><mo>=</mo><mi>A</mi><mtext>；</mtext><mi>A</mi><mo separator="true">⋅</mo><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A+A·B=A；A·(A+B)=A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">；</span><span class="mord mathnormal">A</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
<li>还原律 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mo stretchy="true">‾</mo></mover><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\overline{\overline{A}}=A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span><span style="top:-4.0033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
<li>反演律(德摩根定律) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mrow><mi>A</mi><mo>+</mo><mi>B</mi></mrow><mo stretchy="true">‾</mo></mover><mo>=</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mo>⋅</mo><mover accent="true"><mi>B</mi><mo stretchy="true">‾</mo></mover><mtext>；</mtext><mover accent="true"><mrow><mi>A</mi><mo separator="true">⋅</mo><mi>B</mi></mrow><mo stretchy="true">‾</mo></mover><mo>=</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mo>+</mo><mover accent="true"><mi>B</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{A+B}=\overline{A}\cdot\overline{B}；\overline{A·B}=\overline{A}+\overline{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9667em;vertical-align:-0.0833em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0833em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mord cjk_fallback">；</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9667em;vertical-align:-0.0833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span></li>
<li>包含律 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">⋅</mo><mi>B</mi><mo>+</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mo separator="true">⋅</mo><mi>C</mi><mo>+</mo><mi>B</mi><mo separator="true">⋅</mo><mi>C</mi><mo>=</mo><mi>A</mi><mo separator="true">⋅</mo><mi>B</mi><mo>+</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mo separator="true">⋅</mo><mi>C</mi><mtext>；</mtext></mrow><annotation encoding="application/x-tex">A·B+\overline A·C + B·C=A·B+\overline{A}·C；</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9667em;vertical-align:-0.0833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord cjk_fallback">；</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mo stretchy="false">(</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mo>+</mo><mi>C</mi><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mo stretchy="false">(</mo><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mo stretchy="false">(</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mo>+</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(A+B)·(\overline A+C)·(B+C)=(A+B)·(\overline A+C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1333em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1333em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></li>
</ol>
<h4 id="逻辑代数的规则">逻辑代数的规则</h4>
<ol>
<li>代入规则</li>
<li>反演规则 与、或互换，0、1互换，原变量与反变量互换</li>
<li>对偶规则 与、或互换，0、1互换，原变量与反变量<strong>不</strong>换</li>
</ol>
<h4 id="逻辑函数的表达式">逻辑函数的表达式</h4>
<ul>
<li>逻辑函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F=f(A_1,A_2,\cdots,A_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li>逻辑函数的常用表达式<br>
与或式、或与式、与或非式……</li>
<li>逻辑函数的标准表达式
<ul>
<li>最小项表达式：全部由最小项构成的 与或式（积之和式）</li>
<li>最大项表达式：全部由最大项构成的 或与式（和之积式）</li>
</ul>
</li>
<li>最小项
<ul>
<li>定义:由n个变量组成的 “与” 项中，每个变量以原变量或反变量的形式出现且仅出现一次，则这个与项称为最小项。n个变量有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>个最小项</li>
</ul>
</li>
</ul>
<blockquote>
<p>为书写方便，把最小项记做<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">m_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。<br>
下标i的取值规则：按照变量顺序将最小项中的原变量用1表示、反变量用0表示，得到一个二进制数，与其对应的十进制数，即该最小项的编号i。</p>
</blockquote>
<ul>
<li>最小项性质
<ul>
<li>对于任何一个最小项，只有对应的一组变量取值，使其值为1，其余情况下均为0；</li>
<li>全体最小项之和为1 ；</li>
<li>任意两个最小项的乘积为0；</li>
<li>相邻最小项：除一个变量互为相反外，其余变量都分别相同的两个最小项。<br>
具有相邻性的两个最小项之和，可以合并为一个乘积项，消去一个以原变量和反变量形式出现的变量，保留由没有变化的变量构成的乘积项。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>例</mtext><mo>:</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mover accent="true"><mi>B</mi><mo stretchy="true">‾</mo></mover><mover accent="true"><mi>C</mi><mo stretchy="true">‾</mo></mover><mo>+</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mover accent="true"><mi>B</mi><mo stretchy="true">‾</mo></mover><mi>C</mi><mo>=</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover><mover accent="true"><mi>B</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">例:\overline A\overline B\overline C+\overline A\overline BC=\overline A\overline B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">例</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9667em;vertical-align:-0.0833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>最小项表达式<br>
全部由最小项构成的与或式，也称标准与或式，可由最小项推导法直接从真值表中导出。</li>
</ul>
<blockquote>
<p>最小项推导法： 从真值表推出逻辑函数表达式的一种方法 。把输出为1的输入组合写成乘积项的形式，其中取值为 1 的输入用原变量表示，取值为 0 的输入用反变量表示，然后把这些乘积项加起来</p>
</blockquote>
<ul>
<li>最大项
<ul>
<li>定义：由n个变量组成的 “或” 项中，每个变量以原变量或反变量的形式出现且仅出现一次，则这个或项称为最大项。n个变量有2<sup>n</sup>个最大项</li>
</ul>
</li>
</ul>
<blockquote>
<p>为书写方便，把最大项记做M<sub>i</sub>。<br>
下标i的取值规则：按照变量顺序将最大项中的原变量用0表示、反变量用1表示，得到一个二进制数，与其对应的十进制数，即该最大项的编号i。</p>
</blockquote>
<ul>
<li>
<p>最大项性质</p>
<ul>
<li>对于任何一个最大项，只有对应的一组变量取值，使其值为0，其余情况下均为1；</li>
<li>全体最大项之积为0 ；</li>
<li>任意两个最大项的加和为1；</li>
<li>相邻最大项：除一个变量互为相反外，其余变量都分别相同的两个最大项。<br>
具有相邻性的两个最大项之积，可以合并为一个和项，消去一个以原变量和反变量形式出现的变量，保留由没有变化的变量构成的和项。</li>
</ul>
</li>
<li>
<p>最大项表达式<br>
全部由最大项构成的或与式，也称标准或与式，可由<br>
最大项推导法直接从真值表中导出。</p>
</li>
</ul>
<blockquote>
<p>最大项推导法： 从真值表推出逻辑函数表达式的一种方法 。把输出为0的输入组合写成和项的形式，其中取值为 0 的输入用原变量表示，取值为 1 的输入用反变量表示，然后把这些和项乘起来</p>
</blockquote>
<h4 id="逻辑函数化简">逻辑函数化简</h4>
<ul>
<li>代数法
<ol>
<li>合并乘积项法 ——利用互补律消去1个变量</li>
<li>吸收项法 ——利用吸收律和包含律减少“与”项</li>
<li>配项法 ——利用互补律，配在乘积项上</li>
</ol>
</li>
<li>卡诺图化简<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409091527691.png" alt>
<ul>
<li>卡诺图化简法
<ol>
<li>将真值表中的1填入卡诺图相应位置；</li>
<li>找出相邻的1，并圈出最小项，注意圈1的个数只能是2的n次方（n为变量个数）；</li>
<li>将圈出的1对应的乘积项相加，得到化简后的逻辑函数表达式。</li>
</ol>
</li>
<li>卡诺图化简规则<br>
同一卡诺图内，相邻的1可以合并为一个乘积项，同时消去取值不同的一个变量</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409091531911.png" alt></p>
<blockquote>
<p>注意:卡诺图边角是循环连续的，即边角只有一个值不同，也是相邻的。</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>理论课</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机组成原理笔记(2)</title>
    <url>/2024/09/18/ComputerConstructionNote2/</url>
    <content><![CDATA[<h3 id="逻辑门电路">逻辑门电路</h3>
<h4 id="晶体管和mos管">晶体管和MOS管</h4>
<ul>
<li>半导体：导电能力介于导体和绝缘体之间的物体称为半导体。P型半导体，N型半导体，多子，少子</li>
<li>PN结：将P型和N型半导体制作在一起，形成PN结</li>
<li>PN结正向偏置：P型半导体接正极，N型半导体接负极，形成正向偏置</li>
<li>PN结反向偏置：P型半导体接负极，N型半导体接正极，形成反向偏置</li>
<li>晶体二极管：一个PN结，记作D<br>
二极管单向导电性：受外加电压极性控制的开关特性<br>
正向导通：正向电压大于开启电压<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">V_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，二极管导通。一旦导通，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>D</mi></msub><mo>=</mo><msub><mi>V</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">U_D=V_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 不变。因此，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">V_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>称为钳位电压或正向压降.<br>
反向截止：：二极管外加反向电压或电压小于开启电压<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">V_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ，二极管截止。二极管截止，电流<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>D</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">I_D=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><br>
击穿：二极管两端外加反向电压超过一个阈值(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>Z</mi></msub></mrow><annotation encoding="application/x-tex">V_Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)时，二极管会被击穿，此时二极管失去单向导电性，压降是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>Z</mi></msub></mrow><annotation encoding="application/x-tex">V_Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>晶体三极管：两个PN结，记作Q<br>
NPN型：由两层N型半导体中间夹一层P型半导体<br>
PNP型： 由两层P型半导体中间夹一层N型半导体</li>
</ul>
<p>晶体三极管的稳态开关<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409110828826.png" alt></p>
<ul>
<li>晶体三极管的开关特性
<ul>
<li>在模拟电路中，晶体三极管主要作为线性放大元件和非线<br>
性元件</li>
<li>在数字电路中，晶体三极管主要作为开关元件。通常采用晶体管共发射极电路，放大能力强，也即控制能力强，只要在输入端加上两种不同幅值的信号，就可控制晶体管的<br>
导通或截止。</li>
<li>作为开关电路，晶体三极管主要工作在截止区和饱和区。</li>
<li>三极管的稳态开关特性是指三极管稳定在截止和饱和导通两种状态下的特性。</li>
</ul>
</li>
<li>MOS管(金属氧化物半导体场效应管)<br>
MOS管属于单极型集成电路，只有一种载流子（自由电子或空穴）参与导电。<br>
MOS管分为NMOS管和PMOS管两种类型，<br>
MOS管还分增强型（如栅极与衬底间不加电压时，栅极下面没有沟道存在）和耗尽型（如栅极与衬底间不加电压时，栅极下面已有沟道存在）
<ol>
<li>NMOS管<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409110835399.png" alt></li>
<li>PMOS管<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409110836556.png" alt></li>
</ol>
</li>
</ul>
<h4 id="逻辑门电路实现">逻辑门电路实现</h4>
<ul>
<li>门电路：由晶体管和电阻、电容等元件组成的电路，能实现某种逻辑关系的电路，是数字电路的基本逻辑单元电路。
<ul>
<li>分立元件门、集成门</li>
</ul>
</li>
<li>与门电路(二极管实现)<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409110851309.png" alt></li>
</ul>
<blockquote>
<p>工作原理：<br>
当 A、B为高电平（高电平额定值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mrow><mi>i</mi><mi>H</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{iH}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为3.0V）时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">D_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">D_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>均导通，则输出位高电平（Y = 3.0+0.7 = 3.7V）<br>
当 A、B为低电平（低电平额定值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mrow><mi>i</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{iL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为0.3V）时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">D_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">D_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>均导通，由于二极管导通后钳位电压为0.7V，则输出Y=0.3+0.7=1.0V<br>
当A为低电平、B为高电平时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">D_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>优先导通，输出Y=0.3+0.7=1.0V，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">D_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>被反偏截止</p>
</blockquote>
<ul>
<li>或门电路(二极管实现)<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409110858254.png" alt></li>
</ul>
<blockquote>
<p>工作原理：<br>
当A、B为低电平0.3V时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">D_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">D_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>均导通，由于二极管导通后的钳位电压为0.7V，则输出Y=0.3-0.7= -0.4V。<br>
当A为0.3V、B为3     .0V时， D2优先导通，则输出Y=3.0-0.7= 2.3V；由于A只有0.3V ，则D1被反偏截止。<br>
当A、B均为高电平3.0V时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">D_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">D_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>导通，则输出Y=3-0.7=2.3V。</p>
</blockquote>
<ul>
<li>非门电路(三极管实现)</li>
<li>非门电路(CMOS实现)</li>
<li>或非门电路(CMOS实现)</li>
<li>与非门电路(CMOS实现)</li>
<li>与非门电路(TTL实现)</li>
</ul>
<p>门电路的外特性</p>
<h3 id="基本组合逻辑部件设计">基本组合逻辑部件设计</h3>
<h4 id="组合逻辑设计概述">组合逻辑设计概述</h4>
<ul>
<li>数字电路分类:组合逻辑电路、时序逻辑电路</li>
<li>组合逻辑电路:将逻辑门以一定的方式组合在一起，使其具有一定逻辑功能的数字电路。</li>
</ul>
<blockquote>
<p>是一种无记忆电路——任一时刻的输出信号仅取决于该时刻的输入信号，而与信号作用前电路原来所处的状态无关。<br>
特点:由逻辑门电路组成、没有反馈电路和储存电路、当时的输出信号仅取决于当时的输入信号、无记忆功能</p>
</blockquote>
<ul>
<li>
<p>组合逻辑电路的不同表示方法<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>逻辑图</mtext><mo>⟶</mo><mtext>表达式</mtext><mo>⟶</mo><mtext>真值表</mtext><mo>⟶</mo><mtext>电路功能</mtext></mrow><annotation encoding="application/x-tex">逻辑图\longrightarrow 表达式\longrightarrow 真值表\longrightarrow 电路功能</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6943em;vertical-align:-0.011em;"></span><span class="mord cjk_fallback">逻辑图</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟶</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6943em;vertical-align:-0.011em;"></span><span class="mord cjk_fallback">表达式</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟶</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6943em;vertical-align:-0.011em;"></span><span class="mord cjk_fallback">真值表</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟶</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">电路功能</span></span></span></span></p>
</li>
<li>
<p>组合逻辑电路设计方法<br>
根据功能要求，采用某种设计方法，得到满足功能要求、且最简单的组合逻辑电路</p>
<ol>
<li>逻辑抽象：确定输入、输出变量，列出真值表</li>
<li>写出逻辑表达式：根据真值表写出标准表达式（并进行化简）</li>
<li>绘逻辑图：根据最简逻辑函数表达式画出原理图。</li>
<li>HDL编程：如用case语句、if-else语句，assign语句</li>
</ol>
</li>
<li>
<p>组合逻辑的手工设计方法</p>
</li>
<li>
<p>组合逻辑的自动设计方法<br>
基于HDL和EDA工具的组合逻辑电路设计方法</p>
<ol>
<li>确定输入、输出变量，列出真值表(复杂系统也可<br>
不写出真值表，而直接用HDL的系统级描述方式)</li>
<li>写出逻辑表达式：根据真值表写出标准表达式（并进行化简）</li>
<li>HDL编程：如用case语句、if-else语句，assign语句</li>
</ol>
</li>
</ul>
<h4 id="运算器单元电路">运算器单元电路</h4>
<ul>
<li>
<p>加法运算电路<br>
半加器、全加器、多位加法器、减法运算电路</p>
</li>
<li>
<p>溢出<br>
运算结果超出计数系统所能表示的范围</p>
<ul>
<li>如果符号位相同的两数相加，所得结果的符号位与之相反，结果溢出</li>
<li>如果符号位相异的两数相减，所得结果的符号位与减数相同，结果溢出</li>
<li>其他情况，不会产生溢出</li>
<li>有符号数运算，出现溢出表示结果是错误的</li>
</ul>
</li>
</ul>
<blockquote>
<p>溢出的判断：采用双符号位，“00”表示正，“11”表示负，如果运算结果符号位出现“01”或“10”表示出现溢出</p>
</blockquote>
<ul>
<li>
<p>乘法运算电路：阵列乘法器<br>
基本思路：利用若干全加器，完全由硬件直接计算乘法结果<br>
实现电路：<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409180815962.png" alt></p>
</li>
<li>
<p>数值比较器<br>
一种关系运算电路，对两个二进制数进行比较得出大于、小于、等于的的结果</p>
<ul>
<li>1位比较器：利用真值表输出</li>
<li>4位比较器(7485芯片)<br>
规则：从高位开始比较，高位不等时，数值的大小由高位决定；若高位相等，则再比较低位，数值的大小由低位比较结果决定。<br>
<strong>4位比较器的使用与拓展</strong><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409180827629.png" alt></li>
</ul>
</li>
<li>
<p>1位ALU<br>
可执行1位与、或、或非、与非、加、减运算<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409180833770.png" alt></p>
</li>
<li>
<p>32位ALU<br>
加法器可采用串行进位，也可采用先行进位<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409180846047.png" alt><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409180846343.png" alt></p>
</li>
</ul>
<h4 id="编码器-译码器">编码器/译码器</h4>
<h5 id="编码器">编码器</h5>
<p>编码：为区分一系列不同事物，对其中的每个事物用一组二进制代码表示，编码器是实现编码功能的数字电路</p>
<ul>
<li>
<p>二进制编码器<br>
2<sup>n</sup>线-n编码器：用n位二进制代码，对2<sup>n</sup>个信号进行编码的电路。</p>
<ul>
<li>输入： 2<sup>n</sup>个信号</li>
<li>输出： n位二进制代码</li>
<li>任意一时刻只能对其中一个信号进行编码，即只允许其中一个输入信号有效(高电平或低电平)，而其余信号无效，否则输入将出现混乱。</li>
</ul>
</li>
<li>
<p>8线-3线编码器(高电平输入有效)<br>
个输入信号：Y0，Y1，…，Y7。任何时刻最多只有其中一个信号为1（高电平），其余均为0（低电平）。<br>
3位输出编码：C，B，A。<br>
当Y0=1时，CBA=000；Y1=1时，CBA=001；Y2=1时，CBA=010，以此类推。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409180904983.png" alt></p>
</li>
</ul>
<p><strong>8线-3线编码器（高电平输入有效）的Verilog HDL设计</strong><br>
方法一：根据8线-3线编码器的功能列出真值表，由真值表推出输出的逻辑表达式，然后用assign语句建模（算法级描述）</p>
<figure class="highlight v"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> encoder8_3(Y0,Y1,Y2,Y3,Y4,Y5,Y6,Y7, C,B,A);</span><br><span class="line">    <span class="keyword">input</span> Y0,Y1,Y2,Y3,Y4,Y5,Y6,Y7;</span><br><span class="line">    <span class="keyword">output</span> C,B,A;</span><br><span class="line">    <span class="keyword">assign</span> C =! (!Y4&amp;&amp;!Y5&amp;&amp;!Y6&amp;&amp;!Y7);</span><br><span class="line">    <span class="keyword">assign</span> B =! (!Y2&amp;&amp;!Y3&amp;&amp;!Y6&amp;&amp;!Y7);</span><br><span class="line">    <span class="keyword">assign</span> A =! (!Y1&amp;&amp;!Y3&amp;&amp;!Y5&amp;&amp;!Y7);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>方法二：根据逻辑功能定 义，采用case语句直接描述，设计过程更简单</p>
<figure class="highlight v"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> encoder8_3(Y0,Y1,Y2,Y3,Y4,Y5,Y6,Y7, C,B,A);</span><br><span class="line">    <span class="keyword">input</span> Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7;</span><br><span class="line">    <span class="keyword">reg</span> C, B, A;</span><br><span class="line">    <span class="keyword">always</span></span><br><span class="line">    <span class="keyword">case</span> (&#123;Y0,Y1,Y2,Y3,Y4,Y5,Y6,Y7&#125;)</span><br><span class="line">        <span class="number">&#x27;b10000000</span> : &#123;C,B,A&#125; = <span class="number">0</span>; <span class="number">&#x27;b01000000</span> : &#123;C,B,A&#125; = <span class="number">1</span>;</span><br><span class="line">        <span class="number">&#x27;b00100000</span> : &#123;C,B,A&#125; = <span class="number">2</span>; <span class="number">&#x27;b00010000</span> : &#123;C,B,A&#125; = <span class="number">3</span>;</span><br><span class="line">        <span class="number">&#x27;b00001000</span> : &#123;C,B,A&#125; = <span class="number">4</span>; <span class="number">&#x27;b00000100</span> : &#123;C,B,A&#125; = <span class="number">5</span>;</span><br><span class="line">        <span class="number">&#x27;b00000010</span> : &#123;C,B,A&#125; = <span class="number">6</span>; <span class="number">&#x27;b00000001</span> : &#123;C,B,A&#125; = <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">default</span> : &#123;C,B,A&#125; = <span class="number">3&#x27;bx</span>;</span><br><span class="line">    <span class="keyword">endcase</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>8421BCD编码器<br>
用4位二进制，对10个十进制数字进行编码</p>
</li>
<li>
<p>优先编码器</p>
<ul>
<li>克服二进制编码器仅允许1个输入信号有限的局限，允许两个以上输入信号同时有效；</li>
<li>对所有输入信号进行优先级别排序，任何时刻只对优先级最高的输入信号编码，对优先级别低的输入信号则不响应，以保证编码器可靠工作。</li>
<li>优点：当有两个或两个以上的输入有效时，输出不会发生混乱。广泛应用于计算机的优先中断系统、键盘编码系统中。</li>
</ul>
</li>
</ul>
<p><strong>优先编码器–74147（低电平输入有效）的Verilog HDL</strong></p>
<figure class="highlight v"><table><tr><td class="code"><pre><span class="line">Module</span><br><span class="line">CT74147(IN0,IN1,IN2,IN3,IN4,IN5,IN6,IN7,IN8,IN9,YN0,YN1,YN2,YN3);</span><br><span class="line">    <span class="keyword">input</span> IN0,IN1,IN2,IN3, IN4, IN5,IN6,IN7,IN8,IN9;</span><br><span class="line">    <span class="keyword">output</span> YN0,YN1,YN2,YN3;</span><br><span class="line">    <span class="keyword">reg</span> YN0,YN1,YN2,YN3;</span><br><span class="line">    <span class="keyword">reg</span>[<span class="number">3</span>:<span class="number">0</span>] Y; <span class="comment">//中间变量</span></span><br><span class="line"><span class="keyword">always</span> @(IN0 <span class="keyword">or</span> IN1 <span class="keyword">or</span> IN2 <span class="keyword">or</span> IN3 <span class="keyword">or</span> IN4 <span class="keyword">or</span> IN5 <span class="keyword">or</span> IN6 <span class="keyword">or</span> IN7 <span class="keyword">or</span> IN8 <span class="keyword">or</span> IN9)</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (IN9 == <span class="number">1&#x27;b0</span>) Y = <span class="number">4&#x27;b0110</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (IN8 == <span class="number">1&#x27;b0</span>) Y = <span class="number">4&#x27;b0111</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (IN7 == <span class="number">1&#x27;b0</span>) Y = <span class="number">4&#x27;b1000</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (IN6 == <span class="number">1&#x27;b0</span>) Y = <span class="number">4&#x27;b1001</span>;</span><br><span class="line">        ……..</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (IN1 == <span class="number">1&#x27;b0</span>) Y = <span class="number">4&#x27;b1110</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (IN0 == <span class="number">1&#x27;b0</span>) Y = <span class="number">4&#x27;b1111</span>;</span><br><span class="line">        YN0 = Y[<span class="number">0</span>];</span><br><span class="line">        YN1 = Y[<span class="number">1</span>];</span><br><span class="line">        YN2 = Y[<span class="number">2</span>];</span><br><span class="line">        YN3 = Y[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h5 id="译码器">译码器</h5>
<p>将二进制代码所表示的信息翻译成对应高低电平信号输出的<br>
过程称为译码，译码是编码的反操作。实现译码功能的电路称为译码器（Decoder）<br>
变量译码器（二进制译码器）、码制变换译码器、显示译码器</p>
<ul>
<li>
<p>二进制译码器<br>
将每个输入二进制代码，译成对应的一根输出线上的高电平（或低电平）信号。因此称为n线-2<sup>n</sup>线译码器</p>
</li>
<li>
<p>3线-8线译码器（74138）<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409180924265.png" alt></p>
</li>
<li>
<p>BCD译码器<br>
码制变换译码器：将输入的二进制代码转换成对应的其他码制输出的译码器。<br>
BCD译码器（4-10线译码器）：4位8421码转换成十进制数的电路。用于驱动十进制数码显示管、指示灯等</p>
<ul>
<li>完全译码BCD译码器、不完全译码BCD译码器</li>
</ul>
</li>
<li>
<p>显示译码器<br>
用于驱动数码显示器，是一种将二进制代码表示的数字、文字、符号用人们习惯的形式直观显示出来的电路<br>
译码器-&gt;驱动器-&gt;显示器</p>
</li>
</ul>
<h4 id="多路选择器">多路选择器</h4>
<p>数据选择器：从一组输入数据选出其中一个作为数据输出的电路，又称多路选择器（Multiplexer，多路器）</p>
<blockquote>
<p>以“与或非”门或以“与或”门为主体，在选择控制信号的作用下，能从多路平行输入数据中任选一路数据作为输出</p>
</blockquote>
<ul>
<li>8选1多路选择器（74151）<br>
<strong>功能一</strong>：8选1数据选择器。D7-D0为数据输入端，A2A1A0为选择控制端，使能控制输入EN为低电平时有效。<br>
<strong>功能二</strong>：多功能运算电路。 D7-D0为控制输入端。
<ol>
<li>通过D7~D0取不同的值，从输入变量A2 、A1、A0的各个最小项中选取某几个最小项的或输出，实现不同的运算电路。</li>
<li>有2<sup>8</sup>=256种功能，包含3变量的各种最小项表达式，可实现任意组合逻辑电路的设计。<br>
例如：<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409181013847.png" alt></li>
</ol>
</li>
</ul>
<p><strong>多路选择器（74151的Verilog HDL设计）</strong></p>
<figure class="highlight v"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> CT74151(A2,A1,A0,STN,D7,D6,D5,D4,D3,D2,D1,D0,Y,WN);</span><br><span class="line">    <span class="keyword">input</span> A2,A1,A0,STN;</span><br><span class="line">    <span class="keyword">input</span> D7,D6,D5,D4,D3,D2,D1,D0;</span><br><span class="line">    <span class="keyword">output</span> Y,WN;</span><br><span class="line">    <span class="keyword">reg</span> Y,WN;</span><br><span class="line"><span class="keyword">always</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (STN == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">case</span> (&#123;A2,A1,A0&#125;)</span><br><span class="line">            <span class="number">3&#x27;b000</span> : Y = D0;</span><br><span class="line">            <span class="number">3&#x27;b001</span> : Y = D1;</span><br><span class="line">            <span class="number">3&#x27;b010</span> : Y = D2;</span><br><span class="line">            <span class="number">3&#x27;b011</span> : Y = D3;</span><br><span class="line">            <span class="number">3&#x27;b100</span> : Y = D4;</span><br><span class="line">            <span class="number">3&#x27;b101</span> : Y = D5;</span><br><span class="line">            <span class="number">3&#x27;b110</span> : Y = D6;</span><br><span class="line">            <span class="number">3&#x27;b111</span> : Y = D7;</span><br><span class="line">        <span class="keyword">endcase</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span> Y = <span class="number">1&#x27;b0</span>;</span><br><span class="line">    WN = ~Y;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h4 id="组合逻辑电路的竞争冒险">组合逻辑电路的竞争冒险</h4>
<h5 id="竞争冒险现象">竞争冒险现象</h5>
<ul>
<li>竞争：在组合逻辑电路中，某个输入变量通过两条或两条以上的途径传到输出端，由于每条途径延迟时间不同，到达输出门的时间就有先有后，这种现象称为竞争。</li>
<li>冒险：门电路因输入端的竞争，而导致输出端产生不正常的尖峰干扰冒险信号（毛刺）的现象，称为冒险。</li>
</ul>
<blockquote>
<p>竞争冒险的原因：门电路的延时。信号在器件内部通过连线和逻辑单元时，都有一定的延时。延时的大小与连线的长短和逻辑单元的数目有关，同时还受器件的制造工艺、工作电压、温度等条件的影响。信号的<strong>高低电平转换</strong>也需要一定的过渡时间。</p>
</blockquote>
<h5 id="竞争冒险的判断">竞争冒险的判断</h5>
<ol>
<li>代数法：<br>
逻辑函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>中，若某个变量（假定为A）同时以原变量和反变量形式存在，逻辑函数在一定条件下（其它变量取特定的值1或0）可以简化为可以简化为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>A</mi><mo>+</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">F = A + \overline A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span> 或<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>A</mi><mo separator="true">⋅</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">F=A·\overline A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord mathnormal">A</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>的形式，则该逻辑电路存在冒险。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>A</mi><mo>+</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">F = A + \overline A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>存在“0”冒险，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mi>A</mi><mo separator="true">⋅</mo><mover accent="true"><mi>A</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">F=A·\overline A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord mathnormal">A</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>存在“1”冒险。</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409181021995.png" alt></p>
<ol start="2">
<li>卡诺图法<br>
在逻辑函数的卡诺图中，函数的每个与项对应卡诺图上的一个卡诺圈，若两个卡诺圈相切，相切处将存在冒险。</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409181036446.png" alt></p>
<h5 id="竞争冒险的消除">竞争冒险的消除</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409181036070.png" alt></p>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>理论课</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机组成原理笔记(3)</title>
    <url>/2024/09/25/ComputerConstructionNote3/</url>
    <content><![CDATA[<h2 id="时序逻辑电路设计">时序逻辑电路设计</h2>
<h3 id="锁存器和触发器">锁存器和触发器</h3>
<ul>
<li>组合逻辑电路的不足<br>
不受统一的时钟信号控制，电路输出端完全由输入端的状态决定，是一种无记忆电路 <em>输入信号消失，则输出信号也会立即消失</em></li>
</ul>
<h4 id="rs锁存器-d锁存器">RS锁存器/D锁存器</h4>
<p><strong>触发器</strong>就是构成记忆功能部件的基本单元，是实现储存记忆功能的基本单元电路</p>
<h5 id="时序逻辑的特点">时序逻辑的特点</h5>
<ul>
<li>当时的输出由当时的输入和电路的原来状态共同决定 具有“记忆”功能</li>
<li>结构特点：由组合逻辑电路和储存电路组成</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409231419362.png" alt></p>
<h5 id="触发器的概念和特点">触发器的概念和特点</h5>
<ul>
<li>构成记忆功能部件的逻辑单元电路</li>
</ul>
<p>特点：</p>
<ol>
<li>有两个互非的输出Q和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>Q</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0778em;vertical-align:-0.1944em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span>，Q称为状态变量<br>
当Q=0时，称为0态；当Q=1时，称为1态</li>
<li>无外加信号时，触发器保持原有状态不变，n级触发器可以储存n位二进制数的2<sup>n</sup>种状态</li>
<li>在外加信号的作用下，触发器可以从一种状态转换到另一种状态，具有置0或置1的功能</li>
</ol>
<h5 id="双稳态电路">双稳态电路</h5>
<ul>
<li>可以有两种稳定状态的电路</li>
<li>可以用两个反相器构成<br>
可输出两种稳定状态，但是首次加电，初值未知，Q未知，缺少输入，电路无法工作</li>
</ul>
<h5 id="基本rs锁存器">基本RS锁存器</h5>
<ol>
<li>
<p><strong>RS锁存器</strong>：由两个与非门或或非门交叉连接构成。</p>
<ul>
<li><strong>功能</strong>：
<ul>
<li><strong>保持</strong>：保持当前状态不变。</li>
<li><strong>置0</strong>：将输出状态置为0。</li>
<li><strong>置1</strong>：将输出状态置为1。</li>
</ul>
</li>
<li><strong>约束条件</strong>：两个输入信号 S 和 R 不允许同时为1。</li>
</ul>
</li>
<li>
<p><strong>RS锁存器的逻辑表示方法</strong>：</p>
<ul>
<li><strong>功能表</strong>：描述输入状态如何影响输出。</li>
<li><strong>特性表</strong>：将电路的当前状态和输入列入真值表，用以计算次态。</li>
<li><strong>特性方程</strong>：基于特性表推导出锁存器的功能方程。</li>
<li><strong>基本RS锁存器的HDL代码</strong>：</li>
</ul>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> RS_FF(Q, QN, SDN, RDN);</span><br><span class="line"><span class="keyword">input</span> SDN, RDN;</span><br><span class="line"><span class="keyword">output</span> Q, QN;</span><br><span class="line"><span class="keyword">assign</span> Q = !(SDN &amp;&amp; QN);</span><br><span class="line"><span class="keyword">assign</span> QN = !(RDN &amp;&amp; Q);</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="d锁存器">D锁存器</h5>
<ol>
<li>
<p><strong>D锁存器</strong>：通过单一输入端 D，简化RS锁存器，消除不确定状态。</p>
<ul>
<li><strong>工作原理</strong>：
<ul>
<li>当时钟信号有效时，输入端 D 决定输出。</li>
<li>当时钟信号无效时，输出保持不变。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>钟控RS锁存器</strong>：为协调电路的同步工作，增加时钟信号控制。</p>
<ul>
<li><strong>电位触发</strong>：当时钟信号为高电位时，RS锁存器的状态随输入变化。</li>
</ul>
</li>
<li>
<p><strong>钟控D锁存器</strong>：通过D输入和时钟信号的配合实现数据存储。</p>
</li>
</ol>
<h4 id="d触发器">D触发器</h4>
<p><strong>D触发器</strong>：</p>
<ul>
<li>由两个反向的D锁存器构成，主从结构，时钟沿触发状态变化。</li>
<li><strong>分类</strong>：
<ul>
<li><strong>主从触发器</strong>：主锁存器和从锁存器的时钟输入相反。</li>
<li><strong>边沿触发器</strong>：只在时钟信号的边沿（上升沿或下降沿）改变状态。</li>
</ul>
</li>
</ul>
<h4 id="jk触发器">JK触发器</h4>
<p><strong>JK触发器</strong>：</p>
<ul>
<li>功能最全面的触发器，具备置0、置1、翻转、保持功能。</li>
<li><strong>逻辑功能</strong>：通过增加反馈线解决RS锁存器无效状态问题。</li>
<li><strong>特性表</strong>：根据不同输入 J, K 决定输出。</li>
</ul>
<p>JK触发器的HDL设计</p>
<figure class="highlight v"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> JK_FF(CP,J, K,Q,QN);</span><br><span class="line">   <span class="keyword">input</span> CP, J, K;</span><br><span class="line">   <span class="keyword">output</span> Q,QN;</span><br><span class="line">   <span class="keyword">reg</span> Q,QN;</span><br><span class="line">   <span class="keyword">always</span> @(CP <span class="keyword">or</span> J <span class="keyword">or</span> K)</span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">         <span class="keyword">if</span> (CP==<span class="number">0</span>) <span class="comment">//保持</span></span><br><span class="line">            <span class="keyword">begin</span> Q = Q; QN = QN; <span class="keyword">end</span></span><br><span class="line">         <span class="keyword">else</span> <span class="keyword">if</span> (CP==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">case</span> (&#123;J,K&#125;)</span><br><span class="line">               <span class="number">2</span>’b00: <span class="keyword">begin</span> Q = Q; QN = QN; <span class="keyword">end</span> <span class="comment">//保持</span></span><br><span class="line">               <span class="number">2</span>’b01: <span class="keyword">begin</span> Q = <span class="number">1</span>’b0; QN = <span class="number">1</span>’b1; <span class="keyword">end</span> <span class="comment">//置0</span></span><br><span class="line">               <span class="number">2</span>’b10: <span class="keyword">begin</span> Q = <span class="number">1</span>’b1; QN = <span class="number">1</span>’b0; <span class="keyword">end</span> <span class="comment">//置1</span></span><br><span class="line">               <span class="number">2</span>’b11: <span class="keyword">begin</span> Q = !Q; QN = !QN; <span class="keyword">end</span> <span class="comment">//翻转</span></span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="有限状态机-fsm">有限状态机（FSM）</h3>
<p>可描述有限个状态以及这些状态之间的转移及引起转移的动作等的离散数学模型。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409250820671.png" alt></p>
<ol>
<li><strong>FSM的分类</strong>：
<ul>
<li><strong>Moore型FSM</strong>：输出信号仅与当前状态有关。</li>
<li><strong>Mealy型FSM</strong>：输出信号与当前状态和输入信号有关。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409250821061.png" alt></li>
</ul>
</li>
</ol>
<h4 id="moore型有限状态机">Moore型有限状态机</h4>
<ol start="2">
<li>
<p>Moore型FSM设计：</p>
<ul>
<li>输出信号仅与当前状态相关</li>
<li>输入M位，输出N位，状态K位（可以表示2<sup>k</sup>个不同状态）</li>
<li>次态逻辑：组合逻辑电路，输入M+K位，输出K位次态</li>
<li>状态寄存器：K位寄存器</li>
<li>输出逻辑：组合逻辑电路，输入K位状态，输出N位信号</li>
</ul>
</li>
<li>
<p><strong>FSM设计步骤</strong>：</p>
<ol>
<li>确定输入、输出和状态数。</li>
<li>绘制状态转换图。</li>
<li>编写状态转换表。</li>
<li>编写输出逻辑表和次态逻辑表。</li>
</ol>
</li>
<li>
<p><strong>Moore型FSM设计示例</strong>：交通灯控制器FSM模型。</p>
<ul>
<li><strong>状态</strong>：A路绿灯/B路红灯、A路黄灯/B路红灯、A路红灯/B路绿灯、A路红灯/B路黄灯。</li>
<li><strong>输入</strong>：传感器检测是否有车辆等待，1表示有人通过或等待，0表示无人等待。</li>
<li><strong>输出</strong>：A路绿灯B路红灯、A路黄灯B路红灯、A路红灯B路绿灯、A路红灯B路黄灯。</li>
</ul>
</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409250834683.png" alt></p>
<h4 id="mealy型有限状态机">Mealy型有限状态机</h4>
<ol>
<li>
<p>Mealy型FSM设计：</p>
<ul>
<li>输出信号与当前状态和输入信号有关</li>
<li>输入M位，输出N位，状态K位（可以表示2<sup>k</sup>个不同状态）</li>
<li>次态逻辑：组合逻辑电路，输入M+K位，输出K位次态</li>
<li>状态寄存器：K位寄存器</li>
<li>输出逻辑：组合逻辑电路，输入M+K位，输出N位信号</li>
</ul>
</li>
<li>
<p><strong>FSM设计步骤</strong>：与Moore型FSM类似，但输出逻辑表和次态逻辑表不同。</p>
</li>
</ol>
<h4 id="有限状态机的状态编码问题">有限状态机的状态编码问题</h4>
<ol>
<li><strong>起始状态选择</strong>：起始状态指电路复位后所处的初态，选择合适的起始状态将使设计简捷高效。 FSM必须有时钟信号和复位信号。</li>
<li><strong>状态编码方式的选择</strong>：</li>
</ol>
<ul>
<li>二进制编码：采用log<sub>2</sub>N个触发器来表示这N个状态，按二进制顺序编码，节省逻辑资源，但可能产生输出毛刺</li>
<li>格雷码编码：采用log<sub>2</sub>N个触发器来表示这N个状态，但相邻状态只有一个比特位不同。节省逻辑资源，降低了输出毛刺的可能，状态转换中，相邻状态只有一个比特位产生变化。</li>
<li>独热码编码：采用N个触发器来表示这N个状态。逻辑资源消耗最大，但可以避免状态机产生错误的输出，并且有时可简化输出逻辑。</li>
</ul>
<h2 id="none"><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409250850893.png" alt></h2>
<h4 id="时序电路的时序分析">时序电路的时序分析</h4>
<ol>
<li>
<p><strong>时序约束</strong>：</p>
<ul>
<li><strong>建立时间</strong> $ T_{setup} $：时钟沿之前，输入必须稳定。</li>
<li><strong>保持时间</strong> $ T_{hold} $：时钟沿之后，输入需保持稳定。</li>
<li><strong>孔径时间</strong>：$T_{setup} + T_{hold} $ ，输入必须稳定的时间窗口。</li>
<li><strong>Clock-to-Q时间</strong>  $ T_{ctq} $ ：从触发时钟边沿到输出稳定的时间</li>
</ul>
</li>
<li>
<p><strong>时钟周期的计算</strong>：</p>
<ul>
<li>$ T_{clk} \geq T_{ctq} + T_{cd} + T_{setup} +时钟偏移$</li>
<li>其中：
<ul>
<li>$ T_{ctq} $：时钟到输出的延迟。</li>
<li>$ T_{cd} $：组合逻辑的最大延迟。</li>
<li>时钟偏移：由于时钟信号源到各个寄存器部件的连线长度不同等原因所引起的各个寄存器时钟信号达到的细微时间差异， 一般忽略。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409250920664.png" alt></p>
<ol start="3">
<li>时序电路的时序</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409250903174.png" alt></p>
<h3 id="寄存器">寄存器</h3>
<ol>
<li><strong>寄存器的概念</strong>：用于存放一组二进制代码
<ul>
<li><strong>基本组成</strong>：由触发器和控制门电路组成，其中：一个触发器能储存1位二进制代码；接收数据的控制门电路，控制在同一个接收命令作用下，使各触发器同时接收数据。</li>
<li><strong>触发方式</strong>：由组成寄存器的触发器的触发方式决定：边沿或电位触发。</li>
<li><strong>基本操作</strong>：写/读/复位</li>
</ul>
</li>
</ol>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>寄存器</mtext><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>数码寄存器</mtext><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>数据寄存器</mtext><mo stretchy="false">(</mo><mtext>多位</mtext><mi>D</mi><mtext>型触发器组成</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>数据锁存器</mtext><mo stretchy="false">(</mo><mtext>多位电位触发器组成</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>寄存器阵列</mtext></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>移位寄存器</mtext><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>单项移位寄存器</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>双向移位寄存器</mtext></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">寄存器 \begin{cases} 数码寄存器\begin{cases}数据寄存器(多位D型触发器组成)\\ 数据锁存器(多位电位触发器组成)\\寄存器阵列\end{cases} \\移位寄存器\begin{cases}单项移位寄存器\\ 双向移位寄存器\end{cases} \end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.32em;vertical-align:-3.41em;"></span><span class="mord cjk_fallback">寄存器</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.85em;"><span style="top:-1.366em;"><span class="pstrut" style="height:3.816em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.358em;"><span class="pstrut" style="height:3.816em;"></span><span style="height:1.816em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="1.816em" style="width:0.8889em" viewbox="0 0 888.89 1816" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V1816 H384z M384 0 H504 V1816 H384z"/></svg></span></span><span style="top:-3.816em;"><span class="pstrut" style="height:3.816em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.958em;"><span class="pstrut" style="height:3.816em;"></span><span style="height:1.816em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="1.816em" style="width:0.8889em" viewbox="0 0 888.89 1816" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V1816 H384z M384 0 H504 V1816 H384z"/></svg></span></span><span style="top:-6.766em;"><span class="pstrut" style="height:3.816em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.91em;"><span style="top:-5.91em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord cjk_fallback">数码寄存器</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewbox="0 0 888.89 316" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewbox="0 0 888.89 316" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord cjk_fallback">数据寄存器</span><span class="mopen">(</span><span class="mord cjk_fallback">多位</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord cjk_fallback">型触发器组成</span><span class="mclose">)</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord cjk_fallback">数据锁存器</span><span class="mopen">(</span><span class="mord cjk_fallback">多位电位触发器组成</span><span class="mclose">)</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord cjk_fallback">寄存器阵列</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:4.41em;"></span><span class="mord"><span class="mord cjk_fallback">移位寄存器</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord cjk_fallback">单项移位寄存器</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord cjk_fallback">双向移位寄存器</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.41em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h4 id="数据寄存器-数据锁存器">数据寄存器/数据锁存器</h4>
<h5 id="数据寄存器："><strong>数据寄存器</strong>：</h5>
<ol>
<li><strong>组成</strong>
<ul>
<li>由多个边沿触发器组成的用于保存一组二进制代码的寄存单元。</li>
<li>当时钟信号的有效沿（上升沿或下降沿）到来时，将输入端数据打入寄存器，此时输出信号等于输入信号；</li>
<li>在时钟信号的其它时刻，输出端保持刚才输入的数据，即为寄存状态，而不管此时输入信号是否变化</li>
</ul>
</li>
<li><strong>结构</strong>：多位并行数据输入输出</li>
<li><strong>HDL设计示例</strong>：8位数据寄存器<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> reg_8bit(qout, data, clk, clr);</span><br><span class="line"><span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] qout;</span><br><span class="line"><span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] data;</span><br><span class="line"><span class="keyword">input</span> clk, clr;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] qout;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk <span class="keyword">or</span> <span class="keyword">posedge</span> clr)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">if</span> (clr) qout = <span class="number">8&#x27;b0</span>;</span><br><span class="line">  <span class="keyword">else</span> qout = data;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="数据锁存器："><strong>数据锁存器</strong>：</h5>
<ul>
<li>由多位电位触发器组成的用于保存一组二进制代码的寄存单元。</li>
</ul>
<ol>
<li>功能：（1）当输入控制信号（如时钟）为高电平时，门是打开的，输出信号等于输入信号； （2）当输入控制信号为低电平时，门是关闭的，输出端保持刚才输入的数据，即为锁存状态，而不管此时输入信号是否变化。</li>
<li><strong>使用场合</strong>：通常由电平信号来控制，属于电平敏感型，适于数据有效滞后于控制信号有效的场合。</li>
<li><strong>HDL设计示例</strong>：1位数据锁存器<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> latch_1(q,d,clk);</span><br><span class="line">   <span class="keyword">output</span> q;</span><br><span class="line">   <span class="keyword">input</span> d, clk ;</span><br><span class="line">   <span class="keyword">assign</span> q = clk ? d : q; <span class="comment">/* 时钟信号为高电平，打入数据，否则锁存原数 */</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> latch_8bit(qout,data,clk);</span><br><span class="line">   <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] qout;</span><br><span class="line">   <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] data;</span><br><span class="line">   <span class="keyword">input</span> clk;</span><br><span class="line">   <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] qout;</span><br><span class="line">   <span class="keyword">always</span> @(clk <span class="keyword">or</span> data) <span class="comment">//电平敏感</span></span><br><span class="line">      <span class="keyword">if</span> (clk) qout = data;</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="据寄存器和数据锁存器的区别">据寄存器和数据锁存器的区别</h5>
<ul>
<li>数据寄存器：
<ul>
<li>由边沿触发的触发器（D触发器）组成。</li>
<li>通常由同步时钟信号来控制，属于脉冲敏感型</li>
<li>适于数据有效提前于控制信号（一般为时钟信号）有效、并要求同步操作的场合。</li>
</ul>
</li>
<li>数据锁存器：
<ul>
<li>由电位触发器（D锁存器）组成。</li>
<li>一般由电平信号来控制，属于电平敏感型</li>
<li>适于数据有效滞后于控制信号有效的场合</li>
</ul>
</li>
</ul>
<hr>
<h4 id="移位寄存器">移位寄存器</h4>
<ol>
<li><strong>移位寄存器的定义</strong>：具有移位功能的寄存器。每来一个时钟脉冲，寄存器中数据就依次向左或向右移一位。</li>
<li><strong>应用场景</strong>：用于数据的串行输入和并行输出，或并行输入和串行输出。乘法运算中的右移，除法运算中的左移等。</li>
<li><strong>分类</strong>：
<ul>
<li><strong>左移寄存器</strong>：数据从左侧输入，逐位右移。</li>
<li><strong>右移寄存器</strong>：数据从右侧输入，逐位左移。</li>
<li><strong>双向移位寄存器</strong>：可双向移动数据。</li>
<li><strong>循环移位寄存器</strong>：数据从一端移入，从另一端移出，形成循环。</li>
</ul>
</li>
</ol>
<h5 id="4位右移移位寄存器">4位右移移位寄存器</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409301436324.png" alt></p>
<ul>
<li>工作方式
<ul>
<li>串入并出<br>
串并转换（需要N个CP周期），经过4个CP，串行输入的4位数据全部移入移位寄存器中，并从Q<sub>3</sub>Q<sub>2</sub>Q<sub>1</sub>Q<sub>0</sub>并行输出1011</li>
<li>串入串出<br>
把最右边的触发器的输出作为电路的输出。经过4个CP后， Q<sub>3</sub> 输出的是最先串行输入的数据。<br>
从每个触发器Q端输出的波形相同，但后级触发器Q端输出波形比前级触发器Q端输出波形滞后一个时钟周期。<br>
把工作于串入串出方式的移位寄存器称为“延迟线” （第N级FF延迟N个CP周期）</li>
</ul>
</li>
</ul>
<h5 id="4位双向移位寄存器">4位双向移位寄存器</h5>
<ul>
<li>S=0，左移：数据从S<sub>L</sub>端串行输入，顺序左移，经过4个CP，串行输入的4位数据全部移入移位寄存器中，可从输出端并行输出；或也可继续左移，并通过QA端实现串行输出。</li>
<li>S=1，右移：数据从S<sub>R</sub>端串行输入，也可实现并行或串行输出。</li>
<li>CP：时钟信号</li>
<li>/R<sub>D</sub>：复位信号，低电平有效</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409301445906.png" alt></p>
<ul>
<li>
<p>4位双向移位寄存器（CT74194）<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409301448030.png" alt></p>
</li>
<li>
<p>用2片CT74194扩展为8位移位寄存器<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409301449761.png" alt></p>
<ul>
<li>把两片的S<sub>1</sub>、S<sub>0</sub>、CP和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>R</mi><mo stretchy="true">‾</mo></mover><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">\overline R_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>分别并联，两片同时做同样操作</li>
<li>将片①的Q3接至片②的DIR，当S1S0=01时，两片同时右移，片②的输出Q3作为整个电路的右移串行输出端（Q7 ）</li>
<li>将片②的Q0接至片① 的D<sub>IL</sub>，当S1S0=10时，两片同时左移，片①的输出Q0 作为整个电路的左移串行输出端Q0</li>
</ul>
</li>
</ul>
<p><strong>移位寄存器的Verilog实现</strong>：基于时钟信号，数据位通过移位操作向左或向右移动。</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span> shift_reg(qout, din, clk);</span><br><span class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] qout;</span><br><span class="line"><span class="keyword">input</span> din, clk;</span><br><span class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] qout;</span><br><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  qout = &#123;qout[<span class="number">2</span>:<span class="number">0</span>], din&#125;; <span class="comment">// 右移操作</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<h3 id="计数器">计数器</h3>
<h4 id="同步计数器">同步计数器</h4>
<ul>
<li>计数器：具有计数功能的数字电路，可以统计输入脉冲的个数</li>
<li>分类：同步计数器和异步计数器、加法计数器和减法计数器、二进制计数器和十进制计数器</li>
</ul>
<blockquote>
<p>同步计数器：逻辑表达式、状态转换表、状态转换图、时序图</p>
</blockquote>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410081050864.png" alt></p>
<h5 id="特点：">特点：</h5>
<ul>
<li>所有触发器的时钟端并联在一起，作为计数器的时钟端</li>
<li>各触发器同时翻转，不存在时钟到各触发器输出的传输延迟的积累</li>
<li>由于其工作频率只与一个触发器的时钟到输出的传输延迟有关，所以它的工作频率比异步计数器高。</li>
<li>由于计数器各触发器几乎是同时翻转的，因此，各触发器输出波形的偏移为各触发器时钟到输出的延迟之差，同步计数器输出经译码后所产生的尖峰信号宽度比较小。</li>
<li>缺点：结构比较复杂（各触发器的输入由多个Q输出相与得到），所用元件较多。</li>
</ul>
<h4 id="异步计数器">异步计数器</h4>
<h5 id="特点：">特点：</h5>
<ul>
<li>输入系统时钟脉冲只作用于最低位触发器，高位触发器的时钟信号往往是由低一位触发器的输出提供的，高位触发器的翻转有待低一位触发器翻转后才能进行。</li>
<li>由于每一级触发器都存在传输延迟，因此计数器工作速度慢，而且，位数越多计数越慢。在大型数字设备中较少采用。</li>
<li>对计数器状态进行译码时，由于触发器不同步，译码器输出会出现尖峰脉冲（位数越多，尖峰信号也就越宽），使仪器设备产生误动作。</li>
<li>优点：结构比较简单，所用元件较少。</li>
</ul>
<p>以下降沿触发的4位二进制异步计数器为例<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410081051772.png" alt></p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410081107725.png" alt></p>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>理论课</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机组成原理笔记(4)</title>
    <url>/2024/10/09/ComputerConstructionNote4/</url>
    <content><![CDATA[<h2 id="主存储器">主存储器</h2>
<h3 id="存储系统概述">存储系统概述</h3>
<h4 id="存储器分类">存储器分类</h4>
<ul>
<li>按照存储介质分类
<ul>
<li>半导体存储器</li>
<li>磁介质存储器</li>
<li>光盘存储器</li>
</ul>
</li>
<li>按照访问方式分类
<ul>
<li>随机存储器RAM</li>
<li>只读存储器ROM</li>
<li>顺序访问存储器（Tape）</li>
<li>直接访问存储器（Disk）</li>
</ul>
</li>
<li>按照在计算机中的作用分类
<ul>
<li>主存储器（内存）</li>
<li>辅助存储器（外存）</li>
<li>控制存储器</li>
<li>输入输出存储器</li>
</ul>
</li>
</ul>
<ul>
<li>按照功能分类
<ul>
<li>高速缓存器（Cache）</li>
<li>主存储器</li>
<li>辅助存储器</li>
<li>控制存储器</li>
</ul>
</li>
</ul>
<h4 id="存储器的性能指标">存储器的性能指标</h4>
<ul>
<li>访问时间（Access Time）：T<sub>A</sub>
<ul>
<li>从给定地址到存储器定位到目标位置所需的时间</li>
</ul>
</li>
<li>存储周期（Storage Cycle）：T<sub>C</sub>
<ul>
<li>对RAM,T<sub>C</sub>指两次访问存储单元的最小时间间隔</li>
<li>T<sub>C</sub> &gt; T<sub>A</sub></li>
</ul>
</li>
<li>带宽（Bandwidth）/数据传输率（Data Transfer Rate）
<ul>
<li>一般来说：1/Cycle Time</li>
<li>其他类型：T<sub>N</sub>=T<sub>A</sub>+N/R，带宽：N/T<sub>N</sub><br>
T<sub>N</sub>：读写N个数据的时间<br>
T<sub>A</sub>：访问时间<br>
N；数据个数（Bits）<br>
R：数据传输率（Bits/s）</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091028554.png" alt><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091028570.png" alt></p>
<h4 id="半导体存储器">半导体存储器</h4>
<p>从访问方式上可分为：</p>
<ul>
<li>随机访问存储器RAM、只读存储器ROM</li>
</ul>
<p>RAM又可分为：</p>
<ul>
<li>静态RAM SRAM：<em>静态存储器，相对动态而言，集成度低，不必刷新。用作Cache</em></li>
<li>动态RAM DRAM：<em>动态存储器，需要刷新，相对而言，集成度高。用做主存，SDRAM、DDRSDRAM、DDR2SDRAM、DDR3SDRAM</em></li>
</ul>
<p>ROM又可分为：</p>
<ul>
<li>固定掩模ROM</li>
<li>可编程ROM PROM（一次性可编程）</li>
<li>EPROM 可擦除可编程ROM（紫外线擦除）</li>
<li>EEPROM （电擦除）</li>
<li>闪速存储器Flash Memory</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091041359.png" alt></p>
<h3 id="存储单元电路">存储单元电路</h3>
<h4 id="存储单元电路">存储单元电路</h4>
<ul>
<li>存储单元电路：存储器中用来存储一位二进制数的电路</li>
<li>存储字：存储单元的集合，存储一个二进制数</li>
<li>存储字长：存储单元的位数</li>
<li>存储容量：存储单元的个数</li>
<li>存储器容量：存储容量（存储字长*存储单元个数）</li>
<li>存储器带宽：存储器每秒能读出的二进制位数</li>
</ul>
<p><strong>基本要求</strong>：</p>
<ul>
<li>具有两种稳定（或半稳定）状态，用来表示二进制的 0和1</li>
<li>可以实现状态写入（或设置）</li>
<li>可以实现状态读出（或感知）</li>
</ul>
<h4 id="sram存储单元电路">SRAM存储单元电路</h4>
<ol>
<li>
<p><strong>SRAM（静态随机存储器）单元电路</strong><br>
SRAM通常采用<strong>六管单元电路</strong>，每个存储单元由六个MOS管组成，两个为工作管（T1、T2），两个为负载管（T3、T4），两个为门控管（T5、T6）。</p>
<ul>
<li>稳定状态：“1”时，T1截止，T2导通；“0”时，T2截止，T1导通。</li>
<li>保持状态：字选线处于低电平，T5和T6截止，电路内部保持稳定。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091138130.png" alt></li>
</ul>
</li>
<li>
<p><strong>SRAM的读出操作</strong><br>
读出时字选线为高电平，T5和T6导通。根据存储的值，数据线上的电压反映出存储的“1”或“0”。</p>
<ul>
<li>如果存储的是“1”，数据线D为高电平；</li>
<li>如果存储的是“0”，数据线D为低电平。</li>
</ul>
</li>
<li>
<p><strong>SRAM的写入操作</strong><br>
写入时，字选线为高电平，T5和T6导通：</p>
<ul>
<li>写“1”：数据线D为高电平，T1截止，T2导通，存储“1”；</li>
<li>写“0”：数据线D为低电平，T1导通，T2截止，存储“0”。</li>
</ul>
</li>
</ol>
<h4 id="dram存储单元电路">DRAM存储单元电路</h4>
<ol>
<li>
<p><strong>DRAM（动态随机存储器）单元电路</strong><br>
DRAM存储单元通常使用<strong>单管单元电路</strong>，其核心是一个MOS管（T）和一个电容（Cs）。电容用来存储电荷，表示二进制“1”或“0”：</p>
<ul>
<li><strong>有电荷</strong>表示“1”；</li>
<li><strong>无电荷</strong>表示“0”。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091138998.png" alt></li>
</ul>
</li>
<li>
<p><strong>DRAM的读出操作</strong><br>
读出操作首先将数据线D预充电至Vpre（2.5V）。字选线高电平时，MOS管导通：</p>
<ul>
<li>如果存储的是“1”，Cs电容电压较高，电流从电路内部流出到数据线；</li>
<li>如果存储的是“0”，Cs电容电压较低，电流从数据线流入存储电路。</li>
</ul>
</li>
<li>
<p><strong>DRAM的写入操作</strong><br>
写入操作根据需要在数据线上施加高或低电平：</p>
<ul>
<li>写“1”：数据线D加高电平，通过字选线高电平导通MOS管，使Cs充电；</li>
<li>写“0”：数据线D加低电平，通过MOS管使Cs放电，表示“0”。</li>
</ul>
</li>
<li>
<p><strong>DRAM的刷新机制</strong><br>
由于电容的漏电流，Cs上的电荷会逐渐消失，因此DRAM需要定期刷新以保持存储的值。<br>
刷新操作可以通过读出操作实现，因为读出时数据线的电压调整会重新写入数据到电容中。</p>
</li>
</ol>
<h4 id="rom存储单元电路">ROM存储单元电路</h4>
<p><strong>ROM（只读存储器）</strong> 具有非易失性，数据在断电后仍能保存。<br>
ROM的单元电路使用不同的技术来实现数据存储，具体包括：</p>
<ul>
<li><strong>固定掩膜（Masks）ROM</strong>：使用二极管或三极管表示二进制值，无法修改。</li>
<li><strong>PROM（可编程ROM）</strong>：通过大电流永久烧断熔丝进行一次性编程，不能擦除或修改。</li>
<li><strong>EPROM（可擦除PROM）</strong>：通过紫外线擦除电荷并重新编程，采用FAMOS（浮空栅极MOS）结构。</li>
<li><strong>EEPROM（电擦除PROM）</strong>：通过电压实现擦除，能够多次编程。</li>
</ul>
<ol start="2">
<li><strong>固定掩膜ROM</strong><br>
其基本原理是通过设计芯片时在特定位置设置或者不设置二极管或三极管来代表“0”或“1”。</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091145906.png" alt><br>
3. <strong>PROM</strong><br>
PROM在制造时所有位元的初始状态为“1”，通过烧断熔丝将某些位元设置为“0”，这种变化是不可逆的。</p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091146937.png" alt><br>
4. <strong>EPROM</strong><br>
EPROM存储单元电路使用FAMOS结构，编程时通过高电压击穿G极与D极之间的隔离层，将电子注入G极。擦除时通过紫外线照射使G极的电子获得能量越过隔离层。</p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091146519.png" alt><br>
5. <strong>EEPROM</strong><br>
EEPROM基于浮空栅结构的改进，它在浮空栅上增加了一个第二浮空栅，通过施加正电压实现电子注入，负电压实现擦除。</p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091146284.png" alt></p>
<h4 id="存储单元电路的符号表示">存储单元电路的符号表示</h4>
<ol>
<li>存储单元电路通常使用符号来简化表示，表示为具有字选线、数据线和MOS管的简单结构。</li>
<li>一个存储单元电路通常存储1位二进制代码，通过多个存储单元组成存储芯片，而多个芯片构成整个存储系统。</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091147543.png" alt></p>
<h3 id="存储芯片结构">存储芯片结构</h3>
<h4 id="存储芯片容量描述">存储芯片容量描述</h4>
<ol>
<li>
<p>存储芯片容量通常以“字单元数 × 每个字单元的位数”来表示：</p>
<ul>
<li><strong>64K×8</strong>：表示该芯片有64K个字单元，每个字单元存储8位数据。</li>
<li><strong>1K×2</strong>：表示该芯片有1K个字单元，每个字单元存储2位数据。</li>
</ul>
</li>
<li>
<p><strong>地址线与数据线</strong></p>
<ul>
<li><strong>地址线</strong>：决定芯片可以访问的字单元数量。若有<code>n</code>条地址线，则芯片可以寻址2<sup>n</sup>个字单元。</li>
<li><strong>数据线</strong>：决定每次可以读取或写入的位数。若有<code>m</code>条数据线，则每次可以读取或写入<code>m</code>位数据。</li>
</ul>
</li>
</ol>
<h4 id="存储芯片的内部结构">存储芯片的内部结构</h4>
<ol>
<li><strong>一维地址结构</strong>
<ul>
<li>在一维地址结构中，地址线直接控制存储单元的选择，所有字单元排列成一列。译码器通过接收地址信号来选择一个特定的字单元。</li>
<li>例如，<strong>1024×2</strong>的存储芯片具有10条地址线（<code>A0</code>到<code>A9</code>）和2条数据线。地址线通过译码器选择一个特定的字单元，数据线则决定每次传输的位数。</li>
</ul>
</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091148500.png" alt><br>
2. <strong>二维地址结构</strong></p>
<ul>
<li>在二维地址结构中，字单元排列成矩阵，地址被分为行地址和列地址两部分，分别通过行译码器和列译码器来选择特定的字单元。</li>
<li>例如，<strong>4096×4</strong>的存储芯片可表示为128行×128列的存储矩阵。每个字单元由4位组成，行地址用7条地址线，列地址也用5条地址线。</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091149455.png" alt><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091150123.png" alt><br>
3. <strong>二维地址结构的好处</strong></p>
<ul>
<li>通过行列分开寻址，减少了译码器的复杂度。</li>
<li>存储单元矩阵使得存储器的设计更加紧凑和高效。</li>
</ul>
<h4 id="存储芯片结构示例">存储芯片结构示例</h4>
<ol>
<li>
<p><strong>SRAM芯片示例</strong></p>
<ul>
<li>例如，**2114（1024×4）**的SRAM芯片具有10条地址线，4条数据线。</li>
<li>数据线D0到D3对应每个字单元中的4位数据。地址线<code>A0</code>到<code>A9</code>决定选择哪个字单元进行操作。</li>
</ul>
</li>
<li>
<p><strong>DRAM芯片示例</strong></p>
<ul>
<li>例如，<strong>4M×4</strong>的DRAM芯片具有刷新电路，负责对存储单元进行定期刷新，确保数据不会因电荷泄漏而丢失。</li>
<li>该芯片内部包括行译码器、列译码器、数据缓冲器、刷新计数器等模块，以实现高效存储。</li>
</ul>
</li>
</ol>
<h3 id="存储器扩展">存储器扩展</h3>
<h4 id="存储器芯片的扩展">存储器芯片的扩展</h4>
<h5 id="位扩展-2-sup-n-sup-x-font-color-red-m-font"><strong>位扩展</strong>（2<sup>n</sup> X <font color="red">m</font>）</h5>
<ul>
<li>当存储芯片的位数（m）不够时，通过<strong>位扩展</strong>可以增加存储器的位数。例如，两个1K×4的SRAM芯片通过位扩展可构成1K×8的存储器。</li>
<li>位扩展方法：将多个芯片的数据位空间拼接在一起。所有芯片的地址线连接到相同的地址总线，而数据线分别连接到总线的不同位。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410141420404.png" alt></li>
</ul>
<h5 id="字扩展-font-color-red-2-sup-n-sup-font-x-m"><strong>字扩展</strong>（<font color="red">2<sup>n</sup></font> X m）</h5>
<ul>
<li>当存储芯片的字数（<code>2^n</code>）不够时，通过<strong>字扩展</strong>可以增加存储器的地址空间。例如，四个1K×8的SRAM芯片通过字扩展可构成4K×8的存储器。</li>
<li>字扩展方法：将多个芯片的字空间拼接在一起。每个芯片的地址线部分连接到相同的地址总线，片选信号由译码器控制。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410141421744.png" alt></li>
</ul>
<h5 id="混合扩展-font-color-red-2-sup-n-sup-font-x-font-color-red-m-font"><strong>混合扩展</strong>（<font color="red">2<sup>n</sup></font> X <font color="red">m</font>）</h5>
<ul>
<li>当存储器的字数和位数都不够时，可以同时进行位扩展和字扩展，即<strong>混合扩展</strong>。例如，使用4K×4的SRAM芯片可以构建16K×8的存储器。</li>
<li>混合扩展需要使用多个芯片，通过译码器生成片选信号，控制不同芯片的访问。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410141423438.png" alt></li>
</ul>
<h4 id="存储器芯片的扩展示例">存储器芯片的扩展示例</h4>
<h5 id="基本思路">基本思路</h5>
<ol>
<li>确定每个芯片的地址管脚数、数据管脚数。</li>
<li>确定整个存储空间所需的地址总线和数据总线的数量。</li>
<li>计算所需芯片的数量，确定每个芯片在整个存储空间中的地址空间范围、位空间范围。</li>
<li>所有芯片的地址管脚全部连接到地址总线对应的地址线上。</li>
<li>同一地址空间的芯片CS信号连在一起。</li>
<li>同一位空间的芯片数据线连在一起，并连接到对应的数据总线上。</li>
<li>根据每个芯片的地址空间范围，设计芯片所需片选信号CS的逻辑电路，电路的输入一定是，地址总线中，没有连接到芯片地址管脚上的那部分地址线。</li>
<li>统一读写控制</li>
</ol>
<h5 id="异种芯片使用示例"><strong>异种芯片使用示例</strong></h5>
<ul>
<li>用3片<strong>16K×4</strong>的SRAM芯片和若干<strong>8K×4</strong>的SRAM芯片，组成一个<strong>64K×8</strong>的按字节编址的存储器。通过片选译码器生成控制信号，将多个芯片空间拼接在一起，实现数据线和地址线的合理分配。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410141548162.png" alt></li>
</ul>
<h4 id="dram的刷新">DRAM的刷新</h4>
<h5 id="dram的刷新机制">DRAM的刷新机制</h5>
<ol>
<li>
<p><strong>刷新原因</strong></p>
<ul>
<li>DRAM存储单元的电容会因漏电流导致电荷丢失，从而使存储的数据逐渐消失。因此，DRAM需要定期刷新以保持数据的正确性。</li>
<li>刷新周期通常为2ms、4ms或8ms。</li>
</ul>
</li>
<li>
<p><strong>读操作的破坏性</strong></p>
<ul>
<li>读出操作会改变电容的电荷状态，因此DRAM的读操作是破坏性的。每次读操作后，数据需要立即重新写入电容进行恢复。</li>
</ul>
</li>
<li>
<p><strong>DRAM存储单元电路刷新的实现</strong></p>
<ul>
<li>
<p><strong>传感放大器</strong>：由于读出过程D线电压变化量较小，需要对变化量进行放大，才能得到有效的数据，因此，单管存储单元电路中，D线上必须增加<strong>传感放大器</strong>(Sense Amplifier)</p>
</li>
<li>
<p><strong>刷新地址计数器</strong>：在刷新过程中，刷新地址计数器对刷新地址进行计数，确定要刷新的存储单元。</p>
</li>
<li>
<p><strong>刷新操作</strong>：在D线上增加了传感放大器后，读过程实际上就是一次刷新过程。刷新由传感放大器在读出过程中同时完成。事实上，DRAM的刷新，就是通过这样的读操作来实现的。</p>
</li>
</ul>
</li>
</ol>
<h5 id="dram的刷新方式">DRAM的刷新方式</h5>
<ol>
<li>
<p><strong>集中刷新</strong></p>
<ul>
<li>将整个刷新周期分为两个部分，一部分用于刷新所有存储行，此时CPU无法访问内存；另一部分用于CPU访存。</li>
<li>这种方式会产生死区时间，CPU无法访问内存。</li>
</ul>
</li>
<li>
<p><strong>分散刷新</strong></p>
<ul>
<li>刷新与CPU访存交替进行，每次刷新一行，刷新期间CPU可以继续进行存储操作。分散刷新不会出现死区时间，但会降低系统性能。</li>
</ul>
</li>
<li>
<p><strong>分布式刷新</strong></p>
<ul>
<li>在整个刷新周期内，刷新操作分散进行，可以保证每一行都被刷新。相比于集中刷新和分散刷新，分布式刷新能够有效减少死时间，提高性能。</li>
</ul>
</li>
</ol>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>理论课</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机组成原理笔记(5)</title>
    <url>/2024/10/23/ComputerConstructionNote5/</url>
    <content><![CDATA[<h2 id="指令系统与mips汇编语言">指令系统与MIPS汇编语言</h2>
<h3 id="指令格式">指令格式</h3>
<h4 id="指令系统概述">指令系统概述</h4>
<p><strong>指令系统</strong>是计算机执行程序的基础，它定义了计算机的所有指令和操作方式，具体包括以下三个方面：</p>
<ul>
<li><strong>操作类型</strong>：指令系统中应提供哪些操作？常见的基本操作有 <code>LD</code>（加载）、<code>ST</code>（存储）、<code>INC</code>（加一）、<code>BRN</code>（跳转），这些操作足以编写任何计算程序，但实际使用中，单独依赖这些指令会导致程序过长。</li>
<li><strong>操作对象</strong>：如何表示操作对象？可以表示多少个？操作对象通常包括寄存器和内存单元，大多数情况下为双操作数形式（如 A &lt;- B + C），也可能有单操作数形式（如 A &lt;- ~B）。</li>
<li><strong>指令格式</strong>：如何将这些操作类型和对象编码成统一的格式？这涉及到指令的长度、字段数量及其编码方式。</li>
</ul>
<h4 id="机器指令的要素">机器指令的要素</h4>
<p>每条机器指令至少包含四个基本要素：</p>
<ol>
<li><strong>操作码（Opcode）</strong>：用于指明执行的具体操作，如加法、存储等。</li>
<li><strong>源操作数地址</strong>：指向执行操作的源操作数地址，可能包含一个或多个地址。</li>
<li><strong>目的操作数地址</strong>：操作结果需要存储的地址。</li>
<li><strong>下一条指令的地址</strong>：通常程序中的指令按顺序执行，因此在大多数情况下无需显式指定下一条指令地址，只有少数指令（如跳转指令）需要明确给出。</li>
</ol>
<h4 id="指令类型">指令类型</h4>
<p>指令根据其功能可以分为以下几类：</p>
<ul>
<li><strong>数据传输指令</strong>：用于寄存器和存储器之间或寄存器之间的数据传递。</li>
<li><strong>算术/逻辑运算指令</strong>：用于整型数或浮点数的算术运算和逻辑运算。</li>
<li><strong>程序控制指令</strong>：用于改变程序的执行顺序，常见的有条件跳转、循环控制、子程序调用和返回指令。</li>
<li><strong>其他指令</strong>：特权指令（如多任务操作系统中的特权操作）、暂停指令和空操作指令。</li>
</ul>
<h4 id="操作数的类型">操作数的类型</h4>
<p>操作数可以表示以下类型的数据：</p>
<ul>
<li><strong>数值类型</strong>：包括无符号数、定点数、浮点数等。</li>
<li><strong>逻辑型数据</strong>：如布尔值、字符等。</li>
<li><strong>地址类型</strong>：操作数或指令的内存地址。</li>
</ul>
<h4 id="操作数的位置">操作数的位置</h4>
<p>操作数可以存储在不同的位置：</p>
<ul>
<li><strong>存储器地址</strong>：操作数存储在内存中的具体地址。</li>
<li><strong>寄存器地址</strong>：操作数存储在寄存器中。</li>
<li><strong>输入输出端口</strong>：用于与外部设备进行数据交换的端口地址。</li>
</ul>
<h3 id="mips指令系统">MIPS指令系统</h3>
<h4 id="mips概述">MIPS概述</h4>
<p>MIPS是基于 <strong>RISC（精简指令集计算机）</strong> 的指令系统，最早由斯坦福大学的Patterson教授带领的团队在1980年代初开发。MIPS指令集的主要特点是：</p>
<ul>
<li>通过简化指令集设计，减少了硬件复杂度，提高了执行效率。</li>
<li>典型的MIPS处理器包括R2000（32位）、R3000（32位）、R4000（64位）等。</li>
<li>MIPS指令集遵循 <strong>Load-Store架构</strong> ，即内存只能通过加载（<code>LOAD</code>）和存储（<code>STORE</code>）指令访问。</li>
</ul>
<h4 id="mips的寄存器结构">MIPS的寄存器结构</h4>
<ul>
<li><strong>通用寄存器</strong>：MIPS有32个32位的通用寄存器（GPR），标号从 <code>$0</code> 到 <code>$31</code>。其中：
<ul>
<li><code>$zero</code>：值恒为0。</li>
<li><code>$at</code>：保留给汇编程序使用。</li>
<li><code>$v0 - $v1</code>：用于存储函数返回值。</li>
<li><code>$a0 - $a3</code>：用于传递函数参数。</li>
<li><code>$t0 - $t9</code>：临时寄存器，用于存储中间运算结果。</li>
<li><code>$s0 - $s7</code>：保存寄存器，函数调用过程中不会被覆盖。</li>
<li><code>$k0 - $k1</code>：保留给操作系统使用。</li>
<li><code>$gp</code>：全局指针。</li>
<li><code>$sp</code>：栈指针，指向当前栈顶。</li>
<li><code>$ra</code>：返回地址寄存器，保存子程序调用的返回地址。</li>
</ul>
</li>
</ul>
<h4 id="mips指令格式">MIPS指令格式</h4>
<p>MIPS指令长度固定为32位，主要分为以下三种格式：</p>
<ul>
<li>
<p><strong>R格式（Register）</strong>：适用于寄存器之间的运算操作。结构如下：</p>
<ul>
<li><code>Opcode</code>（6位）：操作码。</li>
<li><code>Rs</code>（5位）：第一个源操作数寄存器。</li>
<li><code>Rt</code>（5位）：第二个源操作数寄存器。</li>
<li><code>Rd</code>（5位）：目标寄存器。</li>
<li><code>Shamt</code>（5位）：移位量（用于移位指令）。</li>
<li><code>Func</code>（6位）：功能字段，进一步指定具体操作。</li>
</ul>
</li>
<li>
<p><strong>I格式（Immediate）</strong>：适用于使用立即数的指令，结构如下：</p>
<ul>
<li><code>Opcode</code>（6位）：操作码。</li>
<li><code>Rs</code>（5位）：源操作数寄存器。</li>
<li><code>Rt</code>（5位）：目标寄存器。</li>
<li><code>Immediate</code>（16位）：立即数。</li>
</ul>
</li>
<li>
<p><strong>J格式（Jump）</strong>：用于跳转指令，结构如下：</p>
<ul>
<li><code>Opcode</code>（6位）：操作码。</li>
<li><code>Target</code>（26位）：跳转目标地址。</li>
</ul>
</li>
</ul>
<h4 id="mips指令类型">MIPS指令类型</h4>
<p>MIPS的指令大致可分为以下几类：</p>
<ul>
<li><strong>Load/Store指令</strong>：如 <code>LW</code>（加载字）和 <code>SW</code>（存储字），用于在寄存器和存储器之间传输数据。</li>
<li><strong>算术指令</strong>：如 <code>ADD</code>、<code>SUB</code>，可以对寄存器中的数值进行加法和减法运算。</li>
<li><strong>逻辑指令</strong>：如 <code>AND</code>、<code>OR</code>，用于逻辑运算。</li>
<li><strong>移位指令</strong>：如 <code>SLL</code>（逻辑左移）、<code>SRL</code>（逻辑右移），用于位移操作。</li>
<li><strong>条件分支指令</strong>：如 <code>BEQ</code>（相等时分支），用于控制程序流的执行。</li>
<li><strong>跳转指令</strong>：如 <code>J</code>（无条件跳转），用于在程序中跳转到指定地址。</li>
</ul>
<h3 id="mips汇编语言">MIPS汇编语言</h3>
<h4 id="mips汇编语言概述">MIPS汇编语言概述</h4>
<p>MIPS汇编语言的语法简单，指令集中每条指令都对应具体的硬件操作。MIPS汇编程序由<strong>数据段</strong>、<strong>代码段</strong>和<strong>全局符号</strong>组成：</p>
<ul>
<li><strong>数据段（.DATA）</strong>：用于定义全局变量和初始化数据。</li>
<li><strong>代码段（.TEXT）</strong>：包含程序的指令代码。</li>
<li><strong>全局符号（.GLOBL）</strong>：用于声明全局可访问的标签，常用于定义入口函数 <code>main</code>。</li>
</ul>
<h4 id="mips伪指令">MIPS伪指令</h4>
<p>MIPS汇编语言中提供了多种伪指令，用于简化编程过程：</p>
<ul>
<li><strong><code>LA</code>（Load Address）</strong>：加载地址。</li>
<li><strong><code>LI</code>（Load Immediate）</strong>：加载立即数。</li>
<li><strong><code>MOVE</code></strong>：将一个寄存器的值复制到另一个寄存器。</li>
<li><strong><code>MUL</code></strong> 和 <strong><code>DIV</code></strong>：执行乘法和除法运算。</li>
</ul>
<h4 id="函数调用与寄存器约定">函数调用与寄存器约定</h4>
<p>MIPS函数调用的约定非常严格：</p>
<ul>
<li><strong>参数传递</strong>：通过 <code>$a0 - $a3</code> 传递函数参数。</li>
<li><strong>返回值</strong>：函数返回值存储在 <code>$v0</code> 和 <code>$v1</code> 中。</li>
<li><strong>返回地址</strong>：使用 <code>$ra</code> 寄存器保存函数返回地址。</li>
<li><strong>栈的使用</strong>：调用函数时，需要在栈中保存临时数据和返回地址。栈指针 <code>$sp</code> 始终指向栈顶，函数调用前减小栈指针，函数返回后恢复栈指针。</li>
</ul>
<h3 id="寻址方式">寻址方式</h3>
<h4 id="常见寻址方式">常见寻址方式</h4>
<p>MIPS指令支持多种寻址方式，用于计算操作数的有效地址：</p>
<ul>
<li>
<p><strong>立即寻址</strong>：操作数直接包含在指令中。</p>
</li>
<li>
<p><strong>寄存器直接寻址</strong>：操作数存储在寄存器中，指令指定寄存器地址。</p>
</li>
<li>
<p><strong>寄存器间接寻址</strong>：寄存器中存储的是操作数的内存地址。</p>
</li>
<li>
<p><strong>基址寻址</strong>：通过基址寄存器和偏移量计算操作数的内存地址。</p>
</li>
<li>
<p><strong>变址寻址</strong>：类似于基址寻址，但基址寄存器的值会根据索引或步长自动调整。</p>
</li>
</ul>
<h4 id="mips的load-store架构">MIPS的Load/Store架构</h4>
<p>MIPS采用Load-Store架构，即内存只能通过加载（<code>LOAD</code>）和存储（<code>STORE</code>）指令访问，而其他运算指令只能操作寄存器中的数据。这种架构设计简化了硬件实现，同时提升了程序执行效率。</p>
<h3 id="mips编程示例">MIPS编程示例</h3>
<h4 id="简单的mips程序示例">简单的MIPS程序示例</h4>
<p>以下是一个简单的MIPS程序，打印字符串并退出：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.data</span><br><span class="line">str1:   .asciiz &quot;Hello, MIPS!&quot;</span><br><span class="line"></span><br><span class="line">.text</span><br><span class="line">.globl main</span><br><span class="line">main:</span><br><span class="line">    li $v0, 4         # 指定系统调用号4（打印字符串）</span><br><span class="line">    la $a0, str1      # 加载字符串地址到$a0</span><br><span class="line">    syscall           # 系统调用</span><br><span class="line"></span><br><span class="line">    li $v0, 10        # 指定系统调用号10（退出）</span><br><span class="line">    syscall           # 系统调用</span><br></pre></td></tr></table></figure>
<h4 id="算术运算">算术运算</h4>
<p>在MIPS中，算术运算只能在寄存器之间进行，以下是加法和减法运算的示例：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">add $t0, $t1, $t2  # $t0 = $t1 + $t2</span><br><span class="line">sub $t0, $t1, $t2  # $t0 = $t1 - $t2</span><br><span class="line">mul $t0, $t1, $t2  # $t0 = $t1 * $t2</span><br><span class="line">div $t0, $t1, $t2  # $t0 = $t1 / $t2</span><br></pre></td></tr></table></figure>
<h3 id="总结">总结</h3>
<ul>
<li>MIPS架构是一种经典的RISC（精简指令集计算机）架构，因其简洁、高效而广泛应用于教学和嵌入式系统。</li>
<li>MIPS的指令集和汇编语言具备结构清晰、便于学习和掌握的特点，同时提供了足够的灵活性和高效性，适合编写性能要求较高的程序。</li>
</ul>
<hr>
<h2 id="mips处理器设计">MIPS处理器设计</h2>
<h3 id="处理器设计概述">处理器设计概述</h3>
<h4 id="1-处理器的功能与组成">1. 处理器的功能与组成</h4>
<ol>
<li>
<p><strong>CPU的功能</strong>：控制指令执行。包括：</p>
<ul>
<li><strong>取指令</strong>：从指令存储器中读取并分析指令。</li>
<li><strong>取数</strong>：从数据存储器读取操作数。</li>
<li><strong>执行</strong>：完成指令指定的动作（例如运算）。</li>
</ul>
</li>
<li>
<p><strong>指令周期</strong>：指CPU从指令存储器中读取并执行指令的整个时间，分为：</p>
<ul>
<li><strong>取指周期</strong>：读取指令并分析指令所需的时间。</li>
<li><strong>取数周期</strong>：从数据存储器读取操作数的时间。</li>
<li><strong>执行周期</strong>：完成指令动作的时间（因指令而异）。</li>
</ul>
</li>
<li>
<p><strong>CPU组成</strong>：</p>
<ul>
<li><strong>控制单元</strong>（Control Unit，CU）：负责生成指令执行所需的控制信号。</li>
<li><strong>执行单元</strong>（Datapath）：完成算术逻辑运算，包含ALU和寄存器。</li>
</ul>
</li>
<li>
<p><strong>数据通路</strong>：指令执行时数据流经过的部件和路径，用于数据传送、处理和存储。</p>
</li>
<li>
<p><strong>控制器</strong>：根据指令生成控制信号，用于控制数据通路中各部件的功能。</p>
</li>
</ol>
<h4 id="处理器设计的一般方法">处理器设计的一般方法</h4>
<ol>
<li>分析指令系统需求：包括指令格式、类型、功能等。</li>
<li>数据通路设计：选择数据通路部件，构建各类指令的数据通路。</li>
<li>控制器设计：确定控制信号和逻辑实现。</li>
</ol>
<h3 id="mips模型机">MIPS模型机</h3>
<h4 id="mips模型机指令集">MIPS模型机指令集</h4>
<ol>
<li><strong>寄存器结构</strong>：
<ul>
<li>32个32位通用寄存器（GPRs），包括HI、LO、PC寄存器。</li>
</ul>
</li>
<li><strong>指令格式</strong>：
<ul>
<li>R类型、I类型、J类型三种指令格式，分别对应算术运算、数据存取、跳转等操作。</li>
</ul>
</li>
</ol>
<h4 id="数据通路部件">数据通路部件</h4>
<ol>
<li><strong>ALU（算术逻辑单元）</strong>：执行逻辑和算术操作，如加法、减法等。</li>
<li><strong>多路选择器（MUX）</strong>：选择数据传输的路径。</li>
<li><strong>符号扩展器（Signext）</strong>：扩展立即数至32位。</li>
<li><strong>寄存器堆</strong>：支持两个32位读端口和一个32位写端口。</li>
<li><strong>数据存储器（DM）和指令存储器（IM）</strong>：分别用于存储数据和指令。</li>
</ol>
<h4 id="时钟同步方法">时钟同步方法</h4>
<ol>
<li><strong>时钟周期</strong>：数据通路由状态元件和操作元件组成，时钟周期为状态元件存储的信息传递到下一状态元件的时间。</li>
<li><strong>边沿触发</strong>：所有状态元件的数据写入发生在时钟的上跳沿时刻。</li>
</ol>
<h3 id="mips单周期处理器设计">MIPS单周期处理器设计</h3>
<h4 id="单周期处理器概述">单周期处理器概述</h4>
<p>单周期处理器中，每一条指令都在一个时钟周期内完成，因此每条指令的CPI（每指令周期数）固定为1。为了实现这一目标，单周期处理器必须为每条指令设计一个完整的数据通路，并确保所有操作在一个时钟周期内完成。</p>
<p>单周期处理器的架构设计基于以下关键部分：</p>
<ul>
<li><strong>数据通路设计</strong>：通过硬件模块（如ALU、寄存器堆、数据存储器等）处理指令。</li>
<li><strong>控制器设计</strong>：生成相应的控制信号，协调数据通路中各个模块的操作。</li>
</ul>
<h4 id="单周期数据通路设计">单周期数据通路设计</h4>
<h5 id="数据通路设计的总体思路">数据通路设计的总体思路</h5>
<p>单周期数据通路采用<strong>哈佛体系结构</strong>，即指令存储器（Instruction Memory, IM）和数据存储器（Data Memory, DM）是独立的，分别用于存储指令和操作数据。数据通路包括以下步骤：</p>
<ul>
<li><strong>取指令</strong>：从IM读取指令。</li>
<li><strong>译码</strong>：根据指令类型读取寄存器中的操作数。</li>
<li><strong>执行</strong>：在ALU中进行算术或逻辑运算。</li>
<li><strong>数据存取</strong>：对于内存操作指令，访问DM。</li>
<li><strong>写回</strong>：将运算结果写回寄存器堆。</li>
</ul>
<h5 id="关键指令的通路设计">关键指令的通路设计</h5>
<p>根据MIPS指令集中的典型指令，如R型指令、LW/SW指令和分支指令，设计它们的专用数据通路。</p>
<ol>
<li><strong>R型指令</strong>数据通路设计（如<code>add</code>, <code>sub</code>, <code>and</code>, <code>or</code>）</li>
</ol>
<ul>
<li>
<p><strong>指令格式</strong>：<code>add rd, rs, rt</code>，指令类型为R型。</p>
</li>
<li>
<p><strong>执行流程</strong>：</p>
<ul>
<li>读取寄存器<code>rs</code>和<code>rt</code>的值。</li>
<li>在ALU中执行指定的算术或逻辑运算（例如<code>add</code>）。</li>
<li>将运算结果写入目的寄存器<code>rd</code>。</li>
</ul>
<p><img src="https://example.com/r_type_path.png" alt="R型指令数据通路"><br>
<strong>所需硬件</strong>：寄存器堆、ALU。</p>
</li>
<li>
<p><strong>数据流</strong>：<code>R[rd] ← R[rs] op R[rt]</code></p>
</li>
</ul>
<ol start="2">
<li><strong>LW指令</strong>数据通路设计（如<code>lw rt, offset(rs)</code>）</li>
</ol>
<ul>
<li>
<p><strong>指令格式</strong>：<code>lw rt, offset(rs)</code>，从内存中加载数据到寄存器。</p>
</li>
<li>
<p><strong>执行流程</strong>：</p>
<ul>
<li>读取寄存器<code>rs</code>的值，并使用立即数<code>offset</code>计算内存地址。</li>
<li>访问数据存储器（DM），读取数据。</li>
<li>将数据存储到目的寄存器<code>rt</code>。</li>
</ul>
<p><img src="https://example.com/lw_path.png" alt="LW指令数据通路"><br>
<strong>所需硬件</strong>：寄存器堆、ALU、符号扩展器、数据存储器。</p>
</li>
<li>
<p><strong>数据流</strong>：<code>R[rt] ← M[R[rs] + SignExt(imm)]</code></p>
</li>
</ul>
<ol start="3">
<li><strong>SW指令</strong>数据通路设计（如<code>sw rt, offset(rs)</code>）</li>
</ol>
<ul>
<li>
<p><strong>指令格式</strong>：<code>sw rt, offset(rs)</code>，将寄存器数据存入内存。</p>
</li>
<li>
<p><strong>执行流程</strong>：</p>
<ul>
<li>读取寄存器<code>rs</code>和<code>rt</code>的值。</li>
<li>计算存储地址。</li>
<li>将寄存器<code>rt</code>的数据存入计算出的内存地址。</li>
</ul>
<p><img src="https://example.com/sw_path.png" alt="SW指令数据通路"><br>
<strong>所需硬件</strong>：寄存器堆、ALU、符号扩展器、数据存储器。</p>
</li>
<li>
<p><strong>数据流</strong>：<code>M[R[rs] + SignExt(imm)] ← R[rt]</code></p>
</li>
</ul>
<ol start="4">
<li>**分支指令（BEQ）**数据通路设计</li>
</ol>
<ul>
<li>
<p><strong>指令格式</strong>：<code>beq rs, rt, offset</code>，如果<code>rs == rt</code>，跳转到<code>PC + offset</code>。</p>
</li>
<li>
<p><strong>执行流程</strong>：</p>
<ul>
<li>读取寄存器<code>rs</code>和<code>rt</code>的值。</li>
<li>在ALU中执行比较操作（<code>rs - rt</code>），判断是否相等。</li>
<li>如果相等，更新PC为<code>PC + SignExt(offset) &lt;&lt; 2</code>。</li>
</ul>
<p><img src="https://example.com/beq_path.png" alt="BEQ指令数据通路"><br>
<strong>所需硬件</strong>：寄存器堆、ALU、符号扩展器、移位器、加法器。</p>
</li>
<li>
<p><strong>数据流</strong>：<code>if (R[rs] == R[rt]) then PC ← PC + SignExt(offset) &lt;&lt; 2</code></p>
</li>
</ul>
<h5 id="数据通路的合并">数据通路的合并</h5>
<p>为了实现单周期处理器，必须将所有指令的独立数据通路合并为一个统一的数据通路。关键在于：</p>
<ul>
<li><strong>多路选择器（MUX）的使用</strong>：由于各条指令的操作路径不同，需要使用多路选择器在不同的操作路径之间切换。例如：
<ul>
<li><code>RegDst</code>：控制写入寄存器的地址是否是<code>rt</code>（LW指令）或<code>rd</code>（R型指令）。</li>
<li><code>MemtoReg</code>：控制写入寄存器的数据是来自ALU的运算结果（R型指令）还是数据存储器（LW指令）。</li>
</ul>
</li>
</ul>
<h5 id="完整的单周期数据通路">完整的单周期数据通路</h5>
<p>整合R型、LW、SW和分支指令的数据通路，形成最终的单周期数据通路：</p>
<ul>
<li>
<p>通过引入多个MUX控制信号（如<code>RegDst</code>、<code>ALUSrc</code>、<code>PCSrc</code>），动态选择不同的数据通路。</p>
<p><img src="https://example.com/full_cycle_path.png" alt="完整数据通路"></p>
</li>
</ul>
<h4 id="单周期控制器设计">单周期控制器设计</h4>
<h5 id="控制信号的生成">控制信号的生成</h5>
<p>控制器的核心任务是生成正确的控制信号，以控制数据通路中各个模块的工作。这些控制信号包括：</p>
<ul>
<li><strong>寄存器写入控制</strong>：<code>RegWrite</code>。</li>
<li><strong>内存读取/写入控制</strong>：<code>MemRead</code>、<code>MemWrite</code>。</li>
<li><strong>ALU操作控制</strong>：<code>ALUOp</code>。</li>
<li><strong>分支跳转控制</strong>：<code>Branch</code>。</li>
</ul>
<h5 id="主控单元与alu控制单元">主控单元与ALU控制单元</h5>
<p>控制器分为<strong>主控单元</strong>和<strong>ALU控制单元</strong>：</p>
<ul>
<li><strong>主控单元</strong>：根据指令操作码生成大部分控制信号，并为ALU控制单元提供操作类型<code>ALUOp</code>。</li>
<li><strong>ALU控制单元</strong>：根据主控单元提供的<code>ALUOp</code>和指令的功能码<code>Func</code>，生成ALU的操作信号（如加法、减法、逻辑与等）。</li>
</ul>
<h5 id="控制信号分析">控制信号分析</h5>
<ul>
<li>
<p><strong>RegDst</strong>：</p>
<ul>
<li>R型指令：<code>RegDst = 1</code>，写入目的寄存器<code>rd</code>。</li>
<li>LW指令：<code>RegDst = 0</code>，写入寄存器<code>rt</code>。</li>
</ul>
</li>
<li>
<p><strong>ALUSrc</strong>：</p>
<ul>
<li>R型指令：<code>ALUSrc = 0</code>，ALU的输入来自寄存器<code>rt</code>。</li>
<li>LW/SW指令：<code>ALUSrc = 1</code>，ALU的输入来自符号扩展的立即数。</li>
</ul>
</li>
<li>
<p><strong>MemtoReg</strong>：</p>
<ul>
<li>R型指令：<code>MemtoReg = 0</code>，寄存器的写入数据来自ALU。</li>
<li>LW指令：<code>MemtoReg = 1</code>，寄存器的写入数据来自数据存储器。</li>
</ul>
</li>
<li>
<p><strong>Branch</strong>：仅对分支指令有效。如果分支条件满足（如<code>rs == rt</code>），<code>Branch = 1</code>，否则<code>Branch = 0</code>。</p>
</li>
</ul>
<h5 id="完整的控制信号表">完整的控制信号表</h5>
<p>每条指令都有一套特定的控制信号，以下为部分指令的控制信号示例：</p>
<table>
<thead>
<tr>
<th>指令类型</th>
<th>RegDst</th>
<th>ALUSrc</th>
<th>MemtoReg</th>
<th>RegWrite</th>
<th>MemRead</th>
<th>MemWrite</th>
<th>Branch</th>
<th>ALUOp</th>
</tr>
</thead>
<tbody>
<tr>
<td>R型指令</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>LW指令</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>00</td>
</tr>
<tr>
<td>SW指令</td>
<td>X</td>
<td>1</td>
<td>X</td>
<td>0</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>BEQ指令</td>
<td>X</td>
<td>0</td>
<td>X</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>01</td>
</tr>
</tbody>
</table>
<h5 id="alu控制单元的设计"><strong>ALU控制单元</strong>的设计</h5>
<p>ALU控制单元通过<code>ALUOp</code>和指令的<code>Func</code>字段（R型指令）来生成具体的ALU操作信号。ALU执行的操作类型由指令功能码（<code>Func</code>）决定，如下表所示：</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>ALUOp</th>
<th>功能码(Func)</th>
<th>ALU操作类型</th>
<th>ALU控制信号</th>
</tr>
</thead>
<tbody>
<tr>
<td>LW/SW</td>
<td>00</td>
<td>XXXXXXXXXX</td>
<td>加法</td>
<td>0010</td>
</tr>
<tr>
<td>BEQ</td>
<td>01</td>
<td>XXXXXXXXXX</td>
<td>减法</td>
<td>0110</td>
</tr>
<tr>
<td>ADD</td>
<td>10</td>
<td>100000</td>
<td>加法</td>
<td>0010</td>
</tr>
<tr>
<td>SUB</td>
<td>10</td>
<td>100010</td>
<td>减法</td>
<td>0110</td>
</tr>
<tr>
<td>AND</td>
<td>10</td>
<td>100100</td>
<td>与</td>
<td>0000</td>
</tr>
<tr>
<td>OR</td>
<td>10</td>
<td>100101</td>
<td>或</td>
<td>0001</td>
</tr>
<tr>
<td>SLT</td>
<td>10</td>
<td>101010</td>
<td>小于比较</td>
<td>0111</td>
</tr>
</tbody>
</table>
<p><strong>ALU控制逻辑分析</strong></p>
<ul>
<li>当<code>ALUOp</code>为<code>00</code>时，表示是<code>LW</code>或<code>SW</code>指令，ALU执行加法操作，用于地址计算。</li>
<li>当<code>ALUOp</code>为<code>01</code>时，表示<code>BEQ</code>指令，ALU执行减法操作，比较寄存器<code>rs</code>和<code>rt</code>的值。</li>
<li>当<code>ALUOp</code>为<code>10</code>时，表示R型指令，ALU的操作类型由<code>Func</code>字段决定，具体实现相应的算术或逻辑操作。</li>
</ul>
<h5 id="主控单元和alu控制单元结合"><strong>主控单元和ALU控制单元结合</strong></h5>
<p>主控单元生成的<code>ALUOp</code>会根据不同指令类型传递给ALU控制单元，然后结合<code>Func</code>字段，ALU控制单元生成具体的ALU控制信号。整个控制信号设计形成一个完整的控制路径，如下图：</p>
<p><img src="https://example.com/alu_control_unit.png" alt="ALU控制单元"></p>
<h4 id="mips单周期处理器的性能分析">MIPS单周期处理器的性能分析</h4>
<h5 id="指令周期分析"><strong>指令周期分析</strong></h5>
<p>由于单周期处理器的所有指令都在一个时钟周期内完成，时钟周期长度由最长指令决定。在MIPS中，<code>LW</code>指令是执行时间最长的指令，因此处理器的时钟周期长度由<code>LW</code>指令的执行时间决定。</p>
<h5 id="不同指令的执行时间"><strong>不同指令的执行时间</strong></h5>
<p>假设处理器的主要硬件单元具有如下延迟：</p>
<ul>
<li><strong>指令存储器读取</strong>（IM Access Time）：200ps</li>
<li><strong>寄存器堆访问时间</strong>（Register File Access Time）：50ps</li>
<li><strong>ALU运算延迟</strong>：100ps</li>
<li><strong>数据存储器访问时间</strong>（DM Access Time）：200ps</li>
</ul>
<p>以此计算不同指令的执行时间：</p>
<ol>
<li>
<p><strong>R型指令</strong>：</p>
<ul>
<li><strong>取指令</strong>：200ps</li>
<li><strong>读寄存器</strong>：50ps</li>
<li><strong>ALU运算</strong>：100ps</li>
<li><strong>写寄存器</strong>：50ps</li>
<li><strong>总计</strong>：400ps</li>
</ul>
</li>
<li>
<p><strong>LW指令</strong>：</p>
<ul>
<li><strong>取指令</strong>：200ps</li>
<li><strong>读寄存器</strong>：50ps</li>
<li><strong>ALU计算地址</strong>：100ps</li>
<li><strong>访问数据存储器</strong>：200ps</li>
<li><strong>写寄存器</strong>：50ps</li>
<li><strong>总计</strong>：600ps</li>
</ul>
</li>
<li>
<p><strong>SW指令</strong>：</p>
<ul>
<li><strong>取指令</strong>：200ps</li>
<li><strong>读寄存器</strong>：50ps</li>
<li><strong>ALU计算地址</strong>：100ps</li>
<li><strong>写数据到存储器</strong>：200ps</li>
<li><strong>总计</strong>：550ps</li>
</ul>
</li>
<li>
<p><strong>BEQ指令</strong>：</p>
<ul>
<li><strong>取指令</strong>：200ps</li>
<li><strong>读寄存器</strong>：50ps</li>
<li><strong>ALU比较</strong>：100ps</li>
<li><strong>PC更新</strong>：50ps</li>
<li><strong>总计</strong>：400ps</li>
</ul>
</li>
</ol>
<h5 id="单周期处理器的缺点"><strong>单周期处理器的缺点</strong></h5>
<ul>
<li><strong>效率低下</strong>：由于所有指令的执行时间固定为最长的指令（LW指令）的时钟周期（600ps），即使较短指令（如<code>R型</code>指令）也必须在相同的时间内执行，导致时钟周期利用效率低。</li>
<li><strong>改进建议</strong>：采用多周期处理器设计，不同指令类型可以使用不同的时钟周期，从而优化性能。</li>
</ul>
<p>以下是MIPS多周期处理器设计的详细内容，包含数据通路设计和控制器设计的详细解释与分析。</p>
<h3 id="mips-多周期处理器设计">MIPS 多周期处理器设计</h3>
<h4 id="多周期处理器概述">多周期处理器概述</h4>
<p>在多周期处理器设计中，每条指令被分解为多个步骤，每个步骤在一个时钟周期内完成。因此，不同指令类型可以占用不同数量的时钟周期。这种设计的优势在于它允许更高的时钟频率和更灵活的指令执行时间，从而提高了性能和资源利用效率。</p>
<p><strong>优点</strong>：</p>
<ul>
<li><strong>更短的时钟周期</strong>：时钟周期不再由最长指令决定。</li>
<li><strong>指令执行时间优化</strong>：不同指令根据需要占用不同的时钟周期。</li>
<li><strong>硬件资源共享</strong>：功能单元（如ALU、寄存器堆等）可以在不同时钟周期内复用，减少硬件成本。</li>
</ul>
<h4 id="mips多周期数据通路设计">MIPS多周期数据通路设计</h4>
<h5 id="多周期设计的基本原理">多周期设计的基本原理</h5>
<p>MIPS多周期处理器的数据通路设计基于以下几个关键步骤，每个步骤在一个时钟周期内完成：</p>
<ol>
<li><strong>取指令</strong>：从指令存储器读取指令。</li>
<li><strong>译码和读取寄存器</strong>：对指令进行译码并从寄存器堆中读取操作数。</li>
<li><strong>执行运算/计算地址</strong>：在ALU中进行算术或逻辑运算，或者计算内存地址。</li>
<li><strong>访问存储器</strong>：对于LW/SW指令，访问数据存储器。</li>
<li><strong>写回</strong>：将运算结果或从内存读取的数据写回寄存器堆。</li>
</ol>
<h5 id="多周期数据通路的设计步骤">多周期数据通路的设计步骤</h5>
<ol>
<li><strong>取指令阶段</strong>（Instruction Fetch, IF）</li>
</ol>
<ul>
<li><strong>操作描述</strong>：根据PC值从指令存储器中读取指令，并将<code>PC</code>加4以准备下一条指令。</li>
<li><strong>所需硬件</strong>：PC（程序计数器）、指令存储器（IM）、加法器（用于<code>PC + 4</code>的计算）。</li>
<li><strong>RTL描述</strong>：
<ul>
<li><code>IR ← M[PC]</code> （指令寄存器<code>IR</code>中保存指令）</li>
<li><code>PC ← PC + 4</code></li>
</ul>
</li>
</ul>
<ol start="2">
<li><strong>译码和读寄存器阶段</strong>（Instruction Decode, ID）</li>
</ol>
<ul>
<li><strong>操作描述</strong>：对指令进行译码，并从寄存器堆中读取两个操作数<code>rs</code>和<code>rt</code>。</li>
<li><strong>所需硬件</strong>：指令寄存器<code>IR</code>、寄存器堆<code>Register File</code>。</li>
<li><strong>RTL描述</strong>：
<ul>
<li><code>A ← R[IR[25:21]]</code>（<code>A</code>保存<code>rs</code>的值）</li>
<li><code>B ← R[IR[20:16]]</code>（<code>B</code>保存<code>rt</code>的值）</li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>执行/地址计算阶段</strong>（Execution, EX）</li>
</ol>
<ul>
<li><strong>操作描述</strong>：
<ul>
<li>对于R型指令：在ALU中进行算术或逻辑运算。</li>
<li>对于LW/SW指令：计算内存地址。</li>
<li>对于BEQ指令：在ALU中进行比较以决定是否分支。</li>
</ul>
</li>
<li><strong>所需硬件</strong>：ALU、符号扩展器（SignExt，用于扩展立即数）。</li>
<li><strong>RTL描述</strong>：
<ul>
<li>R型指令：<code>ALUOut ← A op B</code></li>
<li>LW/SW指令：<code>ALUOut ← A + SignExt(IR[15:0])</code>（计算内存地址）</li>
<li>BEQ指令：<code>ALUOut ← A - B</code></li>
</ul>
</li>
</ul>
<ol start="4">
<li><strong>访问存储器阶段</strong>（Memory Access, MEM）</li>
</ol>
<ul>
<li><strong>操作描述</strong>：
<ul>
<li>对于LW指令：从数据存储器读取数据。</li>
<li>对于SW指令：将寄存器数据写入数据存储器。</li>
</ul>
</li>
<li><strong>所需硬件</strong>：数据存储器（DM）。</li>
<li><strong>RTL描述</strong>：
<ul>
<li>LW指令：<code>MDR ← M[ALUOut]</code>（从内存中读取数据）</li>
<li>SW指令：<code>M[ALUOut] ← B</code>（将<code>rt</code>的数据存入内存）</li>
</ul>
</li>
</ul>
<ol start="5">
<li><strong>写回阶段</strong>（Write Back, WB）</li>
</ol>
<ul>
<li><strong>操作描述</strong>：
<ul>
<li>对于R型指令：将ALU的结果写入寄存器堆。</li>
<li>对于LW指令：将从内存中读取的数据写入寄存器堆。</li>
</ul>
</li>
<li><strong>所需硬件</strong>：寄存器堆。</li>
<li><strong>RTL描述</strong>：
<ul>
<li>R型指令：<code>R[IR[15:11]] ← ALUOut</code></li>
<li>LW指令：<code>R[IR[20:16]] ← MDR</code></li>
</ul>
</li>
</ul>
<h5 id="各类指令的多周期执行过程"><strong>各类指令的多周期执行过程</strong></h5>
<ol>
<li><strong>R型指令的多周期执行</strong></li>
</ol>
<ul>
<li><strong>步骤</strong>：
<ul>
<li>T1：取指令 → <code>IR ← M[PC]</code>，<code>PC ← PC + 4</code></li>
<li>T2：读取寄存器 → <code>A ← R[IR[25:21]]</code>，<code>B ← R[IR[20:16]]</code></li>
<li>T3：ALU运算 → <code>ALUOut ← A op B</code></li>
<li>T4：写寄存器 → <code>R[IR[15:11]] ← ALUOut</code></li>
</ul>
</li>
</ul>
<ol start="2">
<li><strong>LW指令的多周期执行</strong></li>
</ol>
<ul>
<li><strong>步骤</strong>：
<ul>
<li>T1：取指令 → <code>IR ← M[PC]</code>，<code>PC ← PC + 4</code></li>
<li>T2：读取寄存器 → <code>A ← R[IR[25:21]]</code></li>
<li>T3：地址计算 → <code>ALUOut ← A + SignExt(IR[15:0])</code></li>
<li>T4：读数据存储器 → <code>MDR ← M[ALUOut]</code></li>
<li>T5：写寄存器 → <code>R[IR[20:16]] ← MDR</code></li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>SW指令的多周期执行</strong></li>
</ol>
<ul>
<li><strong>步骤</strong>：
<ul>
<li>T1：取指令 → <code>IR ← M[PC]</code>，<code>PC ← PC + 4</code></li>
<li>T2：读取寄存器 → <code>A ← R[IR[25:21]]</code>，<code>B ← R[IR[20:16]]</code></li>
<li>T3：地址计算 → <code>ALUOut ← A + SignExt(IR[15:0])</code></li>
<li>T4：写数据存储器 → <code>M[ALUOut] ← B</code></li>
</ul>
</li>
</ul>
<ol start="4">
<li><strong>BEQ指令的多周期执行</strong></li>
</ol>
<ul>
<li><strong>步骤</strong>：
<ul>
<li>T1：取指令 → <code>IR ← M[PC]</code>，<code>PC ← PC + 4</code></li>
<li>T2：读取寄存器 → <code>A ← R[IR[25:21]]</code>，<code>B ← R[IR[20:16]]</code></li>
<li>T3：ALU比较 → <code>ALUOut ← A - B</code></li>
<li>T4：更新PC → <code>if (ALUOut == 0) then PC ← PC + SignExt(IR[15:0]) &lt;&lt; 2</code></li>
</ul>
</li>
</ul>
<h4 id="多周期控制器设计">多周期控制器设计</h4>
<h5 id="控制器的两部分">控制器的两部分</h5>
<p>多周期处理器的控制器分为两部分：</p>
<ol>
<li><strong>主控单元</strong>：根据当前指令的操作码（Opcode），控制指令执行的各个阶段。</li>
<li><strong>ALU控制单元</strong>：负责生成ALU的控制信号。</li>
</ol>
<h5 id="控制信号的生成"><strong>控制信号的生成</strong></h5>
<p>多周期控制器的任务是通过不同的状态机步骤，生成每个时钟周期所需的控制信号。关键的控制信号包括：</p>
<ul>
<li><strong>PCWrite</strong>：用于更新PC。</li>
<li><strong>MemRead</strong>、<strong>MemWrite</strong>：控制数据存储器的读取和写入。</li>
<li><strong>IRWrite</strong>：控制指令寄存器的写入。</li>
<li><strong>RegWrite</strong>：控制寄存器堆的写入。</li>
<li><strong>ALUSrcA</strong>、<strong>ALUSrcB</strong>：选择ALU输入的来源。</li>
<li><strong>ALUOp</strong>：确定ALU的运算类型。</li>
</ul>
<h5 id="状态机的设计"><strong>状态机的设计</strong></h5>
<p>多周期处理器的控制器通过状态机来控制每个指令执行的不同阶段。每个状态对应指令执行的一个步骤，状态机的设计如下：</p>
<ol>
<li><strong>T1</strong>：取指令阶段，生成<code>PCWrite</code>和<code>IRWrite</code>信号。</li>
<li><strong>T2</strong>：译码阶段，生成<code>ALUSrcA = 0</code>，<code>ALUSrcB = 1</code>，控制ALU计算<code>PC + 4</code>。</li>
<li><strong>T3</strong>：根据指令类型生成不同的控制信号，例如：
<ul>
<li>R型指令：<code>ALUSrcA = 1</code>，<code>ALUSrcB = 0</code>，<code>ALUOp = R类型</code>。</li>
<li>LW/SW指令：<code>ALUSrcA = 1</code>，`ALUSrc</li>
</ul>
</li>
</ol>
<p>B = 2<code>，</code>ALUOp = 加法`。<br>
4. <strong>T4-T5</strong>：存储器访问或写寄存器阶段，生成相应的控制信号。</p>
<h5 id="完整的多周期控制信号表"><strong>完整的多周期控制信号表</strong></h5>
<table>
<thead>
<tr>
<th>状态</th>
<th>ALUSrcA</th>
<th>ALUSrcB</th>
<th>ALUOp</th>
<th>MemRead</th>
<th>MemWrite</th>
<th>RegWrite</th>
<th>PCWrite</th>
<th>IRWrite</th>
</tr>
</thead>
<tbody>
<tr>
<td>T1</td>
<td>0</td>
<td>1</td>
<td>加法</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>T2</td>
<td>1</td>
<td>0</td>
<td>加法</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>T3</td>
<td>1</td>
<td>2</td>
<td>加法</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>T4</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>1（LW）</td>
<td>1（SW）</td>
<td>1（R型）</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>T5</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>0</td>
<td>0</td>
<td>1（LW）</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<h4 id="mips多周期处理器的性能分析">MIPS多周期处理器的性能分析</h4>
<h5 id="指令周期数"><strong>指令周期数</strong></h5>
<p>在多周期处理器中，不同类型的指令需要不同的时钟周期数：</p>
<ul>
<li><strong>R型指令</strong>：4个时钟周期</li>
<li><strong>LW指令</strong>：5个时钟周期</li>
<li><strong>SW指令</strong>：4个时钟周期</li>
<li><strong>BEQ指令</strong>：3个时钟周期</li>
</ul>
<h5 id="时钟周期与cpi"><strong>时钟周期与CPI</strong></h5>
<p>多周期处理器的时钟周期时间取决于最慢的操作（如访问存储器），但CPI会根据指令类型的不同而变化。通过这种设计，多周期处理器可以有效地减少CPI，提高执行效率。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>CO</category>
        <category>理论课</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>CO</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
      </tags>
  </entry>
  <entry>
    <title>离散数学II笔记</title>
    <url>/2024/09/17/DiscreteMathematicsNote/</url>
    <content><![CDATA[<h1 id="离散数学ii">离散数学II</h1>
<h2 id="week1">week1</h2>
<h3 id="什么是离散数学">什么是离散数学</h3>
<h4 id="离散数学的研究对象和应用">离散数学的研究对象和应用</h4>
<ul>
<li>离散数学研究离散对象，一切以离散现象作为其研究对象或对象之一的数学均称为离散数学，其研究各种各样的离散量的结构及之间的关系。分析、方程等研究连续对象</li>
<li>离散数学在基础数学研究、计算机科学、编码与密码学、物理、化学、生物等领域均有重要应用。</li>
<li>计算机是一种离散结构，离散数学充分面熟计算机科学的离散性特点，是研究计算机科学的基本数学工具和最合适的理论手段</li>
</ul>
<h4 id="离散数学-基础数学工具">离散数学:基础数学工具</h4>
<ul>
<li>将信息转换成数学符号后，存储、传播、理解<br>
和处理的速度、效率急剧提升，<strong>没有二义性</strong></li>
<li>数学符号带来程序语言</li>
</ul>
<h4 id="离散数学的发展历史">离散数学的发展历史</h4>
<h4 id="离散数学主要内容">离散数学主要内容</h4>
<ul>
<li>离散数学是现代数学的一个分支</li>
<li>[x] 数理逻辑</li>
<li>[ ] 集合论</li>
<li>[ ] 图论</li>
<li>[ ] 代数系统</li>
<li>[ ] 有限状态机</li>
</ul>
<h3 id="数理逻辑">数理逻辑</h3>
<h4 id="常用的二元逻辑联结词">常用的二元逻辑联结词</h4>
<p>合取<code>^</code>、析取<code>v</code>、否定<code>~</code>、蕴含<code>-&gt;</code>、等价<code>&lt;-&gt;</code><br>
它们的真值表如下</p>
<table>
<thead>
<tr>
<th></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∧</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\wedge B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∨</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\vee B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">¬</mi><mi>A</mi></mrow><annotation encoding="application/x-tex">\lnot A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">¬</span><span class="mord mathnormal">A</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\rightarrow B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>↔</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\leftrightarrow B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">↔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td>T</td>
<td>T</td>
<td>T</td>
<td>T</td>
<td>T</td>
<td>F</td>
<td>T</td>
<td>T</td>
</tr>
<tr>
<td>T</td>
<td>T</td>
<td>F</td>
<td>F</td>
<td>T</td>
<td>F</td>
<td>F</td>
<td>F</td>
</tr>
<tr>
<td>T</td>
<td>F</td>
<td>T</td>
<td>F</td>
<td>T</td>
<td>F</td>
<td>T</td>
<td>F</td>
</tr>
<tr>
<td>T</td>
<td>F</td>
<td>F</td>
<td>F</td>
<td>F</td>
<td>T</td>
<td>T</td>
<td>T</td>
</tr>
</tbody>
</table>
<h4 id="谓词">谓词</h4>
<ul>
<li>在逻辑学中，将命题中表示思维对象的词称为主<br>
词，将表示对象性质的词称为谓词。</li>
</ul>
<blockquote>
<p>a：张华 b：李明 H(x)：x 是学生<br>
这两个命题分别表示为 H(a) 和 H(b)，这样的表示就<br>
显示了这两个命题有相同谓词的特征 。</p>
</blockquote>
<ul>
<li>二元谓词:L 表示元素之间的关系，可看作从 D<sup>2</sup> 到 {0, 1}的函数，称为二元谓词。若 x 爱 y，则 L(x, y) = 1，否则 L(x, y) = 0。</li>
</ul>
<blockquote>
<p>函数与谓词的区别在于：对于一元函数 f， f(x) 是论域中的元素；对于一元谓词 P， P(x) 是 0 或 1。<br>
需要注意：这里的函数 f 是单值函数，并且 f 的自变量和函数值都取自同一个集合 D，还要求 f 是全函数，即对于任意 xÎD， f(x) 有定义。因此，用 f (x) 表示 x 的父亲确实定义了一个函数，因为每个人都有唯一的父亲，并且任何人的父亲也是人。<br>
如果用f(x)表示 x 的舅舅，那么并没有定义一个函数，因为有的人有多个舅舅，即 f 不是单值函数，并且有的人没有舅舅，即 f 不是全函数。<br>
这种自变量和函数值都取自同一个集合 D 的函数称为 D 上的运算。</p>
</blockquote>
<h3 id="集合论">集合论</h3>
<ul>
<li>合论是研究集合一般性质的数学分支，创始人是康托尔<br>
（G.Cantor）</li>
<li>康托尔建立的集合论一般称为朴素集合论</li>
<li>在现代数学中，每个对象本质上都是集合，都可以用某种集合来定义。</li>
<li>由于集合论的语言适应于描述和研究离散对象及其关系，<br>
它也是计算机科学与工程的基础理论和表达工具，而且在程序设计、数据结构、形式语言、关系数据库、操作系统等计算机科学分支领域都有重要的应用。</li>
</ul>
<h3 id="图论">图论</h3>
<ul>
<li>图论是一个古老的数学分支，它的创始人是18世纪的数学家欧拉（Euler）</li>
<li>1736年欧拉解决了哥尼斯堡七桥问题，奠定图论和拓扑学的基础。</li>
<li>1847年，物理学家基尔霍夫（Kirchhoff）将图论应用于电网，引进“树”的概念。</li>
<li>1859年哈密顿提出周游世界游戏—图论应用于数学游戏研究中</li>
<li>1850年著名难题“四色猜想”，直到1976年由美国的阿普尔（Appel）、黑肯（Hakan）和考齐（Koch）利用电子计算机加以解决。</li>
</ul>
<h3 id="代数系统">代数系统</h3>
<ul>
<li>19世纪伽罗瓦（Galois）提出群的概念。</li>
<li>20世纪以来，代数学研究对象和研究方法发生了重大变革，形成了抽象代数学。抽象代数学研究一般的数学结构，它对现代数学研究具有基本的重要性。在计算机科学研究中占有重要的地位和作用，对计算机科学产生和发展具有决定性的影响。</li>
<li>没有抽象代数结构研究和数理逻辑研究的先行发展，图灵不可能在1936年提出图灵机这样的代数结构作为计算的模型。</li>
<li>20世纪50年代，关系代数理论能够作为数据库理论模型。</li>
<li>在计算机算法设计与分析中，代数算法研究占主导地位，便于形式描述、正确性和终止性证明以及复杂性分析。</li>
<li>代数系统是离散数学的重要组成部分。</li>
</ul>
<h3 id="如何学好离散数学">如何学好离散数学</h3>
<h3 id="延伸学习内容-算法">延伸学习内容:算法</h3>
<h3 id="chapter-1-集合的基本概念及其运算">Chapter 1 集合的基本概念及其运算</h3>
<h4 id="集合与元素">集合与元素</h4>
<ul>
<li>集合是人们能够<font color="red">明确区分</font>的一些对象(客体)构成的一个整体。 by contor, 1875</li>
<li>集合通常用<font color="blue">大写英文字母</font>表示，通常用：<br>
N 表示自然数集合(含0)， R 表示实数集合，<br>
Q 表示有理数集合， I (Z) 表示整数,I<sup>+</sup>表示正整数集合,I<sup>-</sup>表示负整数集合</li>
<li>元素：集合里含有的<font color="red">对象</font>称为该集合的元素。通常用<font color="red">小写英文字母</font>表示元素。<br>
如果a 是集合A的元素，则记为 a∈A，否则记为 a∉A</li>
</ul>
<h4 id="集合的表示方法">集合的表示方法</h4>
<ul>
<li>枚举法(外延法)：列举出集合中的所有元素，并用花括号括起来。例如：A={a,b,c}</li>
<li>抽象法：用谓词描述集合中元素的属性，其描述形式为{a|P(a)}，例如：A={x|x是自然数}</li>
</ul>
<blockquote>
<p>抽象原则:任给一个性质 P，就确定了一个集合A , A的元素恰好是具有性质P的对象，即:A = { x | P(x) }，也就是说，x ( P(x) &lt;-&gt; xA )</p>
</blockquote>
<h2 id="week-2">week 2</h2>
<h3 id="集合间的相等和包含关系">集合间的相等和包含关系</h3>
<h4 id="集合的相等">集合的相等</h4>
<ul>
<li>定义:设 A, B为任意两集合，若A和B含有相同的元素，则称A和B相等, 记作：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A=B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>
<ul>
<li>集合与其元素排列次序无关</li>
<li>集合与其元素重复出现次数无关</li>
<li>集合的元素可以是一个集合</li>
</ul>
</li>
</ul>
<h4 id="集合的包含关系">集合的包含关系</h4>
<ul>
<li>定义(子集或包含):若集合A的每一个元素都是集合 B 的元素，则称 A是 B 的子集，也称 A 包含于 B 或 B 包含 A 。记作：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\subseteq B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>，即：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>B</mi><mo>⇔</mo><mi mathvariant="normal">∀</mi><mi>x</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mi>A</mi><mo>→</mo><mi>x</mi><mo>∈</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A\subseteq B \Leftrightarrow \forall x(x\in A \rightarrow x\in B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∀</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></li>
<li>定义(真子集):若集合A是集合B的子集，且A不等于B，则称A是B的真子集，记作：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊂</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\subset  B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>，即：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊂</mo><mi>B</mi><mo>⇔</mo><mi mathvariant="normal">∀</mi><mi>x</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mi>A</mi><mo>→</mo><mi>x</mi><mo>∈</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∧</mo><mi mathvariant="normal">∃</mi><mi>x</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mi>B</mi><mo>∧</mo><mi>x</mi><mo mathvariant="normal">∉</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A\subset  B \Leftrightarrow \forall x(x\in A \rightarrow x\in B) \wedge \exists x(x\in B 
\wedge x\notin A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∀</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∃</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span></li>
</ul>
<h4 id="属于与包含的区别">属于与包含的区别</h4>
<ul>
<li>关系&quot;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∈</mo></mrow><annotation encoding="application/x-tex">\in</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span></span></span></span>“和”<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊆</mo></mrow><annotation encoding="application/x-tex">\subseteq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">⊆</span></span></span></span>&quot;的区别</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∈</mo></mrow><annotation encoding="application/x-tex">\in</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span></span></span></span>：构成集合A的元素a与A是&quot;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∈</mo></mrow><annotation encoding="application/x-tex">\in</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span></span></span></span>“关系<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊆</mo></mrow><annotation encoding="application/x-tex">\subseteq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">⊆</span></span></span></span>：集合A的子集B与A是”<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊆</mo></mrow><annotation encoding="application/x-tex">\subseteq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">⊆</span></span></span></span>&quot;关系</p>
<p>问题：设A，B为集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∈</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\in B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \subseteq B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>是否能同时成立？<br>
答：可以同时成立，设S={ {1，3}，4}，T={ {1，3}，4，{ {1，3}，4} }，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>∈</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">S\in T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>⊆</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">S\subseteq T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409131000084.png" alt="例题"></p>
<p><strong>定理1</strong>：设A，B为集合，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A=B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 当且仅当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>B</mi><mo>⇔</mo><mi>B</mi><mo>⊆</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A\subseteq B\Leftrightarrow B\subseteq A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span><br>
<strong>定理2</strong>：设A、B、C为集合，若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\subseteq B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>⊆</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">B\subseteq C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A\subseteq C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></p>
<h3 id="两个特殊集合">两个特殊集合</h3>
<h4 id="全集">全集</h4>
<p>定义：在对集合的研究中，如果所讨论的<br>
集合，都是某一固定集合U的子集，称集合U为全集，<br>
记作 U，即<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>∨</mo><mi mathvariant="normal">¬</mi><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">U=\{x|P(x)\vee \lnot P(x) \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)}</span></span></span></span></p>
<h4 id="空集">空集</h4>
<ul>
<li>定义：不含有任何元素的集合称为空集, 记作 $\varnothing $ ，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∅</mi><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>∨</mo><mi mathvariant="normal">¬</mi><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\varnothing = \{x | P(x)\vee \lnot P(x) \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6633em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)}</span></span></span></span>，其中P(x)是任意谓词。</li>
<li>定理3：设A是任意集合，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∅</mi><mo>⊆</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\varnothing \subseteq A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord amsrm">∅</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>。</li>
<li>定理4：空集是唯一的。</li>
</ul>
<h3 id="幂集">幂集</h3>
<h4 id="幂集的定义">幂集的定义</h4>
<ul>
<li>定义：集合 A 的全部子集构成的集合称为A的幂集， 记作 P(A)，即<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mi>X</mi><mtext>│</mtext><mi>X</mi><mo>⊆</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">P(A) = \{X│X⊆A \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord">│</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">}</span></span></span></span></li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409131158702.png" alt></p>
<h4 id="有穷集的幂集的基数">有穷集的幂集的基数</h4>
<ul>
<li>
<p>有穷集的基数的定义：<br>
有穷集合A中所含有元素的个数称为 A 的基数。 记作 #A(或 |A|，n(A))。</p>
</li>
<li>
<p>定理5：设A为有穷集，则#P(A)=2<sup>#A</sup></p>
</li>
</ul>
<h3 id="集合的运算">集合的运算</h3>
<p>∩（交）、∪（并）、－（差 ，也称相对补）、~（补，也称绝对补）、 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊕</mo></mrow><annotation encoding="application/x-tex">\oplus</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⊕</span></span></span></span> （对称差）、$\bigcap  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>（广义交）、</mtext></mrow><annotation encoding="application/x-tex">（广义交）、</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">（广义交）、</span></span></span></span>\bigcup  $（广义并）</p>
<h4 id="交-并-差">交、并、差</h4>
<ul>
<li>定义：设 A 和 B 是任意两个集合，<br>
(1) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mi>B</mi><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>∈</mo><mi>A</mi><mo>∧</mo><mi>x</mi><mo>∈</mo><mi>B</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A∩B = \{ x | x∈A ∧ x∈B \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">}</span></span></span></span><br>
(2) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mi>B</mi><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>∈</mo><mi>A</mi><mo>∨</mo><mi>x</mi><mo>∈</mo><mi>B</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A∪B = \{ x | x∈A ∨ x∈B \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">}</span></span></span></span><br>
(3) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext>－</mtext><mi>B</mi><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>∈</mo><mi>A</mi><mo>∧</mo><mi>x</mi><mo mathvariant="normal">∉</mo><mi>B</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A－B = \{ x | x∈A ∧ x\notin B \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">}</span></span></span></span></li>
<li>定义：若集合 A 和 B 没有公共元素，即$ A∩B =\varnothing $，则称 A 和 B 是不相交的。</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409191642920.png" alt></p>
<h4 id="补集">补集</h4>
<ul>
<li>定义：设A是全集U的子集，A 相对于 U 的补<br>
集$ U－A $称为 A 的绝对补集，简称A的补集，记作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\sim A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> ，即<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo><mi>A</mi><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>∈</mo><mi>U</mi><mo>∧</mo><mi>x</mi><mo mathvariant="normal">∉</mo><mi>A</mi><mo stretchy="false">}</mo><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">¬</mi><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\sim A = \{ x | x∈U ∧ x\notin A \}= \{x | \lnot (x\in A) \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mord">∣¬</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)}</span></span></span></span></li>
</ul>
<h4 id="对称差集">对称差集</h4>
<ul>
<li>定义：: 设 A 和 B 是任意两个集合，A<br>
和 B 的对称差集，记为 AÅB ，定义为<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊕</mo><mi>B</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mtext>－</mtext><mi>B</mi><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">(</mo><mi>B</mi><mtext>－</mtext><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A\oplus B = ( A－B)\cup (B－A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span></li>
</ul>
<blockquote>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊕</mo><mi>B</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mo>∼</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∩</mo><mo>∼</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A \oplus B = ( A\cap \sim B )∪ (B \cap \sim A )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord">∩</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∩</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊕</mo><mi>B</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="false">)</mo><mtext>－</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A\oplus B = (A\cup B) －(A\cap B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mord cjk_fallback">－</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></p>
</blockquote>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409191620074.png" alt></p>
<h4 id="集合运算的性质">集合运算的性质</h4>
<ul>
<li>定理6：设A、B、C为任意集合，则
<ol>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>A</mi><mo>∪</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \subseteq  A\cup B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>⊆</mo><mi>A</mi><mo>∪</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">B\subseteq A\cup B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>;</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mi>B</mi><mo>⊆</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A\cap B \subseteq A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mi>B</mi><mo>⊆</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A\cap B\subseteq B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext>－</mtext><mi>B</mi><mo>⊆</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A－B \subseteq A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>;</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext>－</mtext><mi>B</mi><mo>=</mo><mi>A</mi><mo>∩</mo><mo>∼</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A－B = A\cap \sim B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord">∩</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>；</li>
<li>若$ A \subseteq B$，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo><mi>B</mi><mo>⊆</mo><mo>∼</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\sim B\subseteq  \sim A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>；</li>
<li>若$A \subseteq C <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>且</mtext></mrow><annotation encoding="application/x-tex">且</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">且</span></span></span></span> B \subseteq C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>，则</mtext></mrow><annotation encoding="application/x-tex">，则</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">，则</span></span></span></span> A\cup B \subseteq C$；</li>
<li>若$ A \subseteq B <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>且</mtext></mrow><annotation encoding="application/x-tex">且</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">且</span></span></span></span> A \subseteq C<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>，则</mtext></mrow><annotation encoding="application/x-tex">，则</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">，则</span></span></span></span> A \subseteq B\cap C$。</li>
</ol>
</li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
        <category>离散</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
        <tag>离散</tag>
      </tags>
  </entry>
  <entry>
    <title>离散数学II笔记(2)</title>
    <url>/2024/09/19/DiscreteMathmaticsNote2/</url>
    <content><![CDATA[<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
</head>
<h2 id="week-3">week 3</h2>
<h3 id="集合的运算-续">集合的运算（续）</h3>
<h4 id="集合的基本定义">集合的基本定义</h4>
<ul>
<li><strong>集合表示</strong>：集合通常用大写字母表示，如A、B、C等，元素用小写字母表示，如x、y、z等。</li>
<li><strong>集合的基本运算</strong>：
<ul>
<li><strong>并集（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∪</mo></mrow><annotation encoding="application/x-tex">\cup</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∪</span></span></span></span>）</strong>：A ∪ B 表示所有属于A或B的元素。</li>
<li><strong>交集（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∩</mo></mrow><annotation encoding="application/x-tex">\cap</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∩</span></span></span></span>）</strong>：A ∩ B 表示所有既属于A又属于B的元素。</li>
<li><strong>差集（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">−</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span></span></span></span>）</strong>：A − B 表示属于A但不属于B的元素。</li>
<li><strong>补集（ ~ ）</strong>：~A 表示不属于A的所有元素。</li>
</ul>
</li>
</ul>
<h4 id="集合的基本定律">集合的基本定律</h4>
<ol>
<li><strong>幂等律</strong>：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mi>A</mi><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A ∪ A = A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mi>A</mi><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A ∩ A = A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
</ul>
</li>
<li><strong>交换律</strong>：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mi>B</mi><mo>=</mo><mi>B</mi><mo>∪</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A ∪ B = B ∪ A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mi>B</mi><mo>=</mo><mi>B</mi><mo>∩</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A ∩ B = B ∩ A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
</ul>
</li>
<li><strong>结合律</strong>：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∪</mo><mi>C</mi><mo>=</mo><mi>A</mi><mo>∪</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∪</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(A ∪ B) ∪ C = A ∪ (B ∪ C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∩</mo><mi>C</mi><mo>=</mo><mi>A</mi><mo>∩</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∩</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(A ∩ B) ∩ C = A ∩ (B ∩ C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li><strong>分配律</strong>：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∩</mo><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∩</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A ∪ (B ∩ C) = (A ∪ B) ∩ (A ∪ C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∪</mo><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A ∩ (B ∪ C) = (A ∩ B) ∪ (A ∩ C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li><strong>同一律</strong>：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mi mathvariant="normal">∅</mi><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A \cup \varnothing = A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6633em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mi>U</mi><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A \cap U = A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
</ul>
</li>
<li><strong>零律</strong>：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mi>U</mi><mo>=</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">A \cup U = U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></li>
<li>$A \cap \varnothing =\varnothing $</li>
</ul>
</li>
<li><strong>吸收律</strong>：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A ∪ (A ∩ B) = A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A \cap (A \cup B) = A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></li>
</ul>
</li>
<li><strong>德·摩根律</strong>：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mo>∼</mo><mi>A</mi><mo>∩</mo><mo>∼</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">\sim (A ∪ B) =\sim A ∩\sim B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord">∩</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mo>∼</mo><mi>A</mi><mo>∪</mo><mo>∼</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">\sim (A ∩ B) =\sim A ∪\sim B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord">∪</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li>
</ul>
</li>
<li><strong>对合律</strong>：
<ul>
<li>$ \sim (\sim A) = A$</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∼</mo><mi mathvariant="normal">∅</mi><mo>=</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">\sim \varnothing = U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6633em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></li>
<li>$\sim U =\varnothing $</li>
</ul>
</li>
<li><strong>否定律</strong>：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mo>∼</mo><mi>A</mi><mo>=</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">A ∪ \sim A = U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord">∪</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span></li>
<li>$A \cap \sim A = \empty $</li>
</ul>
</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409191706058.png" alt></p>
<blockquote>
<p>在不含 ~ 的集合恒等式中，将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∪</mo></mrow><annotation encoding="application/x-tex">∪</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∪</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∩</mo></mrow><annotation encoding="application/x-tex">\cap</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∩</span></span></span></span>互换 ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">\varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6633em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>互换，得到的仍是集合恒等式。——<font color="red"> 对偶原理</font><br>
将不含$\rightarrow $和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>↔</mo></mrow><annotation encoding="application/x-tex">\leftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">↔</span></span></span></span>的命题逻辑等值式中的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∨</mo></mrow><annotation encoding="application/x-tex">\vee</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∨</span></span></span></span> 换为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∪</mo></mrow><annotation encoding="application/x-tex">\cup</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∪</span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∧</mo></mrow><annotation encoding="application/x-tex">\wedge</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∧</span></span></span></span> 换为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∩</mo></mrow><annotation encoding="application/x-tex">\cap</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∩</span></span></span></span> ，$\lnot <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>换为</mtext></mrow><annotation encoding="application/x-tex">换为</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">换为</span></span></span></span>\sim$ ，0 换为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">\varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6633em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span></span></span></span> ，1 换为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇔</mo></mrow><annotation encoding="application/x-tex">\Leftrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">⇔</span></span></span></span>换为 = ，就得到集合恒等式。</p>
</blockquote>
<h4 id="集合运算的性质">集合运算的性质</h4>
<ul>
<li>定理7：设 A 和 B是全集U的子集，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mo>∼</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">B =\sim A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 当且仅当$A ∪ B = U <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>和</mtext></mrow><annotation encoding="application/x-tex">和</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">和</span></span></span></span> A ∩ B = \varnothing $。</li>
<li>定理 8：设 A 和 B是全集U的子集，则下列命题等价：<br>
(1)<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \subseteq B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>；(2)<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mi>B</mi><mo>=</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A∪B = B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>; (3)$ A ∩ B = A<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo separator="true">;</mo><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">; (4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">4</span><span class="mclose">)</span></span></span></span> A – B =\varnothing $</li>
</ul>
<blockquote>
<p>证明两个集合相等常用以下两种方法：<br>
（1）集合相等定义 （元素分析法）<br>
（2）集合运算的基本定律（等式推理）</p>
</blockquote>
<h4 id="交-并的推广">交、并的推广</h4>
<h4 id="广义并与广义交">广义并与广义交</h4>
<p>设  A<sub>1</sub>, A<sub>2</sub>, ……, A<sub>n</sub> 为集合，则：</p>
<ul>
<li>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo>∩</mo><msub><mi>A</mi><mn>2</mn></msub><mo>∩</mo><mo>⋯</mo><mo>∩</mo><msub><mi>A</mi><mi>n</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mi>x</mi><mo>∈</mo><msub><mi>A</mi><mn>1</mn></msub><mo>∧</mo><mi>x</mi><mo>∈</mo><msub><mi>A</mi><mn>2</mn></msub><mo>∧</mo><mo>⋯</mo><mo>∧</mo><mi>x</mi><mo>∈</mo><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A_1 \cap A_2 \cap \cdots \cap A_n = \{x \,|\, x \in A_1 \land x \in A_2 \land \dots \land x \in A_n\} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span></p>
</li>
<li>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo>∪</mo><msub><mi>A</mi><mn>2</mn></msub><mo>∪</mo><mo>⋯</mo><mo>∪</mo><msub><mi>A</mi><mi>n</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mi>x</mi><mo>∈</mo><msub><mi>A</mi><mn>1</mn></msub><mo>∨</mo><mi>x</mi><mo>∈</mo><msub><mi>A</mi><mn>2</mn></msub><mo>∨</mo><mo>⋯</mo><mo>∨</mo><mi>x</mi><mo>∈</mo><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A_1 \cup A_2 \cup \cdots \cup A_n = \{x \,|\, x \in A_1 \lor x \in A_2 \lor \dots \lor x \in A_n\} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span></p>
</li>
</ul>
<p>分别记作：$ \bigcap_{i=1}^{n} A_i $ 和$\bigcup_{i=1}^{n} A_i $</p>
<p>对于无穷多个集合的交集和并集，则分别记为：</p>
<ul>
<li>$ \bigcap_{i=1}^{\infty} A_i = A_1 \cap A_2 \cap \dots \cap A_n \cap \dots $</li>
<li>$ \bigcup_{i=1}^{\infty} A_i = A_1 \cup A_2 \cup \dots \cup A_n \cup \dots $</li>
<li>定义 (集类或集合族) : 如果一个集合的所有元素都是集合，则称该集合为集类。</li>
<li>定义（广义并、广义交）：设 ( \mathcal{B} ) 为任意集类，则</li>
</ul>
<ol>
<li>集合 $ { x ,|, \exists X (X \in \mathcal{B} \land x \in X) } $ 称为 $\mathcal{B} $ 的广义并，记为 $ \cup \mathcal{B}  $。</li>
<li>若 <font color="red">$ \mathcal{B} \neq \varnothing $</font>，则集合 $ { x |, \forall X (X \in \mathcal{B} \rightarrow x \in X) } $ 称为 $ \mathcal{B} $ 的广义交，记为 $ \cap \mathcal{B} $。</li>
</ol>
<blockquote>
<p>若 $ B = \varnothing $，则 $ \cap B $ 无意义，因为对于任意 $ X \in B $，条件 $ X \in B \rightarrow x \in X $ 的前件为假，因此结论为真，导致 $ \cap B $ 等于全集 $ U $。</p>
</blockquote>
<ul>
<li>
<p><strong>定理9</strong>：广义的交、并运算设 ( A ) 为任意集合，( \mathcal{B} ) 为任意集合族，则有：<br>
(1) 若 ( B \neq \varnothing )，则 $ A \cup (\cup B) = \cup { A \cup X ,|, X \in B } $<br>
(2) 若 ( B \neq \varnothing )，则 $ A \cap (\cap B) = \cap { A \cap X ,|, X \in B } $<br>
(3) 若 ( B \neq \varnothing )，则 $ A \cup (\cap B) = \cap { A \cup X ,|, X \in B } $<br>
(4) $ A \cap (\cup B) = \cup { A \cap X ,|, X \in B } $<br>
(5) 若 ( B \neq \varnothing )，则 $ \sim (\cap B) = \cup { \sim X ,|, X \in B } $<br>
(6) 若 ( B \neq \varnothing )，则 $ \sim (\cup B) = \cap { \sim X ,|, X \in {B} } $</p>
</li>
<li>
<p><strong>定理10</strong>：设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>为任意集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">B</mi></mrow><annotation encoding="application/x-tex">\mathcal{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span></span></span> 为任意集合族，则，<br>
(1) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>∈</mo><mi mathvariant="script">B</mi></mrow><annotation encoding="application/x-tex">B\in \mathcal {B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∩</mo><mi>B</mi><mo>∈</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">\cap B \in B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord">∩</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>∈</mo><mo>∪</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">B \in \cup B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∪</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span><br>
(2) 若对任意<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>∈</mo><mi mathvariant="script">B</mi></mrow><annotation encoding="application/x-tex">B \in \mathcal B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span></span></span> 都有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>⊆</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">B \subseteq A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∩</mo><mi>B</mi><mo>⊆</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\cap B \subseteq A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord">∩</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span><br>
(3) 若对任意<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>∈</mo><mi mathvariant="script">B</mi></mrow><annotation encoding="application/x-tex">B \in \mathcal B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.03041em;">B</span></span></span></span> 都有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \subseteq B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mo>∩</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \subseteq \cap B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∩</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></p>
</li>
</ul>
<hr>
<h3 id="有穷集的计数原理">有穷集的计数原理</h3>
<ul>
<li>
<p>引理1：若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>是有穷集合，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∩</mo><mi>B</mi><mtext>＝</mtext><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">A∩B＝\varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.765em;vertical-align:-0.0817em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">＝</span><span class="mord amsrm">∅</span></span></span></span>，则<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>＃</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>＃</mtext><mi>A</mi><mo>+</mo><mtext>＃</mtext><mi>B</mi></mrow><annotation encoding="application/x-tex">＃(A∪B) = ＃A+＃ B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">＃</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord cjk_fallback">＃</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">＃</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></p>
</li>
<li>
<p>定理：若 A 和 B 是有穷集合，则<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>＃</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>＃</mtext><mi>A</mi><mtext>＋＃</mtext><mi>B</mi><mtext>－＃</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">＃( A∪B ) = ＃A＋＃B －＃(A∩B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">＃</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">＃</span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">＋＃</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">－＃</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span><br>
证明：<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409200838779.png" alt></p>
</li>
<li>
<p>推论：若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>是有穷集合，则<br>
$＃(A∪B ∪C), ＝, ＃A＋＃B＋＃C  － ＃(A∩B) －＃(A∩C)－＃(B∩C)＋ ＃(A∩B ∩C) $</p>
</li>
</ul>
<h3 id="集合的归纳定义法">集合的归纳定义法</h3>
<h4 id="归纳定义法">归纳定义法</h4>
<ol>
<li><strong>基本项</strong>：非空集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub><mo>⊆</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">S_0 \subseteq A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>； （规定A的一些生成元）</li>
<li><strong>归纳项</strong>：一组规则，从 A 中元素出发，依据这些规则所获得的元素仍然是 A 中的元素；</li>
<li><strong>极小化</strong>：<br>
(a) A 中的每个元素都是通过有限次使用1) 或 2)获得的。<br>
(b) 如果集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>⊆</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">S \subseteq A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 也满足 1)和 2)，则 S = A 。</li>
</ol>
<h3 id="有序偶和笛卡尔乘积">有序偶和笛卡尔乘积</h3>
<h4 id="有序偶">有序偶</h4>
<p><strong>定义</strong>：1（有序偶）任给两个对象 x 和 y，将它们按规定的顺序构成的序列，称之为有序偶，记为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt; x, y &gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>。其中，x 称为有序偶的第一元，y 称为第二元。</p>
<blockquote>
<p>注意：有序偶≠二元集，有序偶是有顺序的</p>
</blockquote>
<p><strong>有序偶的集合定义</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mo>=</mo><mo stretchy="false">{</mo><mtext> </mtext><mo stretchy="false">{</mo><mi>x</mi><mo stretchy="false">}</mo><mo separator="true">,</mo><mo stretchy="false">{</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">}</mo><mtext> </mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">&lt;x,y&gt;=\{\, \{ x\},\{ x,y\}\,\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mclose">}</span></span></span></span></p>
<p><strong>有序偶的唯一性定理</strong>：若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mo>=</mo><mo>&lt;</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;x,y&gt;=&lt;u,v&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">x=u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span>且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">y=v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>。</p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202409251421270.png" alt><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409251422379.png" alt></p>
<p><strong>n元序偶定义：</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo>&gt;</mo><mo>=</mo><mo>&lt;</mo><mo>&lt;</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo>&gt;</mo><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>&gt;</mo><mtext>，</mtext><mi>n</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">&lt;x_1,x_2,...,x_n&gt;=&lt;&lt;x_2,...,x_n&gt;,x_1&gt;，n&gt;2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>。<br>
<strong>定理</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo>&gt;</mo><mo>=</mo><mo>&lt;</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;x_1,x_2,...,x_n&gt;=&lt;y_1,y_2,...,y_n&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>当且仅当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i=y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>n</mi><mtext>，</mtext><mi>n</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">i=1,2,...,n，n&gt;2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>。</p>
<h4 id="笛卡尔乘积">笛卡尔乘积</h4>
<p><strong>定义</strong>：设 A，B 是任意两个集合，则称集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mi>B</mi><mo>=</mo><mo stretchy="false">{</mo><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><mi>x</mi><mo>∈</mo><mi>A</mi><mo>∧</mo><mi>y</mi><mo>∈</mo><mi>B</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A×B=\{&lt;x,y&gt;\,|\,x\in A \wedge y\in B\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">}</span></span></span></span> 为集合 A 和 B 的笛卡尔乘积。<br>
<strong>性质</strong>：</p>
<ol>
<li>不满足交换律</li>
<li>不满足结合律</li>
<li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi mathvariant="normal">∅</mi><mtext>或</mtext><mi>B</mi><mo>=</mo><mi mathvariant="normal">∅</mi><mtext>时，</mtext><mi>A</mi><mo>×</mo><mi>B</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">A=\varnothing 或B=\varnothing 时，A\times  B = \varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.765em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span><span class="mord cjk_fallback">或</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord amsrm">∅</span><span class="mord cjk_fallback">时，</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6633em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">#</mi><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">#</mi><mi>A</mi><mo separator="true">⋅</mo><mi mathvariant="normal">#</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">\#(A×B)=\#A·\#B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">#</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">#</span><span class="mord mathnormal">A</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">#</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>（A，B为任意有限集）</li>
</ol>
<p><strong>定理</strong>：$A\times B = \varnothing <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>当且仅当</mtext></mrow><annotation encoding="application/x-tex">当且仅当</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">当且仅当</span></span></span></span>A=\varnothing<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>或</mtext></mrow><annotation encoding="application/x-tex">或</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">或</span></span></span></span>B=\varnothing$。</p>
<p><strong>定理</strong>：若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mi>B</mi><mo>⊆</mo><mi>C</mi><mo>×</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">A×B \subseteq C×D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>，当且仅当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>⊆</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A\subseteq C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>⊆</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">B\subseteq D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>。<br>
<strong>定理</strong>：若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mi>B</mi><mo>=</mo><mi>C</mi><mo>×</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">A×B = C×D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>，当且仅当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A=C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">B=D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>。</p>
<p><strong>定理</strong> 设 A，B 和 C 为任意三个集合，则<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∪</mo><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A×(B∪C) = (A×B)∪(A×C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>；<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="false">)</mo><mo>×</mo><mi>C</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">(</mo><mi>B</mi><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(A∪B)×C = (A×C)∪(B×C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>；<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∩</mo><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∩</mo><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A×(B∩C) = (A×B)∩(A×C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>；<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo stretchy="false">)</mo><mo>×</mo><mtext>Ｃ</mtext><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo><mo>∩</mo><mo stretchy="false">(</mo><mi>B</mi><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(A∩B)×Ｃ= (A×C)∩(B×C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">Ｃ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>；<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mo stretchy="false">(</mo><mi>B</mi><mtext>–</mtext><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>B</mi><mo stretchy="false">)</mo><mtext>–</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A×(B – C) = (A×B) – (A×C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">–</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mord">–</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>；<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mtext>–</mtext><mi>B</mi><mo stretchy="false">)</mo><mo>×</mo><mi>C</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo><mtext>–</mtext><mo stretchy="false">(</mo><mi>B</mi><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(A – B)×C = (A×C) – (B×C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord">–</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord">–</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>。</p>
<p><strong>n个集合的笛卡尔乘积</strong>：设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_1,A_2,...,A_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为任意n个集合，则称集合<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo>×</mo><msub><mi>A</mi><mn>2</mn></msub><mo>×</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>×</mo><msub><mi>A</mi><mi>n</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mo>&lt;</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo>&gt;</mo><mtext> </mtext><mi mathvariant="normal">∣</mi><mtext> </mtext><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A_1×A_2×...×A_n=\{&lt;x_1,x_2,...,x_n&gt;\,|\,x_i\in A_i,i=1,2,...,n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">}</span></span></span></span>为n个集合的笛卡尔乘积，特别的，将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo>×</mo><msub><mi>A</mi><mn>2</mn></msub><mo>×</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>×</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_1×A_2×...×A_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>记为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">A^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>离散</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
        <tag>离散</tag>
      </tags>
  </entry>
  <entry>
    <title>离散数学II笔记(3)</title>
    <url>/2024/09/25/DiscreteMathmaticsNote3/</url>
    <content><![CDATA[<h3 id="关系及其性质">关系及其性质</h3>
<h4 id="关系的定义">关系的定义</h4>
<p><strong>定义</strong>（关系）：设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>∈</mo><msub><mi>I</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">n\in I_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>, 且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_1, A_2, …, A_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为n个任意的集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>∈</mo><msub><mi>A</mi><mn>1</mn></msub><mo>×</mo><msub><mi>A</mi><mn>2</mn></msub><mo>×</mo><mo>…</mo><mo>×</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R \in A_1 \times A_2 \times … \times A_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<br>
(1) 称R为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_1, A_2, …, A_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>间的n元关系；<br>
(2) 若n=2，则称R为从A1到A2的二元关系；<br>
(3) 若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">R= \varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6633em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span></span></span></span>, 则称R为空关系；<br>
(4) 若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><msub><mi>A</mi><mn>1</mn></msub><mo>×</mo><msub><mi>A</mi><mn>2</mn></msub><mo>×</mo><mo>…</mo><mo>×</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R= A_1 \times A_2 \times … \times A_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，则称R为全关系<br>
(5) 若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo>=</mo><msub><mi>A</mi><mn>2</mn></msub><mo>=</mo><mo>…</mo><mo>=</mo><msub><mi>A</mi><mi>n</mi></msub><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A_1 = A_2 = … = A_n =A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>, 则称R为A上的n元关系</p>
<blockquote>
<p>对于于二元关系R，<br>
若 &lt;x, y&gt;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∈</mo></mrow><annotation encoding="application/x-tex">\in</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span></span></span></span>R , 则可表示成 x R y , 读做“x与y有关系R”<br>
若 &lt;x, y&gt;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo mathvariant="normal">∉</mo></mrow><annotation encoding="application/x-tex">\notin</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span></span></span></span>R , 则记作 x <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>R</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span> y, 读作“ x与y不存在关系R</p>
</blockquote>
<p>两类特殊关系：<br>
X上的全(域)关系:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>X</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mo>&lt;</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo>&gt;</mo><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo>∈</mo><mi>X</mi><mo stretchy="false">}</mo><mo>=</mo><mi>X</mi><mo>×</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">U_X = \{ &lt;x_i , x_j &gt; | x_i ,x_j\in X \} = X \times X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8252em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span><br>
X上的恒等关系：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>X</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>x</mi><mo>&gt;</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mo>∈</mo><mi>X</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">I_X = \{ &lt; x, x &gt; | x \in X \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">}</span></span></span></span></p>
<p><strong>关系的相等</strong> 定义：设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_1, A_2, …, A_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>间的n元关系， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>B</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>B</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">B_1, B_2, …, B_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>间的m元关系．如果<br>
(1) n=m;<br>
(2) 若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1≤ i ≤ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7955em;vertical-align:-0.136em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, 则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i=B_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>;<br>
(3) 把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>作为集合看，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>=</mo><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_1=R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>．<br>
则称n元关系<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>与m元关系<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>相等，记为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>=</mo><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_1=R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<blockquote>
<p>与集合相等的区别？<br>
例： 设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>⊆</mo><mi>N</mi><mo>×</mo><msub><mi>I</mi><mo>+</mo></msub><mtext>，</mtext><msub><mi>R</mi><mn>2</mn></msub><mo>⊆</mo><mi>I</mi><mo>×</mo><mi>I</mi><mo separator="true">,</mo><msub><mi>R</mi><mn>3</mn></msub><mo>⊆</mo><mi>I</mi><mo>×</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">R_1 \subseteq N \times I_+，R_2 \subseteq I \times I, R_3 \subseteq I \times I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>，且<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">{</mo><mo>&lt;</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>&gt;</mo><mi mathvariant="normal">∣</mi><mi>n</mi><mo>∈</mo><mi>N</mi><mo separator="true">,</mo><mi>m</mi><mo>∈</mo><msub><mi>I</mi><mo>+</mo></msub><mo separator="true">,</mo><mtext>且</mtext><mi>m</mi><mo>=</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R_1=\{&lt;n, m&gt; | n\in N, m\in I_+, 且m=n+1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">且</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">{</mo><mo>&lt;</mo><mi>n</mi><mo separator="true">,</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo>&gt;</mo><mi mathvariant="normal">∣</mi><mi>n</mi><mo>∈</mo><mi>I</mi><mo separator="true">,</mo><mtext>且</mtext><mi>n</mi><mo>≥</mo><mn>0</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R_2=\{&lt;n, n+1&gt; | n\in I, 且n≥0\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">且</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">}</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>3</mn></msub><mo>=</mo><mo stretchy="false">{</mo><mo>&lt;</mo><mi mathvariant="normal">∣</mi><mi>n</mi><mi mathvariant="normal">∣</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><mi>n</mi><mi mathvariant="normal">∣</mi><mo>+</mo><mn>1</mn><mo>&gt;</mo><mi mathvariant="normal">∣</mi><mi>n</mi><mo>∈</mo><mi>I</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R_3=\{&lt;|n|, |n|+1&gt; | n\in I\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">n</span><span class="mord">∣</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord mathnormal">n</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">}</span></span></span></span><br>
作为集合看，R1=R2=R3<br>
作为关系看，R1≠R2，R2=R3</p>
</blockquote>
<p><strong>定义</strong> 设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>⊆</mo><mi>A</mi><mo>×</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">R \subseteq A \times B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>, 令<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mo>∈</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∃</mi><mi>y</mi><mo>∈</mo><mi>B</mi><mtext>使</mtext><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mo>∈</mo><mi>R</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">dom (R) = \{ x\in A | \exist y \in B使 &lt;x, y&gt;\in R \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord">∣∃</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">使</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">}</span></span></span></span> ,<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mi>y</mi><mo>∈</mo><mi>B</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∃</mi><mi>x</mi><mo>∈</mo><mi>A</mi><mtext>使</mtext><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mo>∈</mo><mi>R</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">ran (R) = \{ y\in B | \exist x \in A 使 &lt;x , y&gt;\in R \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣∃</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">使</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">}</span></span></span></span>,<br>
称dom ®为R 的定义域， ran ®为R 的值域。</p>
<h4 id="二元关系的表示">二元关系的表示</h4>
<h5 id="关系图">关系图</h5>
<p>定义 6.4 (关系图) 设A和B为任意的非空有限集，R<br>
为任意从A到B的二元关系．以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A ∪B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>中的每个元素<br>
为一个结点，对每个&lt;x, y&gt;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∈</mo></mrow><annotation encoding="application/x-tex">\in</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span></span></span></span>R，皆画一条从x到y<br>
的有向边，就得到一个有向图G<sub>R</sub>, 称为R的关系图<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409251609576.png" alt></p>
<h5 id="关系矩阵">关系矩阵</h5>
<p>定义 6.5 (关系矩阵) 设A和B为任意的非空有限集，R<br>
为任意从A到B的二元关系．令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>a</mi><mi>m</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A = \{ a_1, a_2, …, a_m \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>b</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">B = \{ b_1, b_2, …, b_n \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>，R的关系矩阵，记作<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>R</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mo stretchy="false">)</mo><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">M_R=(r_{ij})_{m×n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>，其中</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mi>i</mi></msub><mtext> </mtext><mover accent="true"><mi>R</mi><mo stretchy="true">‾</mo></mover><mtext> </mtext><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mi>i</mi></msub><mtext> </mtext><mi>R</mi><mtext> </mtext><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">r_{ij} = \begin{cases} 0, &amp;x_i \, \overline R \,\, y_i \\ 1, &amp; x_i \, R \,\, y_i \end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410081121949.png" alt></p>
<h4 id="关系的性质">关系的性质</h4>
<h5 id="自反性">自反性</h5>
<p>定义 6.6 (自反性) 设R是A上的二元关系，如果对任意的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，都有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">xRx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">x</span></span></span></span>，则称R是自反的，否则称R是非自反的．</p>
<ul>
<li>在R的关系图中，每个顶点均有自环；</li>
<li>在R的关系矩阵中，主对角线的元素均为1．</li>
</ul>
<h5 id="反自反性">反自反性</h5>
<p>定义 6.7 (反自反性) 设R是A上的二元关系，如果对任意的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，都有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mover accent="true"><mi>R</mi><mo stretchy="true">‾</mo></mover><mi>x</mi></mrow><annotation encoding="application/x-tex">x \overline R x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord mathnormal">x</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span></span>，则称R是反自反的，否则称R是非反自反的．</p>
<ul>
<li>在R的关系图中，每个顶点均无自环；</li>
<li>在R的关系矩阵中，主对角线的元素均为0．</li>
</ul>
<h5 id="对称性">对称性</h5>
<p>定义 6.8 (对称性) 设R是A上的二元关系，如果对任意的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x, y \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，都有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mtext> </mtext><mi>R</mi><mtext> </mtext><mi>y</mi></mrow><annotation encoding="application/x-tex">x\, R\, y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>则称R是对称的，否则称R是非对称的．</p>
<ul>
<li>在R的关系图中，任意两个不同顶点之间：或者无弧或者有两条方向相反的弧；</li>
<li>R的关系矩阵是对称矩阵.</li>
</ul>
<h5 id="反对称性">反对称性</h5>
<p>定义 6.9 (反对称性) 设R是A上的二元关系，如果对任意的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x, y \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，都有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mtext> </mtext><mi>R</mi><mtext> </mtext><mi>y</mi></mrow><annotation encoding="application/x-tex">x\, R\, y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>则称R是对称的，否则称R是非对称的．</p>
<ul>
<li>在 R 的关系图中，任意不同顶点之间至多有一条弧;</li>
<li>在R的矩阵中,若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo mathvariant="normal">≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i\neq j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r_{ij} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> , 则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r_{ji} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ji</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>或 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">⋅</mo><msub><mi>r</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>0</mn><mo stretchy="false">(</mo><mi>i</mi><mo mathvariant="normal">≠</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r_{ij} · r_{ji}=0 (i \neq j )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7306em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ji</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></li>
</ul>
<h5 id="传递性">传递性</h5>
<p>定义 6.10 (传递性) 设R是A上的二元关系，如果对任意的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x, y, z \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，都有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xRy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>R</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">yRz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>则称R是传递的，否则称R是非传递的．</p>
<ul>
<li>在 R 的关系图中，若顶点 x 到顶点 y有一条路径，则必有从 x 到 y 的一条边</li>
<li>在关系矩阵：若有 k 使 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mi mathvariant="normal">.</mi><msub><mi>r</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r_{ik} . r_{kj} =1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">ik</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>, 则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r_{ij} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410081134509.png" alt></p>
<p><strong>关系图和关系矩阵中五种性质的表述</strong><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409251616268.png" alt></p>
<blockquote>
<p>只要不违反规则，就是符合规则的</p>
</blockquote>
<h3 id="关系的运算">关系的运算</h3>
<h4 id="关系的集合运算">关系的集合运算</h4>
<p><strong>集合运算定义</strong>：设R和S是从集合A到B的关系, 取全集为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>×</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A×B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>, 则<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>∩</mo><mi>S</mi><mo separator="true">,</mo><mi>R</mi><mo>∪</mo><mi>S</mi><mo separator="true">,</mo><mi>R</mi><mtext>－</mtext><mi>S</mi><mo separator="true">,</mo><mtext>～</mtext><mi>R</mi><mo separator="true">,</mo><mi>R</mi><mo>⊕</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">R∩S, R∪S, R－S, ～R, R \oplus  S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">～</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span><br>
仍是A到B的关系，并且对于任意 x∈A, y∈B:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mo>∩</mo><mi>S</mi><mo stretchy="false">)</mo><mi>y</mi><mo>⇔</mo><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mo>∈</mo><mi>R</mi><mo>∩</mo><mi>S</mi><mo>⇔</mo><mi>x</mi><mi>R</mi><mi>y</mi><mo>∧</mo><mi>x</mi><mi>S</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">x (R∩S) y\Leftrightarrow  &lt;x, y&gt;∈ R ∩ S\Leftrightarrow  x R y ∧ x S y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mo>∪</mo><mi>S</mi><mo stretchy="false">)</mo><mi>y</mi><mo>⇔</mo><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mo>∈</mo><mi>R</mi><mo>∪</mo><mi>S</mi><mo>⇔</mo><mi>x</mi><mi>R</mi><mi>y</mi><mo>∨</mo><mi>x</mi><mi>S</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">x (R∪S) y\Leftrightarrow  &lt;x, y&gt;∈ R ∪ S\Leftrightarrow x R y ∨ x S y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mtext>－</mtext><mi>S</mi><mo stretchy="false">)</mo><mi>y</mi><mo>⇔</mo><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mo>∈</mo><mi>R</mi><mtext>－</mtext><mi>S</mi><mo>⇔</mo><mi>x</mi><mi>R</mi><mi>y</mi><mo>∧</mo><mi>x</mi><mover accent="true"><mi>S</mi><mo stretchy="true">‾</mo></mover><mi>y</mi></mrow><annotation encoding="application/x-tex">x (R－S) y\Leftrightarrow &lt;x, y&gt;∈ R － S\Leftrightarrow x R y ∧ x \overline S y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">(</mo><mtext>～</mtext><mi>R</mi><mo stretchy="false">)</mo><mi>y</mi><mo>⇔</mo><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mo>∈</mo><mtext>～</mtext><mi>R</mi><mo>⇔</mo><mi>x</mi><mover accent="true"><mi>R</mi><mo stretchy="true">‾</mo></mover><mi>y</mi></mrow><annotation encoding="application/x-tex">x (～R) y\Leftrightarrow &lt;x, y&gt;∈ ～R\Leftrightarrow x \overline R y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord cjk_fallback">～</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">～</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mo>⊕</mo><mi>S</mi><mo stretchy="false">)</mo><mi>y</mi><mo>⇔</mo><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mo>∈</mo><mi>R</mi><mo>⊕</mo><mi>S</mi><mo>⇔</mo><mi>x</mi><mo stretchy="false">(</mo><mi>R</mi><mtext>－</mtext><mi>S</mi><mo stretchy="false">)</mo><mi>y</mi><mo>∨</mo><mi>x</mi><mo stretchy="false">(</mo><mi>S</mi><mtext>－</mtext><mi>R</mi><mo stretchy="false">)</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x (R \oplus S) y\Leftrightarrow  &lt;x, y&gt;∈ R \oplus S\Leftrightarrow  x (R－S) y ∨ x (S－R) y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord cjk_fallback">－</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></p>
<p><strong>集合运算下是否保持五个性质</strong>:<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410081153045.png" alt></p>
<h4 id="关系的逆运算">关系的逆运算</h4>
<p><strong>逆运算定义</strong>：(逆关系) 将关系R中每个有序偶的第一元和第二元对换所得到的关系, 称为R的逆关系，记作<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">R^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mtext>＝</mtext><mo stretchy="false">{</mo><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>&gt;</mo><mtext>｜</mtext><mo>&lt;</mo><mi>y</mi><mo separator="true">,</mo><mi>x</mi><mo>&gt;</mo><mo>∈</mo><mi>R</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R^{-1} ＝\{&lt;x, y&gt;｜&lt;y, x &gt;∈R \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">＝</span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord cjk_fallback">｜</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">}</span></span></span></span><br>
显然，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mtext>＝</mtext><mi>r</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dom(R^{-1})＝ran(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">＝</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mtext>＝</mtext><mi>d</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ran(R^{-1})＝dom(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">＝</span><span class="mord mathnormal">d</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span><br>
<strong>定理</strong>： 设A,B为非空有限集合,R为从A到B的二元关系．<br>
(1) M<sub>R<sup>-1</sup></sub>=M<sub>R</sub><sup>T</sup>（转置）<br>
(2) 把G<sub>R</sub>的每个有向边反向后, 得到R<sup>-1</sup>的关系图G<sub>R<sup>-1</sup></sub></p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410091855546.png" alt><br>
<strong>逆运算的性质</strong>：若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo separator="true">,</mo><msub><mi>R</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R, R_i (i=0, 1, 2, …)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mclose">)</span></span></span></span>都是从集合A到集合B的二元关系，K 为 N 的非空子集，则有<br>
(1) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">(R^{-1})^{-1}=R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>;<br>
(2) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext>～</mtext><mi>R</mi><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mtext>～</mtext><mo stretchy="false">(</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(～R)^{-1}= ～(R^{-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord cjk_fallback">～</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">～</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>;<br>
(3) 如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>⊆</mo><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_1\subseteq R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, 则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo>⊆</mo><msubsup><mi>R</mi><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">R_1^{-1}\subseteq R_2^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span></span>;<br>
(4) 如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>=</mo><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_1 =R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, 则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">R_1^{-1} =R_2^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span></span>;<br>
(5) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mo>⋃</mo><mrow><mi>𝒏</mi><mo>∈</mo><mi>K</mi></mrow></msub><msub><mi>R</mi><mi>𝒏</mi></msub><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msub><mo>⋃</mo><mrow><mi>𝒏</mi><mo>∈</mo><mi>K</mi></mrow></msub><mo stretchy="false">(</mo><msubsup><mi>R</mi><mi>𝒏</mi><mrow><mo>−</mo><mi>𝟏</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(⋃_{𝒏∈K} R_𝒏)^{-1}=⋃_{𝒏∈K}(R_𝒏^{-𝟏})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1412em;vertical-align:-0.3271em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">⋃</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.09426em;">n</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3271em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.09426em;">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1412em;vertical-align:-0.3271em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">⋃</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.09426em;">n</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3271em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.09426em;">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathbf mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>;<br>
(6) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mo>⋂</mo><mrow><mi>𝒏</mi><mo>∈</mo><mi>K</mi></mrow></msub><msub><mi>R</mi><mi>𝒏</mi></msub><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msub><mo>⋂</mo><mrow><mi>𝒏</mi><mo>∈</mo><mi>K</mi></mrow></msub><mo stretchy="false">(</mo><msubsup><mi>R</mi><mi>𝒏</mi><mrow><mo>−</mo><mi>𝟏</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(⋂_{𝒏∈K} R_𝒏)^{-1}=⋂_{𝒏∈K}(R_𝒏^{-𝟏})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1412em;vertical-align:-0.3271em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">⋂</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.09426em;">n</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3271em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.09426em;">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1412em;vertical-align:-0.3271em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">⋂</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.09426em;">n</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3271em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.09426em;">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathbf mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>;<br>
(7) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo>−</mo><msub><mi>R</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msubsup><mi>R</mi><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo>−</mo><msubsup><mi>R</mi><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">(R_1-R_2)^{-1}=R_1^{-1}-R_2^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span></span>;<br>
(8) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>R</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msubsup><mi>R</mi><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mo>⊕</mo><msubsup><mi>R</mi><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">(R_1\oplus R_2)^{-1}=R_1^{-1}\oplus R_2^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1205em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em;"><span style="top:-2.4337em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span></span>．</p>
<p><strong>定理</strong>：设R为集合A上的二元关系．则<br>
R是自反的（反自反、对称、反对称、传递）当且仅当R<sup>-1</sup>是自反的（反自反、对称、反对称、传递）<br>
<font color="red">逆运算保持关系的五个性质</font><br>
<strong>定理</strong>：集合A上的二元关系R是对称的当且仅当R=R<sup>-1</sup>。</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>∪</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">R∪R^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>是A上的包含R的最小对称关系;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>∩</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">R∩R^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>为A上的包含在R中的最大对称关系．<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo><mi>R</mi><mo>∩</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⊆</mo><mi>R</mi><mo>⊆</mo><mi>R</mi><mo>∪</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\Rightarrow R∩R^{-1}\subseteq  R \subseteq R∪R^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9501em;vertical-align:-0.136em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></p>
]]></content>
      <categories>
        <category>学习</category>
        <category>离散</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
        <tag>离散</tag>
      </tags>
  </entry>
  <entry>
    <title>离散数学II笔记(4)</title>
    <url>/2024/10/23/DiscreteMathmaticsNote4/</url>
    <content><![CDATA[<h4 id="关系的复合运算-合成">关系的复合运算（合成）</h4>
<h5 id="定义："><strong>定义</strong>：</h5>
<p>设R是 X 到 Y 的关系， S 是Y到Z 的关<br>
系，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mtext>◦</mtext><mi>S</mi><mtext>＝</mtext><mo stretchy="false">{</mo><mo>&lt;</mo><mi>x</mi><mo separator="true">,</mo><mi>z</mi><mo>&gt;</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∃</mi><mi>y</mi><mo>∈</mo><mi>Y</mi><mtext>使得</mtext><mtext> </mtext><mi>x</mi><mi>R</mi><mi>y</mi><mo>∧</mo><mi>y</mi><mi>S</mi><mi>z</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R ◦ S ＝\{&lt;x, z&gt;|\exist y \in Y 使得\, x R y ∧ y S z \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord">◦</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord cjk_fallback">＝</span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣∃</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord cjk_fallback">使得</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">}</span></span></span></span>为 X 到 Z 的关系, 称为 R 和 S 的合成。<br>
显然，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>R</mi><mtext>◦</mtext><mi>S</mi><mo stretchy="false">)</mo><mo>⊆</mo><mi>d</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mtext>，</mtext><mi>r</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mi>R</mi><mtext>◦</mtext><mi>S</mi><mo stretchy="false">)</mo><mo>⊆</mo><mi>r</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mtext>．</mtext></mrow><annotation encoding="application/x-tex">dom (R◦S) \subseteq dom(R)，ran(R◦S) \subseteq ran(S)．</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord">◦</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord">◦</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mord cjk_fallback">．</span></span></span></span></p>
<h5 id="性质："><strong>性质</strong>：</h5>
<p>设A, B, C和D为任意四个集合，二元关系<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>⊆</mo><mi>A</mi><mo>×</mo><mi>B</mi><mo separator="true">,</mo><mtext> </mtext><msub><mi>R</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>R</mi><mn>3</mn></msub><mo>⊆</mo><mi>B</mi><mo>×</mo><mi>C</mi><mtext>，</mtext><msub><mi>R</mi><mn>4</mn></msub><mo>⊆</mo><mi>C</mi><mo>×</mo><mi>D</mi><mtext>：</mtext></mrow><annotation encoding="application/x-tex">R_1 \subseteq A\times B,\, R_2, R_3 \subseteq B\times C，R_4 \subseteq C\times D：</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord cjk_fallback">：</span></span></span></span></p>
<ol>
<li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub><mo>⊆</mo><msub><mi>R</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">R_2 \subseteq R_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>2</mn></msub><mo>⊆</mo><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">R_1◦R_2 \subseteq R_1 ◦ R_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub><mo>⊆</mo><msub><mi>R</mi><mn>3</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">R_2 ◦ R_4 \subseteq R_3 ◦R_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mo>∪</mo><msub><mi>R</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R_1 ◦ (R_2∪R_3) = (R_1◦R_2) ∪ (R_1◦R_3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mo>∪</mo><msub><mi>R</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mn>3</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(R_2∪R_3) ◦R_4 = (R_2◦R_4) ∪ (R_3◦R_4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mo>∩</mo><msub><mi>R</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>⊆</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>∩</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R_1◦ (R_2∩R_3) \subseteq (R_1◦R_2) ∩ (R_1◦R_3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mo>∩</mo><msub><mi>R</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub><mo>⊆</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mo>∩</mo><mo stretchy="false">(</mo><msub><mi>R</mi><mn>3</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(R_2∩R_3) ◦R_4 \subseteq (R_2◦R_4) ∩ (R_3◦R_4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mrow><mtext>–</mtext><mn>1</mn></mrow></msup><mo>=</mo><msubsup><mi>R</mi><mn>2</mn><mrow><mtext>–</mtext><mn>1</mn></mrow></msubsup><mtext>◦</mtext><msubsup><mi>R</mi><mn>1</mn><mrow><mtext>–</mtext><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">(R_1◦R_2)^{–1} = R_2^{–1} ◦ R_1^{–1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">–1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">–1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">–1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span>；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub><mo>=</mo><msub><mi>R</mi><mn>1</mn></msub><mtext>◦</mtext><mo stretchy="false">(</mo><msub><mi>R</mi><mn>2</mn></msub><mtext>◦</mtext><msub><mi>R</mi><mn>4</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(R_1◦R_2) ◦R_4 = R_1◦ (R_2◦R_4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</li>
</ol>
<h5 id="例子：">例子：</h5>
<ul>
<li>设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R = \{(a, b), (b, c)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)}</span></span></span></span>，则：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>b</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R^{-1} = \{(b, a), (c, b)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)}</span></span></span></span>，</li>
<li>如果再有一个关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>b</mi><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">S = \{(b, d)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mclose">)}</span></span></span></span>，则：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>∘</mo><mi>S</mi><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">R \circ S = \{(a, d)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mclose">)}</span></span></span></span></li>
</ul>
</li>
</ul>
<h4 id="关系的幂次">关系的幂次</h4>
<p><strong>定义</strong>：设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>是集合$ A$ 上的关系，$n <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>是自然数，</mtext></mrow><annotation encoding="application/x-tex">是自然数，
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">是自然数，</span></span></span></span>R$ 的 $n $次幂 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">R^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>定义如下：<br>
(1) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">R^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span> 是集合A上的恒等关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">I_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>0</mn></msup><mtext>＝</mtext><msub><mi>I</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">R^0 ＝ I_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9641em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">＝</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>；<br>
(2) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mrow><mi>n</mi><mtext>＋</mtext><mn>1</mn></mrow></msup><mtext>＝</mtext><msup><mi>R</mi><mi>n</mi></msup><mtext>◦</mtext><mi>R</mi></mrow><annotation encoding="application/x-tex">R^{n＋1} ＝ R^n ◦ R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord cjk_fallback mtight">＋</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">＝</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>．</p>
<ul>
<li>
<p>若n, m ∈N 且 R 为集合A上的二元关系，则<br>
(1) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>R</mi><mi>n</mi></msup><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">(R^n)^{-1} = (R^{-1})^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>;<br>
(2) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mi>n</mi></msup><mtext>◦</mtext><msup><mi>R</mi><mi>m</mi></msup><mo>=</mo><msup><mi>R</mi><mrow><mi>n</mi><mo>+</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">R^n◦R^m = R^{n+m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mord">◦</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span>;<br>
(3) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>R</mi><mi>n</mi></msup><msup><mo stretchy="false">)</mo><mi>m</mi></msup><mo>=</mo><msup><mi>R</mi><mrow><mi>n</mi><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(R^n)^m = R^{nm}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">nm</span></span></span></span></span></span></span></span></span></span></span></span>.</p>
</li>
<li>
<p>设有限集$ A <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>恰有</mtext></mrow><annotation encoding="application/x-tex">恰有</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">恰有</span></span></span></span> n<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>个元素．若</mtext></mrow><annotation encoding="application/x-tex">个元素．若</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">个元素．若</span></span></span></span> R$ 为 $A <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>上的二元关系，则有</mtext><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">上的二元关系，则有, 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord cjk_fallback">上的二元关系，则有</span><span class="mpunct">,</span></span></span></span>s, t ∈ N$, 使 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>&lt;</mo><mi>t</mi><mo>≤</mo><msup><mn>2</mn><msup><mi>n</mi><mi>𝟐</mi></msup></msup></mrow><annotation encoding="application/x-tex">s &lt; t ≤ 2^{n^𝟐}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9869em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathbf mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>且$ R^s = R^t$ ．<br>
设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 和 $S $ 都是集合A上的二元关系,则<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410231637515.png" alt></p>
</li>
<li>
<p>设 R 为 A 上的二元关系 ，<br>
(1) R 为自反的 当且仅当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>A</mi></msub><mo>⊆</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">I_A \subseteq R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>;<br>
(2) R为反自反的 当且仅当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>A</mi></msub><mo>∩</mo><mi>R</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">I_A\cap R = \varnothing</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6633em;vertical-align:-0.0817em;"></span><span class="mord amsrm">∅</span></span></span></span>;<br>
(3) R 为对称的 当且仅当$R = R^{–1} <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>；</mtext><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo><mi>R</mi><mtext>为反对称的当且仅当</mtext></mrow><annotation encoding="application/x-tex">；
(4) R 为反对称的 当且仅当</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">；</span><span class="mopen">(</span><span class="mord">4</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord cjk_fallback">为反对称的当且仅当</span></span></span></span>R \cap R^{–1} \subseteq I_A<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo separator="true">;</mo><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo><mi>R</mi><mtext>为传递的当且仅当</mtext></mrow><annotation encoding="application/x-tex">;
(5) R 为传递的 当且仅当</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">5</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord cjk_fallback">为传递的当且仅当</span></span></span></span>R ◦ R \subseteq R$</p>
</li>
</ul>
<p>关系复合的矩阵表示<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410231643993.png" alt></p>
<h4 id="关系的闭包运算">关系的闭包运算</h4>
<h5 id="闭包的定义">闭包的定义</h5>
<p>闭包运算用于通过添加一些元素，使原有关系具备某些特定的性质（如自反性、对称性或传递性）。常见的闭包运算包括自反闭包、对称闭包和传递闭包。</p>
<ol>
<li>
<p><strong>自反闭包</strong>：</p>
<ul>
<li>
<p>定义：设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 是集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 上的一个关系，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的自反闭包 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 是包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的最小自反关系。其形式为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mo>∪</mo><msub><mi>I</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">r(R) = R \cup I_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">I_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 上的恒等关系，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>A</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>∣</mo><mi>x</mi><mo>∈</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">I_A = \{(x, x) \mid x \in A\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">}</span></span></span></span>。</p>
</li>
</ul>
</li>
<li>
<p><strong>对称闭包</strong>：</p>
<ul>
<li>定义：设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 是集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 上的一个关系，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的对称闭包 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 是包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的最小对称关系。其形式为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mo>∪</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">s(R) = R \cup R^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，即通过加入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的逆关系，使其成为对称关系。</li>
</ul>
</li>
<li>
<p><strong>传递闭包</strong>：</p>
<ul>
<li>定义：设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 是集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 上的一个关系，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的传递闭包 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">t(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 是包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的最小传递关系。其形式为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>⋃</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">∞</mi></msubsup><msup><mi>R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">t(R) = \bigcup_{n=1}^{\infty} R^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">⋃</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>，即通过将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 复合多次，直到得到一个传递关系。</li>
</ul>
</li>
</ol>
<h3 id="闭包运算的性质">闭包运算的性质</h3>
<ol>
<li>
<p><strong>自反闭包性质</strong>：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 是包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的最小自反关系。</li>
<li>即，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 中的所有关系，并确保每个元素与自身有关系。</li>
</ul>
</li>
<li>
<p><strong>对称闭包性质</strong>：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 是包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的最小对称关系。</li>
<li>对称闭包保证任意两个互有关联的元素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xRy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>，其逆关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>R</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">yRx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">x</span></span></span></span> 也存在。</li>
</ul>
</li>
<li>
<p><strong>传递闭包性质</strong>：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">t(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 是包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的最小传递关系。</li>
<li>传递闭包确保关系的传递性：如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xRy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>R</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">yRz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>，则必然有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">xRz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="闭包运算的组合性质">闭包运算的组合性质</h3>
<ul>
<li>闭包运算可以组合使用，以确保关系同时具备自反性、对称性和传递性。例如：
<ul>
<li>先进行自反闭包 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r(R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span>，再进行对称闭包 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s(r(R))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">))</span></span></span></span>，最后再进行传递闭包 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">t(s(r(R)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)))</span></span></span></span>，可以得到一个既自反、对称又传递的关系。</li>
</ul>
</li>
</ul>
<h3 id="次序关系">次序关系</h3>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410231651786.png" alt></p>
<h4 id="偏序关系-partial-order">偏序关系 (Partial Order)</h4>
<ul>
<li><strong>定义</strong>：若集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 上的二元关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 满足以下三个性质，则称 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 为偏序关系：
<ul>
<li>自反性：对于任意 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">xRx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">x</span></span></span></span>；</li>
<li>反对称性：若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xRy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>R</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">yRx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">x</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x = y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>；</li>
<li>传递性：若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xRy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>R</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">yRz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">xRz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>。</li>
</ul>
</li>
</ul>
<h5 id="例子：">例子：</h5>
<ol>
<li>自然数集合上的小于等于关系 $ \leq $ 是一个偏序关系。</li>
<li>集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span> 上的包含关系 $ \subseteq $ 是偏序关系。</li>
</ol>
<h4 id="严格偏序关系-strict-partial-order">严格偏序关系 (Strict Partial Order)</h4>
<ul>
<li><strong>定义</strong>：严格偏序关系是不具有自反性的偏序关系。即，关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 满足以下条件：
<ul>
<li>反自反性：对任意 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，没有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">xRx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">x</span></span></span></span>；</li>
<li>反对称性和传递性同样成立。</li>
</ul>
</li>
</ul>
<h5 id="例子：">例子：</h5>
<ul>
<li>整数集上的“&lt;”是一个严格偏序关系。</li>
</ul>
<h4 id="全序关系-total-order">全序关系 (Total Order)</h4>
<ul>
<li><strong>定义</strong>：全序关系是一种偏序关系，且集合中的任何两个元素都是可比的。
<ul>
<li>对任意 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x, y \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，要么 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xRy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>，要么 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>R</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">yRx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">x</span></span></span></span>。</li>
</ul>
</li>
</ul>
<h5 id="例子：">例子：</h5>
<ul>
<li>实数集上的小于等于关系 $ \leq $ 是全序关系。</li>
</ul>
<h4 id="哈斯图-hasse-diagram">哈斯图 (Hasse Diagram)</h4>
<ul>
<li><strong>定义</strong>：哈斯图是一种简化的偏序关系图，用于表示偏序集合的关系结构，去掉了自反性和传递性导致的冗余边。</li>
</ul>
<h5 id="例子：">例子：</h5>
<ul>
<li>集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A = \{1, 2, 3, 4\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mclose">}</span></span></span></span> 的偏序关系 $ \leq $ 的哈斯图：  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1</span><br><span class="line">|</span><br><span class="line">2</span><br><span class="line">|</span><br><span class="line">3</span><br><span class="line">|</span><br><span class="line">4</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="等价关系">等价关系</h3>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410231652635.png" alt></p>
<h4 id="定义">定义</h4>
<ul>
<li>等价关系是一种特殊的二元关系，满足以下三个性质：
<ul>
<li>自反性：对于任意 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">xRx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">x</span></span></span></span>；</li>
<li>对称性：若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xRy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>R</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">yRx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">x</span></span></span></span>；</li>
<li>传递性：若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xRy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>R</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">yRz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>R</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">xRz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>。</li>
</ul>
</li>
</ul>
<h5 id="例子：">例子：</h5>
<ol>
<li>实数上的相等关系是等价关系。</li>
<li>集合中的元素间的同类关系，如模3同余关系。</li>
</ol>
<h4 id="等价类-equivalence-class">等价类 (Equivalence Class)</h4>
<ul>
<li><strong>定义</strong>：对于集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 上的等价关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>，对于任意 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">x \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 有关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 的所有元素构成一个等价类，记作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><msub><mo stretchy="false">]</mo><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">[x]_R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
</ul>
<h5 id="例子：">例子：</h5>
<ul>
<li>模3同余关系下，集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>7</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A = \{1, 2, 3, 4, 5, 6, 7\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">7</span><span class="mclose">}</span></span></span></span> 的等价类为：<br>
[<br>
[1]_R = {1, 4, 7}, \quad [2]_R = {2, 5}, \quad [3]_R = {3, 6}<br>
]</li>
</ul>
<h4 id="等价关系的图表示">等价关系的图表示</h4>
<ul>
<li>等价关系可以通过无向图来表示。图的每个连通分支表示一个等价类。等价关系的简化关系图是无向图，每个结点对应一个元素。</li>
</ul>
<h5 id="例子：">例子：</h5>
<ul>
<li>模3同余关系的简化关系图：  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 - 4 - 7</span><br><span class="line">2 - 5</span><br><span class="line">3 - 6</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="划分-partition">划分 (Partition)</h3>
<h4 id="划分的定义">划分的定义</h4>
<ul>
<li>
<p><strong>定义</strong>：设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 为一个集合，若集合的子集族 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span> 满足以下三个条件：</p>
<ol>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>S</mi><mo>∈</mo><mi mathvariant="script">P</mi><mo separator="true">,</mo><mi>S</mi><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">\forall S \in \mathcal{P}, S \neq \emptyset</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">∅</span></span></span></span>；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋃</mo><mi mathvariant="script">P</mi><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\bigcup \mathcal{P} = A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">⋃</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>；</li>
<li>对于任意 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>S</mi><mn>2</mn></msub><mo>∈</mo><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">S_1, S_2 \in \mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span>，若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>∩</mo><msub><mi>S</mi><mn>2</mn></msub><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∅</mi></mrow><annotation encoding="application/x-tex">S_1 \cap S_2 \neq \emptyset</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">∅</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>=</mo><msub><mi>S</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">S_1 = S_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
</ol>
<p>则称 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 的一个划分。</p>
</li>
</ul>
<h4 id="等价关系与划分的联系">等价关系与划分的联系</h4>
<ul>
<li><strong>定理</strong>：若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> 是集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 上的等价关系，则商集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi mathvariant="normal">/</mi><mi>R</mi><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">[</mo><mi>x</mi><msub><mo stretchy="false">]</mo><mi>R</mi></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo>∈</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A/R = \{[x]_R | x \in A\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{[</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">}</span></span></span></span> 是集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 的一个划分。</li>
<li>反之，若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span> 是集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 的一个划分，则存在等价关系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi mathvariant="script">P</mi></msub></mrow><annotation encoding="application/x-tex">R_{\mathcal{P}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span> 确定 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 上的等价关系。</li>
</ul>
<h4 id="等价关系的哈斯图">等价关系的哈斯图</h4>
<ul>
<li>在偏序集上，也可以通过哈斯图来表示等价类。例如模3同余关系的哈斯图，可以通过去掉冗余的自反和传递关系来简化。</li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
        <category>离散</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
        <tag>离散</tag>
      </tags>
  </entry>
  <entry>
    <title>2025年春本科生机器学习期末回忆版[BUAA-ML]</title>
    <url>/2025/08/11/ML-final/</url>
    <content><![CDATA[<h3 id="t1-混淆矩阵">T1 混淆矩阵</h3>
<p>要求写出混淆矩阵，解释TP、FP、TN、FN定义，给出预测和真实值，计算查准率、查全率和F1</p>
<h3 id="t2-贝叶斯决策">T2 贝叶斯决策</h3>
<p>给出c1、c2和决策损失表，使用最小错误率和最小风险进行决策。</p>
<h3 id="t3-感知机准则求判别函数">T3 感知机准则求判别函数</h3>
<p>李航《机器学习方法》P34 例 2.1，迭代次数比较多<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202506231523905.png" alt><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202506231523458.png" alt></p>
<h3 id="t4-svm-支持向量机">T4 SVM 支持向量机</h3>
<p>解释支持向量机SVM的思想，解释核函数的作用。</p>
<h3 id="t5-id3-决策树">T5 ID3 决策树</h3>
<p>根据三种属性(口味：甜/咸/酸，温度：冷/热，分量：大/中/小)对12个样本构建ID3决策树，分析ID3的缺点，举出两种缓解过拟合的方法（预剪枝算法、后剪枝算法），选择一个说明优劣。</p>
<h3 id="t6-k-means">T6 K-means</h3>
<p>描述K-means算法流程，分析劣势并给出一种改进（K-means++）</p>
<h3 id="t7-集成学习">T7 集成学习</h3>
<p>描述adaBoosting串行学习流程，分析随机森林的学习器和如何实现多样化的学习器</p>
<h3 id="t8-反向传播bp">T8 反向传播BP</h3>
<p>是例题没错了，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>→</mo><mi>M</mi><mo>→</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">D\rightarrow M\rightarrow K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>的前馈神经网络，计算每一层权值参数的更新</p>
<p>包含一层隐藏层的前馈神经网络如图所示, 其中给定训练集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>⋯</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>N</mi></msub><mo separator="true">,</mo><msub><mi>t</mi><mi>N</mi></msub><mo stretchy="false">)</mo></mrow><mo separator="true">,</mo><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><msup><mi>R</mi><mi>D</mi></msup><mo separator="true">,</mo><msub><mi>t</mi><mi>i</mi></msub><mo>∈</mo><msup><mi>R</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">D={(x_1,t_1),(x_2,t_2),⋯,(x_N,t_N)},x_i ∈ R^D,t_i ∈ R^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span>。隐藏层激活函数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>, 输出层激活函数为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">σ(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">y_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 个样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">x_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 对应的神经网络输出向量,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mi>y</mi><msub><mi>n</mi><mn>1</mn></msub></msub><mo separator="true">,</mo><mo>⋯</mo><mo separator="true">,</mo><msub><mi>y</mi><msub><mi>n</mi><mi>k</mi></msub></msub><mo separator="true">,</mo><mo>⋯</mo><mo separator="true">,</mo><msub><mi>y</mi><msub><mi>n</mi><mi>K</mi></msub></msub><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">y_n = [y_{n_1},⋯,y_{n_k},⋯,y_{n_K}]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0972em;vertical-align:-0.2559em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2559em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>, 准则函数为  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><mo stretchy="false">{</mo><msub><mi>y</mi><msub><mi>n</mi><mi>k</mi></msub></msub><mo>−</mo><msub><mi>t</mi><msub><mi>n</mi><mi>k</mi></msub></msub><msup><mo stretchy="false">}</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E_n(w)= \frac{1}{2}∑^K_{k=1}\{y_{n_k} −t_{n_k}\}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2559em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.07em;vertical-align:-0.2559em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2559em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 。网络包含<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>个输入神经元, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>个输出神经元,以及<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>个隐层神经元。试推导反向传播算法中对每一层权值参数（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>m</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{md}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{km}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）的更新。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202506231520390.png" alt="T8"></p>
<h3 id="t9-开放性试题">T9 开放性试题</h3>
<p>文生视频用到了什么技术，可能的挑战和潜在问题。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>ML</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>ML</tag>
      </tags>
  </entry>
  <entry>
    <title>北航2025机器学习期末复习[BUAA-ML]</title>
    <url>/2025/08/11/ML-review/</url>
    <content><![CDATA[<h1 id="北航机器学习期末复习">北航机器学习期末复习</h1>
<h2 id="写在前面">写在前面</h2>
<p>ML 是一门23级才加入大二必修的专业课（此前主要是本科大三的选修课和研究生的必修课，但授课老师基本一致），主要学习方式以每周2学时的理论课和4次实验为主，考核方式是期末闭卷考试+团队大作业，本文汇总了北航机器学习期末考试题型和例题，基本涵盖核心知识点。</p>
<blockquote>
<p>从往年期末考察的内容和今年题型分布来看，依赖往年题和核心考点拟合的成功率较高，建议结合往年题与PPT内容进行复习。<br>
转载来源：<a href="https://suzumiyaakizuki.github.io/2024/12/21/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%9C%9F%E6%9C%AB%E8%80%83%E8%AF%95%E4%BE%8B%E9%A2%98%E6%B1%87%E6%80%BB/">凉宫秋月的文艺部</a></p>
</blockquote>
<hr>
<h2 id="目录">目录</h2>
<ul>
<li><a href="#%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%86%B3%E7%AD%96">贝叶斯决策</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E6%84%9F%E7%9F%A5%E6%9C%BA%E5%87%86%E5%88%99%E6%B1%82%E5%88%A4%E5%88%AB%E5%87%BD%E6%95%B0">使用感知机准则求判别函数</a></li>
<li><a href="#%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90pca">主成分分析（PCA）</a></li>
<li><a href="#%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA">支持向量机（SVM）</a></li>
<li><a href="#k-means%E7%AE%97%E6%B3%95%E5%92%8Cem%E7%AE%97%E6%B3%95">K-Means算法和EM算法</a></li>
<li><a href="#%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0">集成学习</a></li>
<li><a href="#%E5%86%B3%E7%AD%96%E6%A0%91">决策树</a></li>
<li><a href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E7%AE%97%E6%B3%95">反向传播算法</a></li>
<li><a href="#%E5%BC%80%E6%94%BE%E6%80%A7%E8%AF%95%E9%A2%98">开放性试题</a></li>
<li><a href="#%E5%88%86%E7%B1%BB%E5%99%A8%E6%80%A7%E8%83%BD%E5%BA%A6%E9%87%8F">分类器性能度量</a></li>
</ul>
<hr>
<h2 id="贝叶斯决策">贝叶斯决策</h2>
<p><strong>【例题】</strong> 细胞有正常 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)，异常 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 两类，其先验概率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0.9</mn></mrow><annotation encoding="application/x-tex">P(w_1)=0.9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">P(w_2)=0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.1</span></span></span></span>。有一个待识别的细胞，观测值为x，现在已知如果细胞是正常的，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(x|w_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 出现的概率为0.2；如果细胞是异常的，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(x|w_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 出现的概率是0.4。决策的损失表如下：</p>
<table>
<thead>
<tr>
<th style="text-align:left">决策</th>
<th style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></td>
<td style="text-align:center">0</td>
<td style="text-align:center">6</td>
</tr>
<tr>
<td style="text-align:left"><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
</tr>
</tbody>
</table>
<ol>
<li>基于最小错误率原则对待识别细胞进行归类</li>
<li>基于最小风险原则对待识别细胞进行归类</li>
</ol>
<p><strong>【解答】</strong></p>
<ol>
<li>
<p><strong>基于最小错误率原则</strong><br>
应用贝叶斯公式：<br>
已知x，细胞属于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的概率为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>0.2</mn><mo>×</mo><mn>0.9</mn></mrow><mrow><mn>0.2</mn><mo>×</mo><mn>0.9</mn><mo>+</mo><mn>0.4</mn><mo>×</mo><mn>0.1</mn></mrow></mfrac><mo>=</mo><mfrac><mn>0.18</mn><mn>0.22</mn></mfrac><mo>=</mo><mn>0.818</mn></mrow><annotation encoding="application/x-tex">P(w_1|x) = \frac{P(x|w_1)P(w_1)}{P(x|w_1)P(w_1) + P(x|w_2)P(w_2)} = \frac{0.2 \times 0.9}{0.2 \times 0.9 + 0.4 \times 0.1} = \frac{0.18}{0.22} = 0.818</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.2</span><span class="mbin mtight">×</span><span class="mord mtight">0.9</span><span class="mbin mtight">+</span><span class="mord mtight">0.4</span><span class="mbin mtight">×</span><span class="mord mtight">0.1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.2</span><span class="mbin mtight">×</span><span class="mord mtight">0.9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.22</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.18</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.818</span></span></span></span></p>
<p>已知x，细胞属于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的概率为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>0.4</mn><mo>×</mo><mn>0.1</mn></mrow><mrow><mn>0.2</mn><mo>×</mo><mn>0.9</mn><mo>+</mo><mn>0.4</mn><mo>×</mo><mn>0.1</mn></mrow></mfrac><mo>=</mo><mfrac><mn>0.04</mn><mn>0.22</mn></mfrac><mo>=</mo><mn>0.182</mn></mrow><annotation encoding="application/x-tex">P(w_2|x) = \frac{P(x|w_2)P(w_2)}{P(x|w_1)P(w_1) + P(x|w_2)P(w_2)} = \frac{0.4 \times 0.1}{0.2 \times 0.9 + 0.4 \times 0.1} = \frac{0.04}{0.22} = 0.182</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.2</span><span class="mbin mtight">×</span><span class="mord mtight">0.9</span><span class="mbin mtight">+</span><span class="mord mtight">0.4</span><span class="mbin mtight">×</span><span class="mord mtight">0.1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.4</span><span class="mbin mtight">×</span><span class="mord mtight">0.1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.22</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.04</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.182</span></span></span></span></p>
<p>因为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(w_1|x) &gt; P(w_2|x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>，所以应该决策为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p>
</li>
<li>
<p><strong>基于最小风险原则</strong><br>
决策为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的风险为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>λ</mi><mn>11</mn></msub><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>λ</mi><mn>12</mn></msub><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mo>×</mo><mn>0.818</mn><mo>+</mo><mn>6</mn><mo>×</mo><mn>0.182</mn><mo>=</mo><mn>1.092</mn></mrow><annotation encoding="application/x-tex">R(w_1) = \lambda_{11}P(w_1|x) + \lambda_{12}P(w_2|x) = 0 \times 0.818 + 6 \times 0.182 = 1.092</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.818</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.182</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.092</span></span></span></span></p>
<p>决策为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的风险为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>λ</mi><mn>21</mn></msub><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>λ</mi><mn>22</mn></msub><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>×</mo><mn>0.818</mn><mo>+</mo><mn>0</mn><mo>×</mo><mn>0.182</mn><mo>=</mo><mn>0.818</mn></mrow><annotation encoding="application/x-tex">R(w_2) = \lambda_{21}P(w_1|x) + \lambda_{22}P(w_2|x) = 1 \times 0.818 + 0 \times 0.182 = 0.818</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.818</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.182</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.818</span></span></span></span></p>
<p>因为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>&lt;</mo><mi>R</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(w_2) &lt; R(w_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，所以应该决策为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p>
</li>
</ol>
<hr>
<h2 id="使用感知机准则求判别函数">使用感知机准则求判别函数</h2>
<p><strong>【讲解】</strong> 问题的格式是：现有样本集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>⋅</mo><mo>⋅</mo><mo>⋅</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">{x_1, \cdot\cdot\cdot, x_n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">⋅</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 属于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_1, w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>两类，寻找向量a，使得：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>x</mi><mo>∈</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><msup><mi>a</mi><mi>T</mi></msup><mi>x</mi><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\forall x \in w_1, a^T x &gt; 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">∀</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span> 且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>x</mi><mo>∈</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator="true">,</mo><msup><mi>a</mi><mi>T</mi></msup><mi>x</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\forall x \in w_2, a^T x &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">∀</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>。即使用一个仿射流形把样本分成两半，这时称样本是线性可分的。其具体操作步骤是：</p>
<ol>
<li>
<p><strong>构造规范化增广样本向量。</strong><br>
这一步的关键是增广和规范化。因为一般线性流形的表达式是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">w^T x+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9247em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> 但是我们要把这个b包含在w里面，就要把样本进行增广。增广的操作步骤是给样本的坐标前面补充1个1。<br>
规范化的意思是，如果样本是正例(属于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)，就保持不变；否则，它的每个坐标都变成相反数。<br>
规范化增广样本向量记作 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>⋅</mo><mo>⋅</mo><mo>⋅</mo><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">{y_1, \cdot\cdot\cdot, y_n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">⋅</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>。</p>
</li>
<li>
<p><strong>在y集合上循环迭代：</strong> 对于每个y，计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>T</mi></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">a^T y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>，如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mi>k</mi><mi>T</mi></msubsup><mi>y</mi><mo>≤</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">a_k^T y \le 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span> 则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>a</mi><mi>k</mi></msub><mo>+</mo><mi>y</mi><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">a_{k+1}=a_k+y;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">;</span></span></span></span> 否则，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>a</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">a_{k+1}=a_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。直到对于某个a，所有的y都满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>T</mi></msup><mi>y</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a^T y &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，那么这就是最终结果。<br>
这实际上是梯度下降法的过程，推导略。</p>
</li>
</ol>
<p><strong>【例子】</strong> 现有数据集:</p>
<ol>
<li>类别1: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mn>1</mn><mi>T</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_1^T=(-2,2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mn>2</mn><mi>T</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_2^T=(-2,-2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></li>
<li>类别2: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mn>3</mn><mi>T</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_3^T=(2,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mn>4</mn><mi>T</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_4^T=(2,-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mclose">)</span></span></span></span><br>
初始化权: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>0</mn><mi>T</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_0^T=(0,2,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, 利用感知机准则求判别函数。</li>
</ol>
<p><strong>【解答】</strong></p>
<ol>
<li>
<p><strong>构造规范化增广样本向量:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mn>1</mn><mi>T</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_1^T=(1,-2,2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mn>2</mn><mi>T</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_2^T=(1,-2,-2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mn>3</mn><mi>T</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_3^T=(-1,-2,-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mn>4</mn><mi>T</mi></msubsup><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_4^T=(-1,-2,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
</li>
<li>
<p><strong>迭代</strong><br>
i. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>1</mn><mi>T</mi></msubsup><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mo>−</mo><mn>2</mn><mo>≤</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">a_1^T y_1=(0,2,1) \cdot (1,-2,2)^T = -2 \le 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>3</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">a_2=a_1+y_1=(1,0,3)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><br>
ii. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>2</mn><mi>T</mi></msubsup><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mo>−</mo><mn>5</mn><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_2^T y_2=(1,0,3) \cdot (1,-2,-2)^T = -5 \le 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">−</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>3</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">a_3=a_2+y_2=(2,-2,1)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><br>
iii. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>3</mn><mi>T</mi></msubsup><msub><mi>y</mi><mn>3</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mn>1</mn><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">a_3^T y_3=(2,-2,1) \cdot (-1,-2,-1)^T = 1 &gt; 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>4</mn></msub><mo>=</mo><msub><mi>a</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">a_4=a_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
iv. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>4</mn><mi>T</mi></msubsup><msub><mi>y</mi><mn>4</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mn>3</mn><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">a_4^T y_4=(2,-2,1) \cdot (-1,-2,1)^T = 3 &gt; 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>5</mn></msub><mo>=</mo><msub><mi>a</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">a_5=a_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
v. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>5</mn><mi>T</mi></msubsup><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mn>8</mn><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">a_5^T y_1=(2,-2,1) \cdot (1,-2,2)^T = 8 &gt; 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>6</mn></msub><mo>=</mo><msub><mi>a</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">a_6=a_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
vi. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>6</mn><mi>T</mi></msubsup><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mn>4</mn><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">a_6^T y_2=(2,-2,1) \cdot (1,-2,-2)^T = 4 &gt; 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>7</mn></msub><mo>=</mo><msub><mi>a</mi><mn>6</mn></msub></mrow><annotation encoding="application/x-tex">a_7=a_6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
vii. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>7</mn><mi>T</mi></msubsup><msub><mi>y</mi><mn>3</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mn>1</mn><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">a_7^T y_3=(2,-2,1) \cdot (-1,-2,-1)^T = 1 &gt; 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>8</mn></msub><mo>=</mo><msub><mi>a</mi><mn>7</mn></msub></mrow><annotation encoding="application/x-tex">a_8=a_7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
viii. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>8</mn><mi>T</mi></msubsup><msub><mi>y</mi><mn>4</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mn>3</mn><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">a_8^T y_4=(2,-2,1) \cdot (-1,-2,1)^T = 3 &gt; 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0894em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>9</mn></msub><mo>=</mo><msub><mi>a</mi><mn>8</mn></msub></mrow><annotation encoding="application/x-tex">a_9=a_8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
至此，对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>T</mi></msup><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^T=(2,-2,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>，所有的y都满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>T</mi></msup><mi>y</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a^T y &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>, 那么这就是最终结果。</p>
</li>
</ol>
<hr>
<h2 id="主成分分析-pca">主成分分析(PCA)</h2>
<p><strong>【讲解】</strong> PCA的考法有两种，第一种是基于最大方差准则进行推导，第二种是给你一些二维向量，让你降成一维。</p>
<p><strong>【例题1】</strong> 基于最大方差准则推导PCA的方法</p>
<p><strong>【解答1】</strong> 问题是把D维数据集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">{x_n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 降为1维。定义投影方向为D维向量u，且满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mi>T</mi></msup><mi>u</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">u^T u=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。<br>
则样本均值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6306em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>，投影后样本均值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mi>T</mi></msup><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">u^T \overline{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>。<br>
投影后样本的方差为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">(</mo><msup><mi>u</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msup><mi>u</mi><mi>T</mi></msup><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><msup><mi>u</mi><mi>T</mi></msup><mo stretchy="false">(</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">)</mo><mi>u</mi><mo>=</mo><msup><mi>u</mi><mi>T</mi></msup><mi>S</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">\frac{1}{N}\sum_{i=1}^{N}(u^T x_i - u^T \overline{x})^2 = u^T (\frac{1}{N}\sum_{i=1}^{N}(x_i - \overline{x})(x_i - \overline{x})^T) u = u^T S u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span></span></span></span><br>
其中S是协方差矩阵。那么优化问题为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>maximize </mtext><msup><mi>u</mi><mi>T</mi></msup><mi>S</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">\text{maximize } u^T S u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord text"><span class="mord">maximize </span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>s.t. </mtext><msup><mi>u</mi><mi>T</mi></msup><mi>u</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{s.t. } u^T u = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord text"><span class="mord">s.t. </span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><br>
利用拉格朗日乘数法，写出其拉格朗日函数：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>u</mi><mi>T</mi></msup><mi>S</mi><mi>u</mi><mo>+</mo><mi>λ</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>u</mi><mi>T</mi></msup><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L(u,\lambda) = u^T S u + \lambda(1 - u^T u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9247em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span><br>
对u求导，并置零，有：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mo>=</mo><mi>λ</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">S u = \lambda u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mord mathnormal">u</span></span></span></span><br>
这意味着，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span>是S的特征值，u是S的特征向量。当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span>是S最大特征值时，u是对应的特征向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">u_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，此时方差取到极大值，称为第一主成分。<br>
于是，我们得到利用PCA降维的操作步骤：</p>
<ol>
<li>计算所有样本点的均值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6306em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span></li>
<li>对所有样本点进行零均值化: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">x_i = x_i - \overline{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6306em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span></li>
<li>计算协方差阵: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">S = \frac{1}{N}\sum_{i=1}^{N} x_i x_i^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>计算协方差阵的最大的特征值和与其对应的特征向量u</li>
<li>进行投影: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>u</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">y=u^T x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span></span></li>
</ol>
<hr>
<h3 id="最小均方误差准则下的pca完整推导流程">最小均方误差准则下的PCA完整推导流程</h3>
<p><strong>一、问题设定与基本思想</strong></p>
<ol>
<li><strong>目标</strong>: 将D维数据{x}降维到M维空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>M</mi><mo>&lt;</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(M&lt;D)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span>, 使得重建误差最小。</li>
<li><strong>核心思想</strong>: 用M维子空间表示数据时, 舍弃(D-M)个方向上的信息损失最小。</li>
</ol>
<p><strong>二、数学建模</strong></p>
<ol>
<li><strong>完整正交基</strong>: 设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>u</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">{u_1, ..., u_D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 是D维空间的标准正交基, 满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>u</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>u</mi><mi>j</mi></msub><mo>=</mo><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_i^T u_j = \delta_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1274em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> (正交归一条件)。</li>
<li><strong>数据表示</strong>: 原始数据点可表示为: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msub><mi>α</mi><mrow><mi>n</mi><mi>i</mi></mrow></msub><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_n = \sum_{i=1}^{D} \alpha_{ni} u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ni</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, 其中系数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mi>n</mi><mi>i</mi></mrow></msub><mo>=</mo><msubsup><mi>x</mi><mi>n</mi><mi>T</mi></msubsup><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_{ni}=x_n^T u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ni</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0883em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li><strong>降维表示</strong>: 用前M个基向量表示: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>~</mo></mover><mi>n</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><msub><mi>z</mi><mrow><mi>n</mi><mi>i</mi></mrow></msub><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msub><mi>b</mi><mi>i</mi></msub><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{x}_n = \sum_{i=1}^{M} z_{ni} u_i + \sum_{i=M+1}^{D} b_i u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8179em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ni</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
<ul>
<li>前M项: 保留的主成分 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>n</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">z_{ni}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ni</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 待定)</li>
<li>后(D-M)项: 常数补偿项 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 待定)</li>
</ul>
</li>
</ol>
<p><strong>三、优化目标建立</strong></p>
<ol>
<li><strong>重建误差</strong>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><msub><mover accent="true"><mi>x</mi><mo>~</mo></mover><mi>n</mi></msub><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">J = \frac{1}{N}\sum_{n=1}^{N} |x_n - \tilde{x}_n|^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></li>
<li><strong>误差表达式推导</strong>: 假设用均值补偿舍弃的维度，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>=</mo><msup><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mi>T</mi></msup><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i = \overline{x}^T u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0118em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8618em;"><span style="top:-3.0835em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，并令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>n</mi><mi>i</mi></mrow></msub><mo>=</mo><msubsup><mi>x</mi><mi>n</mi><mi>T</mi></msubsup><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">z_{ni} = x_n^T u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ni</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0883em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><msub><mover accent="true"><mi>x</mi><mo>~</mo></mover><mi>n</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>n</mi><mi>T</mi></msubsup><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>u</mi><mi>i</mi></msub><mo>−</mo><mo stretchy="false">(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>n</mi><mi>T</mi></msubsup><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><mo stretchy="false">(</mo><msup><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mi>T</mi></msup><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_n - \tilde{x}_n = \sum_{i=1}^{D} (x_n^T u_i) u_i - (\sum_{i=1}^{M} (x_n^T u_i) u_i + \sum_{i=M+1}^{D} (\overline{x}^T u_i) u_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8179em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8618em;"><span style="top:-3.0835em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">= \sum_{i=M+1}^{D} ((x_n - \overline{x})^T u_i) u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>目标函数化简</strong>:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>u</mi><mi>i</mi></msub><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><msup><mo stretchy="false">)</mo><mi>T</mi></msup><msub><mi>u</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">J = \frac{1}{N}\sum_{n=1}^{N} |\sum_{i=M+1}^{D} ((x_n - \overline{x})^T u_i) u_i|^2 = \frac{1}{N}\sum_{n=1}^{N} \sum_{i=M+1}^{D} ((x_n - \overline{x})^T u_i)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msubsup><mi>u</mi><mi>i</mi><mi>T</mi></msubsup><mo stretchy="false">(</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">)</mo><msub><mi>u</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msubsup><mi>u</mi><mi>i</mi><mi>T</mi></msubsup><mi>S</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">= \sum_{i=M+1}^{D} u_i^T (\frac{1}{N}\sum_{n=1}^{N} (x_n-\overline{x})(x_n-\overline{x})^T) u_i = \sum_{i=M+1}^{D} u_i^T S u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
其中S是协方差矩阵: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">S = \frac{1}{N}\sum_{n=1}^{N} (x_n - \overline{x})(x_n - \overline{x})^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></li>
</ol>
<p><strong>四、优化求解</strong></p>
<ol>
<li><strong>带约束优化问题</strong>:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><msub><mi>u</mi><mi>i</mi></msub></msub><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msubsup><mi>u</mi><mi>i</mi><mi>T</mi></msubsup><mi>S</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\min_{u_i} \sum_{i=M+1}^{D} u_i^T S u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
s.t. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>u</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>u</mi><mi>j</mi></msub><mo>=</mo><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_i^T u_j = \delta_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1274em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>拉格朗日函数</strong>:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>J</mi><mo>~</mo></mover><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msubsup><mi>u</mi><mi>i</mi><mi>T</mi></msubsup><mi>S</mi><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msub><mi>λ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>u</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\tilde{J} = \sum_{i=M+1}^{D} u_i^T S u_i + \sum_{i=M+1}^{D} \lambda_i (1 - u_i^T u_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0833em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li><strong>求导得最优条件</strong>:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>J</mi><mo>~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mn>2</mn><mi>S</mi><msub><mi>u</mi><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>u</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo>⇒</mo><mi>S</mi><msub><mi>u</mi><mi>i</mi></msub><mo>=</mo><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial \tilde{J}}{\partial u_i} = 2Su_i - 2\lambda_i u_i = 0 \Rightarrow Su_i = \lambda_i u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4832em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0381em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span><span style="top:-3.3023em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.0833em;"><span class="mord mtight">~</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>解的分析</strong>:
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 必须是S的特征向量。</li>
<li>误差值: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>M</mi><mo>+</mo><mn>1</mn></mrow><mi>D</mi></msubsup><msub><mi>λ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">J=\sum_{i=M+1}^{D} \lambda_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3393em;vertical-align:-0.358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>为使J最小, 应选择S的最小的(D-M)个特征值，这意味着用于构建子空间的前M个基向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>应该是S的最大的M个特征值对应的特征向量。</li>
</ul>
</li>
</ol>
<hr>
<p><strong>【例题2】</strong> 对以下五个二维向量，利用PCA降为一维<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x_{(1)}=\begin{bmatrix} 2 \\ 5 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x_{(2)}=\begin{bmatrix} 3 \\ 3 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x_{(3)}=\begin{bmatrix} 5 \\ 4 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x_{(4)}=\begin{bmatrix} 4 \\ 6 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">4</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x_{(5)}=\begin{bmatrix} 6 \\ 2 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">5</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p>
<p><strong>【解答2】</strong></p>
<ol>
<li>
<p><strong>计算样本均值:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mo>=</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><mrow><mo fence="true">(</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>6</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>20</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>20</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\overline{x} = \frac{1}{5} \left( \begin{bmatrix} 2 \\ 5 \end{bmatrix} + \begin{bmatrix} 3 \\ 3 \end{bmatrix} + \begin{bmatrix} 5 \\ 4 \end{bmatrix} + \begin{bmatrix} 4 \\ 6 \end{bmatrix} + \begin{bmatrix} 6 \\ 2 \end{bmatrix} \right) = \frac{1}{5} \begin{bmatrix} 20 \\ 20 \end{bmatrix} = \begin{bmatrix} 4 \\ 4 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6306em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">20</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">20</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p>
</li>
<li>
<p><strong>零均值化:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x&#x27;_{(1)}=\begin{bmatrix} -2 \\ 1 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2489em;vertical-align:-0.497em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.378em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">2</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x&#x27;_{(2)}=\begin{bmatrix} -1 \\ -1 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2489em;vertical-align:-0.497em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.378em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x&#x27;_{(3)}=\begin{bmatrix} 1 \\ 0 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2489em;vertical-align:-0.497em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.378em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x&#x27;_{(4)}=\begin{bmatrix} 0 \\ 2 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2489em;vertical-align:-0.497em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.378em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">4</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x&#x27;_{(5)}=\begin{bmatrix} 2 \\ -2 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2489em;vertical-align:-0.497em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.378em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">5</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p>
</li>
<li>
<p><strong>计算协方差矩阵:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>5</mn></msubsup><msubsup><mi>x</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><msup><msubsup><mi>x</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">S = \frac{1}{5} \sum_{i=1}^{5} x&#x27;_i {x&#x27;_i}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3281em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9831em;"><span style="top:-3.2048em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><mrow><mo fence="true">(</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>4</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>4</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">= \frac{1}{5} \left( \begin{bmatrix} 4 &amp; -2 \\ -2 &amp; 1 \end{bmatrix} + \begin{bmatrix} 1 &amp; 1 \\ 1 &amp; 1 \end{bmatrix} + \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; 0 \end{bmatrix} + \begin{bmatrix} 0 &amp; 0 \\ 0 &amp; 4 \end{bmatrix} + \begin{bmatrix} 4 &amp; -4 \\ -4 &amp; 4 \end{bmatrix} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">2</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">4</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>10</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>10</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">= \frac{1}{5} \begin{bmatrix} 10 &amp; -5 \\ -5 &amp; 10 \end{bmatrix} = \begin{bmatrix} 2 &amp; -1 \\ -1 &amp; 2 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">10</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">5</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">10</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p>
</li>
<li>
<p><strong>计算特征值和特征向量:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>S</mi><mo>−</mo><mi>λ</mi><mi>I</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo>−</mo><mi>λ</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo>=</mo><mn>0</mn><mo>⇒</mo><msup><mi>λ</mi><mn>2</mn></msup><mo>−</mo><mn>4</mn><mi>λ</mi><mo>+</mo><mn>3</mn><mo>=</mo><mn>0</mn><mo>⇒</mo><mo stretchy="false">(</mo><mi>λ</mi><mo>−</mo><mn>3</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>λ</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">|S - \lambda I| = (2-\lambda)^2 - 1 = 0 \Rightarrow \lambda^2 - 4\lambda + 3 = 0 \Rightarrow (\lambda-3)(\lambda-1) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><br>
最大的特征值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\lambda_1=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo>−</mo><mn>3</mn><mi>I</mi><mo stretchy="false">)</mo><mi>u</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>u</mi><mo>=</mo><mn>0</mn><mo>⇒</mo><msub><mi>u</mi><mn>1</mn></msub><mo>+</mo><msub><mi>u</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(S-3I)u = \begin{bmatrix} -1 &amp; -1 \\ -1 &amp; -1 \end{bmatrix} u = 0 \Rightarrow u_1 + u_2 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>.<br>
对应的单位特征向量为: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">u = \begin{bmatrix} \frac{1}{\sqrt{2}} \\ -\frac{1}{\sqrt{2}} \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6331em;"><span style="top:-3.788em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.551em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">2</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.4049em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.551em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">2</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1331em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">]</span></span></span></span></span></span> or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix} -\frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6331em;"><span style="top:-3.788em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.551em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">2</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.4049em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.551em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">2</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1331em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">]</span></span></span></span></span></span></p>
</li>
<li>
<p><strong>进行投影:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msup><mi>u</mi><mi>T</mi></msup><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">y = u^T x&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
</ol>
<hr>
<p><strong>【例题3】</strong> 简述PCA和Fisher准则的区别<br>
<strong>【解答3】</strong> (以下文字是AI生成的)<br>
PCA(主成分分析)和Fisher准则(Fisher线性判别分析)都是降维技术,但它们的目标和方法有所不同:</p>
<ol>
<li><strong>目标不同:</strong>
<ul>
<li><strong>PCA:</strong> 主要目的是数据压缩和特征提取,通过正交变换将数据转换到新的坐标系,使得数据的任何投影的第一大方差在第一个坐标(称为第一主成分)上,第二大方差在第二个坐标上,依此类推。PCA不涉及监督学习,即不考虑数据的标签信息。</li>
<li><strong>Fisher准则:</strong> 是一种监督学习的降维技术,目的是寻找最佳的投影方向,使得不同类别的数据在该方向上的距离尽可能远,而同类数据尽可能近。它利用了数据的类别标签信息。</li>
</ul>
</li>
<li><strong>方法不同:</strong>
<ul>
<li><strong>PCA:</strong> 通过协方差矩阵的特征值和特征向量来确定主成分,选择的是数据方差最大的方向。</li>
<li><strong>Fisher准则:</strong> 通过最大化类间散度与类内散度的比值来确定最佳投影方向,选择的是区分不同类别最有效的方向。</li>
</ul>
</li>
<li><strong>应用场景不同:</strong>
<ul>
<li><strong>PCA:</strong> 适用于无监督学习场景,比如数据压缩、去噪等。</li>
<li><strong>Fisher准则:</strong> 适用于监督学习场景,尤其是分类问题中的特征提取和降维。</li>
</ul>
</li>
<li><strong>对数据的要求不同:</strong>
<ul>
<li><strong>PCA:</strong> 对数据的分布没有特别的要求,可以处理各种类型的数据。</li>
<li><strong>Fisher准则:</strong> 要求数据是分类的,需要知道每个数据点的类别标签。</li>
</ul>
</li>
</ol>
<p>总结来说,PCA是一种无监督的降维方法,关注于数据的方差;而Fisher准则是一种监督的降维方法,关注于类别的区分度。</p>
<hr>
<h2 id="支持向量机">支持向量机</h2>
<p><strong>【来源】</strong> 参考文献1、2、3、4、5</p>
<p><strong>【讲解】</strong> 支持向量机的考法一般是让你简述一下原理,然后问一下软间隔和核函数。</p>
<p><strong>【例题】</strong> SVM的基本思想,模型表达式,软间隔和硬间隔的物理含义,如何用来解决非线性问题</p>
<p><strong>【解答】</strong><br>
对于分类问题：在空间中找一个超平面，最大化地分开不同数据点。对于样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{x_i, t_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是空间中的点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy="false">{</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">t_i \in \{-1, 1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>是标签。找一个分类器 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y(x) = w^T x + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9247em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>, 使得:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>y</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>y</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">t_i = \begin{cases} 1, &amp; y(x_i) &gt; 0 \\ -1, &amp; y(x_i) &lt; 0 \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>
为了鲁棒性，我们要求 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t_i(w^T x_i + b) \ge 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。<br>
SVM的思想是，寻找一个超平面，使其两端的空白区（margin）最大。间隔为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>2</mn><mrow><mi mathvariant="normal">∣</mi><mi>w</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{2}{|w|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3651em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。最大化间隔等价于最小化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>w</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|w|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">∣</span></span></span></span>。</p>
<p><strong>硬间隔SVM</strong>:<br>
问题等价为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>w</mi><mo separator="true">,</mo><mi>b</mi></mrow></msub><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi></mrow><annotation encoding="application/x-tex">\min_{w,b} \frac{1}{2} w^T w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span><br>
s.t. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t_i(w^T x_i + b) \ge 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><br>
这就是SVM的基本型。利用拉格朗日乘数法，可以写出其对偶问题:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>α</mi></msub><mrow><mo fence="true">(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>α</mi><mi>i</mi></msub><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>α</mi><mi>i</mi></msub><msub><mi>α</mi><mi>j</mi></msub><msub><mi>t</mi><mi>i</mi></msub><msub><mi>t</mi><mi>j</mi></msub><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\max_{\alpha} \left( \sum_{i=1}^{N} \alpha_i - \frac{1}{2}\sum_{i=1}^{N}\sum_{j=1}^{N} \alpha_i \alpha_j t_i t_j x_i^T x_j \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span><br>
s.t. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha_i \ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>α</mi><mi>i</mi></msub><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{N} \alpha_i t_i = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><br>
其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>α</mi><mi>n</mi></msub><msub><mi>t</mi><mi>n</mi></msub><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">w = \sum_{n=1}^{N} \alpha_n t_n x_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and b可以从支持向量（即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha_i&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>的样本）中解出。</p>
<p><strong>软间隔SVM与非线性问题</strong>:</p>
<ul>
<li>
<p><strong>软间隔</strong>: 当数据有噪声或者不是线性可分时，硬间隔的条件无法满足。这时可以用软间隔法。对于每一个样本引入一个松弛变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi_i \ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，原始问题变成：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>ξ</mi></mrow></msub><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>w</mi><mi>T</mi></msup><mi>w</mi><mo>+</mo><mi>C</mi><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>ξ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\min_{w,b,\xi} \frac{1}{2} w^T w + C \sum_{i=1}^N \xi_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04601em;">ξ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
s.t. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>≥</mo><mn>1</mn><mo>−</mo><msub><mi>ξ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i(w^T x_i + b) \ge 1 - \xi_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi_i \ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><br>
对偶问题中的约束变为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>α</mi><mi>i</mi></msub><mo>≤</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">0 \le \alpha_i \le C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>。参数C是惩罚项，控制着对误分类样本的惩罚程度。</p>
</li>
<li>
<p><strong>核技巧</strong>: 应对非线性可分问题的另一种方法。如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{x_i, t_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 不是线性可分的，则可能存在一个映射 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>:</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup><mo>→</mo><msup><mi mathvariant="double-struck">R</mi><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">\phi: \mathbb{R}^d \rightarrow \mathbb{R}^{d&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9425em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>, 使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\phi(x_i), t_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^{d&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9425em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> 中是线性可分的，其中一般有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≥</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">d&#x27; \ge d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879em;vertical-align:-0.136em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>。此时，SVM的对偶问题变为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>α</mi></msub><mrow><mo fence="true">(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>α</mi><mi>i</mi></msub><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>α</mi><mi>i</mi></msub><msub><mi>α</mi><mi>j</mi></msub><msub><mi>t</mi><mi>i</mi></msub><msub><mi>t</mi><mi>j</mi></msub><msup><mi>ϕ</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\max_{\alpha} \left( \sum_{i=1}^{N} \alpha_i - \frac{1}{2}\sum_{i=1}^{N}\sum_{j=1}^{N} \alpha_i \alpha_j t_i t_j \phi^T(x_i)\phi(x_j) \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span><br>
s.t. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>α</mi><mi>i</mi></msub><mo>≤</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">0 \le \alpha_i \le C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>α</mi><mi>i</mi></msub><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{N} \alpha_i t_i = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><br>
所谓的核技巧，就是寻找一个函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k(x_i, x_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msup><mi>ϕ</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k(x_i, x_j) = \phi^T(x_i)\phi(x_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1274em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，且计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k(x_i, x_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>的复杂度远低于先计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>再做内积。这样就能够高效地在更高维空间中寻找分界。常用的核有：</p>
<ol>
<li><strong>线性核</strong>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">k(x_i, x_j) = x_i^T x_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1274em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>多项式核</strong>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>γ</mi><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>j</mi></msub><mo>+</mo><mi>c</mi><msup><mo stretchy="false">)</mo><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">k(x_i, x_j) = (\gamma x_i^T x_j + c)^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1274em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></li>
<li><strong>高斯核 (RBF核)</strong>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi>γ</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mi>j</mi></msub><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k(x_i, x_j) = \exp(-\gamma|x_i - x_j|^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1002em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ol>
</li>
</ul>
<hr>
<h2 id="k-means算法和em算法">K-Means算法和EM算法</h2>
<p><strong>【讲解】</strong> 一般都是考概念题,问你K均值算法、高斯混合模型、EM算法分别是什么,有什么改进空间等。</p>
<h3 id="k均值算法-k-means">K均值算法 (K-Means)</h3>
<p><strong>定义</strong>: 给定D维空间上的数据集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>N</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">X=\{x_1, ..., x_N\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>，这些数据对应类别未知。K均值算法将数据集划分成K个簇，每个簇有一个聚类中心 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mu_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, 并将每一个样本 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">x_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 划归到离该样本最近的聚类中心。</p>
<p><strong>K均值算法的一般流程</strong>:</p>
<ol>
<li><strong>初始化</strong>: 随机选择K个样本点作为初始聚类中心 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>μ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mu_1, ..., \mu_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li><strong>E-step (分配)</strong>: 将每个数据点划分给最近的聚类中心。用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r_{nk}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>表示<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">x_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>属于簇k，否则为0。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>k</mi><mo>=</mo><mi>arg</mi><mo>⁡</mo><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>j</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>j</mi></msub><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">r_{nk} = \begin{cases} 1 &amp; \text{if } k = \arg\min_j |x_n - \mu_j|^2 \\ 0 &amp; \text{otherwise} \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li><strong>M-step (更新)</strong>: 重新计算每个簇的中心。最小化准则函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>r</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>k</mi></msub><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">J = \sum_{n=1}^{N}\sum_{k=1}^{K} r_{nk} |x_n - \mu_k|^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>。对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mu_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 求导并置零可得：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>μ</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mn>2</mn><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>r</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mo>⇒</mo><msub><mi>μ</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mi>n</mi></msub><msub><mi>r</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><msub><mi>x</mi><mi>n</mi></msub></mrow><mrow><msub><mo>∑</mo><mi>n</mi></msub><msub><mi>r</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial J}{\partial \mu_k} = 2\sum_{n=1}^{N} r_{nk}(x_n - \mu_k) = 0 \Rightarrow \mu_k = \frac{\sum_n r_{nk}x_n}{\sum_n r_{nk}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3612em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.63em;vertical-align:-0.57em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.06em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.0139em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.535em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.0139em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.57em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li><strong>迭代</strong>: 重复步骤2和3, 直到满足终止条件(聚类中心不再发生显著变化或达到最大迭代次数)。</li>
</ol>
<h3 id="k-means的改进">K-means的改进</h3>
<ul>
<li>
<p><strong>K-means++</strong></p>
<ul>
<li><strong>基本思想</strong>: 针对K-means的簇中心初始化做了改进。假设已选取了n个初始聚类中心(0 &lt; n &lt; k)，在选取第n+1个中心时，距离当前n个聚类中心越远的点会有更高的概率被选为第n+1个聚类中心。具体来说，选择下一个中心<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>的概率正比于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">D(x)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>是点x到已选中心的最短距离。这使得初始聚类中心互相离得更远。</li>
</ul>
</li>
<li>
<p><strong>Kernel K-means</strong></p>
<ul>
<li><strong>基本思想</strong>: 传统K-means采用欧式距离进行样本间的相似度度量，这并不适用于所有数据集。参照SVM中核函数的思想，将所有样本映射到另外一个特征空间(一般为高维)中再进行聚类。</li>
</ul>
</li>
</ul>
<h3 id="高斯混合模型-gmm">高斯混合模型 (GMM)</h3>
<p><strong>定义</strong>: GMM是一种统计模型, 用于表示一组数据是由多个高斯分布混合而成的。GMM是多个高斯分布的线性组合，每个高斯分布称为一个混合成分，每个混合成分都有一个对应的混合系数(先验概率)，所有混合系数的和为1。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>π</mi><mi>k</mi></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>μ</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x) = \sum_{k=1}^{K} \pi_k \mathcal{N}(x | \mu_k, \Sigma_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, 其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>π</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{k=1}^{K} \pi_k = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><br>
GMM能够捕捉数据的多峰特性，广泛应用于聚类分析、图像分割等领域。</p>
<h3 id="em算法-for-gmm">EM算法 for GMM</h3>
<p>使用期望最大化(EM)算法来估计GMM的参数(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>μ</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\pi_k, \mu_k, \Sigma_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)。</p>
<ol>
<li><strong>初始化</strong>: 初始化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>π</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mu_k, \Sigma_k, \pi_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li><strong>E-step (期望)</strong>: 计算每个数据点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">x_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>由每个分量k生成的后验概率(也称为“责任” <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\gamma(z_{nk})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>)。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>k</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>k</mi></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>μ</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>π</mi><mi>j</mi></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>μ</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\gamma(z_{nk}) = p(k|x_n) = \frac{\pi_k \mathcal{N}(x_n|\mu_k, \Sigma_k)}{\sum_{j=1}^{K} \pi_j \mathcal{N}(x_n|\mu_j, \Sigma_j)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7619em;vertical-align:-0.7519em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.5703em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8852em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4603em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li><strong>M-step (最大化)</strong>: 使用E-step中计算的责任来更新模型参数。
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>k</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N_k = \sum_{n=1}^{N} \gamma(z_{nk})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> (每个分量的有效点数)</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>μ</mi><mi>k</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><msub><mi>N</mi><mi>k</mi></msub></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mu_k^{new} = \frac{1}{N_k} \sum_{n=1}^{N} \gamma(z_{nk}) x_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9475em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4321em;vertical-align:-0.4509em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.109em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="normal">Σ</mi><mi>k</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><msub><mi>N</mi><mi>k</mi></msub></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><msubsup><mi>μ</mi><mi>k</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msubsup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><msubsup><mi>μ</mi><mi>k</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msubsup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\Sigma_k^{new} = \frac{1}{N_k} \sum_{n=1}^{N} \gamma(z_{nk}) (x_n - \mu_k^{new})(x_n - \mu_k^{new})^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9664em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4321em;vertical-align:-0.4509em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.109em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0331em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>π</mi><mi>k</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msubsup><mo>=</mo><mfrac><msub><mi>N</mi><mi>k</mi></msub><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">\pi_k^{new} = \frac{N_k}{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9475em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4169em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8942em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.109em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ul>
</li>
<li><strong>迭代</strong>: 重复E-step和M-step直到对数似然函数收敛。最终结果可能依赖于初始值，可以多次初始化取最好的结果。</li>
</ol>
<hr>
<h2 id="集成学习">集成学习</h2>
<p><strong>【例题】</strong> 简述集成学习的基本思想,简述Boosting和Bagging的原理和区别</p>
<p><strong>【解答】</strong><br>
<strong>基本思想</strong>: 集成学习通过构建并结合多个学习器来完成学习任务，以获得比单一学习器更优的泛化性能。其关键是如何产生「好而不同」的个体学习器。</p>
<p><strong>Bagging (Bootstrap Aggregating)</strong>:</p>
<ul>
<li><strong>原理</strong>: Bagging是并行方法。它基于自主采样法(bootstrap sampling)，即从原始训练集中有放回地抽取样本，构造T个含m个样本的采样集。基于每个采样集独立地训练一个基学习器，最后将这些学习器进行组合（分类任务用投票，回归任务用平均）。随机森林是Bagging的一个扩展变体。</li>
<li><strong>特点</strong>:
<ul>
<li>关注于降低方差。</li>
<li>基学习器之间没有强依赖，可以并行生成。</li>
<li>对于不稳定的学习算法（如决策树）效果较好。</li>
<li>无法显著降低偏差。</li>
</ul>
</li>
</ul>
<p><strong>Boosting</strong>:</p>
<ul>
<li><strong>原理</strong>: Boosting是串行方法。它序贯地训练一系列基学习器，每个新的学习器都重点关注之前学习器学错的样本。具体做法是，先训练一个学习器，然后根据其表现调整训练样本的分布（或权重），使得先前错分的样本在后续训练中得到更多关注。如此重复，直到获得足够多的学习器，最后进行加权组合。AdaBoost是Boosting的代表算法。</li>
<li><strong>特点</strong>:
<ul>
<li>关注于降低偏差。</li>
<li>个体学习器之间有强依赖关系，必须串行生成。</li>
<li>通常使用弱学习器（性能略好于随机猜测），如浅层决策树。</li>
<li>对噪声数据较为敏感。</li>
</ul>
</li>
</ul>
<p><strong>区别总结</strong>:</p>
<ol>
<li><strong>样本选择</strong>: Bagging采用有放回的随机采样；Boosting的每一轮训练样本是根据上一轮的学习结果进行调整的。</li>
<li><strong>学习器关系</strong>: Bagging的学习器是并行的、相互独立的；Boosting的学习器是串行的、相互依赖的。</li>
<li><strong>主要目标</strong>: Bagging主要减少方差；Boosting主要减少偏差。</li>
<li><strong>权重</strong>: Bagging的所有学习器权重相等（在投票或平均时）；Boosting的学习器有不同的权重，表现好的学习器权重更大。</li>
</ol>
<hr>
<h2 id="决策树">决策树</h2>
<p><strong>【讲解】</strong> 考法是使用ID3构造决策树,然后简述预剪枝和后剪枝法。</p>
<p><strong>【例题1】</strong> 用ID3算法对下面的数据集进行分类,根据星球的大小和轨道判断其是否宜居:</p>
<table>
<thead>
<tr>
<th style="text-align:center">数量</th>
<th style="text-align:center">大小</th>
<th style="text-align:center">轨道</th>
<th style="text-align:center">是否宜居</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">30</td>
<td style="text-align:center">大</td>
<td style="text-align:center">远</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center">130</td>
<td style="text-align:center">大</td>
<td style="text-align:center">近</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center">48</td>
<td style="text-align:center">小</td>
<td style="text-align:center">远</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center">161</td>
<td style="text-align:center">小</td>
<td style="text-align:center">近</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td style="text-align:center">大</td>
<td style="text-align:center">远</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center">170</td>
<td style="text-align:center">大</td>
<td style="text-align:center">近</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">小</td>
<td style="text-align:center">远</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center">230</td>
<td style="text-align:center">小</td>
<td style="text-align:center">近</td>
<td style="text-align:center">否</td>
</tr>
</tbody>
</table>
<p><strong>【解答】</strong><br>
总样本数 D = 30+130+48+161+20+170+11+230 = 800<br>
宜居 (是): 30+130+48+161 = 369<br>
不宜居 (否): 20+170+11+230 = 431</p>
<ol>
<li>
<p><strong>计算根节点总信息熵:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><mfrac><mn>369</mn><mn>800</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>369</mn><mn>800</mn></mfrac><mo>+</mo><mfrac><mn>431</mn><mn>800</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>431</mn><mn>800</mn></mfrac><mo stretchy="false">)</mo><mo>≈</mo><mn>0.9957</mn></mrow><annotation encoding="application/x-tex">H(D) = -(\frac{369}{800}\log_2\frac{369}{800} + \frac{431}{800}\log_2\frac{431}{800}) \approx 0.9957</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">369</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">369</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">431</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">431</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9957</span></span></span></span></p>
</li>
<li>
<p><strong>计算属性&quot;大小&quot;的信息增益:</strong></p>
<ul>
<li>大小=大: 总数 30+130+20+170 = 350. 是: 160, 否: 190.<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><msup><mi>D</mi><mtext>大</mtext></msup><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><mfrac><mn>160</mn><mn>350</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>160</mn><mn>350</mn></mfrac><mo>+</mo><mfrac><mn>190</mn><mn>350</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>190</mn><mn>350</mn></mfrac><mo stretchy="false">)</mo><mo>≈</mo><mn>0.9947</mn></mrow><annotation encoding="application/x-tex">H(D^{大}) = -(\frac{160}{350}\log_2\frac{160}{350} + \frac{190}{350}\log_2\frac{190}{350}) \approx 0.9947</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">大</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">350</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">160</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">350</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">160</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">350</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">190</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">350</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">190</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9947</span></span></span></span></li>
<li>大小=小: 总数 48+161+11+230 = 450. 是: 209, 否: 241.<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><msup><mi>D</mi><mtext>小</mtext></msup><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><mfrac><mn>209</mn><mn>450</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>209</mn><mn>450</mn></mfrac><mo>+</mo><mfrac><mn>241</mn><mn>450</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>241</mn><mn>450</mn></mfrac><mo stretchy="false">)</mo><mo>≈</mo><mn>0.9963</mn></mrow><annotation encoding="application/x-tex">H(D^{小}) = -(\frac{209}{450}\log_2\frac{209}{450} + \frac{241}{450}\log_2\frac{241}{450}) \approx 0.9963</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">小</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">450</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">209</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">450</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">209</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">450</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">241</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">450</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">241</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9963</span></span></span></span></li>
<li>条件熵: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mtext>大小</mtext><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>350</mn><mn>800</mn></mfrac><mi>H</mi><mo stretchy="false">(</mo><msup><mi>D</mi><mtext>大</mtext></msup><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>450</mn><mn>800</mn></mfrac><mi>H</mi><mo stretchy="false">(</mo><msup><mi>D</mi><mtext>小</mtext></msup><mo stretchy="false">)</mo><mo>≈</mo><mn>0.4375</mn><mo>×</mo><mn>0.9947</mn><mo>+</mo><mn>0.5625</mn><mo>×</mo><mn>0.9963</mn><mo>≈</mo><mn>0.9956</mn></mrow><annotation encoding="application/x-tex">H(D|大小) = \frac{350}{800}H(D^{大}) + \frac{450}{800}H(D^{小}) \approx 0.4375 \times 0.9947 + 0.5625 \times 0.9963 \approx 0.9956</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord cjk_fallback">大小</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">350</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">大</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">450</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">小</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.4375</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.9947</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.5625</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9963</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9956</span></span></span></span></li>
<li>信息增益: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mtext>大小</mtext><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mtext>大小</mtext><mo stretchy="false">)</mo><mo>≈</mo><mn>0.9957</mn><mo>−</mo><mn>0.9956</mn><mo>=</mo><mn>0.0001</mn></mrow><annotation encoding="application/x-tex">G(D, 大小) = H(D) - H(D|大小) \approx 0.9957 - 0.9956 = 0.0001</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">大小</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord cjk_fallback">大小</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.9957</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9956</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.0001</span></span></span></span></li>
</ul>
</li>
<li>
<p><strong>计算属性&quot;轨道&quot;的信息增益:</strong></p>
<ul>
<li>轨道=远: 总数 30+48+20+11 = 109. 是: 78, 否: 31.<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><msup><mi>D</mi><mtext>远</mtext></msup><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><mfrac><mn>78</mn><mn>109</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>78</mn><mn>109</mn></mfrac><mo>+</mo><mfrac><mn>31</mn><mn>109</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>31</mn><mn>109</mn></mfrac><mo stretchy="false">)</mo><mo>≈</mo><mn>0.8614</mn></mrow><annotation encoding="application/x-tex">H(D^{远}) = -(\frac{78}{109}\log_2\frac{78}{109} + \frac{31}{109}\log_2\frac{31}{109}) \approx 0.8614</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">远</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">109</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">78</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">109</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">78</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">109</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">109</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.8614</span></span></span></span></li>
<li>轨道=近: 总数 130+161+170+230 = 691. 是: 291, 否: 400.<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><msup><mi>D</mi><mtext>近</mtext></msup><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><mfrac><mn>291</mn><mn>691</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>291</mn><mn>691</mn></mfrac><mo>+</mo><mfrac><mn>400</mn><mn>691</mn></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>400</mn><mn>691</mn></mfrac><mo stretchy="false">)</mo><mo>≈</mo><mn>0.9820</mn></mrow><annotation encoding="application/x-tex">H(D^{近}) = -(\frac{291}{691}\log_2\frac{291}{691} + \frac{400}{691}\log_2\frac{400}{691}) \approx 0.9820</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">近</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">691</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">291</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">691</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">291</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">691</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">400</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">691</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">400</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9820</span></span></span></span></li>
<li>条件熵: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mtext>轨道</mtext><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>109</mn><mn>800</mn></mfrac><mi>H</mi><mo stretchy="false">(</mo><msup><mi>D</mi><mtext>远</mtext></msup><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>691</mn><mn>800</mn></mfrac><mi>H</mi><mo stretchy="false">(</mo><msup><mi>D</mi><mtext>近</mtext></msup><mo stretchy="false">)</mo><mo>≈</mo><mn>0.13625</mn><mo>×</mo><mn>0.8614</mn><mo>+</mo><mn>0.86375</mn><mo>×</mo><mn>0.9820</mn><mo>≈</mo><mn>0.9656</mn></mrow><annotation encoding="application/x-tex">H(D|轨道) = \frac{109}{800}H(D^{远}) + \frac{691}{800}H(D^{近}) \approx 0.13625 \times 0.8614 + 0.86375 \times 0.9820 \approx 0.9656</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord cjk_fallback">轨道</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">109</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">远</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">800</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">691</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">近</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.13625</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.8614</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.86375</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9820</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9656</span></span></span></span></li>
<li>信息增益: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mtext>轨道</mtext><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><mi>D</mi><mi mathvariant="normal">∣</mi><mtext>轨道</mtext><mo stretchy="false">)</mo><mo>≈</mo><mn>0.9957</mn><mo>−</mo><mn>0.9656</mn><mo>=</mo><mn>0.0301</mn></mrow><annotation encoding="application/x-tex">G(D, 轨道) = H(D) - H(D|轨道) \approx 0.9957 - 0.9656 = 0.0301</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">轨道</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mord cjk_fallback">轨道</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.9957</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.9656</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.0301</span></span></span></span></li>
</ul>
</li>
<li>
<p><strong>选择第一个节点:</strong><br>
因为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mtext>轨道</mtext><mo stretchy="false">)</mo><mo>&gt;</mo><mi>G</mi><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mtext>大小</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(D, 轨道) &gt; G(D, 大小)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">轨道</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">大小</span><span class="mclose">)</span></span></span></span>, 所以选择&quot;轨道&quot;作为根节点。</p>
</li>
<li>
<p><strong>对子节点进行划分:</strong></p>
<ul>
<li><strong>T1 (轨道=近):</strong>
<ul>
<li>样本集: 691个. 是: 291, 否: 400.</li>
<li>因为 “否” (400) &gt; “是” (291), 该分支下的样本多数为不宜居。如果我们不再划分，将此叶节点标记为“不宜居”。</li>
</ul>
</li>
<li><strong>T2 (轨道=远):</strong>
<ul>
<li>样本集: 109个. 是: 78, 否: 31.</li>
<li>因为 “是” (78) &gt; “否” (31), 该分支下的样本多数为宜居。如果我们不再划分，将此叶节点标记为“宜居”。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>如果这是一个简单的树，可以就此停止。* 在 T1 (轨道=近) 分支下, “大小=大” -&gt; 是:130, 否:170 (多数为否); “大小=小” -&gt; 是:161, 否:230 (多数为否)。<br>
* 在 T2 (轨道=远) 分支下, “大小=大” -&gt; 是:30, 否:20 (多数为是); “大小=小” -&gt; 是:48, 否:11 (多数为是)。</p>
<p>由于两个子节点的多数类别已经确定，且在该子节点下根据另一属性划分后，其子节点的多数类别不变，我们可以将树构建如下：</p>
<hr>
<h3 id="id3算法的问题与改进">ID3算法的问题与改进</h3>
<ul>
<li><strong>信息增益的问题</strong>: 信息增益准则对可取值数目较多的属性有所偏好。例如，如果用“编号”作为属性，每个样本一个编号，那么每个分支都只包含一个样本（纯度最高），信息增益会是最大的，但这显然是不合理的。</li>
<li><strong>增益率 (C4.5算法)</strong>: 为了缓解这个问题，C4.5算法使用增益率来选择属性。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mrow><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi></mrow></msub><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">G_{ratio}(D, a) = \frac{G(D, a)}{H(a)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>
其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>v</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></msubsup><mfrac><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mi>v</mi></msup><mi mathvariant="normal">∣</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mi>v</mi></msup><mi mathvariant="normal">∣</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi>D</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">H(a) = -\sum_{v=1}^{V} \frac{|D^v|}{|D|} \log_2 \frac{|D^v|}{|D|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em;">V</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 称为属性a的“固有值”。属性a的取值越多，其固有值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span>通常也越大，从而对信息增益进行惩罚。</li>
</ul>
<hr>
<p><strong>【例题2】</strong> 描述预剪枝法和后剪枝法的方法和优缺点<br>
<strong>【解答】</strong> (以下内容由AI生成)</p>
<p><strong>预剪枝法 (Pre-pruning)</strong></p>
<ul>
<li><strong>具体方法:</strong> 预剪枝是在决策树生成的过程中,对每个节点在划分前先进行估计,如果当前节点的划分不能带来决策树泛化性能提升(例如，在验证集上的准确率没有提升),则停止划分,并将当前节点标记为叶子节点。常见的预剪枝策略包括限制树的最大深度、限制叶节点的最小样本数量、限制节点划分所需的最小信息增益等。</li>
<li><strong>优点:</strong>
<ol>
<li>降低过拟合风险:通过限制树的生长,减少过拟合的可能性。</li>
<li>减少训练和测试时间:由于树的生长被提前终止,可以减少模型的训练和预测时间。</li>
</ol>
</li>
<li><strong>缺点:</strong>
<ol>
<li>欠拟合风险:由于提前停止树的生长,可能会错过一些对模型性能有益的分支,导致模型欠拟合。</li>
<li>视野效应问题:可能在当前划分看似不能提升性能的情况下,进一步的扩展能够显著提高性能,预剪枝会导致算法过早停止。</li>
</ol>
</li>
</ul>
<p><strong>后剪枝法 (Post-pruning)</strong></p>
<ul>
<li><strong>具体方法:</strong> 后剪枝是在决策树完全生长之后进行的剪枝,它首先生成一棵完整的决策树,然后自底向上地对非叶结点进行考察,若将该结点对应的子树替换为叶结点能带来决策树泛化性能提升(例如，在验证集上准确率提升),则将该子树替换为叶结点。常见的后剪枝方法包括错误率降低剪枝(REP)、悲观错误剪枝(PEP)、代价复杂度剪枝(CCP)等。</li>
<li><strong>优点:</strong>
<ol>
<li>泛化性能通常优于预剪枝:后剪枝保留了更多的分支,使得模型有更大的空间去学习和适应数据的复杂模式。</li>
<li>减少欠拟合风险:相较于预剪枝,后剪枝的欠拟合风险更小。</li>
</ol>
</li>
<li><strong>缺点:</strong>
<ol>
<li>训练时间开销大:后剪枝需要在生成完全决策树之后进行剪枝,因此其训练时间开销比未剪枝决策树和预剪枝决策树都要大得多。</li>
<li>计算资源需求高:由于需要在完整的决策树上进行剪枝操作,后剪枝需要更多的计算资源。</li>
</ol>
</li>
</ul>
<hr>
<h2 id="反向传播算法">反向传播算法</h2>
<p><strong>【讲解】</strong><br>
首先记住这个神经元的基本结构,尤其记住各个符号的含义:</p>
<ol>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong>: 前一层的输入</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong>: 权值, 也是神经网络训练的目标</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo></mrow><annotation encoding="application/x-tex">\sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span></span></span></span></strong>: 求和器</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></strong>: 求和器阈值 (或偏置b, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mo>∑</mo><msub><mi>x</mi><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a=\sum x_i w_i + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>)</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></strong>: 净激活，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub><mo>−</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">a = \sum_{i=1}^{N} x_i w_i - \theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2809em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></strong>: 激活函数, 就是ReLU、Sigmoid之类的</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></strong>: 神经元输出，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y=f(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></li>
</ol>
<p>之后的神经网络图中,每一个「圆点」,其实都暗含了这些东西。</p>
<p><strong>算法思想</strong><br>
反向传播算法基于梯度下降，目的是最小化损失函数，如均方误差:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>t</mi><mi>n</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E(w) = \frac{1}{2}\sum_{n=1}^{N} (y(x_n, w) - t_n)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><br>
算法可以分为两个阶段：</p>
<ol>
<li><strong>前馈(正向过程):</strong> 从输入层经隐层逐层正向计算各单元的输出。</li>
<li><strong>学习(反向过程):</strong> 由输出误差逐层反向计算隐层各单元的误差梯度,并用此误差梯度更新前层的权值。</li>
</ol>
<p><strong>梯度计算 (链式法则)</strong><br>
考虑从j层到k层的权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{kj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>。损失E对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{kj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>的偏导为：<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial E_n}{\partial w_{kj}} = \frac{\partial E_n}{\partial a_k} \frac{\partial a_k}{\partial w_{kj}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4443em;vertical-align:-0.5481em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.45em;vertical-align:-0.5481em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.902em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>
我们定义误差项 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\delta_k = \frac{\partial E_n}{\partial a_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3471em;vertical-align:-0.4509em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。因为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>=</mo><msub><mo>∑</mo><mi>j</mi></msub><msub><mi>w</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><msub><mi>y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">a_k = \sum_j w_{kj} y_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1858em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，所以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><msub><mi>y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial a_k}{\partial w_{kj}} = y_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.45em;vertical-align:-0.5481em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.902em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> (其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">y_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>是j层神经元的输出)。<br>
因此: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><msub><mi>δ</mi><mi>k</mi></msub><msub><mi>y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial E_n}{\partial w_{kj}} = \delta_k y_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4443em;vertical-align:-0.5481em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5481em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><strong>对于输出层节点k</strong>:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>y</mi><mi>k</mi></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><msub><mi>t</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>a</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\delta_k = \frac{\partial E_n}{\partial a_k} = \frac{\partial E_n}{\partial y_k} \frac{\partial y_k}{\partial a_k} = (y_k - t_k) f&#x27;(a_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3471em;vertical-align:-0.4509em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4133em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li><strong>对于隐藏层节点j</strong>:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>j</mi></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo stretchy="false">(</mo><msub><mo>∑</mo><mi>k</mi></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mo>∑</mo><mi>k</mi></msub><msub><mi>δ</mi><mi>k</mi></msub><msub><mi>w</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\delta_j = \frac{\partial E_n}{\partial a_j} = (\sum_{k} \frac{\partial E_n}{\partial a_k} \frac{\partial a_k}{\partial a_j}) = (\sum_{k} \delta_k w_{kj}) f&#x27;(a_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4385em;vertical-align:-0.5423em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4443em;vertical-align:-0.5423em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.902em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0516em;vertical-align:-0.2997em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
<p><strong>权重更新</strong>:<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><msubsup><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>−</mo><mi>η</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mo>=</mo><msubsup><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow><mrow><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>−</mo><mi>η</mi><msub><mi>δ</mi><mi>j</mi></msub><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_{ji}^{(\tau+1)} = w_{ji}^{(\tau)} - \eta \frac{\partial E}{\partial w_{ji}^{(\tau)}} = w_{ji}^{(\tau)} - \eta \delta_j y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ji</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ji</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.7543em;vertical-align:-0.8742em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.4486em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.2134em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ji</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4612em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8742em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ji</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span> 是学习率。</p>
<p><strong>一个有用的结论</strong>: 如果激活函数是Sigmoid函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\sigma(x) = \frac{1}{1+e^{-x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7027em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, 那么它的导数是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma&#x27;(x) = \sigma(x)(1-\sigma(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span>。</p>
<hr>
<p><strong>【例题1】</strong><br>
包含一层隐藏层的前馈神经网络如图所示,给定训练集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mi>t</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">D=\{(x_n, t_n)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)}</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>D</mi></msup><mo separator="true">,</mo><msub><mi>t</mi><mi>n</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">x_n \in \mathbb{R}^D, t_n \in \mathbb{R}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span>。隐藏层激活函数为h，输出层激活函数为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span>。准则函数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>t</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E_n(w) = \frac{1}{2}\sum_{k=1}^{K} (y_{nk} - t_{nk})^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3262em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>。网络包含D个输入神经元, M个隐层神经元, K个输出神经元。试推导反向传播算法中对每一层权值参数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>w</mi><mrow><mi>m</mi><mi>d</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(w_{md}^{(1)}, w_{km}^{(2)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 的更新表达式。</p>
<p><strong>【解答1】</strong></p>
<ol>
<li>
<p><strong>前向传播:</strong></p>
<ul>
<li>隐层输入: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>m</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow><mi>D</mi></msubsup><msubsup><mi>w</mi><mrow><mi>m</mi><mi>d</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>x</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">a_m = \sum_{d=0}^{D} w_{md}^{(1)} x_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>隐层输出: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>m</mi></msub><mo>=</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z_m = h(a_m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li>输出层输入: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mi>M</mi></msubsup><msubsup><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>z</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">a_k = \sum_{m=0}^{M} w_{km}^{(2)} z_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>网络输出: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{nk} = \sigma(a_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li>
<p><strong>反向传播 (计算误差项 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span>)</strong></p>
<ul>
<li><strong>输出层 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\delta_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>y</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>y</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>t</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>a</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\delta_k = \frac{\partial E_n}{\partial a_k} = \frac{\partial E_n}{\partial y_{nk}} \frac{\partial y_{nk}}{\partial a_k} = (y_{nk} - t_{nk}) \sigma&#x27;(a_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3471em;vertical-align:-0.4509em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4133em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li><strong>隐藏层 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\delta_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>m</mi></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>m</mi></msub></mrow></mfrac><mo>=</mo><mo stretchy="false">(</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>m</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>δ</mi><mi>k</mi></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mi>m</mi></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mi>m</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>m</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>δ</mi><mi>k</mi></msub><msubsup><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>a</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\delta_m = \frac{\partial E_n}{\partial a_m} = (\sum_{k=1}^K \frac{\partial E_n}{\partial a_k} \frac{\partial a_k}{\partial a_m}) = (\sum_{k=1}^K \delta_k \frac{\partial a_k}{\partial z_m} \frac{\partial z_m}{\partial a_m}) = (\sum_{k=1}^K \delta_k w_{km}^{(2)}) h&#x27;(a_m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3413em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4321em;vertical-align:-0.4509em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.902em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4263em;vertical-align:-0.4451em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.902em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li>
<p><strong>计算梯度:</strong></p>
<ul>
<li><strong>输出层权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">w_{km}^{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span></span>:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mo>=</mo><msub><mi>δ</mi><mi>k</mi></msub><msub><mi>z</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial E_n}{\partial w_{km}^{(2)}} = \frac{\partial E_n}{\partial a_k} \frac{\partial a_k}{\partial w_{km}^{(2)}} = \delta_k z_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6906em;vertical-align:-0.7944em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.4486em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.1885em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7944em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6964em;vertical-align:-0.7944em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.902em;"><span style="top:-2.4486em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.1885em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4159em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7944em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>隐藏层权重 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>w</mi><mrow><mi>m</mi><mi>d</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">w_{md}^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span></span>:</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>w</mi><mrow><mi>m</mi><mi>d</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>m</mi></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>a</mi><mi>m</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>w</mi><mrow><mi>m</mi><mi>d</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mo>=</mo><msub><mi>δ</mi><mi>m</mi></msub><msub><mi>x</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial E_n}{\partial w_{md}^{(1)}} = \frac{\partial E_n}{\partial a_m} \frac{\partial a_m}{\partial w_{md}^{(1)}} = \delta_m x_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6906em;vertical-align:-0.7944em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.4486em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.1885em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7944em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6906em;vertical-align:-0.7944em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.4486em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.1885em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7944em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>
<p><strong>权重更新:</strong></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mo>−</mo><mi>η</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mo>=</mo><mo>−</mo><mi>η</mi><msub><mi>δ</mi><mi>k</mi></msub><msub><mi>z</mi><mi>m</mi></msub><mo>=</mo><mo>−</mo><mi>η</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo>−</mo><msub><mi>t</mi><mrow><mi>n</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>a</mi><mi>k</mi></msub><mo stretchy="false">)</mo><msub><mi>z</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\Delta w_{km}^{(2)} = -\eta \frac{\partial E_n}{\partial w_{km}^{(2)}} = -\eta \delta_k z_m = -\eta (y_{nk} - t_{nk}) \sigma&#x27;(a_k) z_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6906em;vertical-align:-0.7944em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.4486em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.1885em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7944em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">nk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>w</mi><mrow><mi>m</mi><mi>d</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mo>−</mo><mi>η</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>E</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>w</mi><mrow><mi>m</mi><mi>d</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mo>=</mo><mo>−</mo><mi>η</mi><msub><mi>δ</mi><mi>m</mi></msub><msub><mi>x</mi><mi>d</mi></msub><mo>=</mo><mo>−</mo><mi>η</mi><mo stretchy="false">(</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>δ</mi><mi>k</mi></msub><msubsup><mi>w</mi><mrow><mi>k</mi><mi>m</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">)</mo><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>a</mi><mi>m</mi></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\Delta w_{md}^{(1)} = -\eta \frac{\partial E_n}{\partial w_{md}^{(1)}} = -\eta \delta_m x_d = -\eta (\sum_{k=1}^K \delta_k w_{km}^{(2)}) h&#x27;(a_m) x_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6906em;vertical-align:-0.7944em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.4486em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0591em;"><span style="top:-2.1885em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">d</span></span></span></span><span style="top:-3.0591em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5357em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7944em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">km</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
</ol>
<hr>
<p><strong>【例题2】</strong><br>
考虑只有一个神经元的多层神经网络，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_{i+1} = \sigma(w_i x_i + b_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> (i∈[1, 4]), C=Loss(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">x_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>), <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span> 表示sigmoid函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)=1/(1+e^{-x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, 且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|w_i|&lt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。假设已知 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial x_5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 推导 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial b_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> (i∈[1,4]), 并阐述当神经网络层数过深时, 梯度消失的原因。</p>
<p><strong>【解答2】</strong><br>
令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>=</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">z_i = w_i x_i + b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, 则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_{i+1} = \sigma(z_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。</p>
<ol>
<li>
<p><strong>推导 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial b_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></strong><br>
使用链式法则：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>4</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mn>4</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mn>4</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>4</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mo>⋅</mo><mn>1</mn><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>4</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial b_4} = \frac{\partial C}{\partial x_5} \frac{\partial x_5}{\partial z_4} \frac{\partial z_4}{\partial b_4} = \frac{\partial C}{\partial x_5} \sigma&#x27;(z_4) \cdot 1 = \frac{\partial C}{\partial x_5} \sigma&#x27;(z_4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3413em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>3</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>4</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>4</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mn>3</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mn>3</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>3</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><mo stretchy="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mn>4</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mn>4</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>4</mn></msub></mrow></mfrac><mo stretchy="false">)</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>4</mn></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mn>4</mn></msub><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial b_3} = \frac{\partial C}{\partial x_5} \frac{\partial x_5}{\partial x_4} \frac{\partial x_4}{\partial z_3} \frac{\partial z_3}{\partial b_3} = \frac{\partial C}{\partial x_5} (\frac{\partial x_5}{\partial z_4} \frac{\partial z_4}{\partial x_4}) \sigma&#x27;(z_3) = \frac{\partial C}{\partial x_5} \sigma&#x27;(z_4) w_4 \sigma&#x27;(z_3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3413em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3413em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>2</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>4</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>4</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>3</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>3</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mn>2</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>z</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>2</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><mo stretchy="false">(</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>4</mn></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mn>3</mn></msub><mo stretchy="false">)</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial b_2} = \frac{\partial C}{\partial x_5} \frac{\partial x_5}{\partial x_4} \frac{\partial x_4}{\partial x_3} \frac{\partial x_3}{\partial z_2} \frac{\partial z_2}{\partial b_2} = \frac{\partial C}{\partial x_5} (\sigma&#x27;(z_4)w_4) (\sigma&#x27;(z_3)w_3) \sigma&#x27;(z_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3413em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.044em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><mo stretchy="false">(</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>4</mn></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>3</mn></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial b_1} = \frac{\partial C}{\partial x_5} (\sigma&#x27;(z_4)w_4) (\sigma&#x27;(z_3)w_3) (\sigma&#x27;(z_2)w_2) \sigma&#x27;(z_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li>
<p><strong>梯度消失的原因</strong><br>
Sigmoid函数的导数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma&#x27;(z) = \sigma(z)(1-\sigma(z))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">))</span></span></span></span>。其最大值在z=0时取到，为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0.5</mn><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>0.5</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\sigma&#x27;(0) = 0.5 \times (1-0.5) = 0.25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.5</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.25</span></span></span></span>。<br>
因此，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>≤</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\sigma&#x27;(z) \le 0.25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.25</span></span></span></span>。<br>
在上面的推导中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial b_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 的表达式包含了一系列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma&#x27;(z_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的乘积。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>5</mn></msub></mrow></mfrac><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></msubsup><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>⋅</mo><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial b_1} = \frac{\partial C}{\partial x_5} \prod_{i=1}^{3} w_{i+1}\sigma&#x27;(z_{i+1}) \cdot \sigma&#x27;(z_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3991em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
由于题目给定 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|w_i| &lt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>≤</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\sigma&#x27;(z_i) \le 0.25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.25</span></span></span></span>, 这个连乘项 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(w_i \sigma&#x27;(z_i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span> 的绝对值远小于1。当网络层数过深时，这个乘积会变得非常小，趋近于0。<br>
这就导致了靠近输入层的梯度（如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>C</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mn>1</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial C}{\partial b_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>）会变得非常小，使得这些层的权重更新极其缓慢，几乎不学习，这就是<strong>梯度消失</strong>现象。</p>
</li>
</ol>
<hr>
<h2 id="开放性试题">开放性试题</h2>
<p><strong>【来源】</strong> 参考文献1、2、3、4、5</p>
<p><strong>【例题1】</strong> 谈谈你对深度学习的理解,深度学习模型存在什么问题,你觉得深度学习未来会往什么方向发展。<br>
<strong>【解答1】</strong> (以下解答由AI生成)</p>
<ul>
<li>
<p><strong>我对深度学习的理解</strong><br>
深度学习是机器学习的一个子领域,它基于人工神经网络的学习算法,特别是那些具有多个非线性变换的层(即“深度”)。这些层可以学习数据的复杂模式和层次化表示。深度学习模型能够自动从原始数据中提取特征(表示学习),而不需要人为设计特征提取器。这种能力使得深度学习在图像识别、语音识别、自然语言处理等领域取得了革命性的进展。</p>
</li>
<li>
<p><strong>深度学习模型存在的问题</strong></p>
<ol>
<li><strong>数据需求:</strong> 深度学习模型通常需要大量的标注数据来训练,这在某些领域(如医疗图像分析)可能是不切实际的。</li>
<li><strong>可解释性:</strong> 深度学习模型通常被认为是“黑箱”,因为它们的决策过程缺乏透明度,难以解释。</li>
<li><strong>计算资源:</strong> 训练深度学习模型需要大量的计算资源(GPU/TPU),这可能导致成本高昂和能源消耗问题。</li>
<li><strong>过拟合:</strong> 在有限的数据集上训练时,深度学习模型可能会过拟合,即在训练数据上表现很好,但在未见过的数据上表现差。</li>
<li><strong>对抗性脆弱性:</strong> 深度学习模型可能对精心设计的输入(对抗性样本)非常敏感,这些输入可以导致模型做出错误的预测。</li>
</ol>
</li>
<li>
<p><strong>深度学习未来的发展方向</strong></p>
<ol>
<li><strong>更少的数据需求:</strong> 研究如何使用更少的数据来训练有效的模型,例如通过小样本学习、自监督学习、迁移学习和数据增强技术。</li>
<li><strong>提高可解释性 (XAI):</strong> 使模型的决策过程更加透明和可理解，建立对模型的信任。</li>
<li><strong>节能和效率 (Green AI):</strong> 寻找更节能的算法和硬件来训练和部署深度学习模型。</li>
<li><strong>对抗性鲁棒性:</strong> 提高模型对对抗性攻击的鲁棒性,以确保模型在现实世界中的可靠性。</li>
<li><strong>自动机器学习 (AutoML):</strong> 自动化深度学习模型的设计(网络结构搜索)、训练和调参过程。</li>
<li><strong>多模态学习:</strong> 结合来自不同来源（如文本、图像、声音）的信息进行学习。</li>
<li><strong>伦理和公平性:</strong> 确保模型的公平性,避免因数据偏见导致歧视性决策。</li>
</ol>
</li>
</ul>
<hr>
<h2 id="分类器性能度量">分类器性能度量</h2>
<h3 id="混淆矩阵-查准率-查全率-f1">混淆矩阵、查准率、查全率、F1</h3>
<ol>
<li><strong>混淆矩阵(Confusion Matrix)</strong><br>
定义:用于描述分类模型预测结果与真实标签的匹配情况,尤其适用于二分类问题(正例P/负例N)。</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:left">真实标签 \ 预测结果</th>
<th style="text-align:center">预测正例</th>
<th style="text-align:center">预测负例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>真实正例 §</strong></td>
<td style="text-align:center">TP (真正例)</td>
<td style="text-align:center">FN (假负例)</td>
</tr>
<tr>
<td style="text-align:left"><strong>真实负例 (N)</strong></td>
<td style="text-align:center">FP (假正例)</td>
<td style="text-align:center">TN (真负例)</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>TP (True Positive):</strong> 真实为正例,预测为正例 (正确分类)</li>
<li><strong>FN (False Negative):</strong> 真实为正例,预测为负例 (漏报, 第II类错误)</li>
<li><strong>FP (False Positive):</strong> 真实为负例,预测为正例 (误报, 第I类错误)</li>
<li><strong>TN (True Negative):</strong> 真实为负例,预测为负例 (正确分类)</li>
</ul>
<ol start="2">
<li>
<p><strong>查准率(Precision)与查全率(Recall)</strong></p>
<ul>
<li><strong>查准率 (Precision):</strong> 衡量<strong>预测为正例</strong>的样本中真正正例的比例。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Precision = \frac{TP}{TP + FP}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2757em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">FP</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li><strong>查全率 (Recall):</strong> 衡量<strong>真实正例</strong>中被正确预测的比例 (也叫灵敏度, Sensitivity)。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Recall = \frac{TP}{TP + FN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2757em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FN</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li><strong>二者关系 (Trade-off):</strong> 查准率和查全率通常是相互矛盾的。提高查准率（要求更严格地判断为正例）可能会导致一些不那么确定的正例被漏掉，从而降低查全率。反之亦然。
<ul>
<li><strong>高查准率需求:</strong> 垃圾邮件过滤 (宁可漏判, 不可误判正常邮件)。</li>
<li><strong>高查全率需求:</strong> 疾病筛查 (宁可误判, 不可漏掉真实患者)。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>F1 度量 (F1-Score)</strong><br>
定义:查准率与查全率的调和平均数,综合评估模型性能(尤其适用于不均衡数据)。<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mo>=</mo><mfrac><mrow><mn>2</mn><mo>×</mo><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>×</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi></mrow><mrow><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>+</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>2</mn><mi>T</mi><mi>P</mi></mrow><mrow><mn>2</mn><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">F_1 = \frac{2 \times Precision \times Recall}{Precision + Recall} = \frac{2TP}{2TP + FP + FN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2834em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mathnormal mtight">rec</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mord mathnormal mtight">ec</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">ll</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mathnormal mtight">rec</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mord mathnormal mtight">ec</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">ll</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2757em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">FP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FN</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
</li>
</ol>
<hr>
<h2 id="生成式模型-vs-判别式模型">生成式模型 vs. 判别式模型</h2>
<ul>
<li>
<p><strong>生成式模型 (Generative Models)</strong></p>
<ul>
<li><strong>思想</strong>: 学习数据的联合概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(X, Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>。可以通过贝叶斯公式得到后验概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(Y|X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>来进行分类。</li>
<li><strong>例子</strong>: 朴素贝叶斯, 高斯混合模型(GMM), 隐马尔可夫模型(HMM)。</li>
<li><strong>优点</strong>:
<ul>
<li>可以生成新的数据样本。</li>
<li>能够处理缺失数据。</li>
<li>信息更丰富，能反映数据本身的分布。</li>
</ul>
</li>
<li><strong>缺点</strong>:
<ul>
<li>学习过程更复杂，需要更多数据。</li>
<li>为了拟合分布，可能会牺牲一些分类性能。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>判别式模型 (Discriminative Models)</strong></p>
<ul>
<li><strong>思想</strong>: 直接学习决策函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> 或者条件概率分布 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(Y|X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>。</li>
<li><strong>例子</strong>: 逻辑回归, 支持向量机(SVM), 决策树, 传统神经网络。</li>
<li><strong>优点</strong>:
<ul>
<li>学习目标明确，直接面向分类任务，性能通常更好。</li>
<li>学习过程更简单，需要的数据量相对较少。</li>
<li>分类边界更灵活。</li>
</ul>
</li>
<li><strong>缺点</strong>:
<ul>
<li>无法生成数据。</li>
<li>不能反映数据本身的特性。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>关系</strong>: 由生成模型可以得到判别模型，但反之不行。</p>
<hr>
<h2 id="分类器准则与方法总结">分类器准则与方法总结</h2>
<h3 id="1-fisher准则-线性判别分析-lda">1. Fisher准则 (线性判别分析, LDA)</h3>
<ul>
<li><strong>核心思想:</strong> 将高维样本投影到一条直线上, 使得同类样本的投影点尽可能密集(类内离散度最小), 不同类样本的投影中心点尽可能分离(类间离散度最大)。</li>
<li><strong>数学表达:</strong> 最大化目标函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mi mathvariant="normal">_</mi><mi>F</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mspace linebreak="newline"></mspace><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>S</mi><mi mathvariant="normal">_</mi><mi>b</mi><mi>w</mi></mrow><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>S</mi><mi mathvariant="normal">_</mi><mi>w</mi><mi>w</mi></mrow></mrow><annotation encoding="application/x-tex">J\_F(w) = \\frac{w^T S\_b w}{w^T S\_w w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.1513em;vertical-align:-0.31em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.02691em;">ww</span></span></span></span></span></li>
<li><strong>特点:</strong> 监督学习，为分类任务寻找最佳投影方向，对数据分布有高斯假设。</li>
</ul>
<h3 id="2-感知机准则">2. 感知机准则</h3>
<ul>
<li><strong>核心思想:</strong> 通过迭代修正权向量，直到所有样本被正确分类。每次用一个错分样本来更新权向量。</li>
<li><strong>数学表达:</strong> 最小化错分样本的目标函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mi>P</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>y</mi><mo>∈</mo><msub><mi mathvariant="script">Y</mi><mrow><mi>w</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>g</mi></mrow></msub></mrow></msub><mo stretchy="false">(</mo><mo>−</mo><msup><mi>a</mi><mi>T</mi></msup><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">J_P(a) = \sum_{y \in \mathcal{Y}_{wrong}} (-a^T y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3384em;vertical-align:-0.497em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0822em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>。</li>
<li><strong>特点:</strong> 仅适用于线性可分数据，解不唯一，不收敛于线性不可分数据。</li>
</ul>
<h3 id="3-最小二乘准则">3. 最小二乘准则</h3>
<ul>
<li><strong>核心思想:</strong> 最小化模型预测值与真实标签的平方误差和。</li>
<li><strong>数学表达:</strong> 最小化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mi>S</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mi>Y</mi><mi>a</mi><mo>−</mo><mi>b</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">J_S(a) = |Ya-b|^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">Ya</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>, 有解析解 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mo>∗</mo></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>Y</mi><mi>T</mi></msup><mi>Y</mi><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>Y</mi><mi>T</mi></msup><mi>b</mi></mrow><annotation encoding="application/x-tex">a^*=(Y^T Y)^{-1}Y^T b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">b</span></span></span></span>。</li>
<li><strong>特点:</strong> 计算简单，有解析解，但对异常值敏感。</li>
</ul>
<h3 id="4-逻辑回归-logistic-regression">4. 逻辑回归 (Logistic Regression)</h3>
<ul>
<li><strong>核心思想:</strong> 用Sigmoid函数将线性组合映射到(0,1)区间, 输出样本属于正类的概率。通过最大化对数似然函数求解参数。</li>
<li><strong>数学表达:</strong> 模型 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(y=1|x) = \frac{1}{1+e^{-w^T x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4023em;vertical-align:-0.5572em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.5011em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9841em;"><span style="top:-2.9841em;margin-right:0.0714em;"><span class="pstrut" style="height:2.6981em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9773em;"><span style="top:-2.9773em;margin-right:0.1em;"><span class="pstrut" style="height:2.6833em;"></span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5572em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，损失函数为交叉熵。</li>
<li><strong>特点:</strong> 输出具有概率意义，决策边界是线性的。</li>
</ul>
<h3 id="5-支持向量机-svm">5. 支持向量机 (SVM)</h3>
<ul>
<li><strong>核心思想:</strong> 寻找一个最大化分类间隔的超平面(硬间隔)。对线性不可分数据, 引入松弛变量(软间隔)或核技巧映射到高维空间。</li>
<li><strong>数学表达:</strong> 目标函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>w</mi><mo separator="true">,</mo><mi>b</mi></mrow></msub><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant="normal">∣</mi><mi>w</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>+</mo><mi>C</mi><mo>∑</mo><msub><mi>ξ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\min_{w,b} \frac{1}{2}|w|^2 + C\sum\xi_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.046em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>特点:</strong> 泛化能力强，通过核技巧能有效处理非线性问题，对噪声鲁棒。</li>
</ul>
<h3 id="六大分类器准则-方法的核心区别">六大分类器准则/方法的核心区别</h3>
<table>
<thead>
<tr>
<th style="text-align:left">准则/方法</th>
<th style="text-align:left">优化目标</th>
<th style="text-align:left">适用条件</th>
<th style="text-align:left">输出特性</th>
<th style="text-align:left">主要局限</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Fisher准则</strong></td>
<td style="text-align:left">类间方差/类内方差最大化</td>
<td style="text-align:left">二分类、线性可分</td>
<td style="text-align:left">线性投影方向</td>
<td style="text-align:left">假设协方差同质, 对分布敏感</td>
</tr>
<tr>
<td style="text-align:left"><strong>感知机准则</strong></td>
<td style="text-align:left">最小化错分样本距离</td>
<td style="text-align:left">严格线性可分</td>
<td style="text-align:left">线性超平面</td>
<td style="text-align:left">解不唯一; 线性不可分不收敛</td>
</tr>
<tr>
<td style="text-align:left"><strong>最小二乘准则</strong></td>
<td style="text-align:left">最小化平方误差和</td>
<td style="text-align:left">线性可分/不可分</td>
<td style="text-align:left">线性超平面</td>
<td style="text-align:left">对异常值敏感; 无概率输出</td>
</tr>
<tr>
<td style="text-align:left"><strong>逻辑回归</strong></td>
<td style="text-align:left">最大化对数似然函数</td>
<td style="text-align:left">线性可分/不可分</td>
<td style="text-align:left">概率输出+线性边界</td>
<td style="text-align:left">无法直接处理非线性数据</td>
</tr>
<tr>
<td style="text-align:left"><strong>SVM(线性)</strong></td>
<td style="text-align:left">最大化分类间隔</td>
<td style="text-align:left">线性可分/不可分</td>
<td style="text-align:left">线性超平面</td>
<td style="text-align:left">大规模数据计算慢</td>
</tr>
<tr>
<td style="text-align:left"><strong>SVM(核方法)</strong></td>
<td style="text-align:left">高维空间最大化间隔</td>
<td style="text-align:left">非线性数据</td>
<td style="text-align:left">非线性决策边界</td>
<td style="text-align:left">核函数选择与调参复杂</td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>学习</category>
        <category>ML</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>ML</tag>
      </tags>
  </entry>
  <entry>
    <title>2025第一单元总结博客 [BUAA-OO]</title>
    <url>/2025/03/19/OO-Unit1/</url>
    <content><![CDATA[<p>本文将从笔者自身的角度出发，总结2025年北航面向对象课程第一单元作业(HW1, HW2)的程序设计思路和架构搭建，呈现我在完成一个支持加、减、乘、乘方、三角函数、递推函数、普通函数、求导功能的<strong>科学计算器</strong>过程中所遇到的问题、思考以及解决方案。</p>
<hr>
<h3 id="一-架构分析">一、架构分析</h3>
<h4 id="1-1-项目架构概览">1.1 项目架构概览</h4>
<p>本项目采用面向对象的思想，将化简表达式的总功能划分为了表达式解析部分和合并化简部分，前者对应了<code>Lexer</code>、<code>Paser</code>、<code>FuncManager</code>类，后者对应了<code>Expr</code>、<code>Term</code>、<code>Factor</code>等类，通过对递归下降与正则表达式的结合运用，较好地实现了对表达式的解析与合并化简。</p>
<h4 id="1-2-uml类图">1.2 UML类图</h4>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191523149.png" alt="class"></p>
<h4 id="1-3-架构设计">1.3 架构设计</h4>
<h5 id="1-函数处理与词法分析">(1) 函数处理与词法分析</h5>
<ul>
<li><code>FuncManager</code>类：负责处理自定义函数定义与解析，通过HashMap存储函数名、形参与函数表达式，对传入内部的input字符串通过<strong>正则表达式</strong>进行匹配，并展开递推表达式与普通函数，降低解析表达式时处理函数调用的复杂度。</li>
<li><code>Lexer</code>类：负责对传入的字符串进行词法分析，将表达式字符串分割为一个个的<code>Token</code>，处理连续符号与数字合并，完成储存，方便后续的解析。</li>
</ul>
<h5 id="2-表达式解析">(2) 表达式解析</h5>
<ul>
<li>通过递归下降法构建了表达式解析器，通过<code>paserExpr</code>、<code>paserTerm</code>、<code>paserFactor</code>等方法，将表达式字符串解析为<code>Expr</code>、<code>Term</code>、<code>Factor</code>对象，构建表达式树。</li>
<li><code>Expr</code>、<code>Term</code>、<code>Factor</code>类：分别对应表达式、项、因子，内部用ArrayList存储，方便后续的合并化简操作。</li>
<li>利用<code>Factor</code>接口实现多种因子的统一处理，包括<code>NumFactor</code>、<code>PowFactor</code>、<code>FuncFactor</code>、<code>ExprFactor</code>、<code>SinFactor</code>、<code>CosFactor</code>、<code>DerivativeFactor</code>等，分别对应数字、幂、函数、表达式、正弦、余弦、求导因子。</li>
</ul>
<h5 id="3-表达式合并化简">(3) 表达式合并化简</h5>
<ul>
<li>通过定义单项式类<code>Mono</code>与多项式类<code>Poly</code>，将表达式树中的<code>Expr</code>、<code>Term</code>、<code>Factor</code>对象合并为多项式对象，并对其进行合并同类项、化简操作。</li>
<li><code>Mono</code>类：最终解析得到的基本单元</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>M</mi><mi>o</mi><mi>n</mi><mi>o</mi><mo>=</mo><mi>c</mi><mi>o</mi><mi>e</mi><mo>⋅</mo><msup><mi>X</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow></msup><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>P</mi><mi>o</mi><mi>l</mi><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mrow><mi>e</mi><mi>x</mi><msub><mi>p</mi><mi>i</mi></msub></mrow></msup><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>P</mi><mi>o</mi><mi>l</mi><msub><mi>y</mi><mi>j</mi></msub><msup><mo stretchy="false">)</mo><mrow><mi>e</mi><mi>x</mi><msub><mi>p</mi><mi>j</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">Mono=coe \cdot X^{exp} \prod ^{n}_{i=0}sin(Poly_i)^{exp_i}\prod ^{n}_{j=0}cos(Poly_j)^{exp_j}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">coe</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.0652em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><code>Poly</code>类：多项式，内部用HashMap存储单项式，在add、mul等方法中实现合并同类项操作。</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mi>o</mi><mi>l</mi><mi>y</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mi>c</mi><mi>o</mi><msub><mi>e</mi><mi>i</mi></msub><mo>⋅</mo><mi>M</mi><mi>o</mi><mi>n</mi><msub><mi>o</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Poly=\sum_{i=0}^{n}coe_i \cdot Mono_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">co</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h5 id="4-统计分析">(4) 统计分析</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191523148.png" alt="lines"><br>
可以发现，<code>FuncManager</code>类的代码行数最多，原因在于该类需要处理自定义函数的定义与调用，需要处理递推表达式与普通函数，代码量相对较大。并且，笔者在该类中预先对函数进行了部分展开化简（替换定义过的函数、存储递推函数表达式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">{</mo><mn>0</mn><mo stretchy="false">}</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi>f</mi><mo stretchy="false">{</mo><mn>5</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">f\{0\}..f\{5\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">{</span><span class="mord">0</span><span class="mclose">}</span><span class="mord">..</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">{</span><span class="mord">5</span><span class="mclose">}</span></span></span></span>），这虽然不符合递归思想，但大大降低了后续解析表达式的复杂度与成本消耗，提高了解析效率。</p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191525569.png" alt="class"><br>
可以发现，类复杂度分布不均，部分核心类承担了较多的复杂逻辑，而一些辅助类或数据类则相对简单。<code>FuncManager</code>、<code>Lexer</code>、<code>Mono</code>、<code>Parser</code>等类的WMC值较高，尤其是<code>Mono</code>类的WMC值高达45，这是因为在<code>toString</code>方法中，需要将多项式对象转换为字符串，而该类中包含了较多的逻辑判断与字符串拼接操作。</p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191525742.png" alt="method"><br>
<code>Lexer.handleSpecialCharacters()</code>方法复杂度超标的原因是笔者在该方法中实现了对特殊字符的处理，包含了太多if-else判断，导致代码行数与复杂度较高。<code>Mono.toString()</code>和<code>Mono.buildTrigExpr()</code>方法则由于处理基本单元的特判，具有较多的逻辑判断与字符串拼接操作。<code>FuncManager.expandFunction()</code>在递归展开函数时，需要处理递推函数的定义，调用了过多的辅助方法，导致代码行数与复杂度较高。</p>
<p>整个表达式化简项目围绕表达式的解析、因子的封装、多项式的运算与求导展开，各类因子（NumFactor, SinFactor, CosFactor 等）各自聚焦在特定的数学运算逻辑，内聚度相对较好。Parser, Lexer, FuncManager 等在解析层各司其职，但实现细节中个别方法（如 <code>expandFunction</code>、<code>handleSpecialCharacters</code>等）过于复杂，可能需要笔者进一步优化。</p>
<h3 id="二-迭代设计">二、迭代设计</h3>
<h4 id="2-1-第一次作业">2.1 第一次作业</h4>
<h5 id="1-需求分析">(1) 需求分析</h5>
<p>第一次作业是对于面向对象与层次化设计的初步尝试，通过实现一个简单的表达式化简程序，来理解面向对象编程的<strong>思维方法</strong>与<strong>设计原则</strong>。具体需求如下：</p>
<ul>
<li>实现一个表达式化简程序，能够解析并化简输入的表达式。</li>
<li>表达式由若干个项用加减运算连接。</li>
<li>项由若干个因子用乘法运算连接。</li>
<li>因子可以是常数、幂函数、表达式因子。</li>
<li>输出不包含括号的表达式。</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191526315.png" alt="hw1_lines"></p>
<h5 id="2-设计思路">(2) 设计思路</h5>
<p>通过先导课第七次作业的训练，笔者对于递归下降的解析方法有了一定的了解，而在重温OOpre中的表达式树构建方法并参考了往年博客后，构建了如下架构：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">src</span><br><span class="line">|-- MainClass</span><br><span class="line">|</span><br><span class="line">|-- Lexer</span><br><span class="line">|-- Token</span><br><span class="line">|-- Parser</span><br><span class="line">|</span><br><span class="line">|-- Expr</span><br><span class="line">|-- Term</span><br><span class="line">|-- Factor</span><br><span class="line">|-- NumFactor</span><br><span class="line">|-- PowFactor</span><br><span class="line">|-- ExprFactor</span><br><span class="line">|</span><br><span class="line">|-- Mono</span><br><span class="line">|-- Poly</span><br></pre></td></tr></table></figure>
<p>其中，<code>Lexer</code>负责词法分析，将输入字符串解析为<code>Token</code>序列；<code>Parser</code>负责语法解析，<code>Expr</code>, <code>Term</code>, <code>Factor</code>, <code>NumFactor</code>, <code>PowFactor</code>, <code>ExprFactor</code>分别对应表达式、项、因子、常数因子、幂因子、表达式因子；<code>Mono</code>, <code>Poly</code>分别对应单项式与多项式。<br>
程序通过递归下降解析表达式，将解析结果封装成<code>Expr</code>、<code>Term</code>、<code>Factor</code>等对象，再调用<code>Expr.toPoly</code>、<code>Term.toPoly</code>、<code>Factor.toPoly</code>方法递归展开化简为<code>Poly</code>、<code>Mono</code>对象，最后调用<code>Poly.toString</code>、<code>Mono.toString</code>方法生成字符串。</p>
<h5 id="3-设计实现">(3) 设计实现</h5>
<ul>
<li><strong>词法分析Lexer</strong>
<ul>
<li><code>Lexer</code>类负责词法分析，将输入字符串解析为基本语法单元<code>Token</code>。</li>
<li><code>nextToken</code>方法从输入字符串中读取下一个<code>Token</code>，并更新当前读取位置。</li>
<li>第一次作业中，<code>Lexer</code>类仅支持解析数字、变量、加号、减号、乘号、左括号、右括号、幂运算符等基本语法单元。</li>
<li>通过switch-case语句，根据当前读取位置语法单元类型。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in Token.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Token</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Type</span> &#123;</span><br><span class="line">        ADD, SUB, MUL, LPAREN, RPAREN, NUM, VAR, POW</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Type type;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String content;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in Lexer.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Lexer</span><span class="params">(String input)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">while</span> (...) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (currentChar) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;\t&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;(&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;)&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> ...</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">if</span> (isDigit) &#123;</span><br><span class="line">                    ...</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123; <span class="comment">// unexpected characters</span></span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>语法解析Parser</strong>
<ul>
<li><code>Parser</code>类负责语法分析，将<code>Token</code>序列解析为<code>Expr</code>对象。</li>
<li><code>parse</code>方法从<code>Lexer</code>中读取<code>Token</code>序列，并解析为<code>Expr</code>对象。</li>
<li><code>parseExpr</code>、<code>parseTerm</code>、<code>parseFactor</code>方法分别解析表达式、项、因子。</li>
<li><code>parseExpr</code>方法调用<code>parseTerm</code>方法解析项，并将<code>Expr</code>对象的符号传给<code>Term</code>，在此情况下，<code>term</code>之间是加法运算。</li>
<li><code>parseTerm</code>方法调用<code>parseFactor</code>方法解析因子，因子的符号单独解析，<code>factor</code>之间是乘法运算。</li>
<li><code>parseFactor</code>方法解析因子，根据因子类型调用不同的解析方法<code>parseNum</code>、<code>parsePower</code>、<code>parseExprFactor</code>。</li>
<li><code>parseSign</code>辅助方法解析符号，结果传入对象中。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in Parser.java</span></span><br><span class="line"><span class="keyword">public</span> BigInteger <span class="title function_">parseSign</span><span class="params">(BigInteger sign)</span> &#123;</span><br><span class="line">    <span class="comment">// sign是外层传入的符号</span></span><br><span class="line">    <span class="keyword">if</span> (SUB) &#123;</span><br><span class="line">        <span class="comment">// 移动指针</span></span><br><span class="line">        <span class="keyword">return</span> sign.negate();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ADD) &#123;</span><br><span class="line">        <span class="comment">// 移动指针</span></span><br><span class="line">        <span class="keyword">return</span> sign;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 没有符号，不移动指针</span></span><br><span class="line">        <span class="keyword">return</span> sign;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Expr <span class="title function_">parseExpr</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 解析符号</span></span><br><span class="line">    <span class="type">BigInteger</span> <span class="variable">exprSign</span> <span class="operator">=</span> parseSign(BigInteger.ONE);</span><br><span class="line">    <span class="comment">// 解析term</span></span><br><span class="line">    <span class="type">Expr</span> <span class="variable">expr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Expr</span>(); <span class="comment">//expr本身没有符号</span></span><br><span class="line">    expr.addTerm(parseTerm(exprSign));</span><br><span class="line">    <span class="keyword">while</span>(ADD || SUB) &#123;</span><br><span class="line">        <span class="comment">// 解析符号</span></span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">termSign</span> <span class="operator">=</span> parseSign(BigInteger.ONE);</span><br><span class="line">        <span class="comment">// 解析term</span></span><br><span class="line">        expr.addTerm(parseTerm(termSign));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> expr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Expr <span class="title function_">parseTerm</span><span class="params">(BigInteger sign)</span> &#123;</span><br><span class="line">    <span class="comment">// 解析符号，与外层符号combined</span></span><br><span class="line">    <span class="type">BigInteger</span> <span class="variable">termSign</span> <span class="operator">=</span> parseSign(sign);</span><br><span class="line">    <span class="comment">// 解析factor</span></span><br><span class="line">    <span class="type">Term</span> <span class="variable">term</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Term</span>(termSign);</span><br><span class="line">    term.addFactor(parseFactor());</span><br><span class="line">    <span class="keyword">while</span>(MUL) &#123;</span><br><span class="line">        term.addFactor(parseFactor());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> term;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Factor <span class="title function_">parseFactor</span><span class="params">()</span> &#123;...&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>表达式展开</strong>
<ul>
<li>在<code>Expr</code>、<code>Term</code>、<code>Factor</code>中添加<code>toPoly</code>方法，按照层次结构展开表达式。</li>
<li><code>Poly</code>由若干个<code>Mono</code>相加而成，每个<code>Mono</code>是一个基本单元。</li>
<li><code>Mono</code>具有固定形式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>e</mi><mo>⋅</mo><msup><mi>x</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow></msup></mrow><annotation encoding="application/x-tex">coe\cdot x^{exp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">coe</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span></span></span></span>。</li>
<li>如此实现了表达式解析存储与计算展开功能的分离，既符合了单一职责原则，也方便调试输出。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in Expr.java</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">toPoly</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Poly</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>();</span><br><span class="line">    <span class="keyword">for</span> (Term term : terms) &#123;</span><br><span class="line">        <span class="comment">// 由于符号依附于term，term之间是加法关系</span></span><br><span class="line">        result.addPoly(...);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in Term.java</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">toPoly</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Poly</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>();</span><br><span class="line">    <span class="keyword">for</span> (Factor factor : factors) &#123;</span><br><span class="line">        <span class="comment">// factor之间是乘法关系</span></span><br><span class="line">        result.multiplyPoly(...);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sign为负) &#123;</span><br><span class="line">        result.negPoly();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> poly;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// in Factor.java</span></span><br><span class="line"><span class="comment">// Factor是接口，其实现类重写toPoly方法</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">toPoly</span><span class="params">()</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Poly内需要实现<code>addPoly</code>、<code>multiplyPoly</code>、<code>negPoly</code>方法，分别对应<code>+</code>、<code>*</code>、取反操作，具体实现同样依照层次化结构，依赖<code>addMono</code>方法实现同类项合并。<br>
Mono内需要实现<code>multiply</code>方法，实现系数相乘、指数相加。</p>
</blockquote>
<ul>
<li><strong>表达式输出</strong>
<ul>
<li>在<code>Poly</code>中添加<code>toString</code>方法，调用<code>Mono.toString</code>，按照层次结构输出表达式</li>
<li><code>Mono</code>输出时，需要特判情况以优化输出(第一次的性能分还是好拿的)。</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>关于输出优化</strong><br>
主要有两个方向，首先是Poly调用Mono生成的字符串拼接时，将正项放在最前面可以省略<code>+</code>号。其次是在<code>Mono</code>中，如果<code>coe</code>为±1，则省略<code>1</code>；如果<code>exp</code>为0，则省略<code>x</code>，只输出系数；如果<code>exp</code>为1，则省略<code>^1</code>。</p>
</blockquote>
<h5 id="4-复杂度分析">(4) 复杂度分析</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191526679.png" alt="hw1_class"><br>
由于<code>Poly</code>类中循环和特判较多，<code>Lexer</code>类中使用了过多switch-case语句，导致代码复杂度较高，但总体来说，代码结构清晰，符合单一职责原则，每个类只负责一个功能，且每个类的方法也只负责一个功能，符合开闭原则，在后续迭代中，只需要修改解析方法和对应<code>Factor</code>的实现类即可。</p>
<h4 id="2-2-第二次作业">2.2 第二次作业</h4>
<h5 id="1-需求分析">(1) 需求分析</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191527781.png" alt="hw2_lines"><br>
在笔者看来，第二次迭代是本单元跨越难度最大的一次，代码量与架构复杂度都显著上升，引入了新的三角函数因子与自定义递推函数，代码总行数也是来到了近1200行，本次作业的主要需求如下：</p>
<ul>
<li><strong>支持嵌套括号</strong>：第一次作业中实现递归下降已经可以支持嵌套括号 <strong>( 慎用正则表达式！)</strong>。</li>
<li><strong>解析三角函数因子</strong>：允许用户输入三角函数因子<code>sin</code>、<code>cos</code>，最终输出只保留<strong>必要括号</strong>(难点1：无脑加影响性能，不加形式错误)，可以利用三角函数恒等式化简(难点2：化简种类很多，平方和、二倍角、诱导公式等)。</li>
<li><strong>支持自定义递推函数</strong>：允许用户输入自定义递推函数定义并在表达式中调用，包括初始定义<code>f&#123;0&#125;</code>、<code>f&#123;1&#125;</code>，递推定义<code>f&#123;n&#125;(形参) = 常数*f&#123;n-1&#125;(实参) + 常数*f&#123;n-2&#125;(实参)+表达式</code>，支持在表达式中调用(难点3：如何展开递推定义，如何处理递推定义中的形参与实参，如何降低调用成本<strong>防止TLE</strong>)。</li>
</ul>
<h5 id="2-设计思路">(2) 设计思路</h5>
<ul>
<li><strong>引入函数管理类</strong>：新增<code>FuncManager</code>类，用于管理自定义递推函数，包括存储函数定义、解析展开函数定义、处理函数调用时的换参等。</li>
<li><strong>引入函数因子类</strong>：新增<code>FuncFactor</code>类，继承自<code>Factor</code>接口，用于存储函数因子，内部调用<code>FuncManager.callFunc</code>处理函数调用生成对应字符串；调用<code>Parser.parseExpr</code>生成对应<code>Expr</code>对象；重写<code>toPoly</code>方法，调用<code>Expr.toPoly</code>生成对应<code>Poly</code>对象。</li>
<li><strong>引入三角函数因子</strong>：新增<code>SinFactor</code>、<code>CosFactor</code>类，继承自<code>Factor</code>接口，用于存储三角函数因子，并重写<code>toPoly</code>方法。</li>
<li><strong>修改基本单元Mono类</strong>：将基本单元修改为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>e</mi><mo>⋅</mo><msup><mi>x</mi><mi>exp</mi><mo>⁡</mo></msup><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>P</mi><mi>o</mi><mi>l</mi><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mrow><mi>e</mi><mi>x</mi><msub><mi>p</mi><mi>i</mi></msub></mrow></msup><msubsup><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>P</mi><mi>o</mi><mi>l</mi><msub><mi>y</mi><mi>j</mi></msub><msup><mo stretchy="false">)</mo><mrow><mi>e</mi><mi>x</mi><msub><mi>p</mi><mi>j</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">coe \cdot x^{\exp} \prod ^{n}_{i=0}sin(Poly_i)^{exp_i}\prod ^{n}_{j=0}cos(Poly_j)^{exp_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">coe</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2401em;vertical-align:-0.4358em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">e</span><span class="mtight">x</span><span class="mtight">p</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>，新增<code>addSinFactor</code>、<code>addCosFactor</code>方法，用于添加三角函数因子，重写<code>equal</code>与<code>hashCode</code>方法，用于判断<code>Mono</code>对象是否相等。</li>
<li><strong>修改多项式Poly类</strong>：修改<code>Poly</code>类中对应方法以兼容新的<code>Mono</code>对象。</li>
</ul>
<h5 id="3-设计实现">(3) 设计实现</h5>
<ul>
<li><strong>FuncManager类</strong>：静态自定义递推函数管理类，功能包括解析存储函数定义、展开递推函数、处理函数调用时的换参等。
<ul>
<li>提供<code>FuncDefinition</code>方法用于解析初始定义与递推定义，利用<strong>正则表达式 + 匹配括号栈函数</strong>解析函数名、序号、形参、函数表达式；</li>
<li>提供<code>expandFunction</code>方法用于展开递推函数，利用<strong>正则 + 递归 + 匹配括号栈函数</strong>解析函数表达式中的函数调用，并递归展开；</li>
<li>提供<code>callFunc</code>方法用于处理函数调用，利用<strong>正则表达式替换</strong>处理函数表达式中的函数调用；</li>
<li>提供<code>replaceParams</code>辅助方法用于替换函数表达式中的形参；</li>
<li>提供<code>findClosingParen</code>与<code>splitParameters</code>辅助方法用于解析递推函数表达式的实参。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in FuncManager.java</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, HashMap&lt;Integer, String&gt;&gt; functions = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(); <span class="comment">// 储存函数定义</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, ArrayList&lt;String&gt;&gt; parameters = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(); <span class="comment">// 储存函数形参列表</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, String&gt; recurrences = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(); <span class="comment">// 储存递推关系</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">funcDefinition</span><span class="params">(String input)</span> &#123;</span><br><span class="line">    <span class="comment">/* 利用Pattern + Matcher解析初始定义与递推定义</span></span><br><span class="line"><span class="comment">    并存储到functions、parameters、recurrences中</span></span><br><span class="line"><span class="comment">    解析完毕后调用expandFunction展开递推函数的0到5项*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">expandFunction</span><span class="params">(String funcName, <span class="type">int</span> seq, ArrayList&lt;String&gt; factors)</span> &#123;</span><br><span class="line">    <span class="comment">/* 识别递推定义中的&quot;f&#123;n-1&#125;(&quot;和&quot;f&#123;n-2&#125;(&quot;字符串，</span></span><br><span class="line"><span class="comment">    调用辅助函数findClosingParen与splitParameters解析实参，</span></span><br><span class="line"><span class="comment">    递归展开n-1与n-2项，并返回展开后的函数表达式</span></span><br><span class="line"><span class="comment">    拼接后返回展开后的函数表达式并存储到functions中*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">callFunc</span><span class="params">(String name, BigInteger seq, ArrayList&lt;String&gt; factors)</span> &#123;</span><br><span class="line">    <span class="comment">/* 处理函数调用，在functions中查找函数表达式</span></span><br><span class="line"><span class="comment">    调用replaceParams替换函数表达式中的形参，并返回替换后的表达式*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String <span class="title function_">replaceParams</span><span class="params">(String funcName, String expr, ArrayList&lt;String&gt; factors)</span> &#123;</span><br><span class="line">    <span class="comment">/* 使用正则替换函数表达式中的形参，返回替换后的表达式*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">findClosingParen</span><span class="params">(String s, <span class="type">int</span> startIndex)</span> &#123;</span><br><span class="line">    <span class="comment">// 匹配括号栈，找到与startIndex对应的闭合括号索引</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> ArrayList&lt;String&gt; <span class="title function_">splitParameters</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="comment">// 解析函数表达式中的实参，返回实参数组</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>细节实现</strong><br>
注意存储函数时将形参x,y替换成u,v等符号，避免在替换过程出现冲突。解析实参时不能直接用正则表达式，因为实参可能包含无限层次的括号，正则无法处理，需要用栈来匹配括号。为了支持后续可能的迭代(如多种递推函数)，我在存储函数表达式时采用了<code>funcName+seq</code>的形式(f对应一个arraylist，存储着每个序号对应的表达式)，这在第三次作业中给我带来了一部分的重构，其实完全将funcName保存为&quot;f{n}&quot;的形式会更简洁，也不需要跨越层次，破坏了面向对象的思想。</p>
</blockquote>
<ul>
<li><strong>新增因子</strong>：本次迭代支持自定义递推函数因子与三角函数因子，笔者增加了三个继承<code>Factor</code>接口的<code>FuncFactor</code>、<code>SinFactor</code>、<code>CosFactor</code>类以实现层次化结构。
<ul>
<li><code>FuncFactor</code>类：实现自定义递推函数因子；</li>
<li><code>SinFactor</code>类：实现三角函数因子sin，重写<code>toPoly</code>方法；</li>
<li><code>CosFactor</code>类：实现三角函数因子cos，重写<code>toPoly</code>方法。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in FuncFactor.java</span></span><br><span class="line"><span class="keyword">private</span> BigInteger sign;</span><br><span class="line"><span class="keyword">private</span> String funcString; <span class="comment">// 将实参代入函数所得字符串</span></span><br><span class="line"><span class="keyword">private</span> Expr funcExpr; <span class="comment">// 函数表达式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">FuncFactor</span><span class="params">(...)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.sign = sign;</span><br><span class="line">    <span class="built_in">this</span>.funcString = FuncManager.callFunc(...)</span><br><span class="line">    <span class="built_in">this</span>.funcExpr = toExpr();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 将函数字符串转换为表达式</span></span><br><span class="line"><span class="keyword">private</span> Expr <span class="title function_">toExpr</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (sign为负) &#123;</span><br><span class="line">        funcString = <span class="string">&quot;-(&quot;</span> + funcString + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> parser.parseExpr();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">toPoly</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> funcExpr.toPoly();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in SinFactor.java</span></span><br><span class="line"><span class="keyword">private</span> BigInteger sign;</span><br><span class="line"><span class="keyword">private</span> Factor factor;</span><br><span class="line"><span class="keyword">private</span> BigInteger exponent;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// 重写toPoly()方法</span></span><br><span class="line"><span class="meta">@Override</span> <span class="keyword">public</span> Poly <span class="title function_">toPoly</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Mono</span> <span class="variable">mono</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Mono</span>(...);</span><br><span class="line">    mono.addSinFactor(factor.toPoly(), exponent);</span><br><span class="line">    <span class="type">Poly</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Poly</span>(); <span class="comment">// 创建一个多项式</span></span><br><span class="line">    result.addMono(mono);</span><br><span class="line">    <span class="keyword">return</span> result; <span class="comment">// 返回多项式</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// in CosFactor.java ...</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><strong>修改单项式与多项式类</strong>：</p>
<ul>
<li>在<code>Mono</code>类中添加<code>addSinFactor</code>和<code>addCosFactor</code>方法，用于添加三角函数因子，并处理特殊情况(如sin(0)和cos(0)等)；添加<code>normalized</code>方法，返回一个经过归一化处理的单项式，将系数视为1，作为<code>Poly</code>类的<code>Mono</code>哈希表中的键；重写<code>equal</code>和<code>hashCode</code>方法，确保归一化后的单项式可以正确比较与生成哈希码；修改<code>multiply</code>方法与<code>toString</code>方法，以适应三角函数因子的处理；</li>
<li>在<code>Poly</code>类中添加<code>negateTriFactor</code>方法，判断指数最高项符号是否为负，使三角函数因子内<code>Poly</code>的符号一致，便于合并同类项；重写了<code>equal</code>和<code>hashCode</code>方法，确保归一化后的多项式可以正确比较合并；修改了原先的<code>addMono</code>方法，使其在添加单项式之前先进行归一化处理作为哈希表中的键，修改了<code>toString</code>方法，以适应三角函数因子的处理。</li>
</ul>
</li>
<li>
<p><strong>修改表达式解析</strong>：</p>
<ul>
<li>在<code>Lexer</code>类中增加了对函数、三角因子的识别，添加了对应的token类型；</li>
<li>在<code>Parser</code>类中添加<code>parseFuncFactor</code>、<code>parseSinFactor</code>、<code>parseCosFactor</code>方法，用于解析自定义函数因子与三角函数因子，返回<code>Factor</code>对象；修改<code>parseFactor</code>方法，支持以上因子解析；</li>
<li>在<code>MainClass</code>类中，添加对递推函数定义的处理；</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>关于性能优化</strong><br>
这次作业我只处理了最基本的三角函数特殊值与括号问题，对于三角函数的平方和二倍角等公式并没有处理，因此性能上还有较大优化空间，这也导致我的性能分数并不高，但我在互测中的hack成功次数较多，参见bug分析部分。</p>
</blockquote>
<h5 id="4-复杂度分析">(4) 复杂度分析</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191527696.png" alt="hw2_class"><br>
函数管理类<code>FunctionManager</code>负责管理函数，包括函数的添加、展开、存储、查找、调用等操作，因此其内部方法数量较多且循环调用，依赖较强，因而其复杂度较高，通过静态实现，避免了每次调用时创建对象的开销，提高了效率。<code>Lexer</code>类由于要进行if-else判断，复杂度较高在所难免。<code>Parser</code>类负责解析表达式，由于新增因子后方法较多且需要较多判断语句，因此其复杂度较高。<code>Poly</code>类负责多项式的存储与合并，包含很多循环判断语句，复杂度较高。但整体而言，由于新增因子后方法数量增加，复杂度有所提高，但整体的层次化设计使得代码结构更加清晰，易于维护和扩展。</p>
<h4 id="2-3-第三次作业">2.3 第三次作业</h4>
<h5 id="1-需求分析与思路">(1) 需求分析与思路</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191528441.png" alt="hw3"><br>
要求实现普通自定义函数与求导功能，整体难度较低，主要在于对普通自定义函数的解析与求导因子的处理：</p>
<ul>
<li><strong>普通自定义函数</strong>：在静态函数管理类<code>FunctionManager</code>中添加对应方法，用于处理普通自定义函数定义和解析，存储函数名、函数表达式、形参；</li>
<li><strong>求导因子</strong>：添加<code>DerivativeFactor</code>类，用于处理求导因子，包括求导因子的<code>toPoly</code>方法和<code>toDerivative</code>方法，分别用于将求导因子转换为多项式和求导因子求导；</li>
<li><strong>求导</strong>：在<code>Expr</code>、<code>Term</code>、<code>Factor</code>类中按照求导公式添加求导方法，分别用于表达式、项、因子的求导，返回求导后的多项式。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202503191528530.png" alt="derivative"></li>
</ul>
<h5 id="2-设计思路与实现">(2) 设计思路与实现</h5>
<ul>
<li><strong>支持普通自定义函数</strong>：普通自定义函数的定义处理与解析可完全类比于递推函数，在<code>FunctionManager</code>类中修改<code>funcDefinition</code>方法，添加对普通自定义函数的定义处理即可，但对于嵌套的普通函数(如<code>h(x)=g(g(x))</code>)，笔者选择在定义之初就将其展开，避免后续调用时出现递归调用的问题，因此新增了<code>expandNormalFunction</code>方法，用于递归展开普通自定义函数，直到其中不再包含普通自定义函数为止；同样在自定义递推函数表达式中，同样可能出现嵌套的普通函数，只要调用该方法即可；</li>
<li><strong>求导因子</strong>：求导因子处理较为简单，只需新增<code>DerivativeFactor</code>类并添加<code>toPoly</code>和<code>toDerivative</code>方法即可，其中<code>toPoly</code>方法较为简单，只需调用内部表达式<code>expr</code>的<code>toDerivative</code>方法即可，<code>toDerivative</code>方法则较为复杂，需要先将内部的表达式<code>expr</code>求导，然后再<code>toString</code>，重新解析成求导后的表达式<code>expr'</code>，再调用<code>expr'</code>的<code>toDerivative</code>方法。似乎有点绕而且影响性能？笔者于是为每个数据类增加了一个<code>polyCache</code>属性，用于缓存求导后的多项式，避免了重复<code>toPoly</code>(尤其是求导的乘法法则)；</li>
<li><strong>求导方法</strong>：笔者依然根据递归下降原则，为每个数据类增加了<code>toDerivative</code>方法，用于求导，返回求导后的多项式；</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//in Expr.java</span></span><br><span class="line">Poly <span class="title function_">toDerivative</span><span class="params">()</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">for</span> (Term term : terms) &#123;</span><br><span class="line">        <span class="type">Poly</span> <span class="variable">poly</span> <span class="operator">=</span> term.toDerivative();</span><br><span class="line">        ...<span class="comment">//处理加法法则</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// in Term.java</span></span><br><span class="line"><span class="keyword">public</span> Poly <span class="title function_">toDerivative</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; factors.size(); i++) &#123; </span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">            leftPoly = leftPoly.multiplyPoly(...);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; factors.size(); j++) &#123;</span><br><span class="line">        rightPoly = rightPoly.multiplyPoly(...);</span><br><span class="line">        &#125;</span><br><span class="line">        factors.get(i).toDerivative();</span><br><span class="line">        ... <span class="comment">//处理乘法法则</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sign为负) &#123;</span><br><span class="line">        result.negPoly(...);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// in Factor.java </span></span><br><span class="line"><span class="comment">// 分别利用求导法则求导</span></span><br><span class="line">... </span><br></pre></td></tr></table></figure>
<h5 id="3-复杂度分析">(3) 复杂度分析</h5>
<p>本次作业后得到了完整架构，具体分析见开头，此处不再赘述。</p>
<blockquote>
<p><strong>关于重构与整体架构</strong><br>
在三次迭代作业中，我的主体架构在第一次作业中就已确定下来，即使用词法分析和语法解析，将输入的表达式字符串递归解析成表达式、项、因子对象，随后同样遵循递归下降原则，层次化调用<code>toPoly</code>方法，将表达式对象转换成多项式对象。在迭代过程中，我在实现需求时不可避免地对部分代码进行了重构，但主要关注于方法的拓展与兼容性，这也让我的程序没有出现太多由于重构而导致的bug。</p>
</blockquote>
<hr>
<h3 id="三-bug分析">三、Bug分析</h3>
<h4 id="第一次作业：">第一次作业：</h4>
<ul>
<li>笔者在第一次作业的强测和互测中未出现bug，这为后续的迭代作业打下了较好的基础。</li>
</ul>
<h4 id="第二次作业：">第二次作业：</h4>
<ul>
<li>第二次作业笔者出现了两处bug，均出现在复杂度较高的<code>Mono</code>类中，具体如下：
<ul>
<li>第一处是关于<code>sin(0)^0</code>的结果出错，笔者在<code>Mono.addSinFactor</code>方法中，将sin因子添加到基本单元中时，没有首先特判指数为0的情况，导致<code>sin(0)^0</code>由于解析三角函数因子内部的<code>Poly</code>对象为0，根据<code>sin(0)=0</code>使得最终结果为0，而不是1。修复bug时只要在<code>addSinFactor</code>方法中特判指数为0的情况即可(bug所在方法的复杂度并不高)。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addSinFactor</span><span class="params">(Poly factor, BigInteger exponent)</span> &#123;</span><br><span class="line">      &lt;-- bug: 没有特判指数为<span class="number">0</span>直接返回</span><br><span class="line">      <span class="comment">//if (exponent.equals(BigInteger.ZERO)) &#123;</span></span><br><span class="line">      <span class="comment">//    return;// 特判指数为0的情况</span></span><br><span class="line">      <span class="comment">//&#125;</span></span><br><span class="line">      <span class="keyword">if</span> (factor.toString().equals(<span class="string">&quot;0&quot;</span>)) &#123;</span><br><span class="line">          <span class="built_in">this</span>.coefficient = BigInteger.ZERO; </span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (factor.negateTriFactor()) &#123;</span><br><span class="line">          <span class="type">Poly</span> <span class="variable">negFactor</span> <span class="operator">=</span> factor.negPoly(factor);</span><br><span class="line">          ...</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>第二处bug出现在<code>Mono.buildTrigExpr</code>方法中，该方法主要用于特判三角函数因子内添加必要括号。笔者在<code>buildTrigExpr</code>方法中，使用了大量if-else判断语句，以实现要求的<strong>三角函数对应的嵌套因子为不带指数的表达式因子时，该表达式因子两侧必要的一层括号</strong>，笔者绘制了分类树，将所有情况分类处理，但仍然由于归一化生成哈希表键值对和条件判断内容不清的问题，出现了会在诸如<code>sin(2*x^2)</code>的情况下，少输出一层括号，导致了强测两个点正确性的丢失以及互测时多个hack()。该方法的圈复杂度为25，由于涉及if-else特判导致复杂度高，笔者在每一次特判时都加了注释()，结果还是出现了bug :innocent:。说明<strong>注释不能代替思考，代码也要正确！</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> String <span class="title function_">buildTrigExpr</span><span class="params">(String trigName, Poly poly)</span> &#123;</span><br><span class="line">      <span class="comment">// 如果多项式只有一个单项式，则做细分判断</span></span><br><span class="line">      <span class="keyword">if</span> (poly.getMonos().size() == <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="type">Mono</span> <span class="variable">onlyMono</span> <span class="operator">=</span> poly.getMonos().keySet().iterator().next();</span><br><span class="line">          <span class="type">BigInteger</span> <span class="variable">coe</span> <span class="operator">=</span> onlyMono.getCoefficient();  &lt;-- bug: 系数始终为<span class="number">1</span></span><br><span class="line">          <span class="comment">// onlyMono是归一化后系数为1的单项式，所以得到的coe始终为1</span></span><br><span class="line">          <span class="comment">// 这导致后续判断是否要加括号时，无法正确识别到单项式前的系数</span></span><br><span class="line">          <span class="comment">// 应该修改为 coe = poly.getMonos().get(onlyMono);</span></span><br><span class="line">          <span class="type">BigInteger</span> <span class="variable">exp</span> <span class="operator">=</span> onlyMono.getExponent();</span><br><span class="line">          <span class="comment">// 三角函数因子数量（如 &gt; 1 则视为较复杂表达式）</span></span><br><span class="line">          <span class="type">int</span> <span class="variable">trigCount</span> <span class="operator">=</span> onlyMono.getSinMap().size() </span><br><span class="line">                      + onlyMono.getCosMap().size();</span><br><span class="line">          ...</span><br><span class="line">      &#125;</span><br><span class="line">      ...</span><br><span class="line">              <span class="comment">// 3a) 指数为 0</span></span><br><span class="line">              <span class="keyword">if</span> (exp.equals(BigInteger.ZERO)) &#123; &lt;-- bug: 没有判断三角因子个数</span><br><span class="line">              <span class="comment">// 应修改为 exp.equals(BigInteger.ZERO) &amp;&amp; trigCount == 0</span></span><br><span class="line">                  <span class="keyword">return</span> trigName + <span class="string">&quot;(&quot;</span> + poly.toString() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">              &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="第三次作业">第三次作业:</h4>
<ul>
<li>在本次作业强测与互测中，笔者没有发现bug。</li>
</ul>
<hr>
<h3 id="四-测试与互测">四、测试与互测</h3>
<h4 id="第一次作业">第一次作业:</h4>
<ul>
<li>笔者根据递归下降分析法的思想，使用python编写了数据生成器，利用<code>python.sympy</code>库的化简结果与程序输出结果比对，搭建了自动评测机，但并未找出房间内同学的bug</li>
</ul>
<h4 id="第二次作业：">第二次作业：</h4>
<ul>
<li>笔者在第一次作业搭建的评测机基础上修改了数据生成器，但hack成功率却不甚理想，于是手搓了大量极端数据在本地进行测试，比对房间内所有程序的输出，成功hack了11次。</li>
<li>在本地测试平方和二倍角化简相关数据时，笔者注意到某些同学的输出时间较长，在阅读其<code>Poly</code>类代码时发现了大量嵌套的<code>for</code>循环和<code>if</code>判断，利用<strong>好室友</strong>给的TLE数据成功hack了几位同学。  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1</span><br><span class="line">f&#123;n&#125;(x)=1*f&#123;n-1&#125;(sin(sin(sin(x))))+0*f&#123;n-2&#125;(x)</span><br><span class="line">f&#123;1&#125;(x)=sin(sin(sin(sin(x))))</span><br><span class="line">f&#123;0&#125;(x)=sin(sin(sin(sin(x))))</span><br><span class="line">f&#123;5&#125;(f&#123;0&#125;(f&#123;0&#125;(f&#123;0&#125;(f&#123;0&#125;(f&#123;0&#125;(f&#123;0&#125;(x)))))))</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="第三次作业：">第三次作业：</h4>
<ul>
<li>笔者在第二次作业的基础上修改了数据生成器，利用全自动评测机进行代码的本地测试与互测对拍，成功hack其他同学8次。下次一定继续写评测机！第三次作业互测对于cost限制比较严格，所以没有从TLE数据入手(这种数据有点太邪恶了 bushi)</li>
</ul>
<p>综上所述，hack过程最好应当是<strong>自动评测机</strong>+<strong>手搓极端数据</strong>+<strong>结合代码构造数据</strong>，实现“多方位全天候hack攻击”(bushi)。<br>
在笔者看来，在有时间的情况下，直接阅读其他同学的代码会比盲目构造数据具有更大收获，这不仅仅是找出别人的bug，更是学习其他优秀代码的宝贵机会，例如，笔者注意到，部分同学会在一个类中提供多种初始化方法，这样的好处是可以在初始化时选择不同的数据结构，从而优化代码性能，这种思想就非常值得借鉴。</p>
<h3 id="五-优化分析">五、优化分析</h3>
<p>笔者对于三角函数的优化并不多，甚至可以说是几乎没有，这让笔者在避免被TLE数据攻击的同时，也失去了很大一部分性能分，笔者第三次作业中的强测得到了92.7分，全部是由于性能分的丢失。对于平方和与二倍角化简的处理，如果盲目嵌套多层<code>for</code>循环，非常影响复杂度与运行速度，对此笔者想出的解决方法是，为所有数据类都增加<code>polyCache</code>和<code>polyDirty</code>属性，减少非必要的<code>toPoly</code>方法调用，不用担心TLE。</p>
<h3 id="六-心得体会">六、心得体会</h3>
<p>总结博客写了这么长，终于能跳出代码，谈谈我的学习体会了。编程与代码能力的提升最重要的是<strong>动手实践</strong>，OO课程通过先导课<em>冒险小游戏</em> 的开发和第一单元对于递归下降和层次化设计的学习，让我在实践中掌握理论，这对于CS课程的学习是非常有益的。试想去年以前，笔者的最长程序还是几百行代码的数据结构大作业，而到今天，通过三次迭代开发，已经能够完成一个功能较为完善的程序，这无疑是一大进步。诚然，第一单元的迭代作业具有一定的难度，笔者也在此过程中遇到了不少问题，也还有一些遗憾(比如三角函数的优化)，但正是思考钻研这些问题，我对于面向对象设计与构造的理解也不断进步，不断成长。当然，笔者也意识到，编程之路还很长，还有许多需要学习的地方，例如抽象层次和递归。常常说，<strong>人理解循环，神理解递归。</strong> 递归是神的语言，这可能是因为，人的生命只有一次，所以理解不了生命反复。（突然感慨）</p>
<h3 id="七-一些建议">七、一些建议</h3>
<ul>
<li>建议cost的计算可以给得明确一些(能够提供计算器就更好了)，和室友的好几次hack互测结束被收回了:sob:。第三次迭代cost限制严格，根本不想构造TLE数据(担心又会成功提交非法数据)。</li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
        <category>OO</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>OO</tag>
      </tags>
  </entry>
  <entry>
    <title>2025第二单元总结博客 [BUAA-OO]</title>
    <url>/2025/04/20/OO-Unit2/</url>
    <content><![CDATA[<h2 id="buaa-oo-2025-第二单元总结博客">[BUAA-OO] 2025 第二单元总结博客</h2>
<h3 id="电梯调度吟"><strong>电梯调度吟</strong></h3>
<p>预判影行谋略深，乘客随唤策略新。<br>
双轿协同开新境，调度有方启后人。<br>
负载均衡效率高，智能运作见奇勋。<br>
电梯虽小乾坤大，智慧无穷妙理存。</p>
<blockquote>
<p>电梯月结束了，又有很多全新体验。尤其是多线程的相关知识，OS期中复习线程同步互斥时又看见了熟悉的知识点，联想到OO课上学到的相关理论，感觉收获颇丰，有种知识 <s>融会贯通</s> 涌入我的大脑的感觉。闲话少叙，下面进入正题———多线程电梯调度系统。</p>
</blockquote>
<hr>
<h3 id="一-同步块和锁">一、同步块和锁</h3>
<p>下面笔者将结合本人三次作业中对于线程安全和线程同步的实际方案，谈谈同步块的设置和锁的选择，并分析锁与同步块中处理语句之间的关系，具体架构实现请参考<a href="#%E4%BA%8C%E7%BA%BF%E7%A8%8B%E5%8D%8F%E4%BD%9C%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1">线程协作与架构设计</a>和<a href="#%E4%B8%89%E8%B0%83%E5%BA%A6%E5%99%A8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E8%B0%83%E5%BA%A6%E7%AD%96%E7%95%A5">调度器设计与调度策略</a>。</p>
<h4 id="1-1-同步块的设置">1.1 同步块的设置</h4>
<p>同步块和锁设置的原因是为了在多线程并发执行时保证线程安全，防止多个线程同时访问<strong>共享资源</strong>，出现数据不一致的情况。在Unit2的模拟电梯调度系统中，由于我们所采用的生产者-消费者模型，因而存在多种由生产者和消费者访问的共享资源：</p>
<ul>
<li>输入线程生产乘客请求、临时调度请求和更新请求置于主队列或子队列中；</li>
<li>调度线程从主队列中取出请求，通过调度算法将乘客请求放入对应电梯的子队列中；</li>
<li>电梯线程从子队列中取出乘客请求、临时调度请求和更新请求并执行、清除；</li>
<li>电梯线程将乘客请求返回到主队列中；</li>
<li>双轿厢电梯互斥进入换乘楼层，互斥访问协作类。</li>
</ul>
<p>以上场景中对于共享资源的访问，必须保证在同一时刻只有一个线程可以访问/操作。否则，可能会导致数据不一致或程序崩溃等问题。我们选择将共享资源封装成一个专门的类，便于进行同步互斥操作。具体的Java同步块实现如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (object) &#123;</span><br><span class="line">    <span class="comment">// 需要同步的代码块</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 需要同步的方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中，<code>object</code>是用于标识同步对象的，可以是任意对象，也可以是<code>this</code>，即当前对象。在同步块中，只有获取到<code>object</code>的锁才能执行其中的代码，否则会被阻塞，直到锁被释放。对于方法，则是只有获取到当前对象的锁(对于静态方法是这个类的锁)才能执行该方法，否则会被阻塞，直到锁被释放。<br>
读锁和写锁是另一种锁的选择，用于实现读写分离，提高并发性能。读锁允许多个线程同时读取共享资源，而写锁则独占访问共享资源。Java中可以使用<code>ReentrantReadWriteLock</code>类来实现读写锁。读锁和写锁的使用方法如下(不过我在Unit2中并未用到 <s>因为没必要</s> )：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">ReentrantReadWriteLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantReadWriteLock</span>();</span><br><span class="line">lock.readLock().lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 读操作</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    lock.readLock().unlock();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">lock.writeLock().lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 写操作</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    lock.writeLock().unlock();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-2-锁的选择">1.2 锁的选择</h4>
<p>在同步块中，锁的选择至关重要。如果锁的选择不当，可能会导致死锁、数据冲突等问题。在Java中，锁的选择通常基于以下原则：</p>
<ol>
<li><strong>锁的粒度：</strong>
<ul>
<li>锁的粒度越小，线程的并发性能越高，但可能增加死锁的风险。</li>
<li>锁的粒度越大，线程的并发性能越低，但实现简单。</li>
</ul>
</li>
<li><strong>锁的对象：</strong>
<ul>
<li>使用<code>this</code>作为锁对象时，锁住的是当前实例。</li>
<li>使用类对象（如对方法加锁时）作为锁对象时，锁住的是整个类的所有实例。</li>
<li>如果需要<strong>更细粒度的控制</strong>，可以使用特定的对象作为锁。(但要保证不出现死锁或是一睡不醒的情况)</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in MainQueue.java</span></span><br><span class="line"><span class="comment">// 对方法加锁，锁住的是实例化后的对象</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">addPersonRequest</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">    persons.add(person);</span><br><span class="line">    notifyAll(); <span class="comment">// 唤醒所有等待的线程</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// in Elevator.java</span></span><br><span class="line"><span class="comment">// 对this加锁，锁住的是当前实例</span></span><br><span class="line"><span class="type">long</span> <span class="variable">remainingTime</span> <span class="operator">=</span> waitingTime - System.currentTimeMillis() +  lastTime;</span><br><span class="line"><span class="keyword">if</span> (remainingTime &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123; <span class="keyword">synchronized</span> (<span class="built_in">this</span>) &#123; wait(remainingTime); &#125; &#125; <span class="comment">// 电梯运行时等待</span></span><br><span class="line">    <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// in Elevator.java</span></span><br><span class="line"><span class="comment">// 对类对象加锁</span></span><br><span class="line"><span class="keyword">synchronized</span> (subQueue) &#123;</span><br><span class="line">    <span class="comment">// 防止一睡不醒！</span></span><br><span class="line">    <span class="keyword">if</span> (subQueue.isEnd()) &#123; <span class="keyword">return</span>; &#125; <span class="comment">// 如果子队列已结束，则不再等待</span></span><br><span class="line">    <span class="keyword">if</span> (!subQueue.isEmpty()) &#123; <span class="keyword">return</span>; &#125; <span class="comment">// 如果子队列不为空，则不再等待</span></span><br><span class="line">    <span class="keyword">try</span> &#123; subQueue.wait(); &#125;</span><br><span class="line">    <span class="keyword">catch</span> (InterruptedException e) &#123; Thread.currentThread().interrupt(); &#125; <span class="comment">// 调用等待方法，使当前线程挂起</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上一小节列出了模拟电梯调度系统中的共享资源，我们需要在这些共享资源加锁，保证对其的访问是线程安全的。在退出临界区时，需要释放锁，并唤醒其他等待的线程。(在所有同步块中包含<code>notifyAll()</code>方法唤醒所有等待的线程并不明智，还是要具体分析看是否有需要唤醒的线程。)</p>
<h4 id="锁与同步块中处理语句的关系">锁与同步块中处理语句的关系</h4>
<p>设置锁的目的是保证临界区代码的原子性，即要么全部执行，要么全部不执行。因此，<strong>锁保护了同步块中处理语句对于共享资源的访问和操作</strong>。有以下几点需要注意：</p>
<ol>
<li><strong>锁的作用范围：</strong> 锁的作用范围决定了哪些代码可以被多个线程并发执行，哪些代码需要串行执行以维护线程安全。在同步块中，只有获取到锁的线程才能执行代码，其他线程会被阻塞。这要求锁的作用范围应该尽量小，以提高并发性能。</li>
<li><strong>死锁的风险：</strong> 对于共享资源的盲目加锁可能导致死锁。例如，如果两个线程分别持有一个锁，并试图获取对方持有的锁，那么它们将永远无法继续执行。例如下面这段代码就可能导致死锁(不过肯定没人这么写)：</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in Elevator.java</span></span><br><span class="line"><span class="comment">// update结束后，电梯线程需要清除子队列中无法送达的请求</span></span><br><span class="line">sycnhronized (subQueue) &#123; &lt;--获取子队列的锁</span><br><span class="line">    <span class="type">Person</span> <span class="variable">unablePerson</span> <span class="operator">=</span> subQueue.getUnableRequest(isA, isB, transferFloor);</span><br><span class="line">    <span class="keyword">while</span> (unablePerson != <span class="literal">null</span>) &#123; <span class="comment">// 清除等待队列中的无效请求</span></span><br><span class="line">        <span class="comment">// 将无效请求放回主队列</span></span><br><span class="line">        mainQueue.addPersonRequest(unablePerson); &lt;-- 需要获取主队列的锁</span><br><span class="line">        unablePerson = subQueue.getUnableRequest(isA, isB, transferFloor);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in Scheduler.java</span></span><br><span class="line"><span class="comment">// 调度线程从主队列中取出请求，将乘客请求放入对应电梯的子队列中</span></span><br><span class="line">sycnhronized (mainQueue) &#123; &lt;-- 获取主队列的锁</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> mainQueue.getPersonRequest();</span><br><span class="line">    <span class="keyword">if</span> (person != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">elevatorId</span> <span class="operator">=</span> bestElevator(person);</span><br><span class="line">        subQueues.get(elevatorId).addPersonRequest(person); &lt;-- 需要获取子队列的锁</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong>锁的粒度与性能：</strong> 如果同步块中包含的语句过多，会降低并发性能；如果同步块中包含的语句过少，可能无法完全保护共享资源。因此，锁的粒度需要根据具体情况进行调整。一般来说，锁的粒度应该尽量小，以提高并发性能，否则多线程有可能退化成单线程，但也要保证线程安全。</li>
</ol>
<h3 id="二-线程协作与架构设计">二、线程协作与架构设计</h3>
<p>Unit 2的三次作业是循序渐进、逐层深入的，因此我们将在这里对三次作业的设计思路进行总结，尤其是对于多线程协作的架构设计思路。</p>
<table>
<thead>
<tr>
<th style="text-align:center">作业</th>
<th>功能变化</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">hw5</td>
<td>根据输入的乘客请求和对应的电梯序号调度电梯，主要关注电梯运行策略的设计以及基本的生产者-消费者模型构建</td>
</tr>
<tr>
<td style="text-align:center">hw6</td>
<td>在hw5的基础上，不再规定电梯序号，调度器根据乘客请求和电梯状态调度电梯，主要关注调度器的设计和调度策略的实现并增加临时调度请求的处理</td>
</tr>
<tr>
<td style="text-align:center">hw7</td>
<td>在hw6的基础上，增加电梯的更新请求，改造两个单轿厢电梯为双轿厢电梯，主要关注双轿厢电梯的同步更新和运行防撞，调度器需要进行合理调度</td>
</tr>
</tbody>
</table>
<p>下面将结合三次作业的具体实现，总结多线程协作的架构设计思路。</p>
<h4 id="hw5">hw5</h4>
<h5 id="hw5线程协作">hw5线程协作</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202504202147593.png" alt="hw5协作图"></p>
<p>由于乘客所乘坐的电梯已经在输入中给出，因此只需要将乘客请求放入对应电梯的子队列中即可。由于<strong>不知道输入何时到来</strong>，因此需要使用一个输入线程来读取输入，直至读到EOF。同时，由于电梯需要不断运行，<strong>保证将所有乘客送到目的地</strong>，因此需要使用一个电梯线程来处理子队列中的请求。在本次作业中，我们可以选择直接新建一个输入线程和六个电梯线程(<s>白雪公主和六个小矮人bushi</s>)，由输入线程直接将乘客请求放入对应电梯的子队列中，由电梯线程处理子队列中的请求。一个很简单的<strong>生产者-消费者模型：输入线程生产乘客请求，电梯线程消费乘客请求，电梯的子队列作为共享资源</strong>。但通过参考往年博客，我们发现后续作业将取消乘客所乘坐的电梯序号的输入，因此我们选择在hw5中设计一个调度器线程，负责处理输入线程放至主队列的乘客请求，并将乘客请求放入对应电梯的子队列中，交给电梯线程处理。这样，我们的电梯调度系统需要8个线程，分别是1个<code>InputThread</code>输入线程、1个<code>Scheduler</code>调度器线程和6个<code>Elevator</code>电梯线程，<strong>这些线程都由主类创建</strong>(后续协作图上省略主线程的创建过程)。<br>
综上，我们构建了一个两级 <strong>生产者-消费者模型：输入线程生产乘客请求，调度器消费乘客请求，主队列作为共享资源；调度器生产对应电梯的乘客请求，电梯线程消费该乘客请求，电梯的子队列作为共享资源。</strong> 这样做的好处是：</p>
<ul>
<li><strong>解耦</strong>：调度器线程和电梯线程之间的耦合度降低，调度器只负责调度，电梯只负责运行。这样可以更好地分离关注点，提高代码的可维护性和可扩展性。</li>
<li><strong>扩展</strong>：调度器线程可以扩展，在后续作业中，我们可以根据需要添加新的调度策略，而不需要修改电梯线程的实现。这样可以提高代码的可扩展性。</li>
</ul>
<h5 id="hw5架构设计">hw5架构设计</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202504202147446.png" alt="hw5类图"></p>
<p>本单元的第一次迭代难度不是太高，主要的训练目标是让大家熟悉<strong>Java多线程的基本概念和使用方法</strong>，并且确定<strong>单个电梯的运行策略</strong>，为后续设计调度策略打下基础。我的架构设计如下：</p>
<ul>
<li><strong>InputThread</strong>：输入线程，负责读取输入，将乘客请求放入主队列中。</li>
<li><strong>Scheduler</strong>：调度器线程，处理主队列中的乘客请求，根据<code>bestElevator</code>方法的返回值将乘客请求放入对应电梯的子队列中。本次作业中简单地读取乘客的电梯序号即可。</li>
<li><strong>Person</strong>：乘客类，包含乘客的电梯序号、楼层、方向、优先级等信息。由官方包中<code>Request</code>类扩展而来，增加了int类型的楼层和方向属性。</li>
<li><strong>RequesQueue</strong>：请求队列类，用于实例化主队列和子队列，管理乘客请求，是<strong>生产者-消费者模型</strong>中的共享资源。</li>
<li><strong>ELevator</strong>：电梯线程，处理子队列中的乘客请求，根据电梯的运行策略将乘客送到目的地，可以捎带或优先处理高优先级乘客(踢人)。</li>
<li><strong>Strategy</strong>：电梯运行策略接口，实现电梯策略和运行的解构，便于后续调整策略。本次作业采取<strong>LOOK</strong>策略。</li>
</ul>
<h6 id="运行策略和调度策略">运行策略和调度策略</h6>
<ol>
<li><strong>运行策略：</strong><code>Strategy</code>类是电梯线程的抽象策略类，用于获取电梯的运行建议。在本次作业中，我使用了最常见的LOOK策略，即电梯在当前方向上尽可能多地接送请求，直到当前方向上的请求都处理完毕，再转向继续处理请求。
<ul>
<li>子队列不为空，电梯<strong>运行前方</strong>楼层有请求或电梯内有乘客，则电梯继续沿原方向运动；</li>
<li>子队列不为空，所有乘客请求都在电梯<strong>运行后方</strong>的楼层(<code>FromFloor</code>和<code>ToFloor</code>)，则电梯掉头；</li>
<li>子队列为空但并未结束，则电梯停在该楼层等待；</li>
<li>子队列为空且已经结束，则电梯线程结束。</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Strategy</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RequestQueue subQueue;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ArrayList&lt;Person&gt; persons;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> personsIn;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">maxPersonNum</span> <span class="operator">=</span> <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Strategy</span><span class="params">(RequestQueue subQueue, ArrayList&lt;Person&gt; persons, <span class="type">int</span> personsIn)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.subQueue = subQueue;</span><br><span class="line">        <span class="built_in">this</span>.persons = persons;</span><br><span class="line">        <span class="built_in">this</span>.personsIn = personsIn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Advice <span class="title function_">getAdvice</span><span class="params">(<span class="type">int</span> currentFloor, <span class="type">int</span> direction, <span class="type">int</span> personsIn)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.personsIn = personsIn;</span><br><span class="line">        <span class="keyword">if</span> (hasPersonOut(currentFloor) || hasPersonIn(currentFloor, direction)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.OPEN; <span class="comment">// 电梯内有乘客到达目的楼层，或者当前层有等待乘客且方向相同</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (personsIn &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.MOVE; <span class="comment">// 电梯内有乘客，继续前进</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!subQueue.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (hasRequestAhead(currentFloor, direction)) &#123;</span><br><span class="line">                <span class="keyword">return</span> Advice.MOVE; <span class="comment">// 当前方向前方有请求，继续前进</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> Advice.REVERSE; <span class="comment">// 当前方向前方无请求，改变方向</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (subQueue.isEnd()) &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.OVER; <span class="comment">// 子队列为空，且输入结束，结束电梯线程</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.WAIT; <span class="comment">// 电梯内无乘客，外部无请求，等待新请求</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">···</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><strong>调度策略：</strong> 本次作业中，我们只需简单地读取乘客的电梯序号，因此调度策略非常简单。我们只需要将乘客请求放入对应电梯的子队列中即可。</li>
</ol>
<h6 id="数据类">数据类</h6>
<p>根据我们上面的分析，<code>InputThread</code>和<code>Scheduler</code>是生产者，<code>MainQueue</code>是共享资源，<code>Scheduler</code>和<code>Elevator</code>是消费者，<code>SubQueue</code>是共享资源，用来管理储存<code>Person</code>乘客请求。因此对于共享资源<code>MainQueue</code>和<code>SubQueue</code>的访问需要加锁，保证线程安全。我对<code>RequesQueue</code>类所有方法都加上了锁，并在需要时使用<code>notifyAll()</code>唤醒其他等待线程。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// RequesQueue.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestQueue</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Person&gt; persons = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">end</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> ArrayList&lt;Person&gt; <span class="title function_">getPersons</span><span class="params">()</span> &#123;</span><br><span class="line">        notifyAll();</span><br><span class="line">        <span class="keyword">return</span> persons;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">addPersonRequest</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">        persons.add(person);</span><br><span class="line">        notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> Person <span class="title function_">getPersonRequest</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 用于调度器从主队列中获取乘客请求</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">return</span> person;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        notifyAll();</span><br><span class="line">        <span class="keyword">return</span> persons.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">isEnd</span><span class="params">()</span> &#123; <span class="keyword">return</span> end; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">setEnd</span><span class="params">()</span> &#123;</span><br><span class="line">        end = <span class="literal">true</span>;</span><br><span class="line">        notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> Person <span class="title function_">getPersonIn</span><span class="params">(<span class="type">int</span> floor, <span class="type">int</span> direction)</span> &#123;</span><br><span class="line">        ...<span class="comment">// 获取某层某方向优先级最高的乘客</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Person.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(PersonRequest request)</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="built_in">this</span>.fromInt = floorToInt(fromFloor);</span><br><span class="line">        <span class="built_in">this</span>.toInt = floorToInt(toFloor);</span><br><span class="line">        <span class="built_in">this</span>.direction = Integer.compare(toInt, fromInt);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String fromFloor, String toFloor, <span class="type">int</span> personId, <span class="type">int</span> priority, <span class="type">int</span> elevatorId)</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="built_in">this</span>.fromInt = floorToInt(fromFloor);</span><br><span class="line">        <span class="built_in">this</span>.toInt = floorToInt(toFloor);</span><br><span class="line">        <span class="built_in">this</span>.direction = Integer.compare(toInt, fromInt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="线程类">线程类</h6>
<p>本次作业的<code>InputThread</code>和<code>Scheduler</code>类的设计比较简单，主要是读取输入和调度乘客请求：</p>
<ul>
<li><code>InputThread</code>类负责读取输入，将输入的乘客请求封装成<code>Person</code>对象，并放入主队列中。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InputThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RequestQueue mainQueue;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">InputThread</span><span class="params">(RequestQueue mainQueue)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.mainQueue = mainQueue; <span class="comment">// 由MainClass创建的主队列</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ElevatorInput</span> <span class="variable">elevatorInput</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ElevatorInput</span>(System.in);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">PersonRequest</span> <span class="variable">request</span> <span class="operator">=</span> (PersonRequest) elevatorInput.nextRequest();</span><br><span class="line">            <span class="keyword">if</span> (request == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 设置主队列结束标志</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 将输入的乘客请求封装成Person对象</span></span><br><span class="line">                <span class="comment">// 将乘客请求放入主队列</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Scheduler</code>类共享主队列，负责调度乘客请求，将乘客请求分配给电梯。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Scheduler</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RequestQueue mainQueue;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Integer, RequestQueue&gt; subQueues;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Integer, Elevator&gt; elevators;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Scheduler</span><span class="params">(RequestQueue mainQueue, HashMap&lt;Integer, RequestQueue&gt; subQueues,</span></span><br><span class="line"><span class="params">        HashMap&lt;Integer, Elevator&gt; elevators)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.mainQueue = mainQueue;</span><br><span class="line">        <span class="built_in">this</span>.subQueues = subQueues;</span><br><span class="line">        <span class="built_in">this</span>.elevators = elevators;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">bestElevator</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> person.getElevatorId(); <span class="comment">// easy!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (mainQueue) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mainQueue.isEmpty() &amp;&amp; mainQueue.isEnd()) &#123;</span><br><span class="line">                    <span class="comment">// 设置子队列结束标志</span></span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> mainQueue.getPersonRequest();</span><br><span class="line">            <span class="keyword">if</span> (person != <span class="literal">null</span>) &#123;</span><br><span class="line">                subQueues.get(bestElevator(person)).addPersonRequest(person);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Elevator</code>电梯线程的设计相对复杂一些，主要是实现电梯的运行策略和捎带乘客的逻辑。我们在这里使用了一个<code>Strategy</code>类来实现电梯的运行策略，电梯只要调用<code>getAdvice</code>方法就可以获取到下一步的运行策略。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Elevator</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RequestQueue subQueue;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> currentFloor;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> personsIn;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> direction;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ArrayList&lt;Person&gt; persons;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Strategy strategy;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">maxPersonNum</span> <span class="operator">=</span> <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> lastTime; <span class="comment">// 维护时间戳，用于计算等待时间</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Elevator</span><span class="params">(<span class="type">int</span> id, RequestQueue subQueue)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.subQueue = subQueue;</span><br><span class="line">        <span class="built_in">this</span>.currentFloor = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">this</span>.personsIn = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.direction = -<span class="number">1</span>; <span class="comment">// 如何确定初始方向？</span></span><br><span class="line">        <span class="built_in">this</span>.persons = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="built_in">this</span>.strategy = <span class="keyword">new</span> <span class="title class_">Strategy</span>(subQueue, persons, personsIn);</span><br><span class="line">        <span class="built_in">this</span>.lastTime = System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">Advice</span> <span class="variable">advice</span> <span class="operator">=</span> strategy.getAdvice(currentFloor, direction, personsIn);</span><br><span class="line">            <span class="keyword">switch</span> (advice) &#123;</span><br><span class="line">                <span class="keyword">case</span> OPEN:</span><br><span class="line">                    openAndClose();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> MOVE:</span><br><span class="line">                    move();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> REVERSE:</span><br><span class="line">                    reverse();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> OVER: <span class="comment">// 结束</span></span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">case</span> WAIT:</span><br><span class="line">                    waitRequest();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;Error in Elevator.run&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">... <span class="comment">// 具体实现</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>关于<strong>初始方向：</strong> 由于电梯初始在<strong>F1</strong>层，而电梯大楼从<strong>B4</strong>层到<strong>F7</strong>层，LOOK策略会优先接送完当前方向的请求再反向，因此如何设置初始方向成了我在第一次迭代时考虑的问题。我认为，<strong>B4层到F1层</strong>的距离小于<strong>F1层到F7层</strong>的距离，因而设置初始方向向下，使得响应两方向的请求时间都不太长。但在第二次迭代时，我选择修改LOOK策略为<strong>LOOK+ALS</strong>策略，由电梯主动选择方向。</p>
</blockquote>
<blockquote>
<p>关于<strong>量子电梯</strong>：第一次迭代并未有RECEIVE限制，即要求电梯在接到请求(输出RECEIVE)后才能运动，因此电梯在等待或运行时存在<strong>量子状态</strong>：</p>
<ol>
<li>等待状态：电梯在等待乘客请求时，由于<strong>输出ARRIVE是电梯移动一层的结束</strong>，因此等待在某一层的电梯可以处于等待、向上走、向下走的量子状态，也就是在三层楼之间处于不被观测的状态。</li>
<li>运行状态：电梯在运行时，移动的时间是电梯运行的量子时间，电梯在运行时可以处于移动、等待的量子状态。在移动时间结束时，电梯既可以出现在当前楼层，也可以出现在下一楼层。</li>
</ol>
<p>电梯既在等待，又在运行。</p>
</blockquote>
<pre><code>量子电梯时一种仅仅为了适应评测机而诞生的毫无作用的小trick。想要ban掉量子电梯的设计，最简单的方法就是让电梯开始移动也输出一个标志位。
</code></pre>
<h4 id="hw6">hw6</h4>
<h5 id="hw6线程协作">hw6线程协作</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202504202148419.png" alt="hw6协作图"></p>
<p>在第六次作业中，我们继续沿用<strong>两级生产者-消费者模型</strong>，在上次作业的基础上迭代。输入线程负责读取乘客请求并将其放入主队列；调度器从主队列中取出乘客请求，并根据调度策略调用<code>bestElevator</code>方法，将其分配给合适的电梯子队列；电梯线程从自己的子队列中取出请求并处理。本次作业的重点在于 <strong>1. 实现模拟电梯系统的调度策略</strong> 以及 <strong>2. 实现新增临时调度请求</strong>。</p>
<ul>
<li>新增<code>Elevator</code>类向<code>MainQueue</code>中<strong>返回乘客请求</strong>的协作，用于临时调度前后的乘客请求取消RECEIVE，并配合LOOK+ALS策略实现<strong>乘客可重复选择电梯</strong>。</li>
<li>新增调度辅助类<code>ElevatorStorage</code>和<code>ShadowElevator</code>类，通过<strong>电梯线程主动留下影子</strong>和<strong>调度器线程获取电梯状态</strong>的协作方式，实现调度策略。</li>
<li>新增<code>InputThread</code>类向<code>SubQueue</code>中<strong>添加临时调度请求</strong>的协作，保证电梯线程在运行时会<strong>优先</strong>处理临时调度请求。</li>
</ul>
<h5 id="hw6架构设计">hw6架构设计</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202504202148898.png" alt="hw6类图"></p>
<p>本次作业的架构设计在第五次作业的基础上进行了扩展和优化：</p>
<ul>
<li><strong>InputThread</strong>：读取输入并放入主队列(乘客请求)或者电梯线程的子队列(临时调度请求)，在输入结束时传递<code>InputEnd</code>信号。</li>
<li><strong>MainQueue</strong>：主队列存储所有待分配的乘客请求(输入线程生产的乘客请求以及电梯线程返回的乘客请求)，供调度器消费，设置计数器给出<code>isAllEnd</code>信号。</li>
<li><strong>Scheduler</strong>：调度器线程负责从主队列中取出乘客请求，并根据调度策略将其分配到合适的电梯子队列。</li>
<li><strong>SubQueue</strong>：每个电梯都有自己的子队列，存储分配给该电梯的乘客请求。</li>
<li><strong>Elevator</strong>：电梯线程从自己的子队列中取出请求并处理，根据 LOOK+ALS 策略运行。</li>
<li><strong>ElevatorStorage</strong>：电梯存储类，存储所有影子电梯的状态信息。</li>
<li><strong>ShadowElevator</strong>：影子电梯类，用于模拟电梯的当前状态，供调度器进行调度决策。</li>
<li><strong>NewStrategy</strong>：策略类，实现 LOOK+ALS 策略，指导电梯的运行。</li>
</ul>
<h6 id="look-als-策略的实现">LOOK+ALS 策略的实现</h6>
<p><strong>自由竞争策略</strong>曾经是往届博客中强推的一种电梯调度方法，但所有电梯一拥而上比拼速度，会导致耗电量巨大，且电梯运行效率低下，也不符合现实情况。而RECEIVE的限制使得电梯不能随意移动，而必须在接受乘客请求后才能开始运动(这也ban掉了量子电梯)，因此我们需要设计一个合理的调度策略来解决这个问题。那么问题来了，<strong>RECEIVE应该在何时输出，由谁来输出？</strong><br>
由<code>Scheduler</code>或者<code>SubQueue</code>在将乘客请求放入电梯子队列时输出RECEIVE是一种简单的设计，但这样会导致电梯接受乘客请求的时间未知，不利于维护时间戳以及保证输出顺序。因此，我们选择在<code>Elevator</code>中输出RECEIVE，但<strong>电梯线程如何知道何时输出RECEIVE并及时输出呢？</strong><br>
电梯在运行过程中，可能会出现电梯正在移动或者等待的情况，此时电梯无法执行接受新的乘客请求的方法。这会导致输出时间延后，还是不利于维护时间戳。所以，有什么方法可以<strong>让电梯在运行过程中及时输出RECEIVE呢？</strong><br>
事实上，我们不需要在将乘客请求加入子队列时就输出RECEIVE，我们并没有要求乘客RECEIVE和IN之间有时间间隔，完全可以在乘客进入电梯时输出RECEIVE。可电梯无法在RECEIVE<strong>任何乘客</strong>之前移动，除非我们保证电梯在移动之前有RECEIVE的乘客，这和ALS的主请求很相似，不是吗？因此我们<strong>利用ALS运行策略让电梯有主请求。</strong><br>
在实际生活中，人们在电梯厅等待电梯时，通常会选择距离最近的电梯。如果电梯满员或无法满足需求，人们会切换到其他电梯。这种行为模式为我们设计乘客分配策略提供了直观的灵感。<strong><a href="https://bbs.csdn.net/topics/618471285?spm=1001.2014.3001.6377">参考钟昊翔学长的博客</a></strong><br>
综上，我们采用<strong>LOOK+ALS</strong>和<strong>乘客可重复选择电梯</strong>的电梯运行策略；</p>
<ul>
<li>乘客初始时被分配给一个电梯，但如果该电梯满员或无法满足需求，乘客会被放回主队列，重新分配给其他电梯。</li>
<li>LOOK+ALS策略结合了 ALS和 LOOK 策略的优点：<strong>1. ALS 策略</strong>：电梯空闲时选择一个主请求，并沿主请求的方向开始运动，捎带沿途的其他请求。实现了电梯只需要RECEIVE最少的请求即可开始运动。<strong>2. LOOK 策略</strong>：电梯在当前方向上移动，处理沿途的请求，若前方无请求且电梯内无人，则反转方向。实现了电梯在当前方向上尽可能多地接送请求。具体实现如下：
<ul>
<li><strong>选择主请求</strong>：电梯空闲时，从子队列中选择并RECEIVE一个主请求，沿主请求的方向开始运动。</li>
<li><strong>捎带请求</strong>：在运动过程中，电梯会捎带同方向的其他请求。</li>
<li><strong>接送乘客</strong>：电梯在到达目标楼层时，开门接送乘客，乘客进入前RECEIVE(除了主请求)，无法进入的乘客将返回主队列。</li>
<li><strong>方向反转</strong>：当电梯当前方向前方无请求且电梯内无人时，电梯反转方向。</li>
<li><strong>临时调度请求处理</strong>：若电梯收到临时调度请求，会优先处理该请求。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NewStrategy</span> &#123; <span class="comment">// LOOK+ALS</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> SubQueue subQueue; <span class="comment">// 等待队列</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ArrayList&lt;Person&gt; persons; <span class="comment">// 电梯内乘客列表</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> personsIn;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">maxPersonNum</span> <span class="operator">=</span> <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">private</span> AtomicReference&lt;Person&gt; mainRequestRef; <span class="comment">// 主请求</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">NewStrategy</span><span class="params">(SubQueue subQueue, ArrayList&lt;Person&gt; persons,</span></span><br><span class="line"><span class="params">        <span class="type">int</span> personsIn, AtomicReference&lt;Person&gt; mainRequestRef)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.mainRequestRef = mainRequestRef; <span class="comment">// 主请求</span></span><br><span class="line">        <span class="built_in">this</span>.subQueue = subQueue; <span class="comment">// 初始化子队列</span></span><br><span class="line">        <span class="built_in">this</span>.persons = persons; <span class="comment">// 初始化电梯内乘客列表</span></span><br><span class="line">        <span class="built_in">this</span>.personsIn = personsIn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Advice <span class="title function_">getAdvice</span><span class="params">(<span class="type">int</span> currentFloor, <span class="type">int</span> direction, <span class="type">int</span> personsIn)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.personsIn = personsIn;</span><br><span class="line">        <span class="keyword">if</span> (subQueue.hasScheRequest()) &#123; <span class="comment">// 处理临时调度请求</span></span><br><span class="line">            <span class="keyword">return</span> Advice.SCHE;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (direction == <span class="number">0</span>) &#123; <span class="comment">// 电梯空闲状态选择主请求</span></span><br><span class="line">            <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> subQueue.getPrimaryRequest();</span><br><span class="line">            <span class="keyword">if</span> (p != <span class="literal">null</span>) &#123; <span class="comment">// 主请求的设置由电梯完成</span></span><br><span class="line">                <span class="keyword">return</span> Advice.MOVE;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> subQueue.isEnd() ? Advice.OVER : Advice.WAIT;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hasPersonOut(currentFloor) || hasPersonIn(currentFloor, direction)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.OPEN; <span class="comment">// 如果电梯内有乘客到达目的楼层，或者当前层有等待乘客且方向相同</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (personsIn &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.MOVE; <span class="comment">// 如果电梯内有乘客，继续前进</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!subQueue.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (hasRequestAhead(currentFloor, direction)) &#123;</span><br><span class="line">                <span class="keyword">return</span> Advice.MOVE; <span class="comment">// 如果当前方向前方有请求，继续前进</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> Advice.REVERSE; <span class="comment">// 如果当前方向前方无请求，改变方向</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (subQueue.isEnd()) &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.OVER; <span class="comment">// 如果请求队列为空，且输入结束，结束电梯线程</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Advice.WAIT; <span class="comment">// 如果电梯内无乘客，外部无请求，等待新请求</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ···</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="电梯调度的改进">电梯调度的改进</h6>
<p><strong>似是而非的影子电梯</strong>：在第六次作业中，我们引入了影子电梯（<code>ShadowElevator</code>）的概念，用于调度器<strong>对电梯运行的粗略模拟</strong>，实现调度。调度器不再直接根据乘客的电梯序号分配请求，而是根据所有电梯的当前状态（通过影子电梯获取）为每个乘客选择最佳的电梯。具体实现如下：</p>
<ul>
<li><strong>影子电梯（<code>ShadowElevator</code>）</strong>：每个电梯对应一个影子电梯，记录电梯的当前楼层、方向、乘客数量、是否处于临时调度状态等信息。这些信息用于调度器估算电梯完成当前请求所需的时间。</li>
<li><strong>调度器（<code>Scheduler</code>）</strong>：调度器从主队列中取出乘客请求后，调用 <code>bestElevator</code> 方法遍历所有影子电梯，根据每个影子电梯的当前状态估算完成该乘客请求所需的时间，并为乘客选择时间最短的电梯。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in Scheduler.java</span></span><br><span class="line"><span class="keyword">public</span> Integer <span class="title function_">bestElevator</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">    Collection&lt;ShadowElevator&gt; shadows = ElevatorStorage.getInstance().getAllShadows();</span><br><span class="line">    <span class="type">int</span> <span class="variable">bestPerformance</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">    <span class="type">int</span> <span class="variable">bestAssignedCount</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">    <span class="type">int</span> <span class="variable">bestElevatorId</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="type">ShadowElevator</span> <span class="variable">bestShadow</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (ShadowElevator shadow : shadows) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">perf</span> <span class="operator">=</span> shadow.getEstimatePerformance(person);</span><br><span class="line">        <span class="keyword">if</span> (perf &lt; bestPerformance) &#123;</span><br><span class="line">            ... <span class="comment">// 更新最优电梯</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (perf == bestPerformance) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">currentAssigned</span> <span class="operator">=</span> shadow.getAssignedCount();</span><br><span class="line">            <span class="keyword">if</span> (currentAssigned &lt; bestAssignedCount) &#123;</span><br><span class="line">                ... <span class="comment">// 如果已分配数量较少，则选择该电梯</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentAssigned == bestAssignedCount) &#123;</span><br><span class="line">                ... <span class="comment">// 如果已分配数量也相同，则选择电梯编号较小的</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (bestShadow != <span class="literal">null</span>) &#123; <span class="comment">// 选定后增加该电梯的请求分配计数</span></span><br><span class="line">        bestShadow.addAssignedCount();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bestElevatorId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="数据类">数据类</h6>
<ul>
<li><code>MainQueue</code> 类是输入线程和输出线程之间的通信桥梁，用于传递请求供调度器消费。主队列的设计与上次作业类似，但增加了计数器用于线程是否结束。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainQueue</span> <span class="keyword">extends</span> <span class="title class_">RequestQueue</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">passengerCount</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// 乘客请求计数器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">scheRequestCount</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// 调度请求计数器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">inputEnd</span> <span class="operator">=</span> <span class="literal">false</span>; <span class="comment">// 输入结束标志</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">addPassengerCount</span><span class="params">()</span> &#123; passengerCount++; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">addScheRequestCount</span><span class="params">()</span> &#123; scheRequestCount++; &#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">isAllEnd</span><span class="params">()</span> &#123; <span class="keyword">return</span> inputEnd &amp;&amp; passengerCount == <span class="number">0</span> &amp;&amp; scheRequestCount == <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">setInputEnd</span><span class="params">()</span> &#123; inputEnd = <span class="literal">true</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ElevatorStorage</code> 类保存所有电梯的影子状态，并提供更新和获取影子状态的方法。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ElevatorStorage</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ElevatorStorage</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ElevatorStorage</span>(); <span class="comment">// 单例实例</span></span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;Integer, ShadowElevator&gt; shadowElevators; <span class="comment">// 保存影子电梯状态</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">ElevatorStorage</span><span class="params">()</span> &#123;</span><br><span class="line">        shadowElevators = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ElevatorStorage <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">updateShadow</span><span class="params">(<span class="type">int</span> elevatorId, <span class="type">int</span> currentFloor,</span></span><br><span class="line"><span class="params">        <span class="type">int</span> direction, <span class="type">int</span> personsIn, ScheRequest scheRequest)</span> &#123;</span><br><span class="line">        <span class="type">ShadowElevator</span> <span class="variable">shadow</span> <span class="operator">=</span> shadowElevators.get(elevatorId);</span><br><span class="line">        <span class="keyword">if</span> (shadow == <span class="literal">null</span>) &#123;</span><br><span class="line">            shadow = <span class="keyword">new</span> <span class="title class_">ShadowElevator</span>(elevatorId, currentFloor,</span><br><span class="line">                direction, personsIn, scheRequest);</span><br><span class="line">            shadowElevators.put(elevatorId, shadow);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            shadow.update(currentFloor, direction, personsIn, scheRequest);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> ShadowElevator <span class="title function_">getShadow</span><span class="params">(<span class="type">int</span> elevatorId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> shadowElevators.get(elevatorId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> Collection&lt;ShadowElevator&gt; <span class="title function_">getAllShadows</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(shadowElevators.values());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ShadowElevator</code> 类模拟电梯的当前状态，包括楼层、方向、乘客数量、临时调度请求等。调度器根据这些信息估算电梯完成乘客请求所需的时间。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShadowElevator</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> elevatorId;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> currentFloor;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> direction;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> personsIn;</span><br><span class="line">    <span class="keyword">private</span> ScheRequest scheduleReq;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">assignedCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ShadowElevator</span><span class="params">(<span class="type">int</span> elevatorId, <span class="type">int</span> currentFloor, <span class="type">int</span> direction, <span class="type">int</span> personsIn, ScheRequest scheduleReq)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.elevatorId = elevatorId;</span><br><span class="line">        <span class="built_in">this</span>.currentFloor = currentFloor;</span><br><span class="line">        <span class="built_in">this</span>.direction = direction;</span><br><span class="line">        <span class="built_in">this</span>.personsIn = personsIn;</span><br><span class="line">        <span class="built_in">this</span>.scheduleReq = scheduleReq;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">getEstimatePerformance</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">        ... <span class="comment">// 计算电梯完成乘客请求所需的时间</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">totalTime</span> <span class="operator">=</span> travelTime + reversalDelay + loadPenalty;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">int</span>)(totalTime * <span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="线程类">线程类</h6>
<ul>
<li><code>InputThread</code> 类负责读取输入并将乘客请求放入主队列。本次作业中输入结束将设置主队列<code>InputEnd</code>标志位，作为线程结束的条件之一。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InputThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MainQueue mainQueue;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Integer, SubQueue&gt; subQueues;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">InputThread</span><span class="params">(MainQueue mainQueue, HashMap&lt;Integer, SubQueue&gt; subQueues)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.mainQueue = mainQueue;</span><br><span class="line">        <span class="built_in">this</span>.subQueues = subQueues;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ElevatorInput</span> <span class="variable">elevatorInput</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ElevatorInput</span>(System.in);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> elevatorInput.nextRequest();</span><br><span class="line">            <span class="keyword">if</span> (request == <span class="literal">null</span>) &#123;</span><br><span class="line">                mainQueue.setInputEnd();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request <span class="keyword">instanceof</span> PersonRequest) &#123;</span><br><span class="line">                ... <span class="comment">// 将乘客请求放入主队列</span></span><br><span class="line">                mainQueue.addPassengerCount();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request <span class="keyword">instanceof</span> ScheRequest) &#123;</span><br><span class="line">                ... <span class="comment">// 将调度请求放入对应子队列</span></span><br><span class="line">                mainQueue.addScheRequestCount();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Scheduler</code> 类负责从主队列中取出乘客请求，并根据调度策略将其分配到合适的电梯子队列。除<code>bestElevator</code>方法外无变化。</li>
</ul>
<blockquote>
<p>如何实现<strong>电梯调度和乘客分配</strong>是本次作业的核心问题，我的所谓影子电梯调度策略仅能算是某种调参，但借助乘客可重新分配的特性，仍能取得较好的效果。各类调度器比较可参考<a href="#%E4%B8%89%E8%B0%83%E5%BA%A6%E5%99%A8%E8%AE%BE%E8%AE%A1%E4%B8%8E%E8%B0%83%E5%BA%A6%E7%AD%96%E7%95%A5">调度器设计与调度策略</a>。</p>
</blockquote>
<ul>
<li><code>Elevator</code> 类负责处理子队列中的乘客请求，根据 LOOK+ALS 策略运行。对于本次作业新增临时调度请求，电梯线程会在调用<code>getAdvice</code>方法时优先检查是否有临时调度请求，如果有则优先处理临时调度请求；并且在运行时(<code>move()</code>方法中)会检查是否有临时调度请求，保证在规定时限(6s)内完成临时调度请求。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Elevator</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> lastTime; <span class="comment">// 上次运行时间</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> <span class="variable">speed</span> <span class="operator">=</span> <span class="number">0.4</span>; <span class="comment">// 电梯速度</span></span><br><span class="line">    <span class="keyword">private</span> AtomicReference&lt;Person&gt; mainRequest;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">Advice</span> <span class="variable">advice</span> <span class="operator">=</span> newStrategy.getAdvice(currentFloor,</span><br><span class="line">                direction, personsIn);</span><br><span class="line">            <span class="keyword">if</span> (direction == <span class="number">0</span>) &#123;</span><br><span class="line">                initialize(); <span class="comment">// 初始化主请求和方向</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">switch</span> (advice) &#123;</span><br><span class="line">                <span class="keyword">case</span> SCHE: <span class="comment">// 临时调度请求</span></span><br><span class="line">                    handleScheRequset();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> OPEN:</span><br><span class="line">                    openAndClose();</span><br><span class="line">                    <span class="comment">// 主请求到达则设置主请求为空，将未进入的乘客返回主队列</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> MOVE:</span><br><span class="line">                    move();</span><br><span class="line">                    <span class="comment">// 移动开始时检测主请求是否为空，为空则初始化主请求和方向</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> REVERSE:</span><br><span class="line">                    reverse();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> OVER: <span class="comment">// 结束</span></span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">case</span> WAIT:</span><br><span class="line">                    waitRequest();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;Error in Elevator.run&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ElevatorStorage.getInstance().updateShadow(id,</span><br><span class="line">                currentFloor, direction, personsIn, <span class="literal">null</span>); <span class="comment">// 更新电梯状态</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">handleScheRequset</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ScheRequest</span> <span class="variable">req</span> <span class="operator">=</span> subQueue.getScheRequest();</span><br><span class="line">        <span class="keyword">if</span> (req == <span class="literal">null</span>) &#123; <span class="keyword">return</span>; &#125; <span class="comment">// 如果没有临时调度请求，则返回</span></span><br><span class="line">        ...</span><br><span class="line">        scheduleOpenAndClose(tempDirection, targetFloor); <span class="comment">// 如果电梯内已有乘客，开门</span></span><br><span class="line">        TimableOutput.println(String.format(<span class="string">&quot;SCHE-BEGIN-%d&quot;</span>, id)); <span class="comment">// 保证门已关闭后，开始临时调度</span></span><br><span class="line">        lastTime = System.currentTimeMillis(); <span class="comment">// 更新时间</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> subQueue.getAndCleanRequest(); <span class="comment">// 清除子队列</span></span><br><span class="line">        <span class="keyword">while</span> (person != <span class="literal">null</span>) &#123;</span><br><span class="line">            mainQueue.addPersonRequest(person); <span class="comment">// 放回主队列</span></span><br><span class="line">            person = subQueue.getAndCleanRequest();</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">        scheduleMove(tempDirection, targetFloor, tempFloor); <span class="comment">// 移动</span></span><br><span class="line">        speed = originalSpeed; <span class="comment">// 到达目标楼层后，恢复默认速度</span></span><br><span class="line">        cleanOpenAndClose(<span class="number">1000</span>); <span class="comment">// 到达目标楼层，开门并保持 T_stop</span></span><br><span class="line">        TimableOutput.println(String.format(<span class="string">&quot;SCHE-END-%d&quot;</span>, id));</span><br><span class="line">        lastTime = System.currentTimeMillis(); <span class="comment">// 更新时间</span></span><br><span class="line">        direction = <span class="number">0</span>; <span class="comment">// 设置电梯方向为0，表示等待</span></span><br><span class="line">        mainRequest.set(<span class="literal">null</span>); <span class="comment">// 清空主请求</span></span><br><span class="line">        subQueue.setScheRequest(<span class="literal">null</span>); <span class="comment">// 处理完请求后，清空请求</span></span><br><span class="line">        mainQueue.subScheRequestCount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>为了保证电梯能在<strong>两次移动楼层操作内</strong>开始临时调度且 <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>t</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{complete}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>不超过6s</strong>，我们不能让临时调度请求和乘客请求一样经过主队列和调度器分配，否则可能会导致ARRIVE过多或是超过6s，而是选择在<code>InputThread</code>类中直接分派临时调度请求，电梯线程在运行时会优先处理临时调度请求。</p>
</blockquote>
<h4 id="hw7">hw7</h4>
<h5 id="hw7线程协作">hw7线程协作</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202504202149448.png" alt="hw7协作图"></p>
<p>在第七次作业中，我们在之前的基础上增加了对双轿厢电梯的支持，<strong>引入流水线设计</strong>使换乘乘客由A-B电梯接力处理。输入线程读取输入，将<strong>乘客请求</strong>放入<strong>主队列</strong>或直接发送<strong>临时调度/更新请求</strong>给<strong>电梯线程</strong>；调度器从主队列中取出乘客请求，并根据调度策略将其分配给合适的电梯子队列；电梯线程处理自己的子队列中的请求，并在遇到双轿厢更新请求或是到达换乘层时，与<strong>协作器</strong>协调完成双轿厢电梯功能。</p>
<ul>
<li><strong>InputThread</strong>：读取输入，将乘客请求放入主队列，或将临时调度请求和双轿厢更新请求直接发送给对应的电梯子队列。完成输入后，设置主队列的结束标志。</li>
<li><strong>MainQueue</strong>：主队列存储所有待分配的乘客请求，供调度器消费。同时，电梯线程会将<strong>无法处理/换乘</strong>的乘客请求返回主队列，主队列负责维护系统的结束状态。</li>
<li><strong>Scheduler</strong>：调度器线程与之前相同</li>
<li><strong>SubQueue</strong>：电梯的子队列，增加支持双轿厢电梯的特殊操作，如处理更新请求和管理换乘楼层相关的乘客请求。</li>
<li><strong>Elevator</strong>：电梯线程处理自己的子队列中的请求，根据 LOOK+ALS 策略运行。在处理双轿厢更新请求时，与协作器协调，完成双轿厢的设置和更新操作。</li>
<li><strong>Coordinator</strong>：协作器负责管理双轿厢电梯的换乘楼层协调和更新操作。确保两个轿厢不会同时位于换乘楼层，并协调双轿厢的更新过程。</li>
</ul>
<h5 id="hw7架构设计">hw7架构设计</h5>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202504202150522.png" alt="hw7类图"></p>
<p>本次作业是电梯单元的最后一次迭代，我的架构设计在前两次作业的基础上进行了扩展，以支持双轿厢电梯的功能。以下我们主要关心双轿厢电梯的实现和调度策略的改进。</p>
<h6 id="双轿厢电梯的实现">双轿厢电梯的实现</h6>
<p><strong>双轿厢电梯的运行规则：</strong> 双轿厢电梯由原本独立的两台电梯（A 和 B）改造在同一电梯井道内组成(A从原先电梯井瞬移而来，不过并不重要，两台电梯也不会共用子队列)。为了确保安全，两个轿厢不能同时位于换乘楼层。具体规则如下：</p>
<ul>
<li>轿厢 A 只能在 <strong>换乘楼层~F7</strong> 运行，轿厢 B 只能在 <strong>B4~换乘楼层</strong> 运行。</li>
<li>同一井道内的两轿厢不能同时位于换乘楼层。</li>
</ul>
<p>我们选择使用协作器（<code>Coordinator</code>）来管理双轿厢电梯的换乘楼层访问和更新操作。协作器负责协调两个轿厢的运行，轿厢<strong>进入换乘楼层前申请锁，离开时释放锁</strong>，确保它们不会在同一时间进入换乘楼层。</p>
<h6 id="协作器-coordinator-的实现">协作器（Coordinator）的实现</h6>
<p>协作器负责管理双轿厢电梯的换乘楼层访问和更新操作：</p>
<ul>
<li><strong>换乘楼层协调</strong>：在 <code>move</code> 方法中，电梯在即将进入换乘楼层时调用 <code>coordinator.robTransferFloor()</code> 获取换乘层的锁，确保同一时间只有一个轿厢在换乘楼层。当电梯离开换乘楼层时，调用 <code>coordinator.releaseTransferFloor()</code> 释放锁，允许另一个轿厢进入换乘楼层。且如果电梯要在换乘层等待，则手动将其挪个位。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Coordinator.java</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> isOccupied; <span class="comment">// 用于楼层换乘协调</span></span><br><span class="line"><span class="comment">// ---------------- 楼层换乘协调功能 ----------------</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">robTransferFloor</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (isOccupied) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wait(); <span class="comment">// 等待直至换乘层空闲</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    isOccupied = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">releaseTransferFloor</span><span class="params">()</span> &#123;</span><br><span class="line">    isOccupied = <span class="literal">false</span>;</span><br><span class="line">    notifyAll();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Elevator.java</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 换乘楼层访问控制</span></span><br><span class="line">    <span class="keyword">if</span> (currentFloor == transferFloor) &#123;</span><br><span class="line">        coordinator.robTransferFloor(); <span class="comment">// 获取换乘层锁</span></span><br><span class="line">    &#125;</span><br><span class="line">    TimableOutput.println(String.format(<span class="string">&quot;ARRIVE-%s-%d&quot;</span>, curFloorStr, id));</span><br><span class="line">    <span class="comment">// 离开换乘楼层时释放锁</span></span><br><span class="line">    <span class="keyword">if</span> (currentFloor == transferFloor + direction) &#123;</span><br><span class="line">        coordinator.releaseTransferFloor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">waitRequest</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (hasUpdated &amp;&amp; currentFloor == transferFloor) &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">if</span> (remainingTime &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123; <span class="keyword">synchronized</span> (<span class="built_in">this</span>) &#123; wait(remainingTime); &#125; &#125;</span><br><span class="line">            <span class="keyword">catch</span> (InterruptedException e) &#123; Thread.currentThread().interrupt(); &#125; <span class="comment">// 中断</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isA) &#123;</span><br><span class="line">            currentFloor = transferFloor + <span class="number">1</span>; <span class="comment">// 更新当前楼层</span></span><br><span class="line">            ...</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isB) &#123;</span><br><span class="line">            currentFloor = transferFloor - <span class="number">1</span>; <span class="comment">// 更新当前楼层</span></span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">        TimableOutput.println(String.format(<span class="string">&quot;ARRIVE-%s-%d&quot;</span>, curFloorStr, id)); <span class="comment">// 输出到达信息</span></span><br><span class="line">        coordinator.releaseTransferFloor(); <span class="comment">// 离开换乘层，释放换乘层</span></span><br><span class="line">        lastTime = System.currentTimeMillis(); <span class="comment">// 更新时间</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>更新协作</strong>：在双轿厢更新过程中，协调两个轿厢的同步操作。确保两个轿厢都准备好后再开始更新，更新过程中保持至少 1 秒的等待时间，并输出更新开始和结束的信息。我没有选择<strong>由某个电梯线程输出</strong>或是<strong>创建协作器线程并由其新建电梯线程</strong>，而是选择<strong>沿用已有的电梯线程</strong>，并<strong>在协作器中添加了多个标志位</strong>来控制更新各阶段的开始和结束，使用 <code>wait()</code> 和 <code>notifyAll()</code> 方法实现线程间的同步。虽然这样可能使得协作器显得复杂，但避免了创建新的线程，也避免输出顺序混乱的问题。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Coordinator</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> elevatorAId;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> elevatorBId;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> readyA;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> readyB;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> readyWaitEnd; <span class="comment">// 用于是否已收到 update 通知</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> printBegin; <span class="comment">// 用于是否输出 UPDATE-BEGIN 消息</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> updateWaitEnd; <span class="comment">// 用于A和B电梯是否结束1s等待</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> printEnd; <span class="comment">// 用于是否输出 UPDATE-END 消息</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> startTime; <span class="comment">// 用于记录更新开始时间</span></span><br><span class="line">    <span class="comment">// ---------------- 更新协作功能 ----------------</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">updateMonitor</span><span class="params">(<span class="type">int</span> elevatorId)</span> &#123;</span><br><span class="line">        <span class="comment">// 标记己方进入更新状态</span></span><br><span class="line">        <span class="keyword">if</span> (elevatorId == elevatorAId) &#123; readyA = <span class="literal">true</span>; &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (elevatorId == elevatorBId) &#123; readyB = <span class="literal">true</span>; &#125;</span><br><span class="line">        <span class="comment">// 若对方未到位，则等待</span></span><br><span class="line">        <span class="keyword">while</span> (!(readyA &amp;&amp; readyB)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123; wait(); &#125;</span><br><span class="line">            <span class="keyword">catch</span> (InterruptedException e) &#123; ... &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!readyWaitEnd) &#123;</span><br><span class="line">            readyWaitEnd = <span class="literal">true</span>;</span><br><span class="line">            notifyAll();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 至此，双方均已进入更新状态</span></span><br><span class="line">        <span class="keyword">if</span> (!printBegin) &#123;</span><br><span class="line">            printBegin = <span class="literal">true</span>;</span><br><span class="line">            TimableOutput.println(String.format(<span class="string">&quot;UPDATE-BEGIN-%d-%d&quot;</span>, elevatorAId, elevatorBId));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 强制等待至少1s，确保双方均在等待中</span></span><br><span class="line">        <span class="keyword">if</span> (startTime &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            startTime = System.currentTimeMillis();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (System.currentTimeMillis() - startTime &lt; <span class="number">1000</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123; wait( ... ); &#125;</span><br><span class="line">            <span class="keyword">catch</span> (InterruptedException e) &#123; ... &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!updateWaitEnd) &#123;</span><br><span class="line">            updateWaitEnd = <span class="literal">true</span>;</span><br><span class="line">            notifyAll();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!printEnd) &#123;</span><br><span class="line">            printEnd = <span class="literal">true</span>;</span><br><span class="line">            TimableOutput.println(String.format(<span class="string">&quot;UPDATE-END-%d-%d&quot;</span>, elevatorAId, elevatorBId));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="电梯线程的更新处理">电梯线程的更新处理</h6>
<p>电梯线程在处理双轿厢更新请求时，执行以下操作：</p>
<ul>
<li>收到更新请求后，清空电梯内的所有乘客，并将无法处理的乘客请求返回主队列。</li>
<li>与协作器协作，完成双轿厢的更新设置，包括设置换乘楼层、轿厢类型（A 或 B）、速度等。</li>
<li>更新完成后，电梯移动到换乘楼层上/下的位置，设置为等待准备重新投入运行。</li>
</ul>
<h6 id="调度策略的改进">调度策略的改进</h6>
<p><strong>扩展影子电梯</strong>：增加了对双轿厢的支持，包含以下属性：</p>
<ul>
<li><code>isA</code> 和 <code>isB</code>：表示电梯是否为轿厢 A 或轿厢 B。</li>
<li><code>transferFloor</code>：换乘楼层。</li>
</ul>
<p>在估算电梯完成乘客请求所需时间时，根据电梯是否为轿厢 A 或 B 以及乘客的起点和终点楼层，判断乘客是否在轿厢 A 或 B 的服务范围内。如果乘客不在某轿厢的服务范围内，则该轿厢不会被选中。</p>
<h6 id="数据类">数据类</h6>
<ul>
<li><code>MainQueue</code> 类扩展了计数器，增加了对更新请求的计数，并提供相应的增加、减少和获取方法。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainQueue</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">passengerCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">scheRequestCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">updateCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">inputEnd</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">addUpdateCount</span><span class="params">()</span> &#123;</span><br><span class="line">        updateCount++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">subUpdateCount</span><span class="params">()</span> &#123;</span><br><span class="line">        updateCount--;</span><br><span class="line">        notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">isAllEnd</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> inputEnd &amp;&amp; passengerCount == <span class="number">0</span> &amp;&amp; scheRequestCount == <span class="number">0</span> &amp;&amp; updateCount == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>SubQueue</code> 类 增加了对双轿厢更新请求的处理方法，如设置更新请求、获取更新请求、检查是否有更新请求等。同时，提供了获取不符合轿厢服务范围的乘客请求的方法，用于将无法处理的乘客请求返回主队列。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubQueue</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">UpdateRequest</span> <span class="variable">updateRequest</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">setUpdateRequest</span><span class="params">(UpdateRequest updateRequest)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateRequest = updateRequest;</span><br><span class="line">        notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> UpdateRequest <span class="title function_">getUpdateRequest</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> updateRequest;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> Person <span class="title function_">getUnableRequest</span><span class="params">(<span class="type">boolean</span> isA, <span class="type">boolean</span> isB, <span class="type">int</span> transferFloor)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (persons.isEmpty()) &#123; <span class="keyword">return</span> <span class="literal">null</span>; &#125;</span><br><span class="line">        <span class="type">Person</span> <span class="variable">selected</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        Iterator&lt;Person&gt; iterator = persons.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> iterator.next();</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">condition1</span> <span class="operator">=</span> isA &amp;&amp; p.getFromInt() &lt; transferFloor;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">condition2</span> <span class="operator">=</span> isB &amp;&amp; p.getFromInt() &gt; transferFloor;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">condition3</span> <span class="operator">=</span> isA &amp;&amp; p.getFromInt() == transferFloor &amp;&amp; p.getToInt() &lt; transferFloor;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">condition4</span> <span class="operator">=</span> isB &amp;&amp; p.getFromInt() == transferFloor &amp;&amp; p.getToInt() &gt; transferFloor;</span><br><span class="line">            <span class="keyword">if</span> (condition1 || condition2 || condition3 || condition4) &#123;</span><br><span class="line">                selected = p;</span><br><span class="line">                iterator.remove();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> selected;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ShadowElevator</code> 类增加了对双轿厢的支持，包含 <code>isA</code>、<code>isB</code> 和 <code>transferFloor</code> 属性。在估算时间时根据轿厢的运行范围对乘客请求进行过滤。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShadowElevator</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isA</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isB</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">transferFloor</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(<span class="type">int</span> currentFloor, <span class="type">int</span> direction, <span class="type">int</span> personsIn,</span></span><br><span class="line"><span class="params">        ScheRequest scheduleReq, <span class="type">boolean</span> isA, <span class="type">boolean</span> isB, <span class="type">int</span> transferFloor)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.currentFloor = currentFloor;</span><br><span class="line">        <span class="built_in">this</span>.direction = direction;</span><br><span class="line">        <span class="built_in">this</span>.personsIn = personsIn;</span><br><span class="line">        <span class="built_in">this</span>.scheduleReq = scheduleReq;</span><br><span class="line">        <span class="built_in">this</span>.isA = isA;</span><br><span class="line">        <span class="built_in">this</span>.isB = isB;</span><br><span class="line">        <span class="built_in">this</span>.transferFloor = transferFloor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">getEstimatePerformance</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">pf</span> <span class="operator">=</span> person.getFromInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">pd</span> <span class="operator">=</span> person.getToInt();</span><br><span class="line">        <span class="type">double</span> <span class="variable">speed</span> <span class="operator">=</span> <span class="number">0.4</span>;</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">if</span> (isA || isB) &#123;</span><br><span class="line">            speed = <span class="number">0.2</span>;</span><br><span class="line">            <span class="keyword">if</span> (isA) &#123;</span><br><span class="line">                <span class="keyword">if</span> (pf &gt; transferFloor || (pf == transferFloor &amp;&amp; pd &gt; transferFloor)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> Integer.MAX_VALUE;</span><br><span class="line">                &#125;</span><br><span class="line">                ...</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isB) &#123;</span><br><span class="line">                <span class="keyword">if</span> (pf &lt; transferFloor || (pf == transferFloor &amp;&amp; pd &lt; transferFloor)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> Integer.MAX_VALUE;</span><br><span class="line">                &#125;</span><br><span class="line">                ...</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="线程类">线程类</h6>
<ul>
<li><code>InputThread</code> 类新增双轿厢更新请求。将更新请求直接发送给电梯线程，并设置相关电梯的协作器。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InputThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MainQueue mainQueue;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Integer, SubQueue&gt; subQueues;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Integer, Elevator&gt; elevators;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">InputThread</span><span class="params">(MainQueue mainQueue, HashMap&lt;Integer, SubQueue&gt; subQueues,</span></span><br><span class="line"><span class="params">        HashMap&lt;Integer, Elevator&gt; elevators)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.mainQueue = mainQueue;</span><br><span class="line">        <span class="built_in">this</span>.subQueues = subQueues;</span><br><span class="line">        <span class="built_in">this</span>.elevators = elevators;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ElevatorInput</span> <span class="variable">elevatorInput</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ElevatorInput</span>(System.in);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> elevatorInput.nextRequest();</span><br><span class="line">            <span class="keyword">if</span> (request == <span class="literal">null</span>) &#123;</span><br><span class="line">                mainQueue.setInputEnd();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request <span class="keyword">instanceof</span> PersonRequest) &#123;</span><br><span class="line">                ...</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request <span class="keyword">instanceof</span> ScheRequest) &#123;</span><br><span class="line">                ...</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request <span class="keyword">instanceof</span> UpdateRequest) &#123;</span><br><span class="line">                <span class="type">UpdateRequest</span> <span class="variable">updateRequest</span> <span class="operator">=</span> (UpdateRequest) request;</span><br><span class="line">                ...</span><br><span class="line">                <span class="type">Coordinator</span> <span class="variable">coordinator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Coordinator</span>(elevatorAId, elevatorBId);</span><br><span class="line">                elevatorA.setCoordinator(coordinator);</span><br><span class="line">                elevatorB.setCoordinator(coordinator);</span><br><span class="line">                subQueueA.setUpdateRequest(updateRequest);</span><br><span class="line">                subQueueB.setUpdateRequest(updateRequest);</span><br><span class="line">                mainQueue.addUpdateCount();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><code>Scheduler</code> 类无变化。</p>
</li>
<li>
<p><code>Elevator</code> 类新增在遇到双轿厢更新请求时，与协作器协作完成更新操作。</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Elevator</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> <span class="variable">speed</span> <span class="operator">=</span> <span class="number">0.4</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Coordinator</span> <span class="variable">coordinator</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isA</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isB</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">hasUpdated</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">transferFloor</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Elevator</span><span class="params">(<span class="type">int</span> id, MainQueue mainQueue, SubQueue subQueue)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">Advice</span> <span class="variable">advice</span> <span class="operator">=</span> newStrategy.getAdvice(currentFloor, direction,</span><br><span class="line">                personsIn, hasUpdated, transferFloor, isA, isB);</span><br><span class="line">            <span class="keyword">if</span> (direction == <span class="number">0</span>) &#123;</span><br><span class="line">                initialize();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">switch</span> (advice) &#123;</span><br><span class="line">                <span class="keyword">case</span> UPDATE:</span><br><span class="line">                    update();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                ...</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (hasUpdated) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">        <span class="keyword">if</span> (personsIn != <span class="number">0</span>) &#123; cleanOpenAndClose(<span class="number">400</span>); &#125;</span><br><span class="line">        <span class="type">UpdateRequest</span> <span class="variable">updateRequest</span> <span class="operator">=</span> subQueue.getUpdateRequest();</span><br><span class="line">        ...</span><br><span class="line">        coordinator.updateMonitor(id); <span class="comment">// 更新等待，由协作器完成</span></span><br><span class="line">        <span class="comment">// 设置更新后状态</span></span><br><span class="line">        <span class="comment">// 清除子队列无法处理的乘客请求</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">unablePerson</span> <span class="operator">=</span> subQueue.getUnableRequest(isA, isB, transferFloor);</span><br><span class="line">        <span class="keyword">while</span> (unablePerson != <span class="literal">null</span>) &#123;</span><br><span class="line">            mainQueue.addPersonRequest(unablePerson);</span><br><span class="line">            unablePerson = subQueue.getUnableRequest(isA, isB, transferFloor);</span><br><span class="line">        &#125;</span><br><span class="line">        subQueue.setUpdateRequest(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">if</span> (isA) &#123; mainQueue.subUpdateCount(); &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="三-调度器设计与调度策略">三、调度器设计与调度策略</h3>
<h4 id="调度器设计与线程交互">调度器设计与线程交互</h4>
<h5 id="hw5">hw5</h5>
<ul>
<li><strong>调度器设计</strong>：在 hw5 中，调度器的主要功能是将乘客请求从主队列分配到对应的电梯子队列。调度策略非常简单，直接根据乘客请求中指定的电梯序号进行分配。</li>
<li><strong>线程交互</strong>：<strong>通过主队列与输入线程交互</strong>，<strong>通过子队列与对应电梯线程交互</strong>。调度器从主队列中取出乘客请求，并根据乘客的电梯序号将其放入对应的电梯子队列。</li>
</ul>
<h5 id="hw6">hw6</h5>
<ul>
<li><strong>调度器设计</strong>：在 hw6 中，调度器的功能得到了扩展。调度器不再依赖乘客请求中指定的电梯序号，而是根据所有电梯的当前状态（通过影子电梯获取）计算所有电梯线程运送这名乘客花费的时间，从而找到理论时间最短的电梯。<strong>临时调度请求则越过调度器，直接发送给电梯线程，以减少调度延迟。</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ShadowElevator.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">getEstimatePerformance</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">pf</span> <span class="operator">=</span> person.getFromInt(); <span class="comment">// 乘客起始楼层</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">pd</span> <span class="operator">=</span> person.getToInt();   <span class="comment">// 乘客目的楼层</span></span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> <span class="variable">reversalDelay</span> <span class="operator">=</span> <span class="number">0.0</span>;</span><br><span class="line">    <span class="comment">// 判断是否需要反转：电梯正行驶且乘客楼层方向与当前方向相反</span></span><br><span class="line">    <span class="keyword">if</span> (direction != <span class="number">0</span> &amp;&amp; (pf - currentFloor) * direction &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 计算反转延迟</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> <span class="variable">loadPenalty</span> <span class="operator">=</span> <span class="number">0.0</span>;</span><br><span class="line">    <span class="comment">// 计算载客数延迟</span></span><br><span class="line">    <span class="type">double</span> travelTime;</span><br><span class="line">    <span class="keyword">if</span> (scheduleReq != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// 计算临时调度时间延迟+正常时间延迟</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 计算正常时间延迟</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> <span class="variable">totalTime</span> <span class="operator">=</span> travelTime + reversalDelay + loadPenalty;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">int</span>)(totalTime * <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>线程交互</strong>：基本无更多变化。输入线程直接发送临时调度请求给电梯线程，电梯线程会在运行过程中会更新影子电梯的状态，供调度器参考。</li>
</ul>
<h5 id="hw7">hw7</h5>
<ul>
<li><strong>调度器设计</strong>：在 hw7 中，调度器的设计进一步扩展以支持双轿厢电梯。调度器需要考虑<strong>双轿厢电梯的换乘楼层限制</strong>，并合理分配乘客请求。调度器继续使用影子电梯类来模拟电梯的当前状态，并在调度决策中考虑双轿厢的运行规则。调度器与协作器协作，确保双轿厢电梯的安全运行。</li>
<li><strong>线程交互</strong>：只考虑新增部分。输入线程直接发送临时调度请求和双轿厢更新请求给电梯线程。双轿厢电梯线程在遇到<strong>更新请求</strong>或是<strong>进出换乘楼层</strong>时通过协作器协作。</li>
</ul>
<h4 id="调度策略分析">调度策略分析</h4>
<h5 id="hw5-调度策略">hw5 调度策略</h5>
<p>在 hw5 中，由于乘客请求指定电梯序号，调度器只需将乘客请求转发至对应的电梯子队列，性能的提升的关键点在于<strong>电梯运行策略与乘客优先级的结合</strong>。我使用LOOK运行策略，在开关门时允许电梯优先处理优先级高的乘客请求，并进行优先级替换，再加上一点点量子电梯，在强测中拿到了96.66分。</p>
<blockquote>
<p>电梯在轿厢较空时，也可以携带反方向的乘客，省下一次开关门的时间。</p>
</blockquote>
<h5 id="hw6-调度策略">hw6 调度策略</h5>
<p>hw6 采用估算电梯最短送达时间，为每个乘客请求选择理论上完成时间最短的电梯，乘客若在电梯到达时无法进入电梯，则重新分配，再加上LOOK + ALS策略结合了乘客的请求优先级，能够有效减少乘客平均等待时间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">T_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，而代价是电梯的耗电量增加。在互测时查看评测机随机生成的测试数据，我的调度策略在高并发请求下，性能会优于传统的影子电梯以及随机分配等策略，强测96.79分。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// SubQueue.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> Person <span class="title function_">getPrimaryRequest</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (persons.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">selected</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">double</span> <span class="variable">maxScore</span> <span class="operator">=</span> Double.NEGATIVE_INFINITY;</span><br><span class="line">    <span class="type">long</span> <span class="variable">currentTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span> (Person p : persons) &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">waitingSeconds</span> <span class="operator">=</span> (currentTime - p.getTimeStamp()) / <span class="number">1000.0</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">compositeScore</span> <span class="operator">=</span> p.getPriority() * waitingSeconds;</span><br><span class="line">        <span class="keyword">if</span> (compositeScore &gt; maxScore) &#123;</span><br><span class="line">            maxScore = compositeScore;</span><br><span class="line">            selected = p;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> selected;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="hw7-调度策略">hw7 调度策略</h5>
<p>hw7 的调度策略在 hw6 的基础上增加了对双轿厢电梯的支持。调度器不仅要考虑单个电梯的运行效率，还需确保双轿厢电梯的协作安全与高效运行。通过影子电梯的状态，调度器可以识别双轿厢电梯的特殊运行规则，并合理分配乘客请求。对于双轿厢电梯跨区域乘客，增加等待时间延迟。但对于我的架构，乘客到达换乘楼层后，是有可能选择其他电梯乘坐的，因此时间计算是不够精准的。这带来了更多优化空间，但受限于时间和精力，我没有进一步优化。不过最后强测分数甚至还比上次高不少(都快赶上影子电梯了？)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">getEstimatePerformance</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="type">double</span> <span class="variable">transferDelay</span> <span class="operator">=</span> <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">if</span> (isA) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isB) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> <span class="variable">totalTime</span> <span class="operator">=</span> travelTime + reversalDelay + loadPenalty + transferDelay;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="四-bug分析与debug">四、Bug分析与debug</h3>
<p>本单元强测和互测均未出现 Bug (我们宿舍开发的评测机功不可没！)，但在写代码和本地跑评测机的过程中还是发现了一些问题。</p>
<ul>
<li><strong>ConcurrentModificationException in visit subQueue</strong>：hw5的这个bug与我的封装和层次化设计问题有关，<code>SubQueue</code>类中使用了<code>ArrayList</code>来存储乘客请求，<code>Elevator</code>类直接<code>get</code>出来遍历时，如果有其他线程对其进行修改，就会抛出迭代器遍历异常。解决方法是<strong>对于电梯线程中遍历的代码块加锁</strong>，但更应该是由<code>SubQueue</code>类用<code>sychronized</code>修饰的方法遍历子队列中的<code>ArrayList</code>，返回操作结果。所以我在随后的作业中都规避了这种做法。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (subQueue) &#123; <span class="comment">// 加锁</span></span><br><span class="line">    <span class="keyword">for</span> (Person person : subQueue.getPersons()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (person.getFromInt() == currentFloor &amp;&amp; person.getDirection() == direction) &#123;</span><br><span class="line">        ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>do not OVER after SCHE/UPDATE and sleep in wait</strong>：我在hw6和hw7中都出现了这个问题(屡教不改)，都是因为电梯运行时策略类返回 <strong>WAIT</strong> 建议和电梯线程执行 <strong>WAIT</strong> 操作不是一个<strong>原子操作</strong>，导致子队列会在电梯线程拿到<strong>WAIT建议</strong> 到进入 <strong>WAIT状态</strong> 的时间段之间改变状态并<code>notifyAll()</code>，电梯线程进入WAIT状态后<strong>一睡不醒</strong>了。解决办法只需要在<code>synchronized</code>块中加上对于subQueue状态的判断。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Elevator.java</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">waitRequest</span><span class="params">()</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">synchronized</span> (subQueue) &#123;</span><br><span class="line">        <span class="keyword">if</span> (subQueue.isEnd()) &#123; <span class="keyword">return</span>; &#125; <span class="comment">// 如果请求队列已结束，则不再等待</span></span><br><span class="line">        <span class="keyword">if</span> (!subQueue.isEmpty()) &#123; <span class="keyword">return</span>; &#125; <span class="comment">// 如果请求队列不为空，则不再等待</span></span><br><span class="line">        <span class="keyword">try</span> &#123; subQueue.wait(); &#125;</span><br><span class="line">        <span class="keyword">catch</span> (InterruptedException e) &#123; Thread.currentThread().interrupt(); &#125; <span class="comment">// 调用等待方法，使当前线程挂起</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>互测中发现的bug</strong>：第五次作业互测中用一条高并发和长时间运行的测试用例hack到一个TLE；第六次作业互测未发现bug；第七次作业互测中发现一位同学的SCHE/UPDATE请求完成超时，另一位同学电梯对于UPDATE请求与多个乘客请求同时到达时无法将乘客送达的问题，还有一位同学发生了电梯相撞的问题。
<blockquote>
<p>有个经典的围师必阙bug是让5部电梯临时调度，同时涌入很多乘客请求，导致唯一未被调度的电梯接受大量请求，导致TLE。在第六次作业中测设置了这样的样例，使得大家都用缓冲区或是正常分配的方式规避了这一问题。而我的架构中乘客是可以重新选择电梯的，因而不会TLE。</p>
</blockquote>
</li>
</ul>
<p>对于多线程debug，无法用IDE的调试模式，只能用print大法打印状态，抽丝剥缕找出问题。此外，多线程的随机性和不可预知性使得一些问题难以复现，调试起来非常麻烦。<strong>感谢室友评测机的本地重复测试功能</strong>（把自己的jar包复制10份放在评测机上并发运行，能快速复现bug、降低随机性）。</p>
<h3 id="五-心得体会">五、心得体会</h3>
<h4 id="线程安全与同步机制">线程安全与同步机制</h4>
<p>在多线程电梯系统的设计中，线程安全的核心在于 <strong>合理使用同步块与锁机制</strong>。我通过封装共享资源（如主队列、子队列），并对其访问方法添加<code>synchronized</code>关键字，确保 <strong>同一时刻仅有一个线程</strong> 操作共享数据，避免了数据竞争。代码逻辑操作保持原子性也十分重要。例如，在电梯线程等待子队列请求时，需在<code>synchronized</code>块内检查子队列状态，避免因状态判断与等待操作分离导致的“一睡不醒”问题。此外，结合<code>wait()/notifyAll()</code>实现线程间协作，确保了状态更新的正确性与及时性。总之，无脑加<code>synchronized</code>和<code>notifyAll</code>不可取，请在理解自己写的代码基础上使用同步互斥机制。</p>
<h4 id="层次化设计与模块化思维">层次化设计与模块化思维</h4>
<p>在架构设计上，系统<strong>高内聚低耦合</strong>是我们层次化与模块化设计的目标。<strong>生产者-消费者模型</strong> 的引入将输入线程、调度器、电梯线程解耦：输入线程仅负责生产请求，调度器专注于分配策略，电梯线程独立运行策略，三者通过主队列和子队列通信，职责清晰。<strong>影子电梯（ShadowElevator）模块</strong> 封装了电梯状态的模拟逻辑，供调度器独立计算最优分配，而<strong>协作器（Coordinator）模块</strong> 专注于双轿厢的同步与冲突避免。这种分层设计使得新增功能（如临时调度、双轿厢）只需扩展特定模块，无需全局重构。同时，<strong>策略模式（NewStrategy）</strong> 将电梯运行逻辑与调度逻辑分离，提升了代码复用性。良好的层次划分不仅能降低开发复杂度，还能显著增强系统的可维护性与扩展性。使得迭代过程中修改的代码量大幅减少，且更不容易出现bug。</p>
<blockquote>
<p>OO第二单元完结撒花！这次的总结博客似乎写的有点太长了（笑），上次参加吴际老师的office hour，说到引入多线程训练作为面向对象设计的一个单元，虽然多线程不属于面向对象的三大特征（继承、封装、多态），但多线程的引入使得面向对象设计从还是稍微 <strong>“面向过程”</strong> 的单线程转变为 <strong>“面向并发、面向系统”</strong> 的多线程（这句话是我自己编的），程序更加复杂，但同时也更加灵活，更加符合现代计算机系统的需求。</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
        <category>OO</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>OO</tag>
      </tags>
  </entry>
  <entry>
    <title>2025第三单元总结博客 [BUAA-OO]</title>
    <url>/2025/06/23/OO-Unit3/</url>
    <content><![CDATA[<h2 id="buaa-oo-2025-第三单元总结博客">[BUAA-OO] 2025 第三单元总结博客</h2>
<h3 id="一-单元测试过程">一、单元测试过程</h3>
<h4 id="1-1-单元测试">1.1 单元测试</h4>
<ul>
<li>单元测试是对软件中最小可测试单元（比如一个方法）进行验证的过程，通常应该在编写代码时进行，目的是确保每个单元都能按预期工作。</li>
<li>单元测试通常是自动化的，可以使用JUnit这类测试框架来编写和运行测试用例。本单元中，我们<strong>测试每个方法是否符合JML约束的过程</strong>就是单元测试。</li>
<li>优点：
<ul>
<li>提高代码质量：通过单元测试，<strong>在编写代码时就能发现和修复bug</strong>，减少后期维护成本。</li>
<li>提高开发效率：<strong>单元测试具有针对性</strong>，可以帮助我们更快地定位问题，提高开发效率。</li>
</ul>
</li>
<li>缺点：
<ul>
<li>需要额外的时间和精力来编写测试用例，无法测试各单元之间的交互。</li>
</ul>
</li>
</ul>
<h4 id="1-2-功能测试">1.2 功能测试</h4>
<ul>
<li>功能测试就是对于项目的功能进行验证，确保功能符合需求规格说明和用户要求。本单元中，我们<strong>对社交网络的各种指令和功能进行测试</strong>，确保它们符合预期，这就是功能测试。</li>
<li>功能测试对于迭代开发而言是非常重要的，通过对上次迭代的功能进行充分测试，可以避免在下次迭代时爆出上次的bug。</li>
<li>优点：
<ul>
<li>在迭代开发中，通过保证先前功能的正确性，<strong>有利于在一个稳定的架构上进行后续迭代</strong>。</li>
</ul>
</li>
<li>缺点：
<ul>
<li>功能测试难以保证测试的全面性，一些指令功能的协同合作可能会被忽略。</li>
</ul>
</li>
</ul>
<h4 id="1-3-集成测试">1.3 集成测试</h4>
<ul>
<li>集成测试是将多个单元组装成子系统进行测试，验证它们之间的交互是否符合预期。本单元中我们对于<strong>社交网络的各个类内部和类之间方法的调用</strong>进行集成测试，确保它们之间的交互符合预期。</li>
<li>集成测试的优点在于可以发现单元测试中无法发现的问题，比如多个单元之间的交互问题。</li>
<li>集成测试的缺点在于无法精准定位问题，可能需要进一步的单元测试来定位错误。</li>
</ul>
<h4 id="1-4-压力测试">1.4 压力测试</h4>
<ul>
<li>压力测试是对系统进行高负载测试，验证系统在高负载下的性能、可靠性和稳定性。本单元中我们对<strong>社交网络复杂度过高的方法多次调用，进行压力测试</strong>，确保它们在高负载下仍然能够正常工作。</li>
<li>压力测试的优点在于可以发现系统在高负载下的性能瓶颈，帮助我们优化系统性能。</li>
<li>压力测试的缺点在于针对极端样例的测试和后续优化可能会导致系统的复杂度增加，增加了后续维护的难度。</li>
</ul>
<h4 id="1-5-回归测试">1.5 回归测试</h4>
<ul>
<li>回归测试是对系统进行修改后，验证系统已经实现的功能是否仍然符合预期。本单元中我们对<strong>社交网络进行迭代开发后，需要重新运行之前的测试用例</strong>，确保它们仍然符合预期。</li>
<li>回归测试的优点在于可以发现系统在修改后可能出现的新问题，帮助我们保证系统的稳定性。</li>
</ul>
<h4 id="1-6-数据构造策略">1.6 数据构造策略</h4>
<ul>
<li>本单元我们实现了一个模拟社交网络，在测试时需要构造强度较高的测试数据。我主要使用了<strong>随机数生成器</strong>来生成测试数据，确保测试数据的多样性和复杂性。</li>
<li>单纯random的数据生成覆盖率极低，会导致绝大部分输出都是异常，无法起到任何测试作用。（除非你想测试异常处理bug）</li>
<li>我使用以下<strong>数据构造策略</strong>来提高数据生成强度。
<ol>
<li>对于随机测试来说，<strong>需要尽可能减少异常指令的出现概率</strong>，因此我采取了在数据生成器中维护<strong>数据池</strong>的方式，在随机时从数据池中随机选择。</li>
<li>为了保证生成的关系图的连通性，可以首先建立一个较为稠密的图甚至是完全图，然后在此基础上进行随机化以及其他操作，这样可以保证生成的图是连通的，并且具有一定的复杂度。对于tag、account和message的相关指令生成也是类似。</li>
<li>对于一些<strong>实现易出错、复杂度过高的方法</strong>，可以有针对性地进行压力测试；其他指令的分布也可在测试过程中有针对性地进行调整。</li>
</ol>
</li>
</ul>
<h3 id="二-大模型辅助下的复杂任务完成和引导分析">二、大模型辅助下的复杂任务完成和引导分析</h3>
<p>利用大模型来辅助规格化设计与代码实现，<strong>需要清晰地描述任务要求，并提供详细的功能流程，确保大模型能够准确生成预期代码。</strong> 具体有以下几个方面：</p>
<ol>
<li><strong>任务描述与明确需求</strong></li>
</ol>
<ul>
<li>对每个任务及其子功能进行详细说明，例如测试代码中的数据生成器，需要告知大模型<strong>需要维护的数据、采用的算法和需要输出的指令要求</strong>。直接粘贴JML给大模型可能会导致其无法理解或产生歧义。</li>
</ul>
<ol start="2">
<li><strong>分解任务与流程设计</strong></li>
</ol>
<ul>
<li>将复杂任务拆分为若干可执行的子模块，如对于数据生成，给出不同函数的具体功能和输出要求。</li>
<li>为每个子模块设计明确的流程或示例框架，可以使用伪代码来展示模块的代码逻辑。</li>
</ul>
<ol start="3">
<li><strong>引导大模型生成一致性代码</strong></li>
</ol>
<ul>
<li>在提示中给出准确的指令要求和示例，确保大模型能理解任务的核心要求。</li>
<li>比如对于询问关注者存储公众号文章的数据结构，给出如下要求：<strong>有没有数据结构能够根据时间戳进行顺序存储，并且查询与增删的时间复杂度都是O(1)？</strong>，大模型便提供了<code>HashMap&lt;id, LinkedNode&gt;</code>的建议。</li>
</ul>
<ol start="4">
<li><strong>交互反馈与代码优化</strong></li>
</ol>
<ul>
<li>在大模型生成代码后，人工审核并反馈调整提示，确保生成的代码逻辑清晰且符合设计需求，达到预期效果。</li>
<li>在第11次作业中，由于person中存储的文章id可以重复，导致了<code>HashMap&lt;id, LinkedNode&gt;</code>的实现无法满足要求。我选择在提示中说明：现在由于在<code>receiveMessage()</code>需要将文章加入receivedArticle中，所以其中的文章id可以重复，但在删除时需要保证将所有的相同id的文章都删除。同时还提供了具体案例，大模型便给出了<code>HashMap&lt;id, LinkedList&lt;LinkedNode&gt;&gt;</code>的实现。再要求大模型使用Hasset来存储<code>LinkedNode</code>，以保证删除时的时间复杂度为O(1)，最终得到了<code>HashMap&lt;id, HashSet&lt;LinkedNode&gt;&gt;</code>的数据结构。</li>
</ul>
<p>通过清晰的任务描述、模块化的流程设计和交互反馈机制，可以有效引导大模型在不同场景下完成复杂任务，实现既有逻辑正确又具有较高扩展性的代码实现。</p>
<h3 id="三-架构分析">三、架构分析</h3>
<h4 id="项目架构设计"><strong>项目架构设计</strong></h4>
<h5 id="network">Network</h5>
<p>实现了 <code>NetworkInterface</code> 接口，提供了添加用户、添加关系、修改关系、查询关系、发送消息、管理标签、管理公众号、管理文章等一系列操作。<code>Network</code>类是整个社交网络的核心，负责管理其他类和它们之间的交互。存储了所有的 <code>Person</code> 对象、<code>OfficialAccount</code> 对象、待发送的 <code>Message</code> 对象、全局的<code>articles</code>文章ID集合、<code>articleContributors</code>文章贡献者映射和<code>emojiMap</code>Emoji表情及其热度。</p>
<ul>
<li><strong>图模型管理</strong>: 内部持有一个<code>Graph</code>对象，用于表示用户之间的连接关系，主要用于判断用户是否连通（<code>isCircle</code>）以及</li>
<li><strong>标签管理</strong>: 内部持有一个<code>TagStorage</code>对象，用于辅助管理用户与标签之间的复杂关系，特别是涉及到标签内用户间关系值总和的计算。</li>
<li><strong>缓存机制</strong>:1. <code>shortestPathCache</code>: 缓存用户间的最短路径结果，通过 <code>shortestPathCacheDirty</code> 标记来判断是否需要更新。2. <code>tripleSum</code>: 缓存网络中的三元组数量。</li>
</ul>
<h5 id="person">Person</h5>
<p>实现了 <code>PersonInterface</code> 接口，代表社交网络中的用户。每个用户有ID、姓名、年龄等基本信息，同时维护着自己的<code>acquaintance</code>好友关系、好友间的情感值<code>value</code>、拥有的标签<code>tags</code>、金钱<code>money</code>、社交活跃度<code>socialValue</code>、收到的消息<code>messages</code>以及收到的文章<code>articleNodeMap</code>。</p>
<ul>
<li><code>Person</code> 维护了<code>PriorityQueue</code>优先队列的内部类来快速查询最佳好友。</li>
<li><code>Person</code> 内部使用自定义的双向链表<code>ListNode</code>和 <code>HashMap</code> 来<strong>提供多种访问方式</strong>（头结点、尾结点或是哈希表），从而高效管理收到的文章列表，支持 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 时间复杂度的查询、添加和删除操作。</li>
</ul>
<h5 id="tag">Tag</h5>
<p>实现了 <code>TagInterface</code> 接口，表示用户可以拥有的标签。每个标签有ID，并记录了拥有该标签的用户列表 <code>persons</code>，缓存了标签内用户的年龄总和<code>ageSumCache</code>、年龄平方和<code>ageVarSumCache</code>以及标签内用户间关系的总和<code>valueSumCache</code>，用于快速计算平均年龄、年龄方差和TagValueSum。</p>
<h5 id="message">Message</h5>
<p>作为消息的基类，定义了消息的基本属性，如ID、社交价值、类型、发送者和接收者（可以是个人或标签）。</p>
<ul>
<li><code>EmojiMessage</code>: 继承自 <code>Message</code>，表示表情消息，包含表情ID (<code>emojiId</code>)。</li>
<li><code>ForwardMessage</code>: 继承自 <code>Message</code>，表示转发消息（文章），包含文章ID (<code>articleId</code>)。</li>
<li><code>RedEnvelopeMessage</code>: 继承自 <code>Message</code>，表示红包消息，包含红包金额 (<code>money</code>)。</li>
</ul>
<h5 id="officialaccount">OfficialAccount</h5>
<p>代表公众号。有所有者ID、公众号ID、名称，并管理关注者列表 (<code>followers</code>)、发布的文章列表 (<code>articles</code>) 以及每个关注者的贡献度 (<code>contributions</code>)。</p>
<ul>
<li>使用 <code>PriorityQueue</code> 优先队列来找到最佳贡献者。</li>
</ul>
<h5 id="辅助类"><strong>辅助类</strong></h5>
<p><code>Graph</code>: 使用<strong>并查集 (Disjoint Set Union, DSU)</strong> 数据结构来表示用户之间的连通性。</p>
<ul>
<li><code>parent</code>: 存储每个节点的父节点。</li>
<li><code>rank</code>: 用于按秩合并优化，减少树的高度。</li>
<li><code>adjacentMap</code>: 存储部分人的直接邻接关系，用于在删除关系后重建并查集。</li>
<li><code>dirty</code>: 标记，当发生关系删除操作时，此标记设为 <code>true</code>，表示需要在下次查询调用<code>isCircle</code>前通过 <code>remake()</code> 方法重建。</li>
</ul>
<p><code>TagStorage</code>: 主要用于优化 <code>queryTagValueSum</code> 这类涉及到标签内成员之间关系值的计算。</p>
<ul>
<li><code>personInTag</code>: 存储一个映射，key是用户ID<code>personId1</code>，value是一个 <code>HashSet</code>，包含了所有 <code>personId1</code> 作为成员存在于其中的 <code>Tag</code> 对象。当两个用户<code>personId1</code>、<code>personId2</code>之间的关系值发生变化时，可以通过这个结构快速找到所有同时包含这两个用户的标签，并更新这些标签的 <code>valueSumCache</code>。</li>
</ul>
<h4 id="图模型构建和维护策略"><strong>图模型构建和维护策略</strong></h4>
<p><strong>关于用户关系图:</strong></p>
<ul>
<li><strong>构建</strong>:
<ul>
<li>当通过 <code>Network.addPerson()</code> 添加用户时，用户节点被加入到网络中，并在 <code>Graph</code> 中通过 <code>graph.addPerson()</code> 初始化，添加到并查集。</li>
<li>当通过 <code>Network.addRelation()</code> 添加用户关系时：
<ul>
<li>在 <code>Person</code> 中，互相将对方添加到自己的 <code>acquaintance</code> 列表并记录 <code>value</code>。</li>
<li>在 <code>Graph</code> 中使用并查集，通过 <code>graph.addRelation()</code> 将这两个用户所在的集合合并，通过路径压缩和按秩合并进行优化，<code>adjacentMap</code> 记录这条边便于后续重建。</li>
</ul>
</li>
</ul>
</li>
<li><strong>维护</strong>:
<ul>
<li><strong>添加关系</strong>: 更新 <code>Person</code> 对象的邻接列表和 <code>Graph</code> 对象的并查集及 <code>adjacentMap</code>。</li>
<li><strong>修改关系 <code>Network.modifyRelation()</code>:</strong>
<ul>
<li>如果修改后的 <code>value</code> 大于0，则只更新 <code>Person</code> 对象中存储的 <code>value</code>。</li>
<li>如果修改后的 <code>value</code> 小于等于0，则相当于删除关系：从 <code>Person</code> 对象的 <code>acquaintance</code> 和 <code>value</code> 中移除，调用 <code>graph.deleteRelation()</code>从 <code>adjacentMap</code> 中移除这条边，并将 <code>dirty</code> 标记设为 <code>true</code>，<code>shortestPathCacheDirty</code> 也会被设为 <code>true</code>。</li>
</ul>
</li>
<li><strong>查询连通性 (<code>Network.isCircle()</code>):</strong>
<ul>
<li>首先检查 <code>Graph</code> 对象的 <code>dirty</code> 标记。</li>
<li>如果 <code>dirty</code> 为 <code>true</code>，则调用 <code>graph.remake()</code> 方法。<code>remake()</code> 方法会清空当前的并查集结构，然后遍历 <code>adjacentMap</code> 中仍然存在的边，重新执行 <code>addRelation</code> 操作来重建并查集。</li>
<li>使用并查集的 <code>findRoot()</code> 操作判断两个用户是否在同一个连通分量中。</li>
</ul>
</li>
<li><strong>查询最短路径 <code>queryShortestPath()</code>:</strong>
<ul>
<li>首先通过 <code>graph.isCircle()</code> 判断两人是否连通，如果不连通则抛出异常。</li>
<li>如果连通，则执行 <code>bfsShortestPath()</code>。</li>
<li><code>bfsShortestPath()</code> 使用广度优先搜索 (BFS) 来计算最短路径，时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>V</mi><mo>+</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(V + E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 是节点数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> 是边数。</li>
<li>我设计了一个简单的缓存机制。如果 <code>shortestPathCacheDirty</code> 为 <code>false</code> 且缓存中存在结果，则直接返回。否则，执行 BFS，并将结果存入缓存，同时将 <code>shortestPathCacheDirty</code> 设为 <code>false</code>。当添加/删除关系导致图结构变化时，<code>shortestPathCacheDirty</code> 会被设为 <code>true</code>，使得下次查询时重新计算。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>标签-用户图:</strong></p>
<ul>
<li><strong>构建</strong>:
<ul>
<li>当用户创建标签 <code>Network.addTag()</code> 时，标签与创建者关联。</li>
<li>当用户被添加到某个标签中 <code>Network.addPersonToTag()</code> 时：
<ul>
<li>在 <code>Tag</code> 的 <code>persons</code> 列表中添加该用户，更新其内部缓存的 <code>ageSumCache</code>、<code>ageVarSumCache</code> 和 <code>valueSumCache</code>。<code>valueSumCache</code> 的更新会遍历新加入用户的好友，看其好友是否也在该标签内，并累加对应的关系值。</li>
<li><code>TagStorage.linkPersonToTag()</code> 会记录 <code>personId1</code> 现在属于这个标签<code>Tag</code> (通过 <code>personId2</code> 的 <code>tagId</code> 找到的标签对象)。</li>
</ul>
</li>
</ul>
</li>
<li><strong>维护</strong>:
<ul>
<li><strong>从标签中删除用户 <code>Network.delPersonFromTag()</code>:</strong>
<ul>
<li>从 <code>Tag</code> 对象的 <code>persons</code> 列表中移除用户，相应地更新 <code>Tag</code> 的 <code>ageSumCache</code>、<code>ageVarSumCache</code> 和 <code>valueSumCache</code>，其中 <code>valueSumCache</code> 的更新逻辑与添加时相反。</li>
<li><code>TagStorage</code> 中的记录无需删除，因为此时 <code>Tag</code> 内的 <code>persons</code> 列表已经不包含 <code>Person1</code>，所以无法访问，在更新valueSum时会被忽略。<strong>但下次再将该用户添加到标签时，<code>TagStorage</code> 需要检查 <code>personInTag</code> 中的记录，避免重复添加！</strong>(hw10 因为这个出bug了)</li>
</ul>
</li>
<li><strong>删除标签 <code>Network.delTag()</code>:</strong>
<ul>
<li>从用户的 <code>tags</code> 列表中移除该标签。<code>TagStorage</code> 的相应记录也不会再被访问到，因此无需删除。(不过这让Java无法自动回收内存，属于是偷懒之举)</li>
</ul>
</li>
<li><strong>关系值变化的影响 <code>Network.addRelation()</code> 、 <code>Network.modifyRelation()</code>:</strong></li>
<li>当两个用户之间的关系建立或关系值发生变化时，会调用 <code>tagStorage.modifyTagValueSum()</code>。</li>
<li><code>TagStorage</code> 会查找所有同时包含这两个用户的标签（通过 <code>personInTag</code> 查找第一个用户所在的标签集合， <code>tag.modifyValueSum</code> 内部会做判断然后判断这些标签是否也包含第二个用户），并调用这些 <code>Tag</code> 对象的 <code>modifyValueSum()</code> 方法来更新它们的 <code>valueSumCache</code>。</li>
</ul>
</li>
</ul>
<h4 id="图构建和维护策略分析"><strong>图构建和维护策略分析</strong>:</h4>
<ul>
<li><strong>惰性重建并查集</strong>: <code>Graph</code> 类中的 <code>dirty</code> 标记和 <code>remake()</code> 方法是一种惰性更新策略。只有在需要查询连通性且图结构发生过删除操作时，才会重建并查集，从而避免了每次删除关系都完全重建的高昂代价。</li>
<li><strong>缓存利用</strong>:
<ul>
<li><code>shortestPathCache</code> 用于缓存最短路径查询结果，减少重复计算。</li>
<li><code>Tag</code>内部的 <code>ageSumCache</code>, <code>ageVarSumCache</code>, <code>valueSumCache</code> 都是为了 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 查询相关统计值而设计的缓存，在成员变动或相关关系变动时进行增量更新。</li>
<li><code>Person</code> 内部的 <code>articleCache</code> 和 <code>dirtyCache</code> 用于缓存最近的文章列表，使得调用<code>queryReceivedArticle</code> 时可以快速返回结果。</li>
</ul>
</li>
<li><strong>数据一致性</strong>:
<ul>
<li>在添加/删除关系时，同时更新了 <code>Person</code> 内部的好友列表和 <code>Graph</code> 的并查集。</li>
<li>在修改关系值时，如果关系被删除，则会触发并查集的 <code>dirty</code> 状态。</li>
<li><code>TagStorage</code> 辅助类的引入是为了存储所有的<code>Tag</code>对象，从而在关系值变化时有效地更新所有相关 <code>Tag</code> 的 <code>valueSumCache</code>，维护数据一致性。</li>
</ul>
</li>
<li><strong>潜在优化点</strong>:
<ul>
<li><strong><code>Graph.remake()</code> 的开销</strong>: 如果删除操作非常频繁，且之后紧跟着大量的 <code>isCircle</code> 查询，<code>remake()</code> 的开销可能会比较大。不过 <strong>考虑到通常查询比修改更频繁，采取了缓存策略</strong> 。</li>
<li><strong><code>TagStorage</code> 的维护</strong>: 如前所述，<code>delPersonFromTag</code> / <code>delTag</code> 后 <code>TagStorage</code> 中的 <code>personInTag</code> 的记录没有清理。如果一个用户从很多标签中被移除或者很多标签被移除，<code>personInTag</code> 中可能会有很多不再需要的 <code>Tag</code> 对象，这在 <code>modifyTagValueSum</code> 遍历时可能会带来轻微的性能损耗（虽然正确性不受影响）。</li>
</ul>
</li>
</ul>
<h3 id="四-性能问题和规格与实现分离">四、性能问题和规格与实现分离</h3>
<h4 id="作业中出现的性能问题及其修复情况">作业中出现的性能问题及其修复情况</h4>
<p>本单元中我并未出现性能问题，主要是因为我在设计时就考虑到了性能问题（在写任何双重循环前都极为慎重，思考复杂度有没有到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>），并且在实现时也进行了充分的考虑和处理，保证整体的时间复杂度在合理范围内。在hw10中出现了上述的bug，主要是因为我在设计时没有考虑到<code>TagStorage</code>中<code>personInTag</code>的记录会导致重复添加的问题，导致在强测和互测中出现问题，只需要在 <code>addPersonToTag</code> 方法中添加一个判断即可。</p>
<h4 id="规格与实现分离的理解">规格与实现分离的理解</h4>
<p>规格与实现分离是软件开发中的一个重要原则，旨在将系统的功能需求（规格）与其具体实现（代码）分开。这样做的好处包括：</p>
<ul>
<li><strong>更清晰的系统设计:</strong> 降低了系统不同子模块之间的耦合，通过规格定义接口和约束条件，使得开发者专注于思考组件的职责和交互方式，而不是实现细节。</li>
<li><strong>更高的灵活性和可维护性:</strong> 实现的改变不影响接口的调用者，从而在不影响其他模块的情况下，独立地修改或替换实现而不用担心引起其他模块的错误。</li>
<li><strong>更好的团队协作:</strong> 接口作为不同模块或开发者之间的契约，使得不同开发者可以并行开发，减少了沟通成本。</li>
<li><strong>增强的可测试性:</strong> 可以针对接口规格进行测试，而不需要依赖具体的实现细节或是受其影响。这样可以更容易地编写单元测试和集成测试，确保系统的正确性。</li>
</ul>
<h3 id="五-junit实现">五、Junit实现</h3>
<p>Junit 绝对是本单元中我体验最差但也收获最多的一个部分，要说它对于我完成作业或者debug的帮助，那可以说是zero，但让我对于手动构造测试样例以及随机数据生成这样的自动化测试手段有了更深刻的理解。此外，本单元中测的Junit黑箱测试点让我必须考虑到数据覆盖性和JML的每个约束条件。</p>
<h4 id="利用规格信息设计-junit-测试">利用规格信息设计 JUnit 测试</h4>
<p>JML 规格为设计 JUnit 测试提供了极其宝贵的信息来源。一个完备的 JML 规格几乎可以看作是测试代码的 <strong>“设计图纸”</strong>。测试的过程中需要细致考虑到 JML 中涉及的所有情况以及规格信息。例如 <code>pure</code>，<code>assignable</code>，<code>ensures</code>等等。</p>
<h4 id="junit-测试检验代码实现与规格的一致性的效果">JUnit 测试检验代码实现与规格的一致性的效果</h4>
<p>测试代码与规格的匹配程度直接影响了测试的有效性。好的测试方法应该能够覆盖到 JML 中的所有约束条件，并且遵照 JML 中的约束条件进行设计，这能够实现<strong>代码实现和测试的分离</strong>，在实现过程中由于性能等限制，具体实现不一定完全按照 JML 的流程来实现，但测试代码可以完全按照 JML 的约束条件实现，避免了实现和测试之间的耦合以及开发者思维惯性导致的错误。<br>
本单元中，我的 Junit 测试主要问题出在规格理解不够细致，忽略了一些<code>pure</code>的约束，又或者是浅拷贝的问题没有注意，至于数据覆盖本身，由于采取了随机生成的方式，还是比较全面的。</p>
<h3 id="六-学习体会">六、学习体会</h3>
<p>JML 单元的重点似乎只是在性能优化和Junit测试上，我在实现上几乎把所有能够优化的地方都优化了，从而没有出现性能问题，但又导致实现过于复杂，花费了很多时间，还出现了一处bug。Junit测试根本无法做本地测试，交上去全靠听天由命，甚至有可能因为<code>PersonInterface</code>写成<code>Person</code>导致过不了编译，测试点也都是不公开的，我其实很想看看<strong>比较明显的bug</strong>究竟是什么样（）</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>OO</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>OO</tag>
      </tags>
  </entry>
  <entry>
    <title>2025第四单元总结博客 [BUAA-OO]</title>
    <url>/2025/06/23/OO-Unit4/</url>
    <content><![CDATA[<h2 id="buaa-oo-2025-第四单元总结博客">[BUAA-OO] 2025 第四单元总结博客</h2>
<h3 id="一-本单元正向建模与开发实践">一、本单元正向建模与开发实践</h3>
<p>hw13的架构设计是本单元正向建模最重要的环节，通过阅读题目要求和参考往届博客，从图书馆相关业务场景中提炼出系统抽象，初步设计出 UML 模型，并在后续迭代开发中根据新增需求不断完善和细化。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202506231552342.png" alt="CLASS"></p>
<ul>
<li><strong>厘清模块职责</strong>：举个例子，图书馆系统中的书籍管理广泛存在于书架、借阅处、预约处、用户、和阅览室，而书籍也包括了序列号和副本号这样的多级索引结构，使用简单的数据结构存储效率并不高。而书籍的管理过程可以抽象成增删查这几种类型，因此可以提取出储存<code>Book</code>的<code>Books</code>类，从原始的<code>Bookshelf</code>等模块中解耦。<code>Books</code>类对内使用多级HashMap提高效率，对外提供了增删查等方法的接口，增强了代码的复用性和职责清晰性。其他类的设计也是类似的思路，比如<code>ReservationInfo</code>类，就是将和预约相关的状态和方法封装成一个类，再由<code>User</code>类和<code>AppointmentOffice</code>类同时持有引用。</li>
<li><strong>UML模型构建</strong>：在有了初步的模块划分后，使用UML类图、状态图和顺序图等工具，将系统抽象为可视化的模型（当然我觉得简单画画草图就好，知道一个类大概有哪些属性，管理哪些对象，怎样交互，不用精确到有什么方法），明确各模块之间的关系和交互流程。</li>
<li><strong>具体代码实现</strong>：将抽象的模型转化为具体代码，在实现过程中，还是要注意模块之间的职责分离和实现的高效性，保持架构设计的清晰度和可维护性。</li>
</ul>
<h3 id="二-架构设计及uml与代码设计之间的追踪关系">二、架构设计及UML与代码设计之间的追踪关系</h3>
<h4 id="架构设计">架构设计</h4>
<p>关于本单元的架构设计，顺序图能够清晰地展示各模块之间的交互流程，展示如下:<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202506231552621.png" alt="order"></p>
<p>在本单元中，架构设计与代码实现应该致力于实现 <strong>“设计先行、实现随进”</strong> 的思路。由于图评测的存在，我们的UML图不仅作为设计蓝图，还需要与代码实现保持一致，确保设计理念在代码中得到贯彻。</p>
<h4 id="追踪关系分析">追踪关系分析</h4>
<ul>
<li><strong>UML设计</strong>：应该在关注代码实现之前首先明确各模块的职责、交互流程；</li>
<li><strong>代码实现</strong>：基于模块划分，将模型转化为具体代码实现，确保每个模块的功能与UML设计一致；</li>
<li><strong>迭代分析</strong>：在每次迭代过程中，通过对比已有UML模型与新增需求，考虑现有架构是否能够较好实现需求，如果新增代码会导致模块职责混乱、耦合过高等问题，则选择重构或新增模块。</li>
</ul>
<h3 id="三-大模型辅助正向建模的体验与引导策略">三、大模型辅助正向建模的体验与引导策略</h3>
<h4 id="大模型的三重角色">大模型的三重角色</h4>
<ul>
<li><strong>翻译桥梁</strong>：将抽象的设计理念转为具体代码框架，在建模阶段启发开发者的设计思路，提供合理的模块划分建议。</li>
<li><strong>代码顾问</strong>：在面对复杂代码或数据结构的需求时，大模型能够提供优化建议，提升性能和设计清晰度。</li>
<li><strong>测试工程师</strong>：辅助完成测试代码，构造测试数据和思路，帮助搭建评测机，验证系统的健壮性和正确性。</li>
</ul>
<h4 id="引导技巧">引导技巧</h4>
<ul>
<li><strong>任务描述清晰</strong>：可以参考本单元在实验中提到的<strong>ROSES</strong>方法，设定大模型的角色，再提供任务描述、任务情境、期望结果、具体步骤等提示，来引导大模型们从业务场景中提取出初步架构设计；</li>
<li><strong>反馈与迭代</strong>：大模型生成的架构大多数情况下并不符合我们的需求，需要不断<s>调教</s>引导，通过不断完善提示语和明确需求来迭代优化大模型的输出。</li>
</ul>
<h3 id="四-架构设计思维的演进">四、架构设计思维的演进</h3>
<ul>
<li>
<p><strong>第一单元</strong><br>
从OOpre到解析表达式，我们开始更关注功能分解和模块职责划分，尤其是递归下降的思想要求我们将表达式分解成项、因子等对象，展示出面向对象的设计思维。</p>
</li>
<li>
<p><strong>第二单元</strong><br>
我们通过多线程电梯这样的场景设计开发，开始注重模块间交互、多线程并发以及整体协同，设计中引入生产者-消费者模型，并在代码实现中学习掌握锁、线程同步等并发编程技巧。</p>
</li>
<li>
<p><strong>第三单元</strong><br>
通过JML，我们开始思考如何在代码开发前就完成规格化设计，这对于大规模写作和工程开发很有帮助。虽然JML仍然是一种精确到代码的规格化，但它促使我们在项目开发初期就考虑系统的整体架构和设计，而不是直接依照JML来编写每个方法的实现。</p>
</li>
<li>
<p><strong>第四单元</strong><br>
在UML建模中，我们强调了架构设计对于工程开发的重要性，要求我们自由实现模块职责分离和系统整体协同。本单元的图评测还要求我们能够清晰地展示系统的结构和类之间的交互流程，确保设计与实现的一致性。</p>
</li>
</ul>
<h3 id="五-测试思维的演进">五、测试思维的演进</h3>
<ul>
<li>
<p><strong>从单元测试到集成测试</strong><br>
OOpre中编写的Junit测试主要聚焦于 <s>代码覆盖率</s> <strong>单个功能或方法的正确性</strong>；而在OO正课的第一单元，我们需要实现表达式化简这一比较复杂的功能，因而转向了数据生成器+借助sympy库/对拍实现的简易评测机，此时的测试仍然是随机生成数据，全靠长时间和高复杂度的测试数据来验证代码的正确性。</p>
</li>
<li>
<p><strong>并发测试与压力测试</strong><br>
在第二单元的电梯调度中，项目复杂性进一步上升，而且bug触发成功率也存在随机性，我开始尝试多线程并发的测试（那几周真是苦了我的电脑），并使用压力测试来验证系统在高负载下的稳定性和性能。通过模拟大量电梯请求，观察电梯的响应和处理能力。</p>
</li>
<li>
<p><strong>自动化Junit测试与JML规格化</strong><br>
在第三单元中，我们开始使用JML进行规格化设计，并通过Junit测试来验证代码是否符合规格约束。我采用了手动构造极端数据（比如空图、完全图等）+自动化生成随机数据的方式来应对中测的Junit评测，我也在此过程中感受到了JML规格化对于测试的指导作用，只需要完全按照前置条件、后置条件、副作用限定来检测代码的正确性，就能较好完成单元测试的要求。</p>
</li>
<li>
<p><strong>数据池维护与动态生成数据</strong><br>
经过第三单元纯随机数据无效的经历，我最终在checker中依据输入手动维护数据池，我在第四单元中也遵循了这一方法。并且我尝试根据题目要求动态生成测试数据，确保生成的数据多样性和覆盖率。</p>
</li>
</ul>
<p>OO课程让我真正开始尝试搭建评测机，也让我认识到测试思维对于验证程序功能与反馈指导系统优化的重要性。</p>
<h3 id="六-课程整体收获与反思">六、课程整体收获与反思</h3>
<ul>
<li><strong>大模型辅助开发的应用</strong><br>
我体验到了大模型在架构设计、代码实现和测试构造中的多角色价值，使整个开发流程更为高效和灵活。</li>
<li><strong>架构设计与实现的精进</strong><br>
在OO课程的学习中，我学会了如何将设计理念转化为可执行的系统架构，并在迭代中不断优化和完善。</li>
<li><strong>测试思维的提升</strong><br>
在中测-强测-互测的环节中，我学会了设计更加全面的测试策略，从随机测试到压力测试，再到注重数据质量和覆盖率测试，逐步提升了测试思维和实践能力。</li>
</ul>
<hr>
<p>OO课程用OOpre的Java与面向对象思维的先导以及OO正课的一学期理论课+16次作业，带领我们完成了面向对象设计与构造的入门引导，但这甚至不是结束的开始，而是开始的结束，让我们继续面向对象！</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>OO</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>OO</tag>
      </tags>
  </entry>
  <entry>
    <title>OS-Linux 学习备忘[BUAA-OS]</title>
    <url>/2025/02/22/OS-LinuxLearning/</url>
    <content><![CDATA[<h2 id="linux-假期预习备忘">Linux 假期预习备忘</h2>
<h3 id="hello-linux">Hello, Linux!</h3>
<ul>
<li><strong>什么是 Linux？</strong>
<ul>
<li>Linux 是基于 Linux 内核的开源操作系统，由 Linus Torvalds 于 1991 年首次发布。</li>
<li>Linux 发行版包括 Ubuntu、Debian 等，本教程使用 Ubuntu 22.04.1 LTS。</li>
</ul>
</li>
</ul>
<h3 id="初识-cli-shell">初识 CLI Shell</h3>
<ul>
<li><strong>CLI Shell 概念</strong>
<ul>
<li>CLI（Command Line Interface）：命令行界面，通过命令行与操作系统交互。</li>
<li>Shell 是操作系统的外壳，用于访问操作系统服务，分为 CLI Shell 和 GUI Shell。</li>
</ul>
</li>
<li><strong>为什么使用 CLI Shell？</strong>
<ul>
<li>节约资源：在资源有限的设备上，运行 GUI Shell 会增加系统负担。</li>
<li>高效自动化操作：CLI Shell 可以通过脚本实现复杂操作。</li>
<li>精准操作：命令行操作可以精确控制，便于复现和传播。</li>
</ul>
</li>
</ul>
<h3 id="linux-基础操作">Linux 基础操作</h3>
<ul>
<li><strong>命令格式</strong>
<ul>
<li>命令名 [选项] [参数] …</li>
</ul>
</li>
<li><strong>目录操作</strong>
<ul>
<li><code>cd</code>：切换目录。</li>
<li><code>ls</code>：列出目录内容。</li>
<li><code>mkdir</code>：创建新目录。</li>
<li><code>rmdir</code>：删除空目录。</li>
<li><code>pwd</code>：显示当前目录的绝对路径。</li>
</ul>
</li>
<li><strong>文件操作</strong>
<ul>
<li><code>touch</code>：创建新文件或更新文件时间戳。</li>
<li><code>rm</code>：删除文件或目录。</li>
<li><code>cp</code>：复制文件或目录。</li>
<li><code>mv</code>：移动或重命名文件或目录。</li>
<li><code>diff</code>：比较两个文件的差异。</li>
</ul>
</li>
<li><strong>查找操作</strong>
<ul>
<li><code>find</code>：查找文件。</li>
<li><code>grep</code>：搜索文件内容。</li>
<li><code>tree</code>：显示目录树结构。</li>
</ul>
</li>
</ul>
<h3 id="开源文本编辑器-vim">开源文本编辑器——Vim</h3>
<ul>
<li><strong>Vim 基本操作</strong>
<ul>
<li>创建文件：<code>touch helloworld.c</code></li>
<li>打开文件：<code>vim helloworld.c</code></li>
<li>进入插入模式：按 <code>I</code> 键。</li>
<li>保存并退出：<code>:wq</code></li>
</ul>
</li>
<li><strong>Vim 配置</strong>
<ul>
<li>配置文件：<code>.vimrc</code>，位于用户主目录下。</li>
</ul>
</li>
</ul>
<h3 id="实用工具介绍">实用工具介绍</h3>
<ul>
<li><strong>GCC</strong>
<ul>
<li>编译器：<code>gcc hello.c</code></li>
<li>执行：<code>./a.out</code></li>
</ul>
</li>
<li><strong>make &amp; Makefile</strong>
<ul>
<li>编写 Makefile 文件，使用 <code>make</code> 命令构建项目。</li>
</ul>
</li>
<li><strong>ctags</strong>
<ul>
<li>代码跳转工具，使用 <code>ctags -R *</code> 创建符号索引文件 <code>tags</code>。</li>
</ul>
</li>
<li><strong>tmux</strong>
<ul>
<li>终端复用工具，支持分屏操作和会话管理。</li>
</ul>
</li>
</ul>
<h3 id="git-简易教程">Git 简易教程</h3>
<ul>
<li><strong>Git 基本概念</strong>
<ul>
<li>三种储存位置：工作区、暂存区、储存库。</li>
<li>四种储存状态：未跟踪、未修改、已修改、已暂存。</li>
</ul>
</li>
<li><strong>常用命令</strong>
<ul>
<li><code>git init</code>：初始化仓库。</li>
<li><code>git clone</code>：克隆仓库。</li>
<li><code>git status</code>：查看仓库状态。</li>
<li><code>git add</code>：添加文件到暂存区。</li>
<li><code>git restore</code>：恢复文件。</li>
<li><code>git checkout</code>：切换分支。</li>
<li><code>git commit</code>：提交更改。</li>
<li><code>git push</code>：推送更改到远程仓库。</li>
<li><code>git pull</code>：拉取远程仓库的更改。</li>
</ul>
</li>
</ul>
<h3 id="shell-脚本教程">Shell 脚本教程</h3>
<ul>
<li><strong>Shell 脚本基础</strong>
<ul>
<li>创建脚本文件：<code>touch hello.sh</code></li>
<li>编写脚本：<code>#!/bin/bash</code>，<code>echo &quot;Hello, world!&quot;</code></li>
<li>运行脚本：<code>chmod +x hello.sh</code>，<code>./hello.sh</code></li>
</ul>
</li>
<li><strong>变量和参数</strong>
<ul>
<li>定义变量：<code>var_name=value</code></li>
<li>脚本参数：<code>$1</code>, <code>$2</code>, <code>$#</code>, <code>$*</code></li>
</ul>
</li>
<li><strong>条件与循环</strong>
<ul>
<li><code>if</code> 语句：条件判断。</li>
<li><code>while</code> 语句：循环操作。</li>
</ul>
</li>
<li><strong>函数</strong>
<ul>
<li>定义函数：<code>function fun_name() &#123; ... &#125;</code></li>
<li>调用函数：<code>fun_name param1 param2 ...</code></li>
</ul>
</li>
</ul>
<h3 id="用命令编辑和输出文本-sed-的使用">用命令编辑和输出文本——sed 的使用</h3>
<ul>
<li><strong>sed 基本用法</strong>
<ul>
<li><code>sed [选项] '命令' 输入文本</code></li>
<li>常用选项：<code>-n</code>（安静模式），<code>-i</code>（直接修改文件）</li>
<li>常用命令：<code>a</code>（新增），<code>c</code>（取代），<code>i</code>（插入），<code>d</code>（删除），<code>s</code>（替换）</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sed [选项] <span class="string">&#x27;命令&#x27;</span> 输入文本</span><br><span class="line">选项（常用）：</span><br><span class="line">-n：安静模式，只显示经过sed处理的内容。否则显示输入文本的所有内容。</span><br><span class="line">-i：直接修改读取的档案内容，而不是输出到屏幕。否则，只输出不编辑。</span><br><span class="line">命令（常用）：</span><br><span class="line">&lt;行号&gt;a&lt;内容&gt;： 新增，在行号后新增一行相应内容。行号可以是“数字”，在这一行之后新增，也可以是“起始行，终止行”，在其中的每一行后新增。当不写行号时，在每一行之后新增。使用$表示最后一行。后面的命令同理。</span><br><span class="line">&lt;行号&gt;c&lt;内容&gt;：取代。用内容取代相应行的文本。</span><br><span class="line">&lt;行号&gt;i&lt;内容&gt;：插入。在当前行的上面插入一行文本。</span><br><span class="line">&lt;行号&gt;d：删除当前行的内容。</span><br><span class="line">&lt;行号&gt;p：输出选择的内容。通常与选项-n一起使用。</span><br><span class="line">s/&lt;re&gt;/&lt;string&gt;：将&lt;re&gt;（正则表达式）匹配的内容替换为&lt;string&gt;。</span><br><span class="line"></span><br><span class="line">sed -n <span class="string">&#x27;3p&#x27;</span> my.txt</span><br><span class="line"><span class="comment"># 输出 my.txt 的第三行</span></span><br><span class="line">sed <span class="string">&#x27;2d&#x27;</span> my.txt</span><br><span class="line"><span class="comment"># 删除 my.txt 文件的第二行</span></span><br><span class="line">sed <span class="string">&#x27;2,$d&#x27;</span> my.txt</span><br><span class="line"><span class="comment"># 删除 my.txt 文件的第二行到最后一行</span></span><br><span class="line">sed <span class="string">&#x27;s/str1/str2/g&#x27;</span> my.txt</span><br><span class="line"><span class="comment"># 在整行范围内把 str1 替换为 str2。</span></span><br><span class="line"><span class="comment"># 如果没有 g 标记，则只有每行第一个匹配的 str1 被替换成 str2</span></span><br><span class="line">sed -e <span class="string">&#x27;4astr &#x27;</span> -e <span class="string">&#x27;s/str/aaa/&#x27;</span> my.txt</span><br><span class="line"><span class="comment">#-e 选项允许在同一行里执行多条命令。例子的第一条是第四行后添加一个 str，</span></span><br><span class="line"><span class="comment"># 第二个命令是将 str 替换为 aaa。命令的执行顺序对结果有影响。</span></span><br></pre></td></tr></table></figure>
<h3 id="重定向和管道">重定向和管道</h3>
<ul>
<li><strong>重定向</strong>
<ul>
<li>输出重定向：<code>&gt;</code>，<code>&gt;&gt;</code></li>
<li>输入重定向：<code>&lt;</code></li>
</ul>
</li>
<li><strong>管道</strong>
<ul>
<li><code>command1 | command2 | command3 | ...</code></li>
</ul>
</li>
</ul>
<h2 id="部分实践内容">部分实践内容</h2>
<ul>
<li>
<p><strong>Git 操作</strong></p>
<ul>
<li>克隆分支：<code>git clone &lt;URL&gt;</code></li>
<li>切换分支：<code>git checkout lab2</code></li>
<li>撤销修改：<code>git restore &lt;filename&gt;</code></li>
<li>添加文件到暂存区：<code>git add .</code></li>
<li>移出暂存区：<code>git restore --staged &lt;filename&gt;</code></li>
<li>恢复文件：<code>git restore &lt;filename&gt;</code></li>
<li>提交更改：<code>git commit -m &quot;git is so easy&quot;</code></li>
<li>推送更改：<code>git push</code></li>
</ul>
</li>
<li>
<p><strong>Shell 脚本</strong></p>
<ul>
<li>创建脚本文件：<code>touch hello.sh</code></li>
<li>编写脚本：<code>#!/bin/bash</code>，<code>echo &quot;Hello, world!&quot;</code></li>
<li>运行脚本：<code>chmod +x hello.sh</code>，<code>./hello.sh</code></li>
</ul>
</li>
<li>
<p><strong>sed 操作</strong></p>
<ul>
<li>替换内容：<code>sed 's/str1/str2/g' my.txt</code></li>
<li>删除行：<code>sed '2d' my.txt</code></li>
</ul>
</li>
<li>
<p><strong>重定向和管道</strong><br>
标准输入（stdin）：文件描述符为0；标准输出（stdout）：文件描述符为1；标准错误（stderr）：文件描述符为2。</p>
<ul>
<li>输出重定向：<code>ls / &gt; lsoutput.txt</code></li>
<li>输入重定向：<code>cat &lt; input.txt</code></li>
<li>管道操作：<code>cat hello.txt | grep &quot;Hello&quot;</code></li>
</ul>
</li>
</ul>
<h2 id="参考资料">参考资料</h2>
<ul>
<li><a href="https://www.cnblogs.com/caozy/p/9261224.html">Linux 常用命令大全</a></li>
<li><a href="https://developer.aliyun.com/article/1635220">Linux 入门教程</a></li>
<li><a href="https://git-scm.com/book/zh/v2">Git 基础教程</a></li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
        <category>OS</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
        <tag>OS</tag>
        <tag>Linux</tag>
        <tag>vim</tag>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>lab0 实验报告 [BUAA-OS]</title>
    <url>/2025/03/10/OS-lab0/</url>
    <content><![CDATA[<h3 id="part1-思考题">Part1. 思考题</h3>
<h4 id="thinking-0-1-git相关">Thinking 0.1 Git相关</h4>
<p>执行以下命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/learnGit <span class="comment"># 已初始化的git仓库</span></span><br><span class="line"><span class="built_in">touch</span> README.txt</span><br><span class="line">git status &gt; Untracked.txt</span><br><span class="line"><span class="comment"># 显示 README.txt 是一个未被跟踪的文件 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 执行 git add README.txt</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;This is the README file for learnGit.&quot;</span> &gt; README.txt</span><br><span class="line">git add README.txt</span><br><span class="line">git status &gt; Stage.txt</span><br><span class="line"><span class="comment"># 显示 README.txt 是一个已暂存的文件，Untracked.txt 是一个未被跟踪的文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 提交 README.txt 文件</span></span><br><span class="line">git commit -m <span class="string">&quot;23373446&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 对比 Untracked.txt 和 Stage.txt 的结果</span></span><br><span class="line"><span class="built_in">cat</span> Untracked.txt</span><br><span class="line"><span class="built_in">cat</span> Stage.txt</span><br><span class="line"><span class="comment"># Untracked.txt 显示 README.txt 是一个未被跟踪的文件，Stage.txt 显示 README.txt 是一个已暂存的文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 修改 README.txt 文件并执行命令 git status &gt; Modified.txt</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Adding more content to README.txt.&quot;</span> &gt;&gt; README.txt</span><br><span class="line">git status &gt; Modified.txt</span><br><span class="line"><span class="comment"># 显示 README.txt 是一个已修改的文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 对比 Modified.txt 和第一次执行 add 命令之前的 status</span></span><br><span class="line"><span class="built_in">cat</span> Modified.txt </span><br><span class="line"><span class="built_in">cat</span> Untracked.txt</span><br><span class="line"><span class="comment"># Modified.txt 显示 README.txt 是一个已修改的文件，Untracked.txt 显示 README.txt 是一个未被跟踪的文件</span></span><br></pre></td></tr></table></figure>
<p>status 是否一样，并思考原因。</p>
<blockquote>
<p>结果不同。第一次执行<code>git add</code>前，<code>README.txt</code>是一个未被跟踪的文件，而在修改已经提交的 <code>README.txt</code>文件后，Git 已经开始跟踪该文件，只是当前修改尚未被添加到暂存区，与未跟踪状态不同。</p>
</blockquote>
<h4 id="thinking-0-2-git命令">Thinking 0.2 Git命令</h4>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503102055812.png" alt><br>
箭头中的add the file、stage the file和commit分别对应的是Git里的哪些命令呢？</p>
<blockquote>
<p>add the file对应的是<code>git add</code>命令，用于将未跟踪文件添加到暂存区(Untracked-&gt;Staged)。<br>
stage the file对应的是<code>git add</code>命令，用于将已跟踪但被修改的文件添加到暂存区(Modified-&gt;Staged)。<br>
commit对应的是<code>git commit</code>命令，用于将暂存区的文件提交到版本库(Staged-&gt;Unmodified)。</p>
</blockquote>
<h4 id="thinking-0-3-git版本">Thinking 0.3 Git版本</h4>
<p>代码文件<code>print.c</code>被错误删除时，应当使用什么命令将其恢复？</p>
<blockquote>
<p>使用<code>git checkout -- print.c</code>命令或者<code>git  restore &lt;file&gt;</code>命令撤销对<code>print.c</code>文件的删除操作。</p>
</blockquote>
<p>代码文件<code>print.c</code>被错误删除后，执行了<code>git rm print.c</code>命令，此时应当使用什么命令将其恢复？</p>
<blockquote>
<p>使用<code>git restore --staged print.c</code>命令恢复<code>print.c</code>文件的未暂存状态，然后使用<code>git restore print.c</code>命令恢复<code>print.c</code>文件的未修改状态。</p>
</blockquote>
<p>无关文件<code>hello.txt</code>已经被添加到暂存区时，如何在不删除此文件的前提下将其移出暂存区？</p>
<blockquote>
<p>使用<code>git restore --staged hello.txt</code>命令将<code>hello.txt</code>文件从暂存区移出。</p>
</blockquote>
<h4 id="thinking-0-4-git-reset">Thinking 0.4 Git reset</h4>
<p>执行以下命令，并观察变化。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; <span class="built_in">cd</span> learnGit/</span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="string">&quot;Testing 1&quot;</span> &gt;&gt; README.txt</span><br><span class="line">&gt; git add README.txt</span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="string">&quot;Testing 2&quot;</span> &gt;&gt; README.txt</span><br><span class="line">&gt; git commit -m <span class="string">&quot;1&quot;</span></span><br><span class="line">&gt; git commit -m <span class="string">&quot;2&quot;</span></span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="string">&quot;Testing 3&quot;</span> &gt;&gt; README.txt</span><br><span class="line">&gt; git commit -m <span class="string">&quot;3&quot;</span></span><br><span class="line">&gt; git <span class="built_in">log</span></span><br><span class="line"><span class="comment">#`git log`命令查看提交历史</span></span><br><span class="line"><span class="comment">#可以看到三次提交的commit id分别为</span></span><br><span class="line">1: a94cd4d430d401235c92308115dddecacb236f6d</span><br><span class="line">2: 42112c824865729cef8c9a937865ac83cf224749</span><br><span class="line">3: 66a074e2349d149d8137fdc948ee9c62f087588b</span><br><span class="line">&gt; git reset --hard HEAD^</span><br><span class="line"><span class="comment"># 回退到上一次提交 输出HEAD 现在位于 42112c8 2</span></span><br><span class="line">&gt; git <span class="built_in">log</span></span><br><span class="line"><span class="comment"># 再次查看提交历史，可以看到只有两次提交</span></span><br><span class="line">&gt; git reset --hard a94cd4d430d401235c92308115dddecacb236f6d</span><br><span class="line"><span class="comment"># 回退到第一次提交 输出HEAD 现在位于 a94cd4d 1</span></span><br><span class="line">&gt; git <span class="built_in">log</span></span><br><span class="line"><span class="comment"># 再次查看提交历史，可以看到只有一次提交</span></span><br><span class="line">&gt; git reset --hard 66a074e2349d149d8137fdc948ee9c62f087588b</span><br><span class="line"><span class="comment"># 再次回到新版本 输出HEAD 现在位于 66a074e 3</span></span><br><span class="line">&gt; git <span class="built_in">log</span></span><br><span class="line"><span class="comment"># 再次查看提交历史，可以看到三次提交</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用<code>git reset HEAD...</code>版本回退，上版本是<code>^</code>，上上版本是<code>^^</code>，以此类推，也可以使用<code>~n</code>表示回退到上n次提交。注意<code>git reset --hard</code>本身是危险的，因为它会重写git的提交历史，覆盖掉之前的写入(Testing 1, Testing 2, Testing 3)，如果还未提交，则无法恢复。</p>
</blockquote>
<h4 id="thinking-0-5-关于重定向">Thinking 0.5 关于重定向</h4>
<p>执行以下命令，并查看结果</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; <span class="built_in">echo</span> first</span><br><span class="line"><span class="comment"># 在终端输出 first</span></span><br><span class="line">&gt; <span class="built_in">echo</span> second &gt; output.txt</span><br><span class="line"><span class="comment"># 将second写入output.txt，覆盖原有内容</span></span><br><span class="line">&gt; <span class="built_in">echo</span> third &gt; output.txt</span><br><span class="line"><span class="comment"># 将third写入output.txt，覆盖原有second</span></span><br><span class="line">&gt; <span class="built_in">echo</span> forth &gt;&gt; output.txt</span><br><span class="line"><span class="comment"># 将forth追加到output.txt，不覆盖原有内容</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>通过上面的命令，可以非常直观地观察到，<code>&gt;</code>是覆盖写入，<code>&gt;&gt;</code>是追加写入。</p>
</blockquote>
<h4 id="thinking-0-6-关于echo">Thinking 0.6 关于echo</h4>
<p>创建下图内容的文件，命名为test，将创建该文件的命令序列保存在command文件中，并将test文件作为批处理文件运行，将运行结果输出至result文件中。给出command文件和result文件的内容，并对最后的结果进行解释说明（可以从test文件的内容入手）. 具体实现的过程中思考下列问题: echo echo Shell Start 与 echo <code>echo Shell Start</code> 效果是否有区别; <code>echo echo $c&gt;file1</code>与echo <code>echo $c&gt;file1</code> 效果是否有区别.</p>
<div style="text-align: center;">
    <img src="https://gitee.com/TheUHO/blog/raw/master/images/202503102055809.png" alt="echo" style="width: 80%;">
</div>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#in file command</span></span><br><span class="line">&gt; <span class="built_in">touch</span> <span class="built_in">test</span></span><br><span class="line"><span class="comment"># edit test</span></span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="string">&quot;echo Shell Start...&quot;</span> &gt; <span class="built_in">test</span></span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="string">&quot;echo set a = 1&quot;</span> &gt;&gt; <span class="built_in">test</span></span><br><span class="line">...</span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="string">&quot;cat file4&gt;&gt;result&quot;</span></span><br></pre></td></tr></table></figure>
<p>运行test脚本，结果</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># in file result</span></span><br><span class="line">3</span><br><span class="line">2</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>结果解释：</p>
<blockquote>
<p>在test文件中，<code>echo</code>命令会将后面的内容输出到终端，因此会逐行输出<code>echo</code>后的内容，脚本的功能是将a赋值为1，b赋值为2，c赋值为a+b，在将c，b，a依次存储到file1，file2，file3中，最后将file1，file2，file3的内容依次追加输入到file4中，再追加到result文件中，因此result文件中的内容为3，2，1。</p>
</blockquote>
<p>关于echo echo Shell Start 与 echo <code>echo Shell Start</code> 效果是否有区别; <code>echo echo $c&gt;file1</code>与<code>echo 'echo $c&gt;file1'</code> 效果是否有区别</p>
<blockquote>
<p>由于带上单引号后会直接输出字符串，<code>echo echo Shell Start</code>与<code>echo 'echo Shell Start'</code>最终都将输出<code>Shell Start</code>，效果无区别。对于<code>echo echo $c&gt;file1</code>与<code>echo 'echo $c&gt;file1'</code>，由于<code>echo echo $c&gt;file1</code>将输出<code>echo $c&gt;file1</code>，其中<code>$c</code>=3，因此file中为3，而<code>echo 'echo $c&gt;file1'</code>将直接输出字符串<code>echo $c&gt;file1</code>到终端，而<code>$c</code>作为参数为空，是因此file中为空，但<code>echo</code>自带换行符，因此file中为空行。</p>
</blockquote>
<h3 id="part2-难点分析">Part2. 难点分析</h3>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202503102055810.png" alt="difficulty"></p>
<h4 id="exercise-0-1">Exercise 0.1</h4>
<ul>
<li>判断回文数，主要考察在CLI中编辑以及其它基本的操作指令，程序本身问题不大。</li>
<li>考察了刚刚学习的make命令和MakeFile的编写，生成可执行文件也是基本的gcc命令。</li>
<li>考察编写shell脚本，需要掌握sed命令和shell脚本中参数的使用，提取需要使用重定向，最后实现<code>sed -n 'kp' $1 &gt;&gt; $2</code>，需要注意sed命令中的参数。</li>
<li>复制到指定文件夹需要使用<code>cp</code>命令，难度不大。</li>
</ul>
<h4 id="exercise-0-2">Exercise 0.2</h4>
<ul>
<li>写一个简单的shell脚本，实现批处理，需要掌握循环的写法，循环变量自加的写法比较有意思（<code>i=$(i+1)</code>/<code>let i=i+1</code>）。</li>
</ul>
<h4 id="exercise-0-3">Exercise 0.3</h4>
<ul>
<li>题目是多种指令的结合使用，还考察了管道指令。查找可以用<code>grep -n</code>实现，将行号与内容分离需要掌握<code>awk</code>指令，其中参数<code>-F分隔符</code>与<code>&#123;print $1&#125;</code>需要掌握含义。管道指令与重定向可以实现执行多步操作并将结果输出到文件中。</li>
</ul>
<h4 id="exercise-0-4">Exercise 0.4</h4>
<ul>
<li>字符串替换可以很容易想到使用<code>sed &quot;s/old/new/g&quot; &quot;$inputfile&quot;</code>，注意参数为双引号，否则单引号会保留字符串而非实际含义，需要加上<code>g</code>全局替换，以及加上<code>-i</code>参数，否则不会直接修改文件，而是输出到终端。</li>
<li>MakeFile的编写有更高要求，需要注意头文件需要自己链接，以及编译得到可执行文件的路径。</li>
</ul>
<h3 id="part3-实验体会">Part3. 实验体会</h3>
<p>lab0的主要题目要求都是基于OSpre的部分，需要我们学习使用命令行操作，这对很多同学来说是初次实践，但一旦掌握了pre和指导书中对于Git，Shell，gcc，MakeFile的介绍，以及勤搜索、多实践，完成难度不会太大，而实现之后也会发现，命令行操作拥有许多便利之处，在此不再一一列举。<br>
对我而言，通过此次lab0的课下实践，我对于make、sed、awk、shell脚本的掌握有了一定的提升。</p>
<h3 id="part4-原创说明">Part4. 原创说明</h3>
<p>阅读了<a href="https://www.hugohealthy.top/2024/04/24/os-lab0%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/">hugo学长的难点分析</a>，对于从GUI到CLI的转变有了更深理解。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>OS</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>OS</tag>
        <tag>Linux</tag>
        <tag>vim</tag>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>lab1 实验报告 [BUAA-OS]</title>
    <url>/2025/04/02/OS-lab1/</url>
    <content><![CDATA[<h2 id="lab1实验报告">Lab1实验报告</h2>
<h3 id="part1-思考题">Part1. 思考题</h3>
<h4 id="thinking-1-1-编译和-objdump">Thinking 1.1 编译和 objdump</h4>
<blockquote>
<p>尝试分别使用实验环境中的原生 x86 工具链（gcc、ld、readelf、objdump 等）和 MIPS 交叉编译工具链（带有mips-linux-gnu- 前缀，如 mips-linux-gnu-gcc、mips-linux-gnu-ld），重复其中的编译和解析过程，观察相应的结果，并解释其中向objdump传入的参数的含义。</p>
</blockquote>
<p>首先通过阅读<strong>附录中的编译链接详解</strong>，了解编译链接的过程，尝试使用原生 x86 工具链和 MIPS 交叉编译工具链分别编译链接程序。</p>
<h5 id="原生-x86-工具链编译链接过程："><strong>原生 x86 工具链编译链接过程：</strong></h5>
<ol>
<li>编写一个简单的程序 <code>hello.c</code>，内容如下：</li>
</ol>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello, World!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>只进行预处理，生成预处理后的代码：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -E hello.c -o hello.i</span><br></pre></td></tr></table></figure>
<p>查看预处理后的代码，结果如下：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">... <span class="comment">//前略</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> <span class="title function_">printf</span> <span class="params">(<span class="type">const</span> <span class="type">char</span> *__restrict __format, ...)</span>;</span><br><span class="line">... <span class="comment">//后略</span></span><br><span class="line"># <span class="number">2</span> <span class="string">&quot;hello.c&quot;</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"># <span class="number">2</span> <span class="string">&quot;hello.c&quot;</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span> <span class="params">()</span> &#123;</span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">&quot;hello world!\n&quot;</span>);</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，预处理后的代码将 <code>#include &lt;stdio.h&gt;</code> 替换为了 <code>stdio.h</code> 文件的内容，并且将 <code>printf</code> 函数声明为 <code>extern</code>，表示该函数在其他地方定义，说明并没有 <code>printf</code> 函数的具体实现。</p>
<ol start="3">
<li>只编译不链接，生成汇编代码并进行反汇编：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -c hello.c</span><br><span class="line">objdump -DS hello.o &gt; think1.txt</span><br></pre></td></tr></table></figure>
<p>查看反汇编后的代码，结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hello.o：     文件格式 elf64-x86-64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disassembly of section .text:</span><br><span class="line"></span><br><span class="line">0000000000000000 &lt;main&gt;:</span><br><span class="line">   0:	f3 0f 1e fa          	endbr64</span><br><span class="line">   4:	55                   	push   %rbp</span><br><span class="line">   5:	48 89 e5             	mov    %rsp,%rbp</span><br><span class="line">   8:	48 8d 05 00 00 00 00 	lea    0x0(%rip),%rax        # f &lt;main+0xf&gt;</span><br><span class="line">   f:	48 89 c7             	mov    %rax,%rdi</span><br><span class="line">  12:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  17:	e8 00 00 00 00       	call   1c &lt;main+0x1c&gt; //没有填入具体的地址</span><br><span class="line">  1c:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  21:	5d                   	pop    %rbp</span><br><span class="line">  22:	c3                   	ret</span><br><span class="line">... //后略</span><br></pre></td></tr></table></figure>
<p>可以注意到，<code>call</code> 指令的地址并没有被填入具体的地址，而是用 <code>00 00 00 00</code> 表示，说明 <code>printf</code> 函数的具体实现仍然不在程序中。</p>
<ol start="4">
<li>编译并链接，生成可执行文件并进行反汇编：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc hello.c -o hello</span><br><span class="line">objdump -DS hello &gt; think2.txt</span><br></pre></td></tr></table></figure>
<p>查看反汇编后的代码，结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">hello：     文件格式 elf64-x86-64</span><br><span class="line"></span><br><span class="line">...//前略</span><br><span class="line">Disassembly of section .plt.sec:</span><br><span class="line"></span><br><span class="line">0000000000001050 &lt;printf@plt&gt;:</span><br><span class="line">    1050:	f3 0f 1e fa          	endbr64</span><br><span class="line">    1054:	ff 25 76 2f 00 00    	jmp    *0x2f76(%rip)        # 3fd0 &lt;printf@GLIBC_2.2.5&gt;</span><br><span class="line">    105a:	66 0f 1f 44 00 00    	nopw   0x0(%rax,%rax,1)</span><br><span class="line">... // 略</span><br><span class="line"></span><br><span class="line">0000000000001149 &lt;main&gt;:</span><br><span class="line">    1149:	f3 0f 1e fa          	endbr64</span><br><span class="line">    114d:	55                   	push   %rbp</span><br><span class="line">    114e:	48 89 e5             	mov    %rsp,%rbp</span><br><span class="line">    1151:	48 8d 05 ac 0e 00 00 	lea    0xeac(%rip),%rax        # 2004 &lt;_IO_stdin_used+0x4&gt;</span><br><span class="line">    1158:	48 89 c7             	mov    %rax,%rdi</span><br><span class="line">    115b:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">    1160:	e8 eb fe ff ff       	call   1050 &lt;printf@plt&gt;</span><br><span class="line">    1165:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">    116a:	5d                   	pop    %rbp</span><br><span class="line">    116b:	c3                   	ret</span><br><span class="line">...//后略</span><br></pre></td></tr></table></figure>
<p>我们注意到，<code>call</code> 指令的地址已经被填入具体的地址<code>1050</code>，也就是被标记为<code>printf@plt</code>的地址，说明<code>printf</code>函数的实现就在这个地址处。</p>
<h5 id="mips-交叉编译工具链编译过程"><strong>MIPS 交叉编译工具链编译过程</strong></h5>
<ol>
<li>只进行预处理</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mips-linux-gnu-gcc -E hello.c -o hello.i</span><br></pre></td></tr></table></figure>
<p>结果同上。</p>
<ol start="2">
<li>只进行编译，生成汇编代码并进行反汇编</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mips-linux-gnu-gcc -c hello.c</span><br><span class="line">mips-linux-gnu-objdump -DS hello.o &gt; think1.txt</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight mips"><table><tr><td class="code"><pre><span class="line">hello.o：     文件格式 elf32-tradbigmips</span><br><span class="line"></span><br><span class="line"><span class="keyword">Disassembly </span>of section <span class="meta">.text</span>:</span><br><span class="line"></span><br><span class="line"><span class="number">00000000</span> &lt;main&gt;:</span><br><span class="line"><span class="symbol">   0:</span>	<span class="number">27</span>bdffe0 	<span class="keyword">addiu	</span><span class="built_in">sp</span>,<span class="built_in">sp</span>,-<span class="number">32</span></span><br><span class="line"><span class="symbol">   4:</span>	afbf001c 	<span class="keyword">sw	</span><span class="built_in">ra</span>,<span class="number">28</span>(<span class="built_in">sp</span>)</span><br><span class="line"><span class="symbol">   8:</span>	afbe0018 	<span class="keyword">sw	</span><span class="built_in">s8</span>,<span class="number">24</span>(<span class="built_in">sp</span>)</span><br><span class="line">   c:	<span class="number">03</span>a<span class="symbol">0f</span>025 	<span class="keyword">move	</span><span class="built_in">s8</span>,<span class="built_in">sp</span></span><br><span class="line"><span class="symbol">  10:</span>	<span class="number">3</span>c1c0000 	<span class="keyword">lui	</span><span class="built_in">gp</span>,<span class="number">0x0</span>       &lt;-- <span class="built_in">gp</span> = <span class="number">0</span></span><br><span class="line"><span class="symbol">  14:</span>	<span class="number">279</span>c0000 	<span class="keyword">addiu	</span><span class="built_in">gp</span>,<span class="built_in">gp</span>,<span class="number">0</span></span><br><span class="line"><span class="symbol">  18:</span>	afbc0010 	<span class="keyword">sw	</span><span class="built_in">gp</span>,<span class="number">16</span>(<span class="built_in">sp</span>)</span><br><span class="line">  <span class="number">1</span>c:	<span class="number">3</span>c020000 	<span class="keyword">lui	</span><span class="built_in">v0</span>,<span class="number">0x0</span>       &lt;-- <span class="built_in">v0</span> = <span class="number">0</span></span><br><span class="line"><span class="symbol">  20:</span>	<span class="number">24440000</span> 	<span class="keyword">addiu	</span><span class="built_in">a0</span>,<span class="built_in">v0</span>,<span class="number">0</span></span><br><span class="line"><span class="symbol">  24:</span>	<span class="number">8</span>f820000 	<span class="keyword">lw	</span><span class="built_in">v0</span>,<span class="number">0</span>(<span class="built_in">gp</span>)</span><br><span class="line"><span class="symbol">  28:</span>	<span class="number">0040</span>c825 	<span class="keyword">move	</span><span class="built_in">t9</span>,<span class="built_in">v0</span>    &lt;-- <span class="built_in">t9</span> = <span class="built_in">v0</span></span><br><span class="line">  <span class="number">2</span>c:	<span class="number">0320</span>f809 	<span class="keyword">jalr	</span><span class="built_in">t9</span></span><br><span class="line"><span class="symbol">  30:</span>	<span class="number">00000000</span> 	<span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span><span class="symbol">  34:</span>	<span class="number">8</span>fdc0010 	<span class="keyword">lw	</span><span class="built_in">gp</span>,<span class="number">16</span>(<span class="built_in">s8</span>)</span><br><span class="line"><span class="symbol">  38:</span>	<span class="number">00001025</span> 	<span class="keyword">move	</span><span class="built_in">v0</span>,<span class="built_in">zero</span></span><br><span class="line">  <span class="number">3</span>c:	<span class="number">03</span>c0e825 	<span class="keyword">move	</span><span class="built_in">sp</span>,<span class="built_in">s8</span></span><br><span class="line"><span class="symbol">  40:</span>	<span class="number">8</span>fbf001c 	<span class="keyword">lw	</span><span class="built_in">ra</span>,<span class="number">28</span>(<span class="built_in">sp</span>)</span><br><span class="line"><span class="symbol">  44:</span>	<span class="number">8</span>fbe0018 	<span class="keyword">lw	</span><span class="built_in">s8</span>,<span class="number">24</span>(<span class="built_in">sp</span>)</span><br><span class="line"><span class="symbol">  48:</span>	<span class="number">27</span>bd0020 	<span class="keyword">addiu	</span><span class="built_in">sp</span>,<span class="built_in">sp</span>,<span class="number">32</span></span><br><span class="line">  <span class="number">4</span>c:	<span class="number">03</span>e00008 	<span class="keyword">jr	</span><span class="built_in">ra</span></span><br><span class="line"><span class="symbol">  50:</span>	<span class="number">00000000</span> 	<span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span>	...</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>生成可执行文件并进行反汇编</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mips-linux-gnu-gcc hello.c -o hello</span><br><span class="line">mips-linux-gnu-objdump -DS hello &gt; think2.txt</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight mips"><table><tr><td class="code"><pre><span class="line">... // 前略</span><br><span class="line"><span class="number">00400650</span> &lt;main&gt;:</span><br><span class="line"><span class="symbol">  400650:</span>	<span class="number">27</span>bdffe0 	<span class="keyword">addiu	</span><span class="built_in">sp</span>,<span class="built_in">sp</span>,-<span class="number">32</span></span><br><span class="line"><span class="symbol">  400654:</span>	afbf001c 	<span class="keyword">sw	</span><span class="built_in">ra</span>,<span class="number">28</span>(<span class="built_in">sp</span>)</span><br><span class="line"><span class="symbol">  400658:</span>	afbe0018 	<span class="keyword">sw	</span><span class="built_in">s8</span>,<span class="number">24</span>(<span class="built_in">sp</span>)</span><br><span class="line">  <span class="number">40065</span>c:	<span class="number">03</span>a<span class="symbol">0f</span>025 	<span class="keyword">move	</span><span class="built_in">s8</span>,<span class="built_in">sp</span></span><br><span class="line"><span class="symbol">  400660:</span>	<span class="number">3</span>c1c0043 	<span class="keyword">lui	</span><span class="built_in">gp</span>,<span class="number">0x43</span>      &lt;-- <span class="built_in">gp</span> = <span class="number">0x43</span></span><br><span class="line"><span class="symbol">  400664:</span>	<span class="number">279</span>c8010 	<span class="keyword">addiu	</span><span class="built_in">gp</span>,<span class="built_in">gp</span>,-<span class="number">32752</span> </span><br><span class="line"><span class="symbol">  400668:</span>	afbc0010 	<span class="keyword">sw	</span><span class="built_in">gp</span>,<span class="number">16</span>(<span class="built_in">sp</span>)</span><br><span class="line">  <span class="number">40066</span>c:	<span class="number">3</span>c020040 	<span class="keyword">lui	</span><span class="built_in">v0</span>,<span class="number">0x40</span>      &lt;-- <span class="built_in">v0</span> = <span class="number">0x40</span></span><br><span class="line"><span class="symbol">  400670:</span>	<span class="number">24440720</span> 	<span class="keyword">addiu	</span><span class="built_in">a0</span>,<span class="built_in">v0</span>,<span class="number">1824</span></span><br><span class="line"><span class="symbol">  400674:</span>	<span class="number">8</span>f828024 	<span class="keyword">lw	</span><span class="built_in">v0</span>,-<span class="number">32732</span>(<span class="built_in">gp</span>)</span><br><span class="line"><span class="symbol">  400678:</span>	<span class="number">0040</span>c825 	<span class="keyword">move	</span><span class="built_in">t9</span>,<span class="built_in">v0</span>    &lt;-- <span class="built_in">t9</span> = <span class="built_in">v0</span></span><br><span class="line">  <span class="number">40067</span>c:	<span class="number">0320</span>f809 	<span class="keyword">jalr	</span><span class="built_in">t9</span></span><br><span class="line"><span class="symbol">  400680:</span>	<span class="number">00000000</span> 	<span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span><span class="symbol">  400684:</span>	<span class="number">8</span>fdc0010 	<span class="keyword">lw	</span><span class="built_in">gp</span>,<span class="number">16</span>(<span class="built_in">s8</span>)</span><br><span class="line"><span class="symbol">  400688:</span>	<span class="number">00001025</span> 	<span class="keyword">move	</span><span class="built_in">v0</span>,<span class="built_in">zero</span></span><br><span class="line">  <span class="number">40068</span>c:	<span class="number">03</span>c0e825 	<span class="keyword">move	</span><span class="built_in">sp</span>,<span class="built_in">s8</span></span><br><span class="line"><span class="symbol">  400690:</span>	<span class="number">8</span>fbf001c 	<span class="keyword">lw	</span><span class="built_in">ra</span>,<span class="number">28</span>(<span class="built_in">sp</span>)</span><br><span class="line"><span class="symbol">  400694:</span>	<span class="number">8</span>fbe0018 	<span class="keyword">lw	</span><span class="built_in">s8</span>,<span class="number">24</span>(<span class="built_in">sp</span>)</span><br><span class="line"><span class="symbol">  400698:</span>	<span class="number">27</span>bd0020 	<span class="keyword">addiu	</span><span class="built_in">sp</span>,<span class="built_in">sp</span>,<span class="number">32</span></span><br><span class="line">  <span class="number">40069</span>c:	<span class="number">03</span>e00008 	<span class="keyword">jr	</span><span class="built_in">ra</span></span><br><span class="line">  <span class="number">4006</span><span class="built_in">a0</span>:	<span class="number">00000000</span> 	<span class="keyword">nop</span></span><br><span class="line"><span class="keyword"></span>	...</span><br></pre></td></tr></table></figure>
<p>可以注意到，二者的区别在于<code>gp</code>、<code>v0</code>、<code>t9</code>寄存器的值不同，使得最终<code>jalr	t9</code>跳转的地址不同，完成了<code>printf</code>函数的调用。</p>
<h5 id="关于objdump的参数"><strong>关于<code>objdump</code>的参数</strong></h5>
<p>使用<code>objdump --help</code>可以查看<code>objdump</code>的参数，结果如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; objdump --<span class="built_in">help</span></span><br><span class="line">用法：objdump &lt;选项&gt; &lt;文件&gt;</span><br><span class="line"> 显示来自目标 &lt;文件&gt; 的信息。</span><br><span class="line"> 至少必须给出以下选项之一：</span><br><span class="line">  -a, --archive-headers    Display archive header information</span><br><span class="line">  -f, --file-headers       Display the contents of the overall file header</span><br><span class="line">  -p, --private-headers    Display object format specific file header contents</span><br><span class="line">  -P, --private=OPT,OPT... Display object format specific contents</span><br><span class="line">  -h, --[section-]headers  Display the contents of the section headers</span><br><span class="line">  -x, --all-headers        Display the contents of all headers</span><br><span class="line">  -d, --disassemble        Display assembler contents of executable sections</span><br><span class="line">  -D, --disassemble-all    Display assembler contents of all sections</span><br><span class="line">      --disassemble=&lt;sym&gt;  Display assembler contents from &lt;sym&gt;</span><br><span class="line">  -S, --<span class="built_in">source</span>             Intermix <span class="built_in">source</span> code with disassembly</span><br><span class="line">      --source-comment[=&lt;txt&gt;] Prefix lines of <span class="built_in">source</span> code with &lt;txt&gt;</span><br><span class="line">  -s, --full-contents      Display the full contents of all sections requested</span><br><span class="line">  -Z, --decompress         Decompress section(s) before displaying their contents</span><br><span class="line">  -g, --debugging          Display debug information <span class="keyword">in</span> object file</span><br><span class="line">  -e, --debugging-tags     Display debug information using ctags style</span><br><span class="line">  -G, --stabs              Display (<span class="keyword">in</span> raw form) any STABS info <span class="keyword">in</span> the file</span><br></pre></td></tr></table></figure>
<p>我们在反汇编时，使用其中的<code>-DS</code>参数，<code>-D</code>表示将所有段反汇编，<code>-S</code>表示将源代码与反汇编代码混合显示，这样我们就可以看到汇编代码对应的源代码了。</p>
<h4 id="thinking-1-2-readelf-程序">Thinking 1.2 readelf 程序</h4>
<blockquote>
<p>尝试使用我们编写的readelf程序，解析之前在target目录下生成的内核ELF文件。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; <span class="built_in">cd</span> tools/readelf &amp;&amp; make</span><br><span class="line">&gt; ./readelf ../../target/mos</span><br><span class="line">0:0x0</span><br><span class="line">1:0x80020000</span><br><span class="line">2:0x80021930</span><br><span class="line">3:0x80021948</span><br><span class="line">4:0x80021960</span><br><span class="line">5:0x0</span><br><span class="line">6:0x0</span><br><span class="line">7:0x0</span><br><span class="line">8:0x0</span><br><span class="line">9:0x0</span><br><span class="line">10:0x0</span><br><span class="line">11:0x0</span><br><span class="line">12:0x0</span><br><span class="line">13:0x0</span><br><span class="line">14:0x0</span><br><span class="line">15:0x0</span><br><span class="line">16:0x0</span><br><span class="line">17:0x0</span><br><span class="line">18:0x0</span><br></pre></td></tr></table></figure>
<blockquote>
<p>也许你会发现我们编写的 <code>readelf</code> 程序是不能解析 <code>readelf</code> 文件本身的，而我们刚才介绍的系统工具 <code>readelf</code> 则可以解析，这是为什么呢？（提示：尝试使用 <code>readelf-h</code>，并阅读 <code>tools/readelf</code> 目录下的 <code>Makefile</code>，观察 <code>readelf</code> 与 <code>hello</code> 的不同）</p>
</blockquote>
<p>运行<code>readelf -h</code>指令，发现<code>readelf</code>和<code>hello</code>的ELF文件头信息如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; readelf -h readelf</span><br><span class="line">ELF 头：</span><br><span class="line">  Magic：   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 </span><br><span class="line">  类别:                              ELF64</span><br><span class="line">  数据:                              2 补码，小端序 (little endian)</span><br><span class="line">  Version:                           1 (current)</span><br><span class="line">  OS/ABI:                            UNIX - System V</span><br><span class="line">  ABI 版本:                          0</span><br><span class="line">  类型:                              DYN (Position-Independent Executable file)</span><br><span class="line">  系统架构:                          Advanced Micro Devices X86-64</span><br><span class="line">  版本:                              0x1</span><br><span class="line">  入口点地址：               0x1180</span><br><span class="line">  程序头起点：          64 (bytes into file)</span><br><span class="line">  Start of section headers:          14488 (bytes into file)</span><br><span class="line">  标志：             0x0</span><br><span class="line">  Size of this header:               64 (bytes)</span><br><span class="line">  Size of program headers:           56 (bytes)</span><br><span class="line">  Number of program headers:         13</span><br><span class="line">  Size of section headers:           64 (bytes)</span><br><span class="line">  Number of section headers:         31</span><br><span class="line">  Section header string table index: 30</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; readelf -h hello</span><br><span class="line">ELF 头：</span><br><span class="line">  Magic：   7f 45 4c 46 01 01 01 03 00 00 00 00 00 00 00 00 </span><br><span class="line">  类别:                              ELF32</span><br><span class="line">  数据:                              2 补码，小端序 (little endian)</span><br><span class="line">  Version:                           1 (current)</span><br><span class="line">  OS/ABI:                            UNIX - GNU</span><br><span class="line">  ABI 版本:                          0</span><br><span class="line">  类型:                              EXEC (可执行文件)</span><br><span class="line">  系统架构:                          Intel 80386</span><br><span class="line">  版本:                              0x1</span><br><span class="line">  入口点地址：               0x8049750</span><br><span class="line">  程序头起点：          52 (bytes into file)</span><br><span class="line">  Start of section headers:          707128 (bytes into file)</span><br><span class="line">  标志：             0x0</span><br><span class="line">  Size of this header:               52 (bytes)</span><br><span class="line">  Size of program headers:           32 (bytes)</span><br><span class="line">  Number of program headers:         8</span><br><span class="line">  Size of section headers:           40 (bytes)</span><br><span class="line">  Number of section headers:         30</span><br><span class="line">  Section header string table index: 29</span><br></pre></td></tr></table></figure>
<p>阅读<code>toools/readelf/Makefile</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">%.o: %.c</span><br><span class="line">	$(CC) -c $&lt;</span><br><span class="line"></span><br><span class="line">.PHONY: clean</span><br><span class="line"></span><br><span class="line">readelf: main.o readelf.o</span><br><span class="line">	$(CC) $^ -o <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line">hello: hello.c</span><br><span class="line">	$(CC) $^ -o <span class="variable">$@</span> -m32 -static -g</span><br><span class="line"></span><br><span class="line">clean:</span><br><span class="line">	<span class="built_in">rm</span> -f *.o readelf hello</span><br></pre></td></tr></table></figure>
<p><code>Makefile</code>中生成<code>hello</code>的命令是<code>$(CC) $^ -o $@ -m32 -static -g</code>，其中的编译链接选项：</p>
<ul>
<li><code>$(CC)</code>: 这是一个Makefile中的变量，通常表示C编译器（默认是<code>gcc</code>）。</li>
<li><code>$^</code>: 表示所有的依赖文件（即<code>hello.c</code>）。</li>
<li><code>-o $@</code>: 指定输出文件名，<code>$@</code>表示目标文件（即<code>hello</code>）。</li>
<li><code>-m32</code>: 指定生成32位的可执行文件。</li>
<li><code>-static</code>: 静态链接，生成的可执行文件会将所有依赖的库静态链接进去，独立运行时不依赖动态库。</li>
<li><code>-g</code>: 生成调试信息，用于调试工具gdb。</li>
</ul>
<p>可以看到，<code>readelf</code>的类别是<code>ELF64</code>，而<code>hello</code>的类别是<code>ELF32</code>，在生成可执行文件时就已规定，因此<code>hello</code>是一个32位的可执行文件，我们编写的<code>readelf</code>使用的数据类型都是32位，因而只能解析32位的可执行文件，而它本身是一个64位的可执行文件，所以无法解析自己。</p>
<h4 id="thinking-1-3">Thinking 1.3</h4>
<blockquote>
<p>在理论课上我们了解到，MIPS体系结构上电时，启动入口地址为0xBFC00000（其实启动入口地址是根据具体型号而定的，由硬件逻辑确定，也有可能不是这个地址，但一定是一个确定的地址），但实验操作系统的内核入口并没有放在上电启动地址，而是按照内存布局图放置。思考为什么这样放置内核还能保证内核入口被正确跳转到？（提示：思考实验中启动过程的两阶段分别由谁执行。）</p>
</blockquote>
<p>操作系统启动包括两个阶段，由<code>bootloader</code>执行，负责初始化硬件环境，找到并读取内核，加载到内存中执行，跳转到内核入口地址，将控制权转交给系统内核：</p>
<ul>
<li>stage1: 在 ROM 或 FLASH 中加载，初始化基本的硬件设备，包括watchdogtimer、中断、时钟、内存等，为stage2准备 RAM 空间，再将stage2代码拷贝到 RAM 中，设置堆栈，跳转到stage2的入口函数，此时，CPU 已经从 ROM/FLASH 切换到 RAM 运行，并开始执行 stage2 的代码。</li>
<li>stage2: 在 RAM 中运行，负责初始化内核所需其他硬件，读取内核镜像到 RAM 中并设置对应参数，最后跳转到内核入口函数(即<code>0xBFC00000</code>启动入口地址)，将控制权转交给内核。</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202504021640655.png" alt="loader"></p>
<p>以上是真实的启动过程，而我们的实验中使用了QEMU模拟器，支持直接加载ELF格式的内核，提供了引导启动的功能，因而简化了stage1和stage2，只需要将内核加载到内存中，跳转到内核入口地址即可，因此内核入口地址可以不是上电启动地址，只要能正确跳转即可。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// in kernel.lds</span><br><span class="line">OUTPUT_ARCH(mips)</span><br><span class="line"></span><br><span class="line">ENTRY(_start)</span><br><span class="line"></span><br><span class="line">SECTIONS &#123;</span><br><span class="line">	. = 0x80020000;</span><br><span class="line">	.text : &#123; *(.text) &#125;</span><br><span class="line">	.data : &#123; *(.data) &#125;</span><br><span class="line">	bss_start = .;</span><br><span class="line">	.bss : &#123; *(.bss) &#125;</span><br><span class="line">	bss_end = .;</span><br><span class="line">	. = 0x80400000;</span><br><span class="line">	end = . ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>QEMU模拟器通过<code>kernel.lds</code>控制各节的加载地址，使得程序各节调整到指定地址，再通过规定的<code>ENTRY(_start)</code>函数，使程序从<code>_start</code>函数开始执行，从而实现了内核的引导启动。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// in init/start.S</span><br><span class="line">.text</span><br><span class="line">EXPORT(_start)</span><br><span class="line">...</span><br><span class="line">	la sp, KSTACKTOP // 0x8040 0000</span><br><span class="line">	j mips_init</span><br></pre></td></tr></table></figure>
<p>内核的入口函数<code>_start</code>中，将栈指针<code>sp</code>指向<code>KSTACKTOP</code>，正确跳转到<code>mips_init</code>函数。</p>
<h3 id="part2-难点分析">Part2. 难点分析</h3>
<h4 id="1-理解操作系统启动的过程">1. 理解操作系统启动的过程</h4>
<ul>
<li>这点在理论课上已经有过讲解，但实验中使用了QEMU模拟器对启动过程进行了模拟和简化，这要求我们对启动过程有更深入的理解，才能在实验中正确地引导内核启动。更重要的是，我们需要在理解<code>bootloader</code>的基础之上，学习QEMU模拟器的运行流程，才能看懂源代码。</li>
<li>QEMU模拟器通过<code>kernel.lds</code>控制各节的加载地址，使得程序各节调整到指定地址，也就是指导书中解释的 LinkerScript，它的核心作用在于明确指定内核各部分在内存中的位置，从而使得内核各部分能够正确地被加载到内存中，确保不同类型的数据分区正确排布，为内核启动与后续运行创造稳定的内存布局。例如，LinkerScript 允许开发者针对不同平台的 ABI 进行定制；分离代码和数据(.text 和 .data)，确保安全性和稳定性。</li>
</ul>
<h4 id="2-理解elf源代码中结构体和指针的使用">2. 理解ELF源代码中结构体和指针的使用</h4>
<p>我们主要关注了两个结构体：<strong>Elf32_Ehdr</strong> 和 <strong>Elf32_Shdr</strong>。<strong>Elf32_Ehdr</strong> 是 ELF 文件的总体描述，包含了文件的魔数、类型、目标平台、入口点、程序头和节头表的位置以及数量等全局信息。  <strong>Elf32_Shdr</strong> 则详细描述了 ELF 文件中各个节的具体属性和位置，如节名、类型、大小、内存加载地址、文件偏移、对齐要求等，为链接、加载和调试提供了关键信息。<br>
注意在读取 ELF 文件时，需要通过指针来访问和解析 ELF 文件中的各个部分，在Lab1中，我们通过指针访问 ELF 文件头、节头表等。这里存在指针类型的转换，为的是能正确地访问 ELF 文件中的数据，确保程序能够正确地解析和加载 ELF 文件。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> e_ident[EI_NIDENT]; <span class="comment">/* Magic number and other info */</span></span><br><span class="line">	Elf32_Half e_type;		  <span class="comment">/* Object file type */</span></span><br><span class="line">	Elf32_Half e_machine;		  <span class="comment">/* Architecture */</span></span><br><span class="line">	Elf32_Word e_version;		  <span class="comment">/* Object file version */</span></span><br><span class="line">	Elf32_Addr e_entry;		  <span class="comment">/* Entry point virtual address */</span></span><br><span class="line">	Elf32_Off e_phoff;		  <span class="comment">/* Program header table file offset */</span></span><br><span class="line">	Elf32_Off e_shoff;		  <span class="comment">/* Section header table file offset */</span></span><br><span class="line">	Elf32_Word e_flags;		  <span class="comment">/* Processor-specific flags */</span></span><br><span class="line">	Elf32_Half e_ehsize;		  <span class="comment">/* ELF header size in bytes */</span></span><br><span class="line">	Elf32_Half e_phentsize;		  <span class="comment">/* Program header table entry size */</span></span><br><span class="line">	Elf32_Half e_phnum;		  <span class="comment">/* Program header table entry count */</span></span><br><span class="line">	Elf32_Half e_shentsize;		  <span class="comment">/* Section header table entry size */</span></span><br><span class="line">	Elf32_Half e_shnum;		  <span class="comment">/* Section header table entry count */</span></span><br><span class="line">	Elf32_Half e_shstrndx;		  <span class="comment">/* Section header string table index */</span></span><br><span class="line">&#125; Elf32_Ehdr;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	Elf32_Word sh_name;	 <span class="comment">/* Section name */</span></span><br><span class="line">	Elf32_Word sh_type;	 <span class="comment">/* Section type */</span></span><br><span class="line">	Elf32_Word sh_flags;	 <span class="comment">/* Section flags */</span></span><br><span class="line">	Elf32_Addr sh_addr;	 <span class="comment">/* Section addr */</span></span><br><span class="line">	Elf32_Off sh_offset;	 <span class="comment">/* Section offset */</span></span><br><span class="line">	Elf32_Word sh_size;	 <span class="comment">/* Section size */</span></span><br><span class="line">	Elf32_Word sh_link;	 <span class="comment">/* Section link */</span></span><br><span class="line">	Elf32_Word sh_info;	 <span class="comment">/* Section extra info */</span></span><br><span class="line">	Elf32_Word sh_addralign; <span class="comment">/* Section alignment */</span></span><br><span class="line">	Elf32_Word sh_entsize;	 <span class="comment">/* Section entry size */</span></span><br><span class="line">&#125; Elf32_Shdr;</span><br></pre></td></tr></table></figure>
<h5 id="elf32-ehdr：elf-文件头">Elf32_Ehdr：ELF 文件头</h5>
<p><strong>Elf32_Ehdr</strong> 是每个 ELF 文件最开始的部分，描述了整个文件的基本属性和组织信息。其中的具体字段如下：</p>
<ul>
<li>
<p><strong>e_ident[EI_NIDENT]</strong><br>
一个 16 字节的标识数组，包含文件的魔数和其他基本信息。</p>
<ul>
<li><strong>魔数（Magic Number）</strong></li>
<li>其他字节包含文件的类（32位或64位）、数据编码格式、版本、操作系统 ABI 等信息。</li>
</ul>
</li>
<li>
<p><strong>e_type</strong>  表示目标文件的类型，例如：</p>
<ul>
<li>ET_REL（可重定位文件），</li>
<li>ET_EXEC（可执行文件），</li>
<li>ET_DYN（共享对象），</li>
<li>ET_CORE（内核转储文件）。</li>
</ul>
</li>
<li>
<p><strong>e_machine</strong>  指明目标文件适用的处理器架构（如 x86、ARM、MIPS 等），用于告诉操作系统如何解释其中的机器码。</p>
</li>
<li>
<p><strong>e_version</strong>  ELF 文件的版本，一般为 1，表示最初的版本。</p>
</li>
<li>
<p><strong>e_entry</strong>  程序入口点的虚拟地址。对于可执行文件来说，启动执行时处理器将从这个地址开始运行。</p>
</li>
<li>
<p><strong>e_phoff</strong>  程序头表（Program Header Table）在文件中的偏移位置。该表描述了程序运行时需要加载到内存中的各个段（segment）。</p>
</li>
<li>
<p><strong>e_shoff</strong>  节头表（Section Header Table）在文件中的偏移位置。节头表提供了关于文件中各个节（section）的详细信息。</p>
</li>
<li>
<p><strong>e_flags</strong>  处理器特定的标志，这些标志通常与目标平台相关，用于控制文件的处理方式。</p>
</li>
<li>
<p><strong>e_ehsize</strong>  ELF 文件头的大小（以字节为单位），告诉系统读取文件头时应取多大的一块数据。</p>
</li>
<li>
<p><strong>e_phentsize</strong>  程序头表中每个表项的大小（字节数），用于遍历各个段描述信息。</p>
</li>
<li>
<p><strong>e_phnum</strong>  程序头表中表项的数量，即文件中有多少个段需要加载。</p>
</li>
<li>
<p><strong>e_shentsize</strong>  节头表中每个表项的大小（字节数），用于遍历各个节的描述信息。</p>
</li>
<li>
<p><strong>e_shnum</strong>  节头表中节的数量，即该 ELF 文件中总共有多少个节。</p>
</li>
<li>
<p><strong>e_shstrndx</strong>  节头表中用于存储节名字的字符串表（Section Header String Table）的索引。利用这个字符串表，可以根据 sh_name 字段找到每个节的名称。</p>
</li>
</ul>
<h5 id="elf32-shdr：节头结构">Elf32_Shdr：节头结构</h5>
<p><strong>Elf32_Shdr</strong> 用于描述 ELF 文件中的每个节（section），这些节存储了不同类型的信息，如代码、数据、符号表等。各字段含义如下：</p>
<ul>
<li>
<p><strong>sh_name</strong>  一个索引值，指向节头字符串表中的字符串，表示该节的名称。通过该名称可以判断节的用途（例如 “.text”、&quot;.data&quot;、&quot;.bss&quot; 等）。</p>
</li>
<li>
<p><strong>sh_type</strong>  指定节的类型。常见类型包括：</p>
<ul>
<li><strong>SHT_PROGBITS</strong>：包含程序数据或代码的节；</li>
<li><strong>SHT_SYMTAB</strong>：符号表；</li>
<li><strong>SHT_STRTAB</strong>：字符串表；</li>
<li><strong>SHT_NOBITS</strong>：不占据文件中实际存储空间的节（例如 .bss）。</li>
</ul>
</li>
<li>
<p><strong>sh_flags</strong>  标识该节的属性，如是否可写、是否可执行、是否在内存中占用空间。</p>
</li>
<li>
<p><strong>sh_addr</strong>  指定该节在进程地址空间中的虚拟地址。对于加载到内存中的节（比如 .text、.data），该字段指出它们在内存中的起始地址。</p>
</li>
<li>
<p><strong>sh_offset</strong>  该节在文件中的偏移量，即从文件开始到该节数据的起始位置。</p>
</li>
<li>
<p><strong>sh_size</strong>  该节的大小（以字节为单位），表示该节包含的数据总量。</p>
</li>
<li>
<p><strong>sh_link</strong>  该字段的意义取决于节的类型。通常用于指定与该节相关的其他节的索引。</p>
</li>
<li>
<p><strong>sh_info</strong>  提供额外的信息，其含义依赖于节的类型。</p>
</li>
<li>
<p><strong>sh_addralign</strong>  指定该节在内存中的对齐要求（以字节为单位）。</p>
</li>
<li>
<p><strong>sh_entsize</strong>  如果该节包含固定大小的条目（例如符号表、重定位表），则此字段记录每个条目的大小。</p>
</li>
</ul>
<h4 id="3-printk-函数与变长参数">3. <code>printk()</code>函数与变长参数</h4>
<p>在Lab1课下中，我们实现了了一个<code>printk()</code>函数，它能够打印出不同类型的数据，包括字符串、整数等。<code>printk()</code>函数使用了变长参数列表，通过<code>va_list</code>、<code>va_start()</code>、<code>va_arg()</code>和<code>va_end()</code>等宏来实现参数的解析和打印。<br>
下面详细说明 <code>printk</code> 函数的实现以及变长参数（variadic arguments）的原理和使用。</p>
<ul>
<li><strong>顶层函数 <code>printk</code></strong><br>
它负责收集格式字符串和变长参数，并调用 <code>vprintfmt</code> 进行解析和格式化。</li>
<li><strong>变长参数的使用</strong><br>
通过 <code>va_list</code>、<code>va_start</code>、<code>va_arg</code>、<code>va_end</code> 宏实现。它允许函数动态读取传入的多个参数，每次调用 <code>va_arg</code> 都能根据指定类型返回下一个参数。</li>
<li><strong>整体流程</strong><br>
用户通过 <code>printk</code> 输出格式化信息，<code>printk</code> 使用变长参数宏将参数整理成列表，再由 <code>vprintfmt</code> 解析格式字符串，最终通过回调函数 <code>outputk</code> 将字符逐一输出到内核控制台（实际写入内存映射的 I/O 地址）。</li>
</ul>
<h5 id="printk-函数实现概述">printk 函数实现概述</h5>
<p>我们在Lab1中实现的输出函数 <code>printk</code> 实现思路可以分为两层：</p>
<ol>
<li>
<p><strong>顶层接口</strong><br>
<code>printk</code> 是一个可变长参数函数，其原型为：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">printk</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *fmt, ...)</span>;</span><br></pre></td></tr></table></figure>
<p>这里的 <code>...</code> 表示该函数可以接受任意数量的额外参数。<code>printk</code> 主要做两件事：</p>
<ul>
<li>利用 C 语言标准库提供的可变长参数宏（<code>va_list</code>、<code>va_start</code>、<code>va_end</code> 等）将参数组织成一个变量列表；</li>
<li>将格式字符串、可变参数列表以及一个用于输出字符的回调函数 <code>outputk</code> 传递给底层的格式化输出函数 <code>vprintfmt</code>。</li>
</ul>
</li>
<li>
<p><strong>格式化输出实现</strong><br>
底层的 <code>vprintfmt</code> 函数负责解析格式字符串（例如 <code>%d</code>、<code>%x</code>、<code>%s</code> 等），提取对应的参数，并调用辅助函数（如 <code>print_char</code>、<code>print_str</code>、<code>print_num</code>）进行数字、字符、字符串的格式化处理。最终，这些格式化后的字符数据会通过 <code>outputk</code> 回调函数逐字符输出到控制台。最终 <code>printk</code> 的调用流程如下：</p>
<ul>
<li>用户调用<code>printk</code>函数，如 <code>printk(&quot;Hello %d\n&quot;, 123);</code></li>
<li><code>printk</code> 调用 <code>va_start</code> 初始化参数列表，将 “Hello %d\n” 作为固定参数，后面的参数 123 记录在 <code>ap</code> 中；</li>
<li>调用 <code>vprintfmt(outputk, NULL, fmt, ap)</code> 进行格式化输出；</li>
<li>格式化过程中，遇到 <code>%</code> 符号时，会解析输出宽度、对齐方式、是否长整型等标志，并用 <code>va_arg</code> 依次提取相应类型的参数；</li>
<li>格式化后的字符串最终通过 <code>outputk</code> 被输出，<code>outputk</code> 内部调用 <code>printcharc</code> 将字符写入特定的内存地址，实现对 QEMU 控制台的输出；</li>
<li>最后在结束时调用 <code>va_end</code> 清理变量参数列表。</li>
</ul>
</li>
</ol>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202504021631279.png" alt="printk调用流程"></p>
<h5 id="理解可变长参数的原理">理解可变长参数的原理</h5>
<p>在 C 语言中，可变长参数允许函数接受不固定数量的参数。实现这一功能主要依赖于 <code>&lt;stdarg.h&gt;</code> 中的几个宏：</p>
<ol>
<li>
<p><strong>va_list</strong>  定义了一个类型，用来存储变长参数列表的信息。可以理解为一个栈堆中指向参数列表当前位置的指针。</p>
</li>
<li>
<p><strong>va_start(va_list ap, lastarg)</strong>  用于初始化 <code>va_list</code> 类型的变量 <code>ap</code>。第二个参数 <code>lastarg</code> 是函数参数列表中最后一个固定参数（在 <code>printk</code> 中为 <code>fmt</code>）。该宏根据 <code>lastarg</code> 的位置确定变长参数列表的起始位置。</p>
</li>
<li>
<p><strong>va_arg(va_list ap, type)</strong>  每调用一次 <code>va_arg</code>，就会返回当前参数，并将内部指针移动到下一个参数的位置。调用时需要指定参数的类型，比如 <code>int</code> 或 <code>long</code>。</p>
</li>
<li>
<p><strong>va_end(va_list ap)</strong>  用于清理 <code>va_list</code> 对象。</p>
</li>
</ol>
<h3 id="part3-实验体会">Part3. 实验体会</h3>
<p>通过本次实验，我深入理解了计算机系统的启动过程，对于 QEMU 模拟器模拟的计算机启动过程有了更直观的认识。同时，Lab1帮助我们掌握ELF文件的结构与具体功能实现，并通过对 <code>printk</code> 函数的实现进行训练。完成Lab1决不能仅仅是完成填空，而必须阅读并理解源代码，知晓其背后的原理。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>OS</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>OS</tag>
        <tag>Linux</tag>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title>lab2 实验报告 [BUAA-OS]</title>
    <url>/2025/06/27/OS-lab2/</url>
    <content><![CDATA[<h2 id="lab2实验报告">Lab2实验报告</h2>
<h3 id="part1-思考题">Part1. 思考题</h3>
<h4 id="thinking-2-1-程序代码中的地址">Thinking 2.1 程序代码中的地址</h4>
<blockquote>
<p>请根据上述说明，回答问题：在编写的 C 程序中，指针变量中存储的地址被视为虚拟地址，还是物理地址？MIPS 汇编程序中 lw和sw 指令使用的地址被视为虚拟地址，还是物理地址？</p>
</blockquote>
<p>由于实际程序中访存、跳转等指令以及用于取指的PC寄存器中的访存目标地址都是<strong>虚拟地址</strong>，因此指针变量中存储的地址也是<strong>虚拟地址</strong>。而MIPS汇编程序中lw和sw指令使用的地址也是<strong>虚拟地址</strong>。</p>
<h4 id="thinking-2-2-链表宏">Thinking 2.2 链表宏</h4>
<blockquote>
<p>请思考下述两个问题：</p>
<ul>
<li>从可重用性的角度，阐述用宏来实现链表的好处。</li>
<li>查看实验环境中的/usr/include/sys/queue.h，了解其中单向链表与循环链表的实现，比较它们与本实验中使用的双向链表，分析三者在插入与删除操作上的性能差异。</li>
</ul>
</blockquote>
<ol>
<li>
<p>从可重用性的角度，使用宏能通过预处理器用复制宏代码的方式替代函数调用，实现链表，宏定义的链表操作函数可以方便地被其他程序调用，而不需要重复编写相同的代码，也省去了函数调用的压栈、返回等等操作。<br>
指导书里提到C++/Java等语言中存在泛型，C语言中没有泛型的语法，使用宏能够较好地实现可重用性(如只要保证链表有<code>field</code>字段和<code>le_prev</code>/<code>le_next</code>属性，就可很方便地实现链表操作，具有可读性和可维护性)。</p>
</li>
<li>
<p>性能差异如下：</p>
</li>
</ol>
<ul>
<li>关于插入操作：单向链表和循环链表在插入操作时都只需要维护2个指针，双向链表需要维护4个指针，对于在某一个元素后插入的情况，单向链表和循环链表以及双向链表只需要O(1)的时间复杂度.而对于在某一元素前插入，单向链表和循环链表需要O(n)的时间复杂度，双向链表需要O(1)的时间复杂度。在某个位置插入时，单向链表和循环链表以及双向链表都需要O(n)的时间复杂度。</li>
<li>关于删除操作：对于删除某个元素的操作，单向链表和循环链表都需要O(n)的时间复杂度，双向链表需要O(1)的时间复杂度；如果要删除某个位置上的元素(只知道序号)，单向链表和循环链表以及双向链表都需要遍历查找，需要O(n)的时间复杂度。</li>
</ul>
<blockquote>
<p>链表头的删除和插入操作都只需要O(1)的时间复杂度；尾部的删除和插入操作，循环链表只需要O(1)的时间复杂度，单向链表和双向链表需要O(n)的时间复杂度。</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">链表类型</th>
<th style="text-align:center">插入/删除操作(某个位置)</th>
<th style="text-align:center">删除某个元素</th>
<th style="text-align:center">插入操作(某个元素前)</th>
<th style="text-align:center">插入操作(某个元素后)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">单向链表</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(1)</td>
</tr>
<tr>
<td style="text-align:center">循环链表</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(1)</td>
</tr>
<tr>
<td style="text-align:center">双向链表</td>
<td style="text-align:center">O(n)</td>
<td style="text-align:center">O(1)</td>
<td style="text-align:center">O(1)</td>
<td style="text-align:center">O(1)</td>
</tr>
</tbody>
</table>
<h4 id="thinking-2-3-page-list-结构体">Thinking 2.3 Page_list 结构体</h4>
<blockquote>
<p>请阅读include/queue.h以及include/pmap.h,将Page_list的结构梳理清楚，选择正确的展开结构。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">&gt;A</span><br><span class="line">&gt;<span class="class"><span class="keyword">struct</span> <span class="title">Page_list</span> &#123;</span></span><br><span class="line">   <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">       <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">           <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_next</span>;</span></span><br><span class="line">           <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_prev</span>;</span></span><br><span class="line">           &#125; pp_link;</span><br><span class="line">           u_short pp_ref;</span><br><span class="line">       &#125;* lh_first;</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">&gt;B</span><br><span class="line">&gt;<span class="class"><span class="keyword">struct</span> <span class="title">Page_list</span> &#123;</span></span><br><span class="line">   <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">      <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">          <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_next</span>;</span></span><br><span class="line">          <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_prev</span>;</span></span><br><span class="line">      &#125; pp_link;</span><br><span class="line">      u_short pp_ref;</span><br><span class="line">  &#125; lh_first;</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">&gt;C</span><br><span class="line">&gt;<span class="class"><span class="keyword">struct</span> <span class="title">Page_list</span>&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	    <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_next</span>;</span></span><br><span class="line">	    <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> **<span class="title">le_prev</span>;</span></span><br><span class="line">	&#125; pp_link;</span><br><span class="line">	u_short pp_ref;</span><br><span class="line">&#125;* lh_first;</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">LIST_HEAD(Page_list, Page);</span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">LIST_ENTRY</span><span class="params">(Page)</span> Page_LIST_entry_t;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page</span> &#123;</span></span><br><span class="line">        Page_LIST_entry_t pp_link; <span class="comment">/* free list link */</span></span><br><span class="line">        u_short pp_ref;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LIST_HEAD(name, type)     \</span></span><br><span class="line"><span class="meta">    struct name &#123;                                                   \</span></span><br><span class="line"><span class="meta">        struct type *lh_first; <span class="comment">/* first element */</span>                          \</span></span><br><span class="line"><span class="meta">    &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LIST_ENTRY(type)                                      \</span></span><br><span class="line"><span class="meta">    struct &#123;                                                              \</span></span><br><span class="line"><span class="meta">        struct type *le_next;  <span class="comment">/* next element */</span>          \</span></span><br><span class="line"><span class="meta">        struct type **le_prev; <span class="comment">/* address of previous next element */</span>      \</span></span><br><span class="line"><span class="meta">    &#125;</span></span><br></pre></td></tr></table></figure>
<p>根据以上代码，我们可以得出选择C。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Page_list</span>&#123;</span> <span class="comment">// LIST_HEAD(Page_list, Page);</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span> <span class="comment">// struct Page</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> &#123;</span> <span class="comment">// LIST_ENTRY(Page)</span></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">le_next</span>;</span></span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> **<span class="title">le_prev</span>;</span></span><br><span class="line">        &#125; pp_link;</span><br><span class="line">        u_short pp_ref;</span><br><span class="line">    &#125;* lh_first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="thinking-2-4-地址空间">Thinking 2.4 地址空间</h4>
<blockquote>
<p>请思考下面两个问题：</p>
<ul>
<li>请阅读上面有关TLB的描述，从虚拟内存和多进程操作系统的实现角度，阐述ASID<br>
的必要性。</li>
<li>请阅读 MIPS 4Kc 文档《MIPS32® 4K™ Processor Core Family Software User’s<br>
Manual》的 Section 3.3.1 与 Section 3.4，结合 ASID 段的位数，说明 4Kc 中可容纳<br>
不同的地址空间的最大数量。</li>
</ul>
</blockquote>
<ol>
<li>
<p>ASID的必要性<br>
在多进程操作系统中，每个进程都有自己的虚拟地址空间，具有不同页表。同一虚拟地址在不同地址空间中可能对应不同的物理地址，ASID 用于区分不同进程的虚拟地址空间。TLB 事实上构建了一个映射 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>V</mi><mi>P</mi><mi>N</mi><mo separator="true">,</mo><mi>A</mi><mi>S</mi><mi>I</mi><mi>D</mi><mo>&gt;</mo><mo><mover><mo><mo>⟶</mo></mo><mrow><mi>T</mi><mi>L</mi><mi>B</mi></mrow></mover></mo><mo>&lt;</mo><mi>P</mi><mi>F</mi><mi>N</mi><mo separator="true">,</mo><mi>N</mi><mo separator="true">,</mo><mi>D</mi><mo separator="true">,</mo><mi>V</mi><mo separator="true">,</mo><mi>G</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;VPN,ASID&gt; \stackrel{TLB}{\longrightarrow} &lt;PFN,N,D,V,G &gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.10903em;">PN</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:1.3003em;vertical-align:-0.011em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2893em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">⟶</span></span></span><span style="top:-3.711em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em;"><span></span></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">PFN</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>，ASID的存在使得TLB可以标识其虚拟地址空间，实现进程间的地址隔离，保护进程的地址空间不被其他进程访问。</p>
</li>
<li>
<p>4Kc 中可容纳不同的地址空间的最大数量</p>
</li>
</ol>
<blockquote>
<p>In this figure the virtual address is extended with an 8-bit address-space identifier (ASID), which reduces the frequency of TLB flushing during a context switch. This 8-bit ASID contains the number assigned to that process and is stored in the CP0 EntryHi register. —— MIPS 4Kc Page 43</p>
</blockquote>
<p>ASID段为8位，因此4Kc中可容纳不同的地址空间的最大数量为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>8</mn></msup><mo>=</mo><mn>256</mn></mrow><annotation encoding="application/x-tex">2^8=256</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">256</span></span></span></span>。</p>
<h4 id="thinking-2-5-tlb-inalidate">Thinking 2.5 tlb_inalidate</h4>
<blockquote>
<p>请回答下述三个问题：</p>
<ul>
<li>tlb_invalidate和tlb_out的调用关系？</li>
<li>请用一句话概括tlb_invalidate的作用。</li>
<li>逐行解释tlb_out中的汇编代码。</li>
</ul>
</blockquote>
<ol>
<li>我们在<code>kern/tlbx.c</code>中看到<code>tlb_invalidate</code>函数的实现，其调用关系如下：</li>
</ol>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">tlb_invalidate</span><span class="params">(u_int asid, u_long va)</span> &#123;</span><br><span class="line">    tlb_out((va &amp; ~GENMASK(PGSHIFT, <span class="number">0</span>)) | (asid &amp; (NASID - <span class="number">1</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>说明：<code>tlb_invalidate</code>函数调用<code>tlb_out</code>函数。<br>
2. <code>tlb_invalidate</code>的作用是使TLB中对应虚拟地址的旧表项无效，保证下次访问对应虚拟地址时触发TLB miss，从而更新TLB中的表项。</p>
<ol start="3">
<li><code>tlb_out</code>中的汇编代码如下：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">LEAF(tlb_out) </span><br><span class="line">.set noreorder</span><br><span class="line">    mfc0    t0, CP0_ENTRYHI // EntryHi寄存器值存入t0，保存原值</span><br><span class="line">    mtc0    a0, CP0_ENTRYHI // 将a0的值存入EntryHi寄存器，a0为旧表项的Key</span><br><span class="line">    nop</span><br><span class="line">    /* Step 1: Use &#x27;tlbp&#x27; to probe TLB entry */</span><br><span class="line">    /* Exercise 2.8: Your code here. (1/2) */</span><br><span class="line">    tlbp                   // 根据Key查询TLB中是否有与之匹配的旧表项，存入Index寄存器</span><br><span class="line">    nop</span><br><span class="line">    /* Step 2: Fetch the probe result from CP0.Index */</span><br><span class="line">    mfc0    t1, CP0_INDEX // 将Index寄存器值存入t1寄存器</span><br><span class="line">.set reorder</span><br><span class="line">    bltz    t1, NO_SUCH_ENTRY // t1为负，说明未找到与Key匹配的旧表项，跳转到NO_SUCH_ENTRY</span><br><span class="line">.set noreorder</span><br><span class="line">    mtc0    zero, CP0_ENTRYHI // 将EntryHi寄存器清零</span><br><span class="line">    mtc0    zero, CP0_ENTRYLO0 // 将EntryLo0寄存器清零</span><br><span class="line">    mtc0    zero, CP0_ENTRYLO1 // 将EntryLo1寄存器清零</span><br><span class="line">    nop</span><br><span class="line">    /* Step 3: Use &#x27;tlbwi&#x27; to write CP0.EntryHi/Lo into TLB at CP0.Index  */</span><br><span class="line">    /* Exercise 2.8: Your code here. (2/2) */</span><br><span class="line">    tlbwi // 将EntryHi和EntryLo0/EntryLo1写入TLB中Index寄存器对应的表项</span><br><span class="line">    nop</span><br><span class="line">.set reorder</span><br><span class="line"></span><br><span class="line">NO_SUCH_ENTRY:</span><br><span class="line">    mtc0    t0, CP0_ENTRYHI // 将t0的值存回EntryHi寄存器，恢复原值</span><br><span class="line">    j       ra // 返回调用者</span><br><span class="line">END(tlb_out)</span><br></pre></td></tr></table></figure>
<h4 id="thinking-2-6-函数调用与-cpu-访存流程">Thinking 2.6 函数调用与 CPU 访存流程</h4>
<blockquote>
<p>请结合 Lab2 开始的 CPU 访存流程与下图中的 Lab2 用户函数部分，尝试将函数调用与CPU访存流程对应起来，思考函数调用与CPU访存流程的关系。</p>
</blockquote>
<p>在Lab2中，CPU 访存流程与函数调用的关系紧密，Lab2在 MOS 系统的作用是管理虚拟内存和页表，保证用户程序的运行。函数调用与CPU访存流程的关系紧密，函数调用涉及到内存的访问和操作，而CPU访存流程则是实现这些操作的基础。</p>
<ol>
<li>在内核初始化阶段，CPU 需要初始化内存管理模块，检测物理内存范围并建立虚拟内存系统。调用<code>mips_detect_memory</code>、<code>mips_vm_init</code>、<code>page_init</code>，确保系统能够正确管理物理内存并支持虚拟内存。</li>
<li>在用户进程运行阶段，CPU通过虚拟地址访问内存。若虚拟地址在TLB中命中，则直接完成访存；若TLB miss，则触发异常处理，随即调用<code>do_tlb_refill</code>、<code>page_lookup</code>、<code>passive_alloc</code>、<code>page_alloc</code>、<code>page_insert</code>、<code>tlb_invalidate</code>等函数，缺页异常处理依赖于内存管理函数的调用，这些函数负责分配物理页并更新页表，从而解决缺页问题。</li>
</ol>
<h4 id="thinking-2-7-其他体系结构的内存管理">Thinking 2.7 其他体系结构的内存管理</h4>
<blockquote>
<p>从下述三个问题中任选其一回答：</p>
<ul>
<li>简单了解并叙述X86体系结构中的内存管理机制，比较X86和MIPS 在内存管理上的区别。</li>
<li>简单了解并叙述RISC-V 中的内存管理机制，比较RISC-V 与 MIPS 在内存管理上的区别。</li>
<li>简单了解并叙述LoongArch 中的内存管理机制，比较 LoongArch 与 MIPS 在内存管理上的区别</li>
</ul>
</blockquote>
<ol>
<li>
<p><strong>X86体系结构中的内存管理机制</strong><br>
X86体系结构中的内存管理机制主要包括以下几个关键部分：</p>
<ol>
<li><strong>分段机制</strong>：X86使用分段机制使用段描述符来定义内存区域，划分为多个段，每个段都有自己的基地址、限长和访问权限等。虚拟地址被分为段选择符和段内偏移。CPU通过段选择符找到对应的段描述符，再根据段描述符中的基地址和限长计算出物理地址。</li>
<li><strong>分页机制</strong>：X86使用分页机制将内存划分为固定大小的页（通常为4KB），并通过多级（通常是二级或三级）页表将虚拟地址映射到物理地址。分页的主要目的是提供内存隔离和内存保护。</li>
<li>在X86系统中，分段和分页机制可以结合使用，也可以单独使用。结合使用时，分段提供逻辑上的内存组织，而分页提供物理上的内存映射，即使用段内偏移作为分页的虚拟地址，再通过页表进行映射得到最终物理地址。</li>
<li><strong>内存保护</strong>：段描述符和页表项中包含访问权限（如读、写、执行），CPU会根据当前的特权级（CPL）检查访问是否合法。X86有四个特权级（Ring 0到Ring 3），内核通常运行在Ring 0，用户进程运行在Ring 3。</li>
</ol>
</li>
<li>
<p><strong>X86和MIPS在内存管理上的区别</strong></p>
<ul>
<li>X86采用的是段页式内存管理机制，而MMIPS采用的是页式内存管理机制。</li>
<li>X86的段描述符和页表项中包含更多的信息，如访问权限、特权级等，而MIPS的页表项中只包含页的物理地址。</li>
<li>在TLB处理方面，TLB miss时，X86直接由硬件的 MMU 处理，使用段描述符和页表项中的信息进行地址转换，并更新TLB；而MIPS则会触发异常，将控制权交给操作系统内核，由内核中的相应程序处理异常并更新TLB。</li>
<li>X86是CISC（复杂指令集计算机）架构，支持64位逻辑地址并可以转换为32位物理地址指令集丰富；而MIPS是RISC（精简指令集计算机）架构，地址空间为32位，指令集相对简单。</li>
</ul>
</li>
</ol>
<h4 id="thinking-a-1-三级页表">Thinking A.1 三级页表</h4>
<blockquote>
<p>在现代的 64 位系统中，提供了 64 位的字长，但实际上不是 64 位页式存储系统。假设在64位系统中采用三级页表机制，页面大小4KB。由于64位系统中字长为8B，且页目录也占用一页，因此页目录中有512 个页目录项，因此每级页表都需要9位。因此在64位系统下，总共需要3×9+12=39位就可以实现三级页表机制，并不需要64位。<br>
现考虑上述39位的三级页式存储系统，虚拟地址空间为512GB，若三级页表的基地址为PTbase，请计算：</p>
<ul>
<li>三级页表页目录的基地址。</li>
<li>映射到页目录自身的页目录项（自映射）。</li>
</ul>
</blockquote>
<ol>
<li>39位的三级页式存储系统中，虚拟地址空间为512GB，页面大小为4KB，因此共有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mn>39</mn><mo>−</mo><mn>12</mn></mrow></msup><mo>=</mo><msup><mn>2</mn><mn>27</mn></msup></mrow><annotation encoding="application/x-tex">2^{39-12}=2^{27}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">39</span><span class="mbin mtight">−</span><span class="mord mtight">12</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">27</span></span></span></span></span></span></span></span></span></span></span></span>个页。则根据三级页表的基地址<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">PT_{base}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>可得页号PN为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">PT_{base}&gt;&gt;12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span></span></span></span>，即由第PN个页表项映射得到该三级页表。根据三级页表的基地址是由二级页表的第一个页表项映射得到，因此二级页表的基地址<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>M</mi><msub><mi>D</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>=</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>+</mo><mi>P</mi><mi>N</mi><mo>×</mo><mn>8</mn><mo>=</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>+</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">PMD_{base}=PT_{base} + PN×8=PT_{base} + PT_{base}&gt;&gt;9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">PM</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">PN</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span>。根据二级页表的基地址是由一级页表的第一个页表项映射得到，因此一级页表的基地址<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>G</mi><msub><mi>D</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>=</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>+</mo><mi>P</mi><mi>M</mi><msub><mi>D</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>9</mn><mo>=</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>+</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>9</mn><mo>+</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>18</mn></mrow><annotation encoding="application/x-tex">PGD_{base}=PT_{base} + PMD_{base}&gt;&gt;9 = PT_{base} + PT_{base}&gt;&gt;9 + PT_{base}&gt;&gt;18</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">PG</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">PM</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">18</span></span></span></span>，也就是三级页表页目录的基地址<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>G</mi><msub><mi>D</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">PGD_{base}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">PG</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li>求映射到页目录自身的页目录项（自映射）的页目录项，页号为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>G</mi><msub><mi>D</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">PGD_{base}&gt;&gt;12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">PG</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span></span></span></span>, 即由第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>G</mi><msub><mi>D</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">PGD_{base}&gt;&gt;12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">PG</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span></span></span></span>个页表项映射得到，因此该页目录项的地址为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>+</mo><mi>P</mi><mi>G</mi><msub><mi>D</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>12</mn><mo>×</mo><mn>8</mn><mo>=</mo><mi>P</mi><mi>G</mi><msub><mi>D</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>=</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>+</mo><mi>P</mi><mi>M</mi><msub><mi>D</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>9</mn><mo>=</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>+</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>9</mn><mo>+</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>18</mn><mo>+</mo><mi>P</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>&gt;</mo><mo>&gt;</mo><mn>27</mn></mrow><annotation encoding="application/x-tex">PT_{base} + PGD_{base}&gt;&gt;12×8=PGD_{base}=PT_{base} + PMD_{base}&gt;&gt;9 = PT_{base} + PT_{base}&gt;&gt;9 + PT_{base}&gt;&gt;18 + PT_{base}&gt;&gt;27</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">PG</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">12</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">PG</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">PM</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">18</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ba</span><span class="mord mathnormal mtight">se</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">27</span></span></span></span>。</li>
</ol>
<h3 id="part2-难点分析">Part2. 难点分析</h3>
<h4 id="链表宏与-page-list-结构体">链表宏与 Page_list 结构体</h4>
<p><a href="#thinking-23-page_list-%E7%BB%93%E6%9E%84%E4%BD%93">Thinking 2.3 Page_list 结构体</a> 中涉及到了链表宏定义，主要的难点在于其中的<strong>le_prev</strong>，注释中描述其为 address of previous next element，即元素 A 的<strong>le_prev</strong>指向前一个元素 B 的<strong>le_next</strong>指针的地址，这是一个<strong>指针的指针！</strong> 而且更为有意思的是，上一个元素 B 的 <strong>le_next</strong> 指针指向的是这个元素 A。换言之，是<strong>指向自己的指针</strong>的指针！<br>
可为什么要使用这个<strong>指针的指针</strong>呢？仔细思考一下，链表中的每个元素都有一个<strong>le_next</strong>指针，指向下一个元素的地址，而<strong>le_prev</strong>指针指向的是上一个元素的<strong>le_next</strong>指针的地址，这样做的目的是为了方便删除链表中的元素(比如当前元素)，即通过修改前一个元素的<strong>le_next</strong>指针和下一个元素的<strong>le_prev</strong>指针，即可删除当前元素。对于插入来说就更明显了，因为要插入一个元素，需要修改前一个元素的<strong>le_next</strong>指针和下一个元素的<strong>le_prev</strong>指针（当然还有它自己的<strong>le_prev</strong>和<strong>le_next</strong>），使用<strong>le_prev</strong>可以很方便地修改上一个元素的<strong>le_next</strong>指针，而不用费时费力去遍历整个链表，<strong>LIST_INSERT_BEFORE</strong>和<strong>LIST_INSERT_AFTER</strong>这两个宏就很直观地体现了这一点。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> LIST_INSERT_BEFORE(listelm, elm, field) \</span></span><br><span class="line"><span class="meta">    do &#123; \</span></span><br><span class="line"><span class="meta">        (elm)-&gt;field.le_prev = (listelm)-&gt;field.le_prev; \</span></span><br><span class="line"><span class="meta">        LIST_NEXT((elm), field) = (listelm); \</span></span><br><span class="line"><span class="meta">        *(listelm)-&gt;field.le_prev = (elm); \</span></span><br><span class="line"><span class="meta">        (listelm)-&gt;field.le_prev = &amp;LIST_NEXT((elm), field); \</span></span><br><span class="line"><span class="meta">    &#125; while (0)</span></span><br></pre></td></tr></table></figure>
<p>理解了<strong>le_prev</strong>的作用，那么<strong>Page_list</strong>结构体就很好理解了，它是一个能够访问前一个元素的next字段、方便插入删除的链表。</p>
<h4 id="tlb的原理和实现-地址转换">TLB的原理和实现&amp;地址转换</h4>
<p>实验环境中的TLB是一个二级页表（页目录和页表），它将虚拟地址转换成物理地址，具体组成可以参考下图</p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202506272047412.jpg" alt="二级页表实现机制"></p>
<p>一级页表项(页目录)偏移量 = 虚拟地址的[31:22]，可以根据它和一级页表基地址找到对应的二级页表项(页表)的基地址，再根据虚拟地址中的二级页表(页表)偏移量[21:12]和基地址找到对应的物理页框号(页框)，最后根据虚拟地址中的页内偏移量[11:0]找到对应的物理地址。所以为了得到物理地址，我们需要以下几个参数：</p>
<ul>
<li>虚拟地址</li>
<li>一级页表基地址(页目录基地址)</li>
<li>二级页表基地址(一级页表项，虚拟地址的[31:22])</li>
<li>物理页框号(二级页表项，虚拟地址的[21:12])</li>
<li>页内偏移量(虚拟地址的[11:0])</li>
</ul>
<p>因此Lab2关于TLB的实验就围绕这几个参数展开。我们需要时刻清楚自己所使用的参数是什么，尤其是虚拟地址<strong>va</strong>和物理地址<strong>pa</strong>等等，这里再放一张指导书中图帮助理解(体现了具体代码实现)</p>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202506272048180.jpg" alt="TLB相关函数流程"></p>
<p><strong>建议多多查阅指导书中关于TLB的描述，理解其原理，再结合代码实现，这样会事半功倍。</strong></p>
<h3 id="实验体会">实验体会</h3>
<p>通过本次实验，我更深刻理解了虚拟地址和物理地址的转换过程，以及我们的MOS设计中的两级页表实现机制。同时，我对于指针的使用有了更深的理解，尤其是链表指针的使用。配合OS理论课中的内存管理相关内容食用更佳！</p>
<h3 id="参考资料">参考资料</h3>
<ul>
<li><a href="https://wokron.github.io/posts/buaa-os-lab2/">wokron 学长的博客</a></li>
<li><a href="http://www.hugohealthy.top/2024/04/24/os-lab2%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/">Hugo 学长的博客</a></li>
<li><a href="https://argithun.github.io/2023/03/15/os-lab2/">Argithun 学长的博客</a></li>
<li><a href="https://chatgpt.com/">ChatGPT老师</a></li>
<li><a href="https://deepseek.com/">DeepSeek老师</a></li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
        <category>OS</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>OS</tag>
        <tag>Linux</tag>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title>lab3 实验报告 [BUAA-OS]</title>
    <url>/2025/06/27/OS-lab3/</url>
    <content><![CDATA[<h2 id="lab3实验报告">Lab3实验报告</h2>
<h3 id="part1-思考题">Part1. 思考题</h3>
<h4 id="thinking-3-1-对物理地址和虚拟地址的理解">Thinking 3.1 对物理地址和虚拟地址的理解</h4>
<blockquote>
<p>请结合MOS中的页目录自映射应用解释代码中<code>e-&gt;env_pgdir[PDX(UVPT)] = PADDR(e-&gt;env_pgdir) | PTE_V</code> 的含义。</p>
</blockquote>
<ul>
<li><code>UVPT</code>是一个虚拟地址，表示用户进程页表的起始地址。<code>PDX(UVPT)</code>是<code>UVPT</code>地址的页目录项的索引（页目录中第<code>PDX(UVPT)</code>个页表项）。</li>
<li><code>e-&gt;env_pgdir[PDX(UVPT)]</code>是用户进程<code>UVPT</code>的页目录项。</li>
<li><code>PADDR(e-&gt;env_pgdir)</code>是将页目录的虚拟地址转换为物理地址。<code>PTE_V</code>表示该页表项有效。</li>
<li><code>e-&gt;env_pgdir[PDX(UVPT)] = PADDR(e-&gt;env_pgdir) | PTE_V</code>的含义是将页目录中第<code>PDX(UVPT)</code>个页表项设置为指向物理地址<code>PADDR(e-&gt;env_pgdir)</code>，并标记为有效。这样做的目的是实现自映射，使得用户进程可以通过虚拟地址<code>UVPT</code>访问自己的页目录，从而实现对页表的访问和操作。</li>
</ul>
<h4 id="thinking-3-2-data-的作用">Thinking 3.2 data 的作用</h4>
<blockquote>
<p><code>elf_load_seg</code> 以函数指针的形式，接受外部自定义的回调函数 <code>map_page</code>。请你找到与之相关的 <code>data</code> 这一参数在此处的来源，并思考它的作用。没有这个参数可不可以？为什么？</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in lib/elfloader.c</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">elf_load_seg</span><span class="params">(Elf32_Phdr *ph, <span class="type">const</span> <span class="type">void</span> *bin, <span class="type">elf_mapper_t</span> map_page, <span class="type">void</span> *data)</span> &#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">if</span> (offset != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> ((r = map_page(data, va, offset, perm, bin,</span><br><span class="line">				  MIN(bin_size, PAGE_SIZE - offset))) != <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> r;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    ...</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// in kern/env.c</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">load_icode_mapper</span><span class="params">(<span class="type">void</span> *data, u_long va, <span class="type">size_t</span> offset, u_int perm, <span class="type">const</span> <span class="type">void</span> *src,</span></span><br><span class="line"><span class="params">			     <span class="type">size_t</span> len)</span> &#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Env</span> *<span class="title">env</span> =</span> (<span class="keyword">struct</span> Env *)data;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">p</span>;</span></span><br><span class="line">	<span class="type">int</span> r;</span><br><span class="line">	<span class="keyword">if</span> ((r = page_alloc(&amp;p)) != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (src != <span class="literal">NULL</span>) &#123;</span><br><span class="line">		<span class="built_in">memcpy</span>((<span class="type">void</span> *)(page2kva(p) + offset), src, len);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> page_insert(env-&gt;env_pgdir, env-&gt;env_asid, p, va, perm);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">load_icode</span><span class="params">(<span class="keyword">struct</span> Env *e, <span class="type">const</span> <span class="type">void</span> *binary, <span class="type">size_t</span> size)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">	ELF_FOREACH_PHDR_OFF (ph_off, ehdr) &#123;</span><br><span class="line">		Elf32_Phdr *ph = (Elf32_Phdr *)(binary + ph_off);</span><br><span class="line">		<span class="keyword">if</span> (ph-&gt;p_type == PT_LOAD) &#123;</span><br><span class="line">			<span class="comment">// &#x27;elf_load_seg&#x27; is defined in lib/elfloader.c</span></span><br><span class="line">			<span class="comment">// &#x27;load_icode_mapper&#x27; defines the way in which a page in this segment</span></span><br><span class="line">			<span class="comment">// should be mapped.</span></span><br><span class="line">			panic_on(elf_load_seg(ph, binary + ph-&gt;p_offset, load_icode_mapper, e));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>查阅代码可以发现，<code>data</code>参数的来源是<code>load_icode</code>函数中传入的参数<code>e</code>，它是一个指向<code>struct Env</code>类型的指针，表示当前进程的控制块指针，包含了进程的相关信息，如<code>env_pgdir</code>、<code>env_asid</code>等。</li>
<li>如果没有<code>data</code>参数，那么<code>load_icode_mapper</code>函数将无法获取到当前进程的页目录和ASID，也就无法正确地调用<code>page_insert</code>函数来将物理页映射到虚拟地址空间中。所以必须要有<code>data</code>参数提供上下文信息，使得回调函数能够正确地执行映射操作。</li>
</ul>
<h4 id="thinking-3-3-elf-load-esg-的不同情况">Thinking 3.3 elf_load_esg 的不同情况</h4>
<blockquote>
<p>结合 <code>elf_load_seg</code> 的参数和实现，考虑该函数需要处理哪些页面加载的情况。</p>
</blockquote>
<p><code>elf_load_seg</code> 函数的实现主要负责将 ELF 文件的一个段加载到内存中。有以下几种情况需要处理：</p>
<ol>
<li><strong>段的起始地址未对齐到页面边界</strong><br>
ELF 段的虚拟地址 <code>ph-&gt;p_vaddr</code> 可能不是页面大小的整数倍。如果地址未对齐（<code>offset != 0</code>），需要特殊处理段的第一个页面：只加载从 <code>offset</code> 开始的部分内容，并使用 <code>MIN(bin_size, PAGE_SIZE - offset)</code> 确保不会越界。</li>
</ol>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">u_long offset = va - ROUNDDOWN(va, PAGE_SIZE);</span><br><span class="line"><span class="keyword">if</span> (offset != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((r = map_page(data, va, offset, perm, bin,</span><br><span class="line">                MIN(bin_size, PAGE_SIZE - offset))) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// bin_size 可能小于页面剩余部分大小</span></span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><strong>加载段的文件内容到内存</strong><br>
按页面大小（<code>PAGE_SIZE</code>）循环加载文件内容，直到文件内容全部加载完毕。每次调用 <code>map_page</code> 将一页数据映射到虚拟地址空间。</li>
</ol>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Step 1: load all content of bin into memory. */</span></span><br><span class="line"><span class="keyword">for</span> (i = offset ? MIN(bin_size, PAGE_SIZE - offset) : <span class="number">0</span>; i &lt; bin_size; i += PAGE_SIZE) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((r = map_page(data, va + i, <span class="number">0</span>, perm, bin + i, MIN(bin_size - i, PAGE_SIZE))) !=</span><br><span class="line">        <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong>段的文件大小小于内存大小，分配额外的内存页面</strong><br>
当文件大小（<code>bin_size</code>）小于段的内存大小（<code>sgsize</code>）时，分配额外的页面直到达到 <code>sgsize</code>，传递 NULL 表示这些页面不需要初始化数据。</li>
</ol>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Step 2: alloc pages to reach `sgsize` when `bin_size` &lt; `sgsize`. */</span></span><br><span class="line"><span class="keyword">while</span> (i &lt; sgsize) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((r = map_page(data, va + i, <span class="number">0</span>, perm, <span class="literal">NULL</span>, MIN(sgsize - i, PAGE_SIZE))) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">    i += PAGE_SIZE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="thinking-3-4-epc-的含义">Thinking 3.4 EPC 的含义</h4>
<blockquote>
<p>你认为这里的 <code>env_tf.cp0_epc</code> 存储的是物理地址还是虚拟地址?</p>
</blockquote>
<ul>
<li>存储的是虚拟地址。<code>env_tf.cp0_epc</code> 保存的是发生异常时的指令地址，<code>load_icode</code> 函数中<code>e-&gt;env_tf.cp0_epc</code>设置为<code>ehdr-&gt;e_entry</code>，即 ELF 文件中的程序入口地址。这个地址是虚拟地址。</li>
</ul>
<h4 id="thinking-3-5-异常处理函数的实现位置">Thinking 3.5 异常处理函数的实现位置</h4>
<blockquote>
<p>试找出0、1、2、3号异常处理函数的具体实现位置。8号异常（系统调用）涉及的<code>do_syscall()</code>函数将在Lab4中实现。</p>
</blockquote>
<p>首先查看<code>kern/trap.c</code>文件</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// kern/trap.c</span></span><br><span class="line"><span class="comment">// 定义了异常处理函数</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">handle_int</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">handle_tlb</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">handle_sys</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">handle_mod</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">handle_reserved</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> (*exception_handlers[<span class="number">32</span>])(<span class="type">void</span>) = &#123;</span><br><span class="line">    [<span class="number">0</span> ... <span class="number">31</span>] = handle_reserved, <span class="comment">// 默认处理函数</span></span><br><span class="line">    [<span class="number">0</span>] = handle_int, <span class="comment">// 0号异常处理函数</span></span><br><span class="line">    [<span class="number">2</span> ... <span class="number">3</span>] = handle_tlb, <span class="comment">// 2、3号异常处理函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> !defined(LAB) || LAB &gt;= 4</span></span><br><span class="line">    [<span class="number">1</span>] = handle_mod, <span class="comment">// 1号异常处理函数</span></span><br><span class="line">    [<span class="number">8</span>] = handle_sys, <span class="comment">// 8号异常处理函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 未定义异常的处理函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">do_reserved</span><span class="params">(<span class="keyword">struct</span> Trapframe *tf)</span> &#123;</span><br><span class="line">	print_tf(tf);</span><br><span class="line">	panic(<span class="string">&quot;Unknown ExcCode %2d&quot;</span>, (tf-&gt;cp0_cause &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x1f</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现在<code>kern/genex.S</code>中有异常函数的定义</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># kern/genex.S</span><br><span class="line">.macro BUILD_HANDLER exception handler </span><br><span class="line">NESTED(handle_\exception, TF_SIZE + 8, zero)</span><br><span class="line">	move    a0, sp</span><br><span class="line">	addiu   sp, sp, -8</span><br><span class="line">	jal     \handler</span><br><span class="line">	addiu   sp, sp, 8</span><br><span class="line">	j       ret_from_exception</span><br><span class="line">END(handle_\exception)</span><br><span class="line">.endm</span><br><span class="line"></span><br><span class="line">.text</span><br><span class="line"></span><br><span class="line">FEXPORT(ret_from_exception)</span><br><span class="line">	RESTORE_ALL</span><br><span class="line">	eret</span><br><span class="line"></span><br><span class="line">NESTED(handle_int, TF_SIZE, zero)</span><br><span class="line">	mfc0    t0, CP0_CAUSE</span><br><span class="line">	mfc0    t2, CP0_STATUS</span><br><span class="line">	and     t0, t2</span><br><span class="line">	andi    t1, t0, STATUS_IM7</span><br><span class="line">	bnez    t1, timer_irq</span><br><span class="line">timer_irq:</span><br><span class="line">	li      a0, 0</span><br><span class="line">	j       schedule</span><br><span class="line">END(handle_int)</span><br><span class="line"></span><br><span class="line">BUILD_HANDLER tlb do_tlb_refill</span><br><span class="line"></span><br><span class="line">#if !defined(LAB) || LAB &gt;= 4</span><br><span class="line">BUILD_HANDLER mod do_tlb_mod</span><br><span class="line">BUILD_HANDLER sys do_syscall</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">BUILD_HANDLER reserved do_reserved</span><br></pre></td></tr></table></figure>
<ul>
<li>0号异常处理函数<code>handle_int</code>在<code>kern/genex.S</code>中实现</li>
<li>其他异常处理函数则通过宏<code>BUILD_HANDLER</code>实现。<code>BUILD_HANDLER</code> 是一个汇编宏，用于生成异常处理函数的框架代码，其中 <code>exception</code> 是异常名称，用于生成我们在<code>kern/trap.c</code>看到的异常处理函数的名称（如 <code>handle_tlb</code>），<code>handler</code> 是实际的异常处理函数（如 <code>do_tlb_refill</code>），也就是我们要找的函数具体实现，<code>do_reserved</code> 在 <code>kern/trap.c</code> 中，其余在<code>kern/tlbex.c</code> 中。</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in kern/tlbex.c</span></span><br><span class="line"><span class="type">void</span> _do_tlb_refill(u_long *pentrylo, u_int va, u_int asid)&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">do_tlb_mod</span><span class="params">(<span class="keyword">struct</span> Trapframe *tf)</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="thinking-3-6-时钟的设置">Thinking 3.6 时钟的设置</h4>
<blockquote>
<p>阅读 <code>entry.S</code>、<code>genex.S</code> 和 <code>env_asm.S</code> 这几个文件，并尝试说出时钟中断在哪些时候开启，在哪些时候关闭。</p>
</blockquote>
<ul>
<li><strong>关闭时钟中断</strong><br>
在<code>kern/entry.S</code>中，<code>.text.exc_gen_entry</code> 段通过 <code>and t0,t0, ~(STATUS_UM | STATUS_EXL| STATUS_IE)</code> 关闭时钟中断。<code>STATUS_UM</code>表示用户模式，<code>STATUS_EXL</code>表示异常模式，<code>STATUS_IE</code>表示中断使能位，随后取出对应的异常码，跳转到<code>exception_handlers</code> 数组中的中断处理函数中。</li>
<li><strong>开启时钟中断</strong><br>
时钟中断由 <code>kern/genex.S</code>中的<code>handle_int</code>函数处理，<code>handle_int</code>函数中通过<code>bnez t1, timer_irq</code>判断是否是时钟中断，如果是，则调用<code>schedule</code>函数。查看<code>kern/sched.c</code>中的<code>schedule</code>函数，发现它会调用<code>kern/env.c</code>中的<code>env_run</code>函数，<code>env_run</code>函数中又不返回地调用了<code>kern/env_asm.S</code>中的<code>env_pop_tf</code>函数，通过它的 <code>RESET_KCLOCK</code> 重设时钟中断，随后<code>j ret_from_exception</code>指令跳转到<code>kern/genex.S</code>中的<code>ret_from_exception</code>函数，在 <code>RESTORE_ALL</code> 宏中恢复了Status寄存器，开启了中断，最终调用<code>eret</code>指令，会将<code>EXL</code>设置为0，返回用户态。此时Status中的<code>UM</code>、<code>IE</code>均已被设置为1，表示在用户模式下且开启中断。之后第一个进程成功以用户模式运行，这时操作系统也可以正常响应中断了。</li>
</ul>
<h4 id="thinking-3-7-进程的调度">Thinking 3.7 进程的调度</h4>
<blockquote>
<p>阅读相关代码，思考操作系统是怎么根据时钟中断切换进程的。</p>
</blockquote>
<p><code>RESET_KCLOCK</code>宏设定了时钟中断的周期。指导书中提到，一旦时钟中断产生，就会触发4KC硬件的异常中断处理流程。系统将PC指向0x80000180，跳转到<code>.text.exc_gen_entry</code>代码段执行。对于时钟引起的中断，通过<code>.text.exc_gen_entry</code>代码段的分发，最终会调用<code>handle_int</code>函数进行处理。<br>
<code>handle_int</code>函数会在时钟中断时进入<code>schedule</code>函数进行调度。进程切换会在四种情况下发生：</p>
<ol>
<li>进程主动放弃CPU（调用<code>sys_yield</code>）；</li>
<li>进程时间片耗尽（<code>count &lt;= 0</code>）；</li>
<li>进程被阻塞或退出（<code>e-&gt;env_status == ENV_NOT_RUNNABLE</code>）；</li>
<li>当前无进程运行（<code>e == NULL</code>）。</li>
</ol>
<p>接着检查如果当前有进程运行（<code>e != NULL</code>），则从<code>env_sched_list</code>队列中移除当前进程，检查该进程是否仍然处于可运行状态（<code>e-&gt;env_status == ENV_RUNNABLE</code>），如果是，则将其插入到队列的末尾，从队首取一个新的进程（<code>e = TAILQ_FIRST(&amp;env_sched_list)</code>），并根据优先级设置时间片长度（<code>count = e-&gt;env_pri</code>）。最后，时钟片数量减一，调用<code>env_run</code>函数。</p>
<h3 id="part2-难点分析">Part2. 难点分析</h3>
<h4 id="进程与内存空间">进程与内存空间</h4>
<p>每个进程都认为自己是独占内存空间的，因此，在实现进程时，需要为每个进程分配独立的内存空间。在<code>env.c</code>中，<code>env_setup_vm</code>函数为每个进程分配了独立的页表，并初始化了页表。<code>env_create</code>函数则根据<code>envs</code>数组中的进程信息，为每个进程分配了独立的内存空间。<br>
值得一提的是，“MOS 操作系统特意将一些内核的数据暴露到用户空间”，因此，在<code>env_setup_vm</code>函数中，<code>UTOP</code>以上到 <code>UVPT</code> 之间的只读空间被拷贝到了用户进程的页表中，这样，用户进程就可以访问内核的数据了。</p>
<h4 id="关于异常分发">关于异常分发</h4>
<p>中断处理和分发的过程用到了很多函数和宏，需要对指导书和相关代码进行仔细阅读和理解。Thinking 3.5 和 3.6 中的分析可以帮助我们更好理解异常分发的过程。</p>
<h4 id="异常重入">异常重入</h4>
<p>在异常分发中，我们使用了 <code>SAVE_ALL</code> 宏来保存上下文到<strong>内核的异常栈</strong>中，查看<code>include/stackframe.h</code> 中 <code>SAVE_ALL</code> 宏的实现：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.macro SAVE_ALL</span><br><span class="line">.set noat</span><br><span class="line">.set noreorder</span><br><span class="line">	mfc0    k0, CP0_STATUS</span><br><span class="line">	andi    k0, STATUS_UM</span><br><span class="line">	beqz    k0, 1f</span><br><span class="line">	move    k0, sp</span><br><span class="line">	/*</span><br><span class="line">	* If STATUS_UM is not set, the exception was triggered in kernel mode.</span><br><span class="line">	* $sp is already a kernel stack pointer, we don&#x27;t need to set it again.</span><br><span class="line">	*/</span><br><span class="line">	li      sp, KSTACKTOP</span><br><span class="line">1:</span><br><span class="line">	subu    sp, sp, TF_SIZE</span><br><span class="line">	...</span><br><span class="line">.set at</span><br><span class="line">.set reorder</span><br><span class="line">.endm</span><br></pre></td></tr></table></figure>
<p><code>SAVE_ALL</code>宏首先判断了当前是否已经陷入内核态（异常重入），否则需要将sp寄存器指向内核异常栈（KSTACKTOP），从而实现<strong>在异常中处理异常</strong>，避免破坏已有的异常栈。</p>
<h3 id="part3-实验体会">Part3. 实验体会</h3>
<p>通过本次实验，我深入理解进程的概念并进行实践，掌握了进程的创建、调度、异常分发等过程。本次实验需要完成的代码并不算困难，但涉及的知识点较多，尤其是进程调度的实现，需要仔细阅读相关代码，理解每个函数的作用和实现原理。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>OS</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>OS</tag>
        <tag>Linux</tag>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title>lab4 实验报告 [BUAA-OS]</title>
    <url>/2025/06/27/OS-lab4/</url>
    <content><![CDATA[<h2 id="lab4实验报告">Lab4实验报告</h2>
<h3 id="part1-思考题">Part1. 思考题</h3>
<h4 id="thinking-4-1-系统调用的实现">Thinking 4.1 系统调用的实现</h4>
<blockquote>
<ul>
<li>内核在保存现场的时候是如何避免破坏通用寄存器的？</li>
<li>系统陷入内核调用后可以直接从当时的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>0</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">a0-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mord">0</span><span class="mord">−</span></span></span></span>a3参数寄存器中得到用户调用msyscall留下的信息吗？</li>
<li>我们是怎么做到让sys开头的函数“认为”我们提供了和用户调用msyscall时同样的参数的？</li>
<li>内核处理系统调用的过程对Trapframe做了哪些更改？这种修改对应的用户态的变化是什么？</li>
</ul>
</blockquote>
<ol>
<li>每当触发中断或异常时需要进入内核，我们在<em>Exercise 3.10</em>中将<code>.text.exc_gen_entry</code>段放到0x80000180为OS提供异常处理程序的入口，内核会在 <code>kern/entry.S</code> 的<code>exc_gen_entry</code>通过 <code>SAVE_ALL</code> 宏完成现场保存。<code>SAVE_ALL</code> 宏会将所有通用寄存器的值压入栈中(除了<code>k0</code>会被用来保存<code>sp</code>寄存器的值和部分CP0寄存器的值)，从而避免了破坏通用寄存器的值。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.macro SAVE_ALL</span><br><span class="line">.set noat</span><br><span class="line">.set noreorder</span><br><span class="line">    mfc0    k0, CP0_STATUS</span><br><span class="line">    andi    k0, STATUS_UM</span><br><span class="line">    beqz    k0, 1f</span><br><span class="line">    move    k0, sp</span><br><span class="line">    /*</span><br><span class="line">    * If STATUS_UM is not set, the exception was triggered in kernel mode.</span><br><span class="line">    * $sp is already a kernel stack pointer, we don&#x27;t need to set it again.</span><br><span class="line">    */</span><br><span class="line">    li      sp, KSTACKTOP</span><br><span class="line">1:</span><br><span class="line">    subu    sp, sp, TF_SIZE</span><br><span class="line">    sw      k0, TF_REG29(sp)</span><br><span class="line">    mfc0    k0, CP0_STATUS</span><br><span class="line">    sw      k0, TF_STATUS(sp)</span><br><span class="line">    ···</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>
<p>陷入内核在保存现场时<code>$a0-$a3</code>寄存器的值未发生改变，因此可以直接从这几个寄存器中获取用户调用<code>msyscall</code>留下的信息。但随后执行<code>handle_sys</code>函数时，将<code>sp</code>寄存器的值传到<code>$a0</code>中作为<code>do_syscall</code>的参数，因此<code>$a0</code>寄存器的值被修改，无法直接得到。</p>
</li>
<li>
<p>在用户态调用 <code>syscall_*()</code>函数时，前四个参数会被存入寄存器 <code>$a0-$a3</code>，而多余的参数（如果有）会被存入栈中。<br>
当用户调用 msyscall 触发系统调用后，CPU 会切换到内核态并跳转到异常处理入口。在内核态中，异常处理程序会保存用户态的寄存器值，包括 <code>$a0-$a3</code> 和栈指针 sp，以便稍后使用。<br>
在内核中，<code>handle_sys</code> 函数会处理系统调用。它会从保存的寄存器 <code>$a0-$a3</code> 中取出前四个参数，同时从用户栈帧中取出多余的参数（如果有）。这些参数会被传递给 <code>do_syscall</code> 函数，从而完成系统调用的实际处理。<br>
这样，内核能够完整地还原用户调用 msyscall 时传递的所有参数（包括寄存器中的参数和栈中的参数），并将它们传递给内核中的系统调用处理函数。</p>
</li>
<li>
<p>栈中储存的EPC寄存器值会加上4，从而在异常处理完成后，程序会从异常处理函数的下一行继续执行。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tf-&gt;cp0_epc += 4</span><br></pre></td></tr></table></figure>
<p>另外，<code>$v0</code>寄存器的值会被设置为系统调用的返回值。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tf-&gt;regs[2] = func(arg1, arg2, arg3, arg4, arg5)</span><br></pre></td></tr></table></figure>
<h4 id="thinking-4-2-envid2env-的实现">Thinking 4.2 envid2env 的实现</h4>
<blockquote>
<p>思考 envid2env 函数: 为什么 envid2env 中需要判断 e-&gt;env_id != envid 的情况？如果没有这步判断会发生什么情况？</p>
</blockquote>
<p>查看<code>kern/env.c</code>文件中<code>mkenvid()</code>函数</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">u_int <span class="title function_">mkenvid</span><span class="params">(<span class="keyword">struct</span> Env *e)</span> &#123;</span><br><span class="line">    <span class="type">static</span> u_int i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> ((++i) &lt;&lt; (<span class="number">1</span> + LOG2NENV)) | (e - envs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出，低10位的<code>(e - envs)</code>表示当前进程在<code>envs</code>数组中的索引，高位是一个递增的值，每次调用<code>mkenvid()</code>函数，这个值都会增加。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">envid2env</span><span class="params">(u_int envid, <span class="keyword">struct</span> Env **penv, <span class="type">int</span> checkperm)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (envid == <span class="number">0</span>) &#123;</span><br><span class="line">        *penv = curenv;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    e = envs + ENVX(envid);</span><br><span class="line">    <span class="keyword">if</span> (e-&gt;env_status == ENV_FREE || e-&gt;env_id != envid) &#123;</span><br><span class="line">        <span class="keyword">return</span> -E_BAD_ENV;</span><br><span class="line">    &#125;</span><br><span class="line">    ···</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>envid2env()</code>函数中使用<code>ENVX(envid)</code>宏来获取<code>envid</code>的低10位，再通过<code>envs</code>数组来获取对应的<code>Env</code>结构体指针，所以如果某一进程完成后被销毁，则其进程控制块会被插回<code>env_free_list</code>中，再次创建进程时，有可能会复用这个进程控制块，并赋值不同的<code>envid</code>。如果没有判断<code>e-&gt;env_id != envid</code>，则如果传入的<code>envid</code>属于已被销毁的进程，也能够成功获取到对应的<code>Env</code>结构体指针，从而造成错误。</p>
<h4 id="thinking-4-3-mkenvid-的函数细节">Thinking 4.3 mkenvid 的函数细节</h4>
<blockquote>
<p>思考下面的问题，并对这个问题谈谈你的理解：请回顾 kern/env.c 文件中 mkenvid() 函数的实现，该函数不会返回 0，请结合系统调用和 IPC 部分的实现与 envid2env() 函数的行为进行解释。</p>
</blockquote>
<p>在<code>mkenvid()</code>函数中，<code>++i</code>会使得<code>mkenvid()</code>函数返回的<code>envid</code>值高位不为0，因此不会返回0。<strong>在IPC调用<code>envid2env()</code>函数时，<code>envid</code>为0表示当前进程的<code>env_id</code></strong>。如果需要通信的进程B<code>env_id</code>为0，则<code>envid2env()</code>函数会返回当前进程A的<code>Env</code>结构体指针，无法找到进程B的<code>Env</code>结构体指针。执行<code>fork()</code>函数时，<strong><code>envid</code>为0表示子进程的返回值，父进程的返回值是子进程的<code>envid</code></strong>，如果子进程的<code>env_id</code>为0，则会导致父进程无法获取子进程的<code>Env</code>结构体指针，智能够获取当前进程的<code>Env</code>结构体指针。</p>
<h4 id="thinking-4-4-fork-的返回结果">Thinking 4.4 fork 的返回结果</h4>
<blockquote>
<p>关于 fork 函数的两个返回值，下面说法正确的是：<br>
A、fork 在父进程中被调用两次，产生两个返回值<br>
B、fork 在两个进程中分别被调用一次，产生两个不同的返回值<br>
C、fork 只在父进程中被调用了一次，在两个进程中各产生一个返回值<br>
D、fork 只在子进程中被调用了一次，在两个进程中各产生一个返回值</p>
</blockquote>
<p>C</p>
<h4 id="thinking-4-5-用户空间的保护">Thinking 4.5 用户空间的保护</h4>
<blockquote>
<p>我们并不应该对所有的用户空间页都使用 duppage 进行映射。那么究竟哪些用户空间页应该映射，哪些不应该呢？请结合 kern/env.c 中 env_init 函数进行的页面映射、 include/mmu.h 里的内存布局图以及本章的后续描述进行思考。</p>
</blockquote>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202506272053784.jpg" alt="mmu"></p>
<ul>
<li>内核部分是所有用户进程共享的，因此不需要映射。</li>
<li>ULIM到UTOP之间页面的内存和页表是所有进程共享的，且用户进程无权限访问，无需使用<code>duppage()</code>进行映射。</li>
<li>UTOP到USTACKTOP间是用户态下的异常处理栈，不会在处理COW异常时调用 <code>fork()</code> ,所以user exception stack不需要映射。</li>
<li>USTACKTOP以下是用户进程的栈空间，<code>duppage()</code>函数会将其映射到子进程中。</li>
</ul>
<h4 id="thinking-4-6-vpt-的使用">Thinking 4.6 vpt 的使用</h4>
<blockquote>
<p>vpt 和 vpd 的作用是什么？怎样使用它们？</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// user/inlude/lib.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> vpt ((const volatile Pte *)UVPT)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> vpd ((const volatile Pde *)(UVPT + (PDX(UVPT) &lt;&lt; PGSHIFT)))</span></span><br></pre></td></tr></table></figure>
<p>vpd是一个指向页目录首地址的指针，可以通过它访问页目录表pde。vpt是一个指向页表首地址的指针，可以通过它访问页表项pte。</p>
<blockquote>
<p>从实现的角度谈一下为什么进程能够通过这种方式来存取自身的页表？</p>
</blockquote>
<p>OS在初始化页表时，将页表的物理地址映射到特定的虚拟地址空间<code>UVPT</code>中，使得用户进程可以通过<code>vpt</code>和<code>vpd</code>来访问自己的页表。</p>
<blockquote>
<p>它们是如何体现自映射设计的?</p>
</blockquote>
<p>vpd的地址是<code>UVPT + (PDX(UVPT) &lt;&lt; PGSHIFT)</code>，而vpt的地址是<code>UVPT</code>，它们都映射到同一页表中。也就是说，页表中的某一页是页目录。这样，用户进程可以通过<code>vpt</code>和<code>vpd</code>来访问自己的页表，实现自映射设计。</p>
<blockquote>
<p>进程能够通过这种方式来修改自己的页表项吗？</p>
</blockquote>
<p>不能。<code>vpt</code>和<code>vpd</code>是只读的，用户进程不能通过它们来修改自己的页表项。</p>
<h4 id="thinking-4-7-页写入异常-内核处理">Thinking 4.7 页写入异常-内核处理</h4>
<blockquote>
<p>在 do_tlb_mod 函数中，你可能注意到了一个向异常处理栈复制 Trapframe 运行现场的过程，请思考并回答这几个问题：</p>
</blockquote>
<blockquote>
<p>这里实现了一个支持类似于“异常重入”的机制，而在什么时候会出现这种“异常重入”？</p>
</blockquote>
<p>出现COW异常时，内核会调用<code>do_tlb_mod()</code>函数来处理写入异常。此时，内核已经处于异常处理状态，如果在处理过程中再次发生异常，就会出现“异常重入”的情况。</p>
<blockquote>
<p>内核为什么需要将异常的现场 Trapframe 复制到用户空间？</p>
</blockquote>
<p>这是因为，当内核处理COW异常时，<code>do_tlb_mod()</code>函数会返回到<code>user/lib/fork.c</code>中的<code>cow_entry()</code> 。页写入异常主要的处理过程是在用户态下由<code>cow_entry</code>完成，因而需要复制栈，使得用户程序能够访问异常发生时的状态信息。</p>
<h4 id="thinking-4-8-页写入异常-用户处理-1">Thinking 4.8 页写入异常-用户处理-1</h4>
<blockquote>
<p>在用户态处理页写入异常，相比于在内核态处理有什么优势？</p>
</blockquote>
<ul>
<li>尽量减少内核出现错误的可能，即使程序崩溃，错误和崩溃页会被限制在单个进程内，不会影响整个OS的稳定。</li>
<li>MOS操作系统遵从微内核的设计理念，在用户态进行页面的拷贝和写入操作，能够提高系统的性能，减少上下文切换的开销。</li>
</ul>
<h4 id="thinking-4-9-页写入异常-用户处理-2">Thinking 4.9 页写入异常-用户处理-2</h4>
<blockquote>
<p>为什么需要将 syscall_set_tlb_mod_entry 的调用放置在 syscall_exofork 之前？</p>
</blockquote>
<p><code>syscall_exofork()</code>函数会创建一个新的进程，子进程需要指向新的进程的<code>env</code>结构体。此时，子进程的页表和父进程的页表是相同的，因此需要将<code>syscall_set_tlb_mod_entry()</code>函数放置在<code>syscall_exofork()</code>之前，以便在子进程中处理写入异常时能够正确地修改页表项。</p>
<blockquote>
<p>如果放置在写时复制保护机制完成之后会有怎样的效果？</p>
</blockquote>
<p><code>syscall_set_tlb_mod_entry()</code>如果放置在写时复制保护机制完成之后，则栈空间将被设置为COW保护，在访问栈空间时会触发写入异常，此时还没有执行<code>syscall_set_tlb_mod_entry()</code>，因此无法处理写入异常，导致程序崩溃。</p>
<h3 id="part2-难点分析">Part2. 难点分析</h3>
<h4 id="系统调用的实现">系统调用的实现</h4>
<p>在用户态触发一条系统调用，需要：</p>
<ul>
<li>在用户态函数（<code>msyscall</code>/<code>do_syscall</code>）中保存现场（<code>$sp</code>等通用寄存器），并跳转到内核态入口（<code>entry.S</code>）</li>
<li>内核态入口（<code>entry.S</code>）捕获异常、切换到内核栈、保存用户 Trapframe</li>
<li>在 <code>kern/syscall_all.c</code> 中分发到对应的 <code>sys_*</code> 函数</li>
<li><code>sys_*</code> 函数完成系统调用的具体操作，并返回结果</li>
<li>在 <code>kern/entry.S</code> 中恢复现场，返回到用户态函数（<code>msyscall</code>）</li>
<li>在用户态函数（<code>msyscall</code>）中恢复现场，并返回结果到用户态程序</li>
<li>需要注意的是，内核态的现场保存是“重入”的，不能破坏原有的现场（<code>SAVE_ALL</code> 宏）</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202506272052893.jpg" alt="syscall"></p>
<h4 id="envid2env-的实现"><code>envid2env</code> 的实现</h4>
<p>将用户传来的 <code>envid</code> 映射到内核中的 <code>struct Env *</code> 指针，需要：</p>
<ul>
<li>在 <code>kern/syscall_all.c</code> 的 IPC、<code>sys_exofork</code> 等函数里调用，并验证目标进程是否“存在”且“可操作”</li>
<li>如果 <code>envid</code> 不合法，或者跨子/父权限越界，必须返回 <code>-E_BAD_ENV</code>，防止恶意或误操作</li>
</ul>
<h4 id="fork-的返回结果"><code>fork</code> 的返回结果</h4>
<ul>
<li><code>fork()</code> 在父进程中返回新子进程的 <code>envid</code> (&gt; 0)，在子进程中返回 0，而出错时返回 &lt; 0。</li>
<li>父子进程都调用 <code>fork()</code>，但只有父进程会返回新子进程的 <code>envid</code>，子进程则返回 0</li>
<li>这两个返回值是通过 <code>sys_exofork</code> 和 <code>syscall_set_tlb_mod_entry</code> 函数实现的</li>
<li>需要在 <code>sys_exofork</code> 内修改子进程 Trapframe 中的 <code>$v0=0</code>，而在父进程则保留为子 <code>envid</code>。</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202506272053179.jpg" alt="fork"></p>
<h4 id="进程间通信">进程间通信</h4>
<p>进程间通信主要通过两个系统调用实现：<code>sys_ipc_recv</code> 和 <code>sys_ipc_try_send</code>：</p>
<ul>
<li>
<p><strong><code>sys_ipc_recv</code></strong>:</p>
<ul>
<li>接收方进程调用此函数并传递待映射的虚拟地址。</li>
<li>设置当前进程的 <code>env_ipc_recving</code> 为1，表示正在等待接收消息。</li>
<li>将 <code>env_ipc_dstva</code> 设置为传入的虚拟地址。</li>
<li>阻塞当前进程，将其移出调度队列。</li>
<li>调度其他进程运行，等待发送方进程发送消息。</li>
</ul>
</li>
<li>
<p><strong><code>sys_ipc_try_send</code></strong>:</p>
<ul>
<li>发送方进程调用此函数，传入接收方进程的 <code>envid</code>、待发送的值、待映射的虚拟地址以及权限位。</li>
<li>使用 <code>envid2env</code> 验证接收方进程是否存在且可操作。</li>
<li>检查接收方进程的 <code>env_ipc_recving</code> 是否为 1：<strong>如果为 0</strong>，表示接收方未准备好接收消息，则调度其他进程运行，等待轮转到发送方进程时再次尝试发送。<strong>如果为 1</strong>，则完成以下操作：1. 将发送的值传递给接收方进程。2. 如果虚拟地址不为 0，则完成页面的映射。3. 清除接收方的 <code>env_ipc_recving</code> 标志，并将其重新加入调度队列。</li>
</ul>
</li>
<li>
<p><strong>页面复制与映射</strong>:</p>
<ul>
<li>当需要复制一个物理页面并建立用户虚拟地址与新物理页面的映射时：
<ul>
<li>使用 <code>page2kva</code> 将新物理页面转换为内核态虚拟地址。</li>
<li>使用 <code>memcpy</code> 进行数据拷贝。</li>
<li>调用 <code>page_insert</code> 将新物理页面映射到用户虚拟地址。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202506272053840.jpg" alt="IPC"></p>
<h4 id="页写入异常-内核处理">页写入异常——内核处理</h4>
<p>实现写时复制（COW）机制：</p>
<ul>
<li>在 <code>duppage</code> 时把原父进程页设置为 <code>PTE_COW</code> 且清除 <code>PTE_D</code>（可写）</li>
<li>当进程写此页时触发 TLB Mod 异常，进入内核的 <code>do_tlb_mod</code>（<code>tlbex.c</code>）</li>
<li>在异常处理里检测到 <code>PTE_COW</code>，分配新物理页、复制数据、更新页表并让子进程继续执行</li>
</ul>
<h4 id="页写入异常-用户处理">页写入异常——用户处理</h4>
<p>分为两部分：</p>
<ol>
<li><strong>处理入口</strong> (<code>cow_entry</code>)：从内核栈恢复到用户栈时，需要修改 Trapframe 并跳回 <code>cow_entry</code>，检查触发页的 PTE</li>
<li><strong>逻辑恢复</strong>：<code>cow_entry</code> 要在用户态正确地调用 <code>sys_set_tlb_mod_entry</code> 和其他系统调用，才能让后续写操作透明完成</li>
</ol>
<h3 id="part3-实验体会">Part3. 实验体会</h3>
<p>Lab4帮助我深入理解了进程间通信（IPC）和系统调用的流程，并学会了如何实现写时复制（COW）机制。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>OS</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>OS</tag>
        <tag>Linux</tag>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title>lab5 实验报告 [BUAA-OS]</title>
    <url>/2025/06/27/OS-lab5/</url>
    <content><![CDATA[<h2 id="lab5-实验报告">Lab5 实验报告</h2>
<h3 id="part1-思考题">Part1. 思考题</h3>
<h4 id="thinking-5-1-设备操作与高速缓存">Thinking 5.1 设备操作与高速缓存</h4>
<blockquote>
<p>如果通过 kseg0 读写设备，那么对于设备的写入会缓存到 Cache 中。这是一种<strong>错误</strong>的行为，在实际编写代码的时候这么做会引发不可预知的问题。请思考：这么做这会引发什么问题？对于不同种类的设备（如我们提到的串口设备和 IDE 磁盘）、的操作会有差异吗？可以从缓存的性质和缓存更新的策略来考虑。</p>
</blockquote>
<p>当系统崩溃或者断电时，Cache 中的数据可能会丢失或未被写入到设备上，这会导致数据不一致或丢失。另外当访问内核空间时，可能导致设备被错误地写入/读取数据。<br>
对于串口设备，通常是直接进行读写操作，具有即时性且读写频繁，发生数据丢失或不一致的风险高于 IDE 磁盘。</p>
<h4 id="thinking-5-2-单个文件的最大体积-一个磁盘块最多存储的文件控制块及一个目录最多子文件">Thinking 5.2 单个文件的最大体积、一个磁盘块最多存储的文件控制块及一个目录最多子文件</h4>
<blockquote>
<p>查找代码中的相关定义，试回答一个磁盘块中最多能存储多少个文件控制块？一个目录下最多能有多少个文件？我们的文件系统支持的单个文件最大为多大？</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> NDIRECT 10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_STRUCT_SIZE 256</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">File</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> f_name[MAXNAMELEN]; <span class="comment">// filename</span></span><br><span class="line">    <span class="type">uint32_t</span> f_size;	 <span class="comment">// file size in bytes</span></span><br><span class="line">    <span class="type">uint32_t</span> f_type;	 <span class="comment">// file type</span></span><br><span class="line">    <span class="type">uint32_t</span> f_direct[NDIRECT];</span><br><span class="line">    <span class="type">uint32_t</span> f_indirect;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">File</span> *<span class="title">f_dir</span>;</span> <span class="comment">// the pointer to the dir where this file is in, valid only in memory.</span></span><br><span class="line">    <span class="type">char</span> f_pad[FILE_STRUCT_SIZE - MAXNAMELEN - (<span class="number">3</span> + NDIRECT) * <span class="number">4</span> - <span class="keyword">sizeof</span>(<span class="type">void</span> *)];</span><br><span class="line">&#125; __attribute__((aligned(<span class="number">4</span>), packed));</span><br></pre></td></tr></table></figure>
<p>指导书 P114 有如下描述：</p>
<blockquote>
<p>f_direct[NDIRECT]为文件的直接指针，每个文件控制块设有10个直接指针，用来记录文件的数据块在磁盘上的位置。每个磁盘块的大小为4KB，也就是说，这十个直接指针能够表示最大40KB的文件，而当文件的大小大于40KB时，就需要用到间接指针。f_indirect指向一个间接磁盘块，用来存储指向文件内容的磁盘块的指针。为<br>
了简化计算，我们不使用间接磁盘块的前十个指针。f_dir指向文件所属的文件目录。f_pad则是为了让整数个文件结构体占用一个磁盘块，填充结构体中剩下的字节。</p>
</blockquote>
<p>查看<code>user/include/fs.h</code> 文件中的定义和指导书的说明，我们可以知道这是理论课上所说的<strong>多级间接索引结构</strong>：</p>
<ul>
<li>一个磁盘块的大小为4KB（4096字节）。</li>
<li>每个文件控制块（File）占用256字节。</li>
<li>每个文件控制块中有10个直接指针，每个指针占用4字节。</li>
<li>每个磁盘块可以存储的文件控制块数量为：<code>4096 / 256 = 16</code>。</li>
<li>f_indirect指向的间接磁盘块可以存储 <strong>4KB / 4B = 1K</strong> 个指针，所以一个目录文件下最多可以有 <strong>16 * 1024 = 16384</strong> 个文件。</li>
<li>一个文件最多可以使用 <strong>10 + 1K - 10(间接磁盘块的前10个指针) = 1024</strong> 个磁盘块，所以一个文件最大可以有 <strong>1024 * 4KB = 4MB</strong>。</li>
</ul>
<h4 id="thinking-5-3-磁盘最大容量">Thinking 5.3 磁盘最大容量</h4>
<blockquote>
<p>请思考，在满足磁盘块缓存的设计的前提下，我们实验使用的内核支持的最大磁盘大小是多少？</p>
</blockquote>
<p><code>DISKMAP</code> 到<code>DISKMAP+DISKMAX</code>这一段虚存地址空间(0x10000000-0x4FFFFFFF)作为缓冲区，因此最大为<code>DISKMAX</code>，即<strong>1GB</strong>。</p>
<h4 id="thinking-5-4-文件系统进程中宏定义理解">Thinking 5.4 文件系统进程中宏定义理解</h4>
<blockquote>
<p>在本实验中，fs/serv.h、user/include/fs.h 等文件中出现了许多宏定义， 试列举你认为较为重要的宏定义，同时进行解释，并描述其主要应用之处。</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">in fs/serv.h</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DISKMAP 0x10000000 <span class="comment">//磁盘块映射到内存的起点</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DISKMAX 0x40000000 <span class="comment">// 最大磁盘大小</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">in user/include/fs.h</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BLOCK_SIZE PAGE_SIZE <span class="comment">// 每个磁盘块的大小为4KB</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NDIRECT 10 <span class="comment">// 每个文件控制块中直接指针的数量</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NINDIRECT (BLOCK_SIZE / 4) <span class="comment">// 每个文件控制块中间接指针的数量</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FILE_STRUCT_SIZE 256 <span class="comment">// 文件控制块的大小</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FS_MAGIC 0x68286097 <span class="comment">//  Everyone&#x27;s favorite OS class 魔数 MIT 6.828</span></span></span><br></pre></td></tr></table></figure>
<h4 id="thinking-5-5-文件描述符与-fork-函数">Thinking 5.5 文件描述符与 fork 函数</h4>
<blockquote>
<p>在 Lab4“系统调用与 fork”的实验中我们实现了极为重要的 fork 函数。那么 fork 前后的父子进程是否会共享文件描述符和定位指针呢？请在完成上述练习的基础上编写一个程序进行验证。</p>
</blockquote>
<p>会。进程所有的文件描述符都存储在 <strong>[FDTABLE, FILEBASE)</strong> 的地址空间中，位于 <strong>USTACKTOP</strong> 以下。在<code>fork()</code>函数执行时，会调用<code>duppage()</code>函数将这父进程页表中的这部分页表项拷贝到子进程的页表中。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">1000</span>];</span><br><span class="line">    fd = open(<span class="string">&quot;/forkTest&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>((r = fork()) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        user_panic(<span class="string">&quot;Error with fork&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(r == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>((r = read(fd, buf, <span class="number">30</span>)) != <span class="number">30</span>)&#123;</span><br><span class="line">            user_panic(<span class="string">&quot;Error with child read forkTest&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        debugf(<span class="string">&quot;child read is good with  \&quot;%s\&quot;\n&quot;</span>, buf);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>((r = read(fd, buf, <span class="number">28</span>)) != <span class="number">28</span>)&#123;</span><br><span class="line">            user_panic(<span class="string">&quot;Error with father read forkTest&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        debugf(<span class="string">&quot;father read is good with \&quot;%s\&quot;\n&quot;</span>, buf);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in forkTest file</span></span><br><span class="line">we share the file descriptor and the file offset pointer.</span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">child read is good with  &quot;we share the file descriptor &quot;</span><br><span class="line">father read is good with &quot;and the file offset pointer.&quot;</span><br></pre></td></tr></table></figure>
<h4 id="thinking-5-6-文件系统用户接口中的结构体">Thinking 5.6 文件系统用户接口中的结构体</h4>
<blockquote>
<p>请解释 File, Fd, Filefd 结构体及其各个域的作用。比如各个结构体会在哪些过程中被使用，是否对应磁盘上的物理实体还是单纯的内存数据等。说明形式自定，要求简洁明了，可大致勾勒出文件系统数据结构与物理实体的对应关系与设计框架。</p>
</blockquote>
<p>…existing code…</p>
<h4 id="thinking-5-6-文件系统用户接口中的结构体">Thinking 5.6 文件系统用户接口中的结构体</h4>
<blockquote>
<p>请解释 File, Fd, Filefd 结构体及其各个域的作用。比如各个结构体会在哪些过程中被使用，是否对应磁盘上的物理实体还是单纯的内存数据等。说明形式自定，要求简洁明了，可大致勾勒出文件系统数据结构与物理实体的对应关系与设计框架。</p>
</blockquote>
<ul>
<li>
<p><strong>File 结构体（磁盘数据 + 内存缓存）</strong><br>
• f_name：文件名，用于路径解析<br>
• f_size：文件大小（字节），磁盘元信息<br>
• f_type：文件类型（普通/目录/设备），磁盘元信息<br>
• f_direct[N]：直接数据块号数组，指向磁盘上的数据块<br>
• f_indirect：间接块号，指向存放额外块号的磁盘块（多级索引）<br>
• f_dir：内存指针，指向父目录的 File 对象，仅存在内存中<br>
• f_pad：对齐填充，确保 File 结构固定 256 字节</p>
</li>
<li>
<p><strong>Fd 结构体（纯内存描述符）</strong><br>
• fd_dev_id：设备 ID，记录文件所在设备<br>
• fd_offset：当前读写偏移量，仅内存维护，不写回磁盘<br>
• fd_omode：打开模式（只读/写/读写），运行时控制访问权限</p>
</li>
<li>
<p><strong>Filefd 结构体（内存封装 + 缓存）</strong><br>
• f_fd：内存 Fd 结构，用于进程间传递和系统调用<br>
• f_fileid：文件 ID，对应 opentab 索引<br>
• f_file：文件控制块</p>
</li>
</ul>
<p>以上结构共同构成用户接口到磁盘数据的桥梁：<br>
Fd 管理进程级别的打开状态，Filefd 将 Fd 与磁盘数据 File 关联，File 在内存与磁盘间同步文件信息与数据块索引。</p>
<h4 id="thinking-5-7-解释时序图-思考进程间通信">Thinking 5.7 解释时序图，思考进程间通信</h4>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202506272056277.jpg" alt="时序图"></p>
<blockquote>
<p>图5.9中有多种不同形式的箭头，请解释这些不同箭头的差别，并思考我们的操作系统是如何实现对应类型的进程间通信</p>
</blockquote>
<p>查阅 OO第四单元手册，了解时序图中的箭头类型及其含义如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">箭头类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">黑三角箭头搭配黑实线</td>
<td>表示同步消息，消息的发送者把进程控制传递给消息的接收者，然后<strong>暂停活动</strong>，<strong>等待</strong>消息接收者的回应消息</td>
</tr>
<tr>
<td style="text-align:center">开三角箭头搭配黑色实线</td>
<td>表示异步消息，消息的发送者把消息发送给消息的接收者，<strong>不用等待回应的消息</strong>，即可开始另一个活动。</td>
</tr>
<tr>
<td style="text-align:center">用开三角箭头搭配黑色虚线</td>
<td>表示返回关系，返回消息和同步消息结合使用，异步消息不进行等待，无需要知道返回值。</td>
</tr>
</tbody>
</table>
<ul>
<li>首先由init程序调用<code>init()</code>函数执行<code>ENV_CREATE(user_env)</code> 和 <code>ENV_CREATE(fs_serv)</code> 函数创建第0个和第1个线程，来启动用户进程 user_env 和文件系统 fs_serv (必须为第1个线程)。</li>
<li><strong>fs_serv</strong> 进入 fs/serv.c，调用 <code>serv_init()</code> 和 <code>fs_init()</code>函数完成初始化，随后进入 <code>serv()</code>函数，被 <code>ipc_receive()</code> 阻塞，等待 <strong>IPC</strong>。</li>
<li><strong>user_env</strong> 经过 <code>open()</code>-&gt;<code>fsipc_open()</code>-&gt;<code>fsipc()</code>-&gt;<code>ipc_send(fsreq)</code> 的函数调用向 fs 进程发送请求，文件系统 fs_serv 执行完后使用 <code>ipc_send(dst_va)</code> 返回，等待下一次服务 <code>wait_for_next_serv</code>。</li>
</ul>
<h3 id="part2-难点分析">Part2. 难点分析</h3>
<p>本实验的设计主要围绕以下几个难点展开：</p>
<ol>
<li>
<p>跨设备统一接口设计<br>
MOS 通过统一的 Fd 结构将不同设备抽象为文件接口，实现了操作上的一致性。在 <code>fd.c</code> 中提供统一的文件操作函数，而 <code>file.c</code>、<code>console.c</code> 等模块则分别实现各自设备的 Dev 抽象函数，确保上层调用对各种设备均适用。</p>
</li>
<li>
<p>文件服务进程与进程间通信<br>
为了解耦文件操作与设备驱动，实验中构建了专门的文件服务进程 <code>serv.c</code>。该进程利用 <code>fsipc.c</code> 模块实现与用户进程的 IPC 通信，有效分离了文件系统请求与具体设备交互的实现，提高了系统模块的灵活性和可靠性。</p>
</li>
<li>
<p>磁盘块管理与缓存优化<br>
文件服务进程通过 <code>fs.c</code> 模块实现文件级和磁盘块级的数据交互，并采用块缓存机制来优化磁盘 I/O 的性能。所有底层磁盘交互均通过系统调用在 <code>KSEG1</code> 段实现，并由 <code>ide.c</code> 模块支持块或扇区级的直接读写，这种设计大大提升了系统的工作效率。</p>
</li>
</ol>
<h4 id="part3-实验体会">Part3. 实验体会</h4>
<p>在 Lab5 中，我们通过建立统一的数据结构和接口设计、模块化的进程间通信以及高效的磁盘访问策略，实现了一个通用高效的文件系统架构。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>OS</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>OS</tag>
        <tag>Linux</tag>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title>lab6 实验报告 [BUAA-OS]</title>
    <url>/2025/06/27/OS-lab6/</url>
    <content><![CDATA[<h2 id="lab6-实验报告">Lab6 实验报告</h2>
<h3 id="part1-思考题">Part1. 思考题</h3>
<h4 id="thinking-6-1-父进程为读者">Thinking 6.1 父进程为读者</h4>
<blockquote>
<p>示例代码中，父进程操作管道的写端，子进程操作管道的读端。如果现在想让父进程作为“读者”，代码应当如何修改？</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> fildes[<span class="number">2</span>];</span><br><span class="line"><span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> status;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    status = pipe(fildes);</span><br><span class="line">    <span class="keyword">if</span>(status ==<span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;error\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">switch</span>(fork()) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">/*子进程-作为管道的写者*/</span></span><br><span class="line">            close(fildes[<span class="number">0</span>]); <span class="comment">/*关闭不用的读端*/</span></span><br><span class="line">            write(fildes[<span class="number">1</span>],<span class="string">&quot;Hello world\n&quot;</span>,<span class="number">12</span>); <span class="comment">/*向管道中写数据*/</span></span><br><span class="line">            close(fildes[<span class="number">1</span>]); <span class="comment">/*写入结束，关闭写端*/</span></span><br><span class="line">            <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">        <span class="keyword">default</span>: <span class="comment">/*父进程-作为管道的读者*/</span></span><br><span class="line">            close(fildes[<span class="number">1</span>]); <span class="comment">/*关闭不用的写端*/</span></span><br><span class="line">            read(fildes[<span class="number">0</span>],buf, <span class="number">100</span>); <span class="comment">/*从管道中读数据*/</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;parent-processread: %s&quot;</span>,buf); <span class="comment">/*打印读到的数据*/</span></span><br><span class="line">            close(fildes[<span class="number">0</span>]); <span class="comment">/*读取结束，关闭读端*/</span></span><br><span class="line">            <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="thinking-6-2-dup-中的进程竞争">Thinking 6.2 dup 中的进程竞争</h4>
<blockquote>
<p>上面这种不同步修改 pp_ref 而导致的进程竞争问题在  user/lib/fd.c 中的 dup 函数中也存在。请结合代码模仿上述情景，分析一下我们的 dup 函数中为什么会出现预想之外的情况？</p>
</blockquote>
<p>dup 实现里，复制一个文件描述符 oldfd 到 newfd ，总共分两步调用 <code>syscall_mem_map</code> 来完成：</p>
<ol>
<li>映射文件描述符（struct Fd）</li>
<li>映射文件内容对应的内存页（page mapping）</li>
</ol>
<p>这两步会分别对引用计数 pp_ref 做一次“+1”操作。如果在这两次映射之间发生了进程切换，就可能出现下面这种情况：<br>
假设有一个 pipe，引用次数：pp_ref=2，fd[0]=1，fd[1]=1。进程 A 在执行 <code>dup(oldfd, newfd)</code>：</p>
<ol>
<li>第一条 <code>syscall_mem_map(… oldfd → newfd …)</code> 已经执行完毕，fd[0]引用计数被+1，此时 fd[0]=2,</li>
<li>紧接着要执行第二条映射（内容页映射），此时pp_ref 还未+1，但刚好被打断，调度到进程 B。</li>
</ol>
<p>此时进程 B 中如果执行 <code>_pipe_is_closed(fd, p)</code> 则会根据 pp_ref == fd[0] == 2 错误地判断写端关闭，导致错误行为。</p>
<h4 id="thinking-6-3-原子操作">Thinking 6.3 原子操作</h4>
<blockquote>
<p>阅读上述材料并思考：为什么系统调用一定是原子操作呢？如果你觉得不是所有的系统调用都是原子操作，请给出反例。希望能结合相关代码进行分析说明。</p>
</blockquote>
<p>系统调用会陷入内核态，在内核态下，CPU 会屏蔽中断，这样就可以保证系统调用的原子性。也就是说，在执行系统调用期间，CPU 不会被时钟中断打断，因此不会发生上下文切换。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// in entry.S</span><br><span class="line">exc_gen_entry:</span><br><span class="line">	SAVE_ALL</span><br><span class="line">	/*</span><br><span class="line">	* Note: When EXL is set or UM is unset, the processor is in kernel mode.</span><br><span class="line">	* When EXL is set, the value of EPC is not updated when a new exception occurs.</span><br><span class="line">	* To keep the processor in kernel mode and enable exception reentrancy,</span><br><span class="line">	* we unset UM and EXL, and unset IE to globally disable interrupts.</span><br><span class="line">	*/</span><br><span class="line">	mfc0    t0, CP0_STATUS</span><br><span class="line">	and     t0, t0, ~(STATUS_UM | STATUS_EXL | STATUS_IE) </span><br><span class="line">	mtc0    t0, CP0_STATUS</span><br><span class="line">/* Exercise 3.9: Your code here. */</span><br><span class="line">	mfc0 t0, CP0_CAUSE</span><br><span class="line">	andi t0, 0x7c</span><br><span class="line">	lw t0, exception_handlers(t0)</span><br><span class="line">	jr t0</span><br></pre></td></tr></table></figure>
<h4 id="thinking-6-4-解决进程竞争">Thinking 6.4 解决进程竞争</h4>
<blockquote>
<p>仔细阅读上面这段话，并思考下列问题<br>
• 按照上述说法控制 pipe_close 中 fd 和 pipe unmap 的顺序，是否可以解决上述场景的进程竞争问题？给出你的分析过程。<br>
• 我们只分析了 close 时的情形，在 fd.c 中有一个 dup 函数，用于复制文件描述符。试想，如果要复制的文件描述符指向一个管道，那么是否会出现与 close 类似的问题？请模仿上述材料写写你的理解。</p>
</blockquote>
<ul>
<li>在 <code>pipe_close</code> 函数中，按照上述说法控制 <code>fd</code> 和 <code>pipeunmap</code> 的顺序，可以解决进程竞争问题。具体来说，我们可以先关闭文件描述符<code>fd</code>，然后再解除管道的映射<code>pipe</code>。这样做的好处是，始终保证了<code>pageref(pipe) &gt; pageref(fd)</code> ，从而避免了发生中断时出现二者相等的情况。</li>
<li>在 <code>dup</code> 函数中会出现与 <code>close</code> 类似的问题。因为在 <code>dup</code> 函数中，复制文件描述符时也会涉及到对管道的引用计数和映射操作。如果在复制过程中发生了进程切换，就可能导致类似的竞争条件。因此，在实现 <code>dup</code> 函数时，也需要首先让 <code>pipe-&gt;pp_ref++</code>，从而确保<code>pageref(pipe) &gt; pageref(fd)</code>，避免在进程切换时出现二者相等的情况。</li>
</ul>
<h4 id="thinking-6-5-如何加载-bss-段">Thinking 6.5 如何加载 bss 段</h4>
<blockquote>
<p>思考以下三个问题。<br>
• 认真回看Lab5文件系统相关代码，弄清打开文件的过程。<br>
• 回顾Lab1与Lab3，思考如何读取并加载ELF文件。<br>
• 在Lab1 中我们介绍了 data text bss 段及它们的含义，data 段存放初始化过的全局变量，bss段存放未初始化的全局变量。关于memsize和filesize，我们在Note 1.3.4中也解释了它们的含义与特点。关于Note 1.3.4，注意其中关于“bss段并不在文件中占数据”表述的含义。回顾Lab3并思考：elf_load_seg()和load_icode_mapper()函数是如何确保加载ELF文件时，bss段数据被正确加载进虚拟内存空间。bss段在ELF中并不占空间，但ELF加载进内存后，bss段的数据占据了空间，并且初始值都是0。请回顾elf_load_seg() 和 load_icode_mapper() 的实现，思考这一点是如何实现的？</p>
</blockquote>
<ul>
<li>打开文件的过程主要涉及到文件系统的用户接口和内核实现。用户进程通过调用 user/lib/file.c 中的 <code>open()</code> 请求打开一个文件，函数接着调用 <code>fsipc</code> 模块的 <code>fsipc_open()</code> 函数，向文件系统发送 IPC 请求。文件服务进程接收到请求后，通过 <code>serve</code> 函数调用 <code>file_open()</code> 来处理打开文件的逻辑。</li>
<li>加载 ELF 文件的过程主要由 kern/env.c 中的 <code>load_icode()</code> 函数实现。该函数首先通过 <code>elf_from</code> 读取 ELF 文件头，然后根据 ELF 文件头中的段信息，调用 <code>elf_load_seg()</code> 函数来加载各个段到虚拟内存中：映射文件中真实数据到 [p_vaddr, p_vaddr + p_filesz) 的虚拟地址空间，并将未初始化的 bss 段映射到 [p_vaddr + p_filesz, p_vaddr + p_memsz) 的虚拟地址空间，将 bss 段的初始值设置为 0。</li>
<li>elf_load_seg() 处理每个段时，会通过调用 <code>load_icode_mapper()</code> 函数来映射文件到对应的虚拟内存地址空间。对于 bss 段，虽然在 ELF 文件中并不占用实际数据，但在加载时会根据 <code>p_memsz</code> 的值为 bss 段分配足够的虚拟内存空间，并将其初始化为 0。这是通过为 bss 段不断分配页面并 在 <code>load_icode_mapper()</code> 中将 bss 段的内存区域置零来实现的。</li>
</ul>
<h4 id="thinking-6-6-内置命令和外部命令">Thinking 6.6 内置命令和外部命令</h4>
<blockquote>
<p>通过阅读代码空白段的注释我们知道，将标准输入或输出定向到文件，需要<br>
我们将其dup到0或1号文件描述符（fd）。那么问题来了：在哪步，0和1被“安排”为标准输入和标准输出？请分析代码执行流程，给出答案。</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in user/init.c</span></span><br><span class="line"><span class="comment">// stdin should be 0, because no file descriptors are open yet</span></span><br><span class="line"><span class="keyword">if</span> ((r = opencons()) != <span class="number">0</span>) &#123;</span><br><span class="line">    user_panic(<span class="string">&quot;opencons: %d&quot;</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// stdout</span></span><br><span class="line"><span class="keyword">if</span> ((r = dup(<span class="number">0</span>, <span class="number">1</span>)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    user_panic(<span class="string">&quot;dup: %d&quot;</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="thinking-6-7-标准输入和标准输出">Thinking 6.7 标准输入和标准输出</h4>
<blockquote>
<p>在 shell 中执行的命令分为内置命令和外部命令。在执行内置命令时shell不<br>
需要fork 一个子 shell，如 Linux 系统中的 cd 命令。在执行外部命令时 shell 需要 fork 一个子 shell，然后子 shell 去执行这条命令。<br>
据此判断，在MOS 中我们用到的 shell 命令是内置命令还是外部命令？请思考为什么 Linux 的 cd 命令是内部命令而不是外部命令？</p>
</blockquote>
<p>查看 user/sh.c 可知，MOS 中所有的 shell 命令都是外部命令。因为每个命令都需要通过 <code>fork()</code> 创建一个子进程来执行，子进程会调用 <code>runcmd()</code> 函数来处理命令。<br>
Linux 的 <code>cd</code> 命令是内部命令而不是外部命令，因为它直接修改了当前 shell 进程的工作目录。执行 <code>cd</code> 命令时，shell 需要更新其内部状态，而不是创建一个新的子进程来执行该操作。这样可以避免不必要的资源开销和上下文切换，提高效率。</p>
<h4 id="thinking-6-8-解释命令执行的现象">Thinking 6.8 解释命令执行的现象</h4>
<blockquote>
<p>在你的 shell 中输入命令 ls.b | cat.b &gt; motd。<br>
• 请问你可以在你的shell 中观察到几次spawn？分别对应哪个进程？<br>
• 请问你可以在你的shell 中观察到几次进程销毁？分别对应哪个进程？</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ls.b | cat.b &gt; motd</span></span><br><span class="line">[00002803] pipecreate </span><br><span class="line">[00003805] destroying 00003805</span><br><span class="line">[00003805] free env 00003805</span><br><span class="line">i am killed ... </span><br><span class="line">[00004006] destroying 00004006</span><br><span class="line">[00004006] free env 00004006</span><br><span class="line">i am killed ... </span><br><span class="line">[00003004] destroying 00003004</span><br><span class="line">[00003004] free env 00003004</span><br><span class="line">i am killed ... </span><br><span class="line">[00002803] destroying 00002803</span><br><span class="line">[00002803] free env 00002803</span><br><span class="line">i am killed ... </span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>spawn 2次，分别是 00002803 进程spawn 00003805 进程和 00003004 进程 spawn 00004006 进程。</p>
</li>
<li>
<p>进程销毁 4 次，分别对应：</p>
<ul>
<li>00003805 进程（00002803 fork 出的子进程）解析并执行<code>ls.b</code>完毕后销毁。</li>
<li>00004006 进程（00003004 fork 出的子进程）执行管道右侧命令<code>cat.b</code>完毕后销毁。</li>
<li>00003004 进程（00002803 fork 出的子进程）解析并执行<code>cat.b &gt; motd</code>完毕后销毁。</li>
<li>00002803 进程（主shell 的子进程）解析并执行<code>ls.b | cat &gt; motd</code>完毕后销毁。</li>
</ul>
</li>
</ul>
<h3 id="part-2-难点分析">Part 2. 难点分析</h3>
<p>Lab6 的实验设计主要围绕Shell的实现以及管道通信展开，实验的难点主要体现在以下几个方面：</p>
<ul>
<li>Shell 的启动与执行：需要理解进程的创建、执行和销毁过程，以及如何解析用户输入的命令，清楚Shell的函数调用流程。</li>
<li>管道通信的实现：需要掌握如何在进程间建立管道，如何通过管道传递数据，以及如何处理管道的读写端。</li>
<li>文件描述符的管理：需要加深Lab5中文件描述符的概念，如何通过 <code>dup</code> 函数复制文件描述符，以及如何在进程间共享文件描述符。</li>
</ul>
<h3 id="part-3-实验体会">Part 3. 实验体会</h3>
<p>Lab6 是一个综合性较强的实验，通过实现Shell和管道通信深入理解操作系统中进程管理、文件描述符和进程间通信的机制，也完成了整个MOS系统的内容，我们也<s>从头体验自己动手完成一个小操作系统的乐趣</s>，收获颇丰。</p>
]]></content>
      <categories>
        <category>学习</category>
        <category>OS</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>OS</tag>
        <tag>Linux</tag>
        <tag>vim</tag>
      </tags>
  </entry>
  <entry>
    <title>OOPre2024课程总结[BUAA-OOPre]</title>
    <url>/2024/11/05/OOPreSummary/</url>
    <content><![CDATA[<h3 id="游戏背景">游戏背景</h3>
<p>在这个架空的魔法世界中，玩家将扮演一位冒险者，探索一个充满挑战和机遇的魔法大陆。玩家需要管理自己的资源（放入背包或仓库），包括药水瓶、装备，并可以用碎片兑换福利。在收集装备、药水瓶和福利碎片，雇佣冒险者的过程中，玩家将增强自己的实力，并通过普通攻击或者递归攻击击败其他冒险者。被雇佣的冒险者将会在雇主减少某种程度的体力值时给予援助。在冒险的最后，冒险者们将进入“秘境工厂”打败守门怪物，寻找宝藏。</p>
<h3 id="架构设计">架构设计</h3>
<h4 id="最终架构">最终架构</h4>
<p>经过多次迭代开发，已经能够完整实现游戏功能，并具有较为清晰的架构设计。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202411051952430.png" alt="UML类图"></p>
<p><strong>核心游戏接口和类</strong></p>
<table>
<thead>
<tr>
<th>类/接口</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>Adventurer</td>
<td>代表游戏中的冒险者，包含属性如ID、名称、体力、攻击力、防御力等</td>
</tr>
<tr>
<td>Item</td>
<td>基类，代表所有物品，包括药水瓶<code>Bottle</code>和装备<code>Equipment</code>，包含属性有ID、名称、CE、是否被携带等</td>
</tr>
<tr>
<td>Bottle</td>
<td>药水瓶基类，具体子类包括HpBottle（体力药水）、AtkBottle（攻击药水）、DefBottle（防御药水）</td>
</tr>
<tr>
<td>Equipment</td>
<td>装备类，包括装备类型、耐久度等属性</td>
</tr>
<tr>
<td>Guard</td>
<td>守卫接口，定义了战斗逻辑，具体实现类如<code>Shd</code>、<code>Flm</code>、<code>Stn</code>、<code>Wnd</code>、<code>Frz</code>等</td>
</tr>
<tr>
<td>Treasure</td>
<td>宝物接口，定义了宝物信息的显示与宝物的使用，具体实现类如<code>ShdTreasure</code>、<code>FlmTreasure</code>等</td>
</tr>
<tr>
<td>Fragment</td>
<td>碎片类，用于收集和兑换福利</td>
</tr>
<tr>
<td>CommandUtil</td>
<td>命令接口，用于处理用户输入的命令，具体实现类包括<code>AddAdventurers</code>、<code>AddBottles</code>、<code>AddEquipments</code>、<code>AddDurabilities</code>、<code>TakeItems</code>、<code>UseBottles</code>、<code>AddFragments</code>、<code>UseFragments</code>、<code>Fight</code>、<code>Employ</code>、<code>AdventureGame</code></td>
</tr>
<tr>
<td>InputManage</td>
<td>输入管理类，用于解析用户输入并调用相应的命令处理类</td>
</tr>
<tr>
<td>TreasureFactory</td>
<td>工厂类，用于创建不同类型的宝物</td>
</tr>
<tr>
<td>MainClass</td>
<td>游戏入口类，读取用户输入并启动主循环</td>
</tr>
</tbody>
</table>
<p>在具体实现过程中，采用了面向对象的设计原则，通过继承、多态等特性实现代码的复用和扩展。同时，通过模块化设计，将不同功能需求划分为独立的模块，并在对应的类中实现，提高了代码的可维护性和可扩展性。</p>
<h4 id="代码结构">代码结构</h4>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">├── project</span><br><span class="line">│   ├── src</span><br><span class="line">│   │   ├── Adventurer.java          // 代表游戏中的冒险者，包含属性如ID、名称、体力、攻击力、防御力等</span><br><span class="line">│   │   ├── Item.java               // 基类，代表所有物品</span><br><span class="line">│   │   ├── Bottle.java             // 药水瓶基类</span><br><span class="line">│   │   ├── HpBottle.java           // 体力药水瓶</span><br><span class="line">│   │   ├── AtkBottle.java          // 攻击药水瓶</span><br><span class="line">│   │   ├── DefBottle.java          // 防御药水瓶</span><br><span class="line">│   │   ├── Equipment.java          // 装备类，包括装备类型、耐久度等属性</span><br><span class="line">│   │   ├── Fragment.java           // 碎片类，用于收集和兑换福利</span><br><span class="line">│   │   ├── Guard.java              // 守卫接口</span><br><span class="line">│   │   ├── ··· // 实现类Shd、Flm、Stn、Wnd、Frz</span><br><span class="line">│   │   ├── TreasureFactory.java    // 工厂类，用于创建不同类型的宝物</span><br><span class="line">│   │   ├── Treasure.java           // 宝物接口</span><br><span class="line">│   │   ├── ··· // 实现类ShdTreasure、FlmTreasure、StnTreasure、WndTreasure、FrzTreasure</span><br><span class="line">│   │   ├── CommandUtil.java        // 命令接口，用于处理用户输入的命令</span><br><span class="line">│   │   ├── AddAdventurers.java     // 添加冒险者的命令处理类</span><br><span class="line">│   │   ├── AddBottles.java         // 添加药水瓶的命令处理类</span><br><span class="line">│   │   ├── AddEquipments.java      // 添加装备的命令处理类</span><br><span class="line">│   │   ├── AddDurabilities.java   // 添加耐久度的命令处理类</span><br><span class="line">│   │   ├── TakeItems.java         // 拿起物品的命令处理类</span><br><span class="line">│   │   ├── UseBottles.java        // 使用药水瓶的命令处理类</span><br><span class="line">│   │   ├── AddFragments.java       // 添加碎片的命令处理类</span><br><span class="line">│   │   ├── UseFragments.java       // 使用碎片的命令处理类</span><br><span class="line">│   │   ├── Fight.java             // 战斗的命令处理类</span><br><span class="line">│   │   ├── Employ.java            // 雇佣的命令处理类</span><br><span class="line">│   │   ├── AdventureGame.java      // 冒险游戏流程的命令处理类</span><br><span class="line">│   │   ├── InputManage.java        // 输入管理类</span><br><span class="line">│   │   └── MainClass.java          // 游戏入口类</span><br><span class="line">│   │</span><br><span class="line">│   └── test</span><br><span class="line">│       ├── AdventurerTest.java      // 冒险者类的单元测试</span><br><span class="line">│       ├── BottleTest.java         // 药水瓶类的单元测试</span><br><span class="line">│       ├── EquipmentTest.java      // 装备类的单元测试</span><br><span class="line">│       ├── TreasureTest.java       // 宝物接口的单元测试</span><br><span class="line">│       ├── ···   // 单元测试</span><br><span class="line">│       ├── CommandUtilTest.java     // 命令接口的单元测试</span><br><span class="line">│       ├── InputManageTest.java     // 输入管理类的单元测试</span><br><span class="line">│       └── TreasureFactoryTest.java // 宝物工厂类的单元测试</span><br></pre></td></tr></table></figure>
<h3 id="迭代中的架构调整">迭代中的架构调整</h3>
<h4 id="代码重构">代码重构</h4>
<ol>
<li>在第三次作业时，将输入的管理和具体命令执行分离，在<code>InputManage</code>类中处理输入，通过switch-case语句进行命令的判断与执行，并在具体类中实现对应功能。</li>
</ol>
<blockquote>
<p>此次代码重构精简了MainClass类，使得代码更加清晰，易于维护。同时将每种命令处理封装在对应的方法中，提高了模块化程度。</p>
</blockquote>
<ol start="2">
<li>在第五次作业中，通过创建<code>CommandUtil</code>接口，并创建多个具体的命令执行类，每个实现类对应一种命令。同时，在<code>InputManage</code>类中使用<code>Arraylist</code>储存命令，通过<code>get</code>方法获取并执行对应命令。</li>
</ol>
<blockquote>
<p>此次代码重构进一步提高了代码的模块化程度，使得代码更加清晰，易于维护。同时，通过使用接口，使得代码易于扩展，便于增加新的命令。</p>
</blockquote>
<h4 id="增量开发">增量开发</h4>
<p>每次作业中，都需要增加新的命令，通过采用层级结构，在对应的类中实现相应的方法，从而将一个较为复杂的命令简化为多个简单方法的层次组合，使得代码更加清晰，易于维护。</p>
<h3 id="使用junit的心得体会">使用JUnit的心得体会</h3>
<p>JUnit测试的使用可以帮助检测代码中潜在的错误，提高了因从整体层面构造样例导致部分语句和分支未被覆盖而导致的bug，同时，通过对每个类中的方法编写测试用例，可以更深入地理解其逻辑与功能，自下而上地提高整个项目代码的可靠性和质量。<br>
但在编写JUnit测试代码时，也产生了一些问题。例如，在进行测试时，由于封装导致部分方法在测试时无法直接获得对象的某些属性，需要通过添加<code>get</code>方法获取对应属性。另外，由于增量开发需要在原有代码基础上增加对象的属性，因而测试代码也需要进行相应的修改，增加了测试代码的维护成本。</p>
<h3 id="学习oopre的心得体会">学习OOPre的心得体会</h3>
<p>在从面向过程编程过渡到面向对象编程的过程中，我形成了更严谨的层次化、模块化意识。在程序设计与数据结构课上，我虽然也刻意培养了模块意识，尽可能简化主函数，并减少不同函数间代码的复用与冗余部分，但通过OOPre的学习，我更加深刻地理解了面向对象编程的精髓，即通过封装、继承、多态等特性，将复杂问题分解为多个简单问题，从而提高代码的可维护性和可扩展性。而层次化模块化的设计使得我们可以在不考虑具体实现的情况下，优先从整体角度搭建一个较为清晰的框架，而在更低的层次中完成具体代码逻辑与功能的实现。<br>
另外，OOPre的课程要求帮助我更深刻地认识到做好本地测试的重要性，不论是使用JUnit进行单元测试还是本地搭建评测机和编写样例，都有助于我们更早地发现并修复代码中的错误，帮助我们更好地debug。</p>
<h3 id="课程建议">课程建议</h3>
<ol>
<li>或许可以在更早的时间就提高测试数据点的强度，帮助同学们及早发现代码中的问题。<s>当然要是希望把生成数据和编写本地评测机作为课程的一部分，在后期提高测试点强度也是合理的</s></li>
</ol>
]]></content>
      <categories>
        <category>学习</category>
        <category>OO</category>
        <category>先导</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>OO</tag>
      </tags>
  </entry>
  <entry>
    <title>OOpre笔记(1)</title>
    <url>/2024/10/10/Object-orientedProgrammingPreNote/</url>
    <content><![CDATA[<h3 id="面向对象程序设计先导lec1">面向对象程序设计先导Lec1</h3>
<h4 id="课程简介">课程简介</h4>
<ul>
<li>从java小白到一周内完成200行代码</li>
<li>课程安排:八次课程 4次迭代作业</li>
</ul>
<h4 id="什么是面向对象">什么是面向对象</h4>
<ul>
<li>面向对象是以对象为中心来构建程序逻辑的方法
<ul>
<li>一切皆为对象</li>
<li>程序逻辑:数据及其关系、行为及其关系</li>
</ul>
</li>
<li>使用<strong>类</strong>这个概念来抽象描述 一个类可以以实例化出任意数量的对象
<ul>
<li>类:数据与行为的综合逻辑体</li>
<li>类关系:表征类之间的数据关系或行为关系</li>
</ul>
</li>
</ul>
<blockquote>
<p>面向对象方法提供了控制程序复杂性的重要机制，提高程序的可读性和可维护性。</p>
</blockquote>
<h4 id="面向对象的三个复杂性控制机制">面向对象的三个复杂性控制机制</h4>
<ul>
<li>封装 让类的内部复杂性外部不可见(黑盒子)方便使用者
<ul>
<li>将数据与行为封装在一起，对外提供接口，隐藏类实现细节的机制</li>
<li>累的使用者和实现者解耦</li>
<li>接口与实现分离</li>
</ul>
</li>
<li>继承 通过建立类之间的抽象层次来协同降低复杂性
<ul>
<li>
<p>找到共性，抽象得到类</p>
</li>
<li>
<p>一个类从另一个类中获得属性和方法的机制</p>
<ul>
<li>建立了上下层关系:父类和子类</li>
</ul>
</li>
</ul>
</li>
<li>多态 类通过提供多种形态方法来解耦复杂性
<ul>
<li>针对同一个指令(方法名)，一个类拥有多种功能形态
<ul>
<li>不同的功能形态以参数区分</li>
</ul>
</li>
<li>OO语言提供了根据对象和输入参数来匹配合适的方法(分派机制)，解耦了类针对统一指令的多种情况</li>
</ul>
</li>
</ul>
<h4 id="java开发系统的构成">Java开发系统的构成</h4>
<ul>
<li>JDK Java开发工具包
<ul>
<li>Java编译器</li>
<li>Java解释器</li>
<li>Java类库</li>
<li>Java文档生成器</li>
<li>Java调试工具</li>
</ul>
</li>
<li>JRE Java运行环境
<ul>
<li>Java解释器</li>
<li>Java类库</li>
</ul>
</li>
</ul>
<h4 id="第一个java程序">第一个Java程序</h4>
<ul>
<li>类名称与相应程序文件名一致</li>
</ul>
<h4 id="java程序的注释">Java程序的注释</h4>
<ul>
<li>三种注释方式
<ul>
<li>单行注释</li>
<li>多行注释</li>
<li>文档注释</li>
</ul>
</li>
</ul>
<h4 id="java程序的类型">Java程序的类型</h4>
<ul>
<li>基础类型
<ul>
<li>整数类型:int 4个字节 short 2个字节 long 8个字节 byte 1个字节</li>
</ul>
<blockquote>
<p>biglnteger 16个字节(类)</p>
</blockquote>
<ul>
<li>字符类型:char 2个字节</li>
<li>浮点类型
<ul>
<li>float 32位</li>
<li>double 64位</li>
</ul>
</li>
<li>布尔类型</li>
</ul>
</li>
<li>构造类型:类、接口</li>
</ul>
<h4 id="java程序的变量作用域">Java程序的变量作用域</h4>
<ul>
<li>变量作用域范围
<ul>
<li>类级</li>
<li>对象级</li>
<li>方法级</li>
<li>语句级</li>
</ul>
</li>
</ul>
<h4 id="java程序中的数组">Java程序中的数组</h4>
<ul>
<li>用以管理同类型的多组数据</li>
<li>数据一旦声明，其容量不可变</li>
<li>可以通过length来访问数组的规模</li>
<li>数组本质上是一个对象指针，指向对象在1内存中的地址</li>
</ul>
<h4 id="java程序的类">Java程序的类</h4>
<ul>
<li>编程单位，是Java程序的基本组成单位</li>
</ul>
<blockquote>
<p>在C中是函数</p>
</blockquote>
<ul>
<li>Java程序中的类由属性及方法组成
<ul>
<li>属性定义数据结构</li>
<li>方法定义对数据结构的操作函数</li>
</ul>
</li>
<li>每一个类都有一种构造方法，可用于实例化对象
<ul>
<li>构造方法:初始化属性变量，返回对象指针</li>
</ul>
</li>
</ul>
<h4 id="从结构化编程到面向对象编程">从结构化编程到面向对象编程</h4>
<ul>
<li>结构化编程
<ul>
<li>程序由函数组成</li>
<li>函数由语句组成</li>
<li>语句由表达式组成</li>
</ul>
</li>
<li>面向对象编程
<ul>
<li>程序由类组成</li>
<li>类由属性和方法组成</li>
<li>属性和方法由语句组成</li>
<li>语句由表达式组成</li>
</ul>
</li>
<li>结构化编程需要单独为结构体定义和实现相应的操作函数，当看到某个结构体类型，需要自己去找操作它的函数，而面向对象编程把结构体和操作函数封装在一起(形成类)</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="java程序中的接口">Java程序中的接口</h4>
<ul>
<li>接口是与类处于同一层次的类型</li>
<li>把行为的设计和行为的实现分离</li>
</ul>
<h4 id="java程序中接口的关系">Java程序中接口的关系</h4>
<h4 id="java程序中的访问权限设置">Java程序中的访问权限设置</h4>
<ul>
<li>public、private</li>
<li>Java程序依据权限设置进行检查，如果违背则报错</li>
</ul>
<h4 id="java程序中的static声明">Java程序中的static声明</h4>
<ul>
<li>使用static关键字声明的属性和方法
<ul>
<li>类级成员，否则为对象级成员</li>
<li>类级成员在类加载时初始化，对象级成员在对象实例化时初始化</li>
<li>类级成员在内存中只有一份，对象级成员在内存中有多份</li>
</ul>
</li>
</ul>
<h4 id="java程序中的this关键字">Java程序中的this关键字</h4>
<ul>
<li>this关键字用于引用当前对象</li>
<li>程序中的非静态方法可以使用this关键字
<ul>
<li>指向当前类中的对象</li>
</ul>
</li>
</ul>
<h4 id="java程序中的object">Java程序中的object</h4>
<ul>
<li>object是一个类，是所有类的父类</li>
<li>object类中定义了几个方法
<ul>
<li>equals方法:按照对象的值进行比较</li>
<li>toString方法:将对象转换为字符串</li>
<li>hashCode方法:返回对象的哈希码</li>
<li>getClass方法:返回对象的类</li>
<li>notify方法:唤醒一个等待的线程</li>
<li>notifyAll方法:唤醒所有等待的线程</li>
<li>wait方法:使当前线程等待</li>
<li>finalize方法:在对象被垃圾回收前调用</li>
</ul>
</li>
</ul>
<h4 id="java语言如何学">Java语言如何学</h4>
<ul>
<li>Java语言中方法内的语句与C语言如出一辙
<ul>
<li>没有C语言繁琐的指针及其运算</li>
</ul>
</li>
<li>理解前面所讲的关键概念</li>
</ul>
<h4 id="java程序的错误">Java程序的错误</h4>
<ul>
<li>Java程序中的错误分为编译错误和运行错误
<ul>
<li>编译错误:程序中存在语法错误，无法通过编译</li>
<li>运行错误:程序中存在逻辑错误，无法正常运行</li>
</ul>
</li>
<li>Java程序中的异常
<ul>
<li>异常是程序中出现的错误</li>
<li>异常分为受检异常和运行时异常</li>
</ul>
</li>
</ul>
<h4 id="初学者常遇到的java编译错误">初学者常遇到的Java编译错误</h4>
<ul>
<li>…expected(缺少某些符号)</li>
<li>…cannot be resolved to a type(无法找到某个类型)</li>
<li>…cannot be resolved to a variable(无法找到某个变量)</li>
<li>…cannot be resolved to a method(无法找到某个方法)</li>
<li>…cannot find symbol(无法找到符号)</li>
<li>…illegal start of type(非法的类型开始)</li>
<li>…illegal start of expression(非法的表达式开始)</li>
<li>…incompatible types(不兼容的类型)</li>
<li>…missing return statement(缺少返回语句)</li>
<li>…missing method body(缺少方法体)</li>
<li>…missing semicolon(缺少分号)</li>
<li>…missing method body(缺少方法体)</li>
</ul>
<h4 id="常见的java程序运行时错误">常见的Java程序运行时错误</h4>
<ul>
<li>ArrayIndexOutOfBoundsException:数组下标越界</li>
<li>NullPointerException:空指针异常</li>
<li>NumberFormatException:数字格式异常</li>
<li>ArithmeticException:算术异常</li>
<li>ClassCastException:类型转换异常</li>
<li>IllegalArgumentException:非法参数异常</li>
<li>IndexOutOfBoundsException:索引越界异常</li>
<li>FileNotFoundException:文件未找到异常</li>
<li>IOException:输入输出异常</li>
<li>NoSuchMethodException:没有找到方法异常</li>
<li>NoSuchFieldException:没有找到字段异常</li>
<li>ClassNotFoundException:没有找到类异常</li>
<li>IllegalAccessException:非法访问异常</li>
</ul>
<h4 id="如何管理程序版本">如何管理程序版本</h4>
<blockquote>
<p>开辟多个目录？如果你想恢复到几天前的某个版本？</p>
</blockquote>
<ul>
<li>版本控制是指在软件开发过程中对程序代码、配置文件、文档等进行版本管理的一种方法，以便在软件开发过程中可以方便地回滚到之前的版本，或者查看不同版本的差异。</li>
<li>程序开发会存在多个版本、存在多人协同开发</li>
</ul>
<h4 id="基于git的版本控制">基于Git的版本控制</h4>
<ul>
<li>Git是一个开源的分布式版本控制系统，它允许开发者在本地对代码进行版本管理，同时也可以将代码提交到远程仓库，以便多人协同开发。</li>
<li>Git可以方便地查看不同版本的差异，可以方便地回滚到之前的版本，可以方便地多人协同开发。</li>
<li>Git是一个分布式版本控制系统，它允许开发者在本地对代码进行版本管理，同时也可以将代码提交到远程仓库，以便多人协同开发。</li>
</ul>
<blockquote>
<p>OO课程及先导课，项目代码提交在gitlab上，评测机主动从gitlab上拉取</p>
</blockquote>
<h4 id="gitlab的四个区域">Gitlab的四个区域</h4>
<ul>
<li>工作区：本地开发环境，可以修改代码，提交到暂存区</li>
<li>暂存区：临时存储修改的代码，可以提交到本地仓库</li>
<li>本地仓库：存储本地的代码版本，可以提交到远程仓库</li>
<li>远程仓库：存储远程的代码版本，可以拉取到本地仓库</li>
</ul>
<h4 id="gitlab中的四种文件状态">Gitlab中的四种文件状态</h4>
<ul>
<li>未跟踪文件；工作区中的新建文件，未添加到暂存区</li>
<li>已修改文件；工作区中的文件被修改，未添加到暂存区</li>
<li>已暂存文件；工作区中的文件被修改，已添加到暂存区，未添加到本地仓库</li>
<li>已提交文件；工作区中的文件被修改，已添加到暂存区，已提交到本地仓库<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202409191418335.png" alt></li>
</ul>
<h4 id="git中的操作">Git中的操作</h4>
<ul>
<li>git init：初始化本地仓库</li>
<li>git add：将工作区中的文件添加到暂存区</li>
<li>git commit：将暂存区中的文件提交到本地仓库</li>
<li>git push：将本地仓库中的文件提交到远程仓库</li>
<li>git pull：将远程仓库中的文件拉取到本地仓库</li>
<li>git status：查看当前仓库的状态</li>
<li>git log：查看当前仓库的提交历史</li>
<li>git diff：查看当前仓库的修改差异</li>
<li>git reset：回滚到之前的版本</li>
<li>git checkout：切换到之前的版本</li>
<li>git branch：创建分支</li>
</ul>
<hr>
<h3 id="lec2：编写类与单元测试">Lec2：编写类与单元测试</h3>
<h4 id="本节大纲">本节大纲</h4>
<ul>
<li><strong>Java程序的类</strong>
<ul>
<li>构造方法</li>
<li>查询方法</li>
<li>修改方法</li>
</ul>
</li>
<li><strong>对象引用与方法调用</strong>
<ul>
<li>初步了解容器</li>
</ul>
</li>
<li><strong>Java程序的单元测试</strong>
<ul>
<li>Junit介绍</li>
<li>编写Junit测试</li>
<li>工具配置与使用</li>
</ul>
</li>
</ul>
<h4 id="c语言与java语言的比较">C语言与Java语言的比较</h4>
<ul>
<li><strong>C语言</strong>: 面向过程，函数是编程的核心。</li>
<li><strong>Java语言</strong>: 面向对象，类是编程的核心。
<ul>
<li>协同方式不同：
<ul>
<li>C语言：函数调用 + 全局变量</li>
<li>Java语言：类调用 + 数据管理 + 抽象层次</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="类的定义">类的定义</h4>
<ul>
<li>类是一种自定义数据类型，包含数据和操作数据的方法。
<ul>
<li><strong>属性</strong>：数据管理</li>
<li><strong>方法</strong>：行为管理</li>
</ul>
</li>
<li><strong>主类</strong>: 包含<code>main</code>方法的类，作为程序的入口。</li>
<li><strong>例子</strong>：<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.print(<span class="string">&quot;Input your name: &quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">        System.out.print(<span class="string">&quot;Input your age: &quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">age</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">        System.out.printf(<span class="string">&quot;Hi, %s, you are %d\n&quot;</span>, name, age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="类的属性和方法">类的属性和方法</h4>
<ul>
<li>从需求中分析类的属性和行为：
<ul>
<li>属性：管理什么数据</li>
<li>方法：提供什么行为</li>
</ul>
</li>
<li><strong>银行账户类（BankAccount）示例</strong>：<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankAccount</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String ID;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> balance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getBalance</span><span class="params">()</span> &#123; <span class="keyword">return</span> balance; &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAccountName</span><span class="params">()</span> &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">withdraw</span><span class="params">(<span class="type">int</span> amount)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (amount &gt; balance) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        balance -= amount;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deposit</span><span class="params">(<span class="type">int</span> amount)</span> &#123;</span><br><span class="line">        balance += amount;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="类的成员可见性">类的成员可见性</h4>
<ul>
<li><strong>public</strong>：外部对象可访问</li>
<li><strong>protected</strong>：本类和子类对象可访问</li>
<li><strong>private</strong>：仅本类对象可访问</li>
</ul>
<h4 id="构造方法">构造方法</h4>
<ul>
<li>构造方法用于初始化对象属性。</li>
<li>Java默认提供无参数构造方法，用户定义构造方法后，默认方法失效。</li>
<li>例子：<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">BankAccount</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.balance = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="重载方法">重载方法</h4>
<ul>
<li>Java允许同名方法，但参数列表必须不同（类型或数量）。</li>
<li><strong>方法重载</strong>：<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">BankAccount</span><span class="params">(String id, <span class="type">int</span> balance)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.ID = id;</span><br><span class="line">    <span class="built_in">this</span>.balance = balance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">BankAccount</span><span class="params">(String balanceStr)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.balance = Integer.parseInt(balanceStr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="对象引用与方法调用">对象引用与方法调用</h4>
<ul>
<li><strong>对象引用</strong>：类似于C语言的指针。
<ul>
<li>确保对象引用的类型与实际对象类型一致。</li>
</ul>
</li>
<li><strong>参数传递</strong>：
<ul>
<li>Java中的对象引用是传递引用。</li>
<li><strong>例子</strong>：<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(Point p)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> p.x;</span><br><span class="line">    p.x = p.y;</span><br><span class="line">    p.y = temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="java中的容器">Java中的容器</h4>
<ul>
<li><strong>ArrayList</strong>：动态数组，提供插入、检索、克隆和删除操作。
<ul>
<li><strong>例子</strong>：<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ArrayList&lt;Bottle&gt; bottleArray = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (Bottle b : bottleArray) &#123;</span><br><span class="line">    <span class="comment">// 操作每个Bottle对象</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="单元测试概述">单元测试概述</h4>
<ul>
<li>单元测试用于验证类的功能是否正确。
<ul>
<li><strong>静态测试</strong>：检查代码逻辑</li>
<li><strong>动态测试</strong>：运行代码并检查结果</li>
</ul>
</li>
<li><strong>Junit</strong>：Java单元测试框架，广泛使用。
<ul>
<li>创建测试用例，设置断言，检查异常，建立测试流程。</li>
</ul>
</li>
</ul>
<h4 id="编写junit测试">编写Junit测试</h4>
<ul>
<li>为每个类编写相应的测试类，测试类命名规则：类名 + <code>Test</code>。</li>
<li>测试方法通常与待测方法同名，并带有<code>@Test</code>标记。</li>
<li><strong>例子</strong>：<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankAccountTest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">BankAccount</span> <span class="variable">ba</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BankAccount</span>(<span class="string">&quot;1234567890&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deposit</span><span class="params">()</span> &#123;</span><br><span class="line">        ba.deposit(<span class="number">50</span>);</span><br><span class="line">        assertEquals(<span class="number">50</span>, ba.getBalance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">withdraw</span><span class="params">()</span> &#123;</span><br><span class="line">        ba.withdraw(<span class="number">50</span>);</span><br><span class="line">        assertEquals(<span class="number">0</span>, ba.getBalance());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="junit基本功能">Junit基本功能</h4>
<ol>
<li>创建测试用例。</li>
<li>设置断言，检查返回值是否符合预期。</li>
<li>检查异常，验证方法是否抛出预期异常。</li>
<li>建立测试流程，使用<code>@Before</code>和<code>@After</code>管理测试前后的操作。</li>
</ol>
<h4 id="在idea中使用junit">在IDEA中使用Junit</h4>
<ol>
<li>安装Junit插件（一般内置）。</li>
<li>创建测试文件夹，保存单元测试文件。</li>
<li>使用快捷键创建单元测试类，选择要测试的函数。</li>
<li>补全测试代码，运行测试，查看覆盖率。</li>
<li>添加分支覆盖率，确保所有条件都被测试。</li>
</ol>
<p>课程组提供了<a href="http://gitlab.oo.buaa.edu.cn/2024_oopre_public/course_system_guidebook/-/blob/main/6-JUnit%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E.pdf">在IDEA中Junit测试使用说明</a>，如果要在VSCode中使用Junit，可以参考<a href="https://blog.csdn.net/weixin_43012017/article/details/141574376">这篇CSDN文章</a>。</p>
<h4 id="覆盖率指标">覆盖率指标</h4>
<ul>
<li><strong>函数覆盖率</strong>：执行了多少方法</li>
<li><strong>语句覆盖率</strong>：执行了多少语句</li>
<li><strong>分支覆盖率</strong>：控制结构的分支是否被测试</li>
<li><strong>条件覆盖率</strong>：布尔表达式的真假分支被覆盖情况</li>
<li><strong>行覆盖率</strong>：有多少行被测试过</li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
        <category>OO</category>
        <category>先导</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
        <tag>OO</tag>
      </tags>
  </entry>
  <entry>
    <title>OOpre笔记(2)</title>
    <url>/2024/10/10/Object-orientedProgrammingPreNote2/</url>
    <content><![CDATA[<h3 id="lec3：继承与接口">Lec3：继承与接口</h3>
<h4 id="继承的定义">继承的定义</h4>
<ul>
<li><strong>继承</strong>：让子类获得父类的属性和方法，实现代码复用和拓展，减少冗余度并增强课维护性。</li>
<li><strong>使用语法</strong>：
<ul>
<li>子类中，使用<code>extends</code>关键字继承父类。</li>
</ul>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">class 子类 extends 父类 &#123;</span><br><span class="line">    <span class="comment">// 子类定义</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>子类可以访问父类的公共（public）和受保护（protected）成员</li>
<li>私有（private）成员无法被直接被访问，需调用父类的方法来访问</li>
<li>Java只支持单继承，一个类最多只能有一个父类</li>
<li>子类中，使用<code>super.attribute</code>可以引用父类中定义的非私有属性</li>
<li>子类中，使用<code>super.methodName()</code>关键字调用父类中定义的非私有方法。</li>
</ul>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">class 子类 extends 父类 &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.methodName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>子类中，可以重写父类中的方法。方法名称、参数列表和返回类型必须保持一致.</li>
</ul>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">class 子类 extends 父类 &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123; <span class="comment">// 重写父类中的方法</span></span><br><span class="line">        <span class="comment">// 子类方法实现</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="重写-override">重写（Override）</h4>
<ul>
<li>@Override 注解：可选的注解，用于标记重写方法，提高代码可读性</li>
<li>访问权限：重写方法的visibility范围必须大于等于父类方法
<ul>
<li>如果父类方法为public，子类方法只能为public</li>
</ul>
</li>
<li>返回类型：重写方法必须与父类方法的返回类型一致
<ul>
<li>若父类方法返回类型为基本类型，则只能相同</li>
<li>若父类方法返回类型为AClass，则只能返回AClass或者其子类的对象</li>
</ul>
</li>
<li>方法名和参数列表：重写方法必须与父类方法完全相同
<ul>
<li>参数个数和参数顺序、参数类型</li>
</ul>
</li>
</ul>
<h4 id="继承带来的便利：">继承带来的便利：</h4>
<ul>
<li>减少冗余：子类不必重复实现父类已有的属性和方法，直接获得
<ul>
<li>如，在编写新的药水瓶类<code>XBottle</code>的时候，只需要使用<code>XBottle extends Bottle</code>来声明</li>
<li>只需编写<code>XBottle</code>独有的属性或方法</li>
<li>根据<code>Xbottle</code>的具体要求重写Bottle中的方法</li>
</ul>
</li>
<li>层次结构：上层类可以概括下层类
<ul>
<li>可以用<code>Bottle</code>来引用<code>Xbottle_obj</code>，<code>Adventurer</code>类不需要新增容器来储存<code>Xbottle</code>实例</li>
<li>任何以<code>Bottle</code>对象为参数的方法，都可以传入<code>Xbottle</code>对象进行统一处理</li>
</ul>
</li>
</ul>
<h4 id="继承的使用情景">继承的使用情景</h4>
<ul>
<li>提炼场景：多个类之间存在相同的属性和方法
<ul>
<li>将相同（公共）的部分提取出来形成一个类（父类）</li>
<li>避免出现重复代码</li>
<li>更好的维护这些相同的属性和代码</li>
</ul>
</li>
<li>扩展场景：引入新类，避免对已有类进行修改
<ul>
<li>新类对已有类进行增量式扩展</li>
<li>避免编写冗余代码</li>
<li>保持已有类及其使用者的稳定</li>
</ul>
</li>
</ul>
<h4 id="继承的优势">继承的优势</h4>
<ul>
<li>代码重用
<ul>
<li>子类无需重复实现父类的属性和方法，提高了重用度</li>
</ul>
</li>
<li>代码拓展
<ul>
<li>子类可以添加新的属性和方法，实现自己独有的功能</li>
<li>实现了对父类的增量式扩展（保持父类不变，因而其使用者也不变</li>
</ul>
</li>
<li>继承层次
<ul>
<li>形成抽象层次结构，任何子类对象都可以使用父类型来统一引用和管理</li>
<li>实现了对各种变化的统一处理能力</li>
</ul>
</li>
</ul>
<h4 id="接口">接口</h4>
<ul>
<li>接口是一种定义方法和常量的抽象类型，不提供方法实现。</li>
<li>一个接口可以被多个类实现，一个类也可以实现多个接口。</li>
<li>通过实现接口来定义程序所需的行为，消除类之间的依赖关系。</li>
<li><strong>使用语法</strong>：<br>
接口中，使用<code>public</code>关键字定义方法。  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">interface 接口名 &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
类中，使用<code>implements</code>关键字实现接口。</li>
</ul>
<h4 id="继承与接口的选择">继承与接口的选择</h4>
<ul>
<li>当存在明显父子关系时选择继承。</li>
<li>当需要定义不同类间的共同行为时选择接口。</li>
</ul>
<h4 id="继承下的junit测试注意事项">继承下的Junit测试注意事项</h4>
<ul>
<li>测试子类时注意是否调用了父类方法和访问了父类属性。</li>
<li>测试其他类的方法时，注意参数的类型是子类型还是父类型。</li>
</ul>
<h3 id="lec4-java程序的bug分析与调试">Lec4: JAVA程序的BUG分析与调试</h3>
<h4 id="多种输入指令的处理策略">多种输入指令的处理策略</h4>
<ol>
<li>
<p><strong>使用 <code>switch case</code> 语句</strong><br>
每种指令封装为一个方法，通过 <code>switch</code> 判断执行：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span> (operator) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>: command1(...); <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">10</span>: command10(...); <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>面临的问题</strong><br>
随着指令增多，<code>main</code> 函数中顺序处理变得复杂。可以通过设计一个父类 <code>CommandUtil</code> 来简化：</p>
<ul>
<li><strong>设计父类</strong>：如 <code>CommandUtil</code>，提供 <code>command(String message)</code> 方法。</li>
<li><strong>子类继承</strong>：具体的指令子类如 <code>AddBottle</code>、<code>AddEquipment</code>。</li>
<li><strong>管理命令</strong>：<code>Manager</code> 类负责管理多个 <code>CommandUtil</code> 对象，并根据输入动态调用合适的命令。</li>
</ul>
</li>
<li>
<p><strong>管理命令对象</strong><br>
<code>Manager</code> 类通过 <code>ArrayList&lt;CommandUtil&gt;</code> 存储所有命令，并通过输入指令自动获取并执行对应命令：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">cmdUtil = cmdUtilArray.get(operator - <span class="number">1</span>);</span><br><span class="line">cmdUtil.command(message);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="常见逻辑性错误">常见逻辑性错误</h4>
<ol>
<li>
<p><strong>引用错误</strong></p>
<ul>
<li>
<p><strong>空指针异常</strong>：当试图通过 <code>null</code> 对象访问其成员时会抛出空指针异常：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> str.length(); <span class="comment">// 抛出NullPointerException</span></span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410101435266.png" alt></p>
</li>
<li>
<p><strong>索引越界异常</strong>：访问数组或容器中元素时，索引超出范围会产生索引越界异常：</p>
</li>
</ul>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">name = list.get(index);  <span class="comment">// 当index超出范围时抛出IndexOutOfBoundsException</span></span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202410101437039.png" alt></p>
<ul>
<li><strong>类型转换错误</strong>：数据类型不匹配时会引发类型转换错误：<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Shape</span> <span class="variable">shape</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Circle</span>();</span><br><span class="line"><span class="type">Rectangle</span> <span class="variable">rect</span> <span class="operator">=</span> (Rectangle) shape;  <span class="comment">// 抛出ClassCastException</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p><strong>运算错误</strong></p>
<ul>
<li><strong>逻辑运算短路求值</strong>：在Java中，逻辑运算符 <code>||</code> 和 <code>&amp;&amp;</code> 存在短路行为，可能影响程序执行：</li>
</ul>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">test</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (test == <span class="literal">null</span> || test.length() &gt; <span class="number">5</span>) &#123;</span><br><span class="line">     <span class="comment">// 正确：不会触发空指针异常</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">test</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (test.length() &gt; <span class="number">5</span> || test == <span class="literal">null</span>)&#123;</span><br><span class="line">    <span class="comment">// 错误：会触发空指针异常</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>隐式强转与类型提升</strong>：数值赋值时可能发生隐式强制转换，导致溢出或精度丢失：<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">b += <span class="number">1020</span>;  <span class="comment">// 隐式类型提升</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p><strong>控制流错误</strong><br>
<strong>差一错误</strong>：指循环次数或索引值与预期相差1，常见于数组遍历：</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= array.length; i++) &#123;  <span class="comment">// 错误：索引越界</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><strong>差一错误的防范</strong></p>
<ul>
<li>
<p>只需对下述三种状态进行检测：</p>
<ul>
<li>0状态：迭代还未发生时，检查程序状态是否符合预期</li>
<li>1状态：进行了一次迭代，检查迭代结果以及迭代后的程序状态是否符合预期</li>
<li>m状态：多次迭代，观察迭代得到的结果并判断能否在预期次数时终止</li>
</ul>
</li>
<li>
<p>对于遍历数组 string，需进行如下测试：</p>
<ul>
<li>0状态：检查(string != null &amp;&amp; string.length &gt; 0)</li>
<li>1状态：进行一次迭代，观察是否得到了第0个元素</li>
<li>m状态：迭代10次，观察第10次迭代是否正常得到最后一个元素，再进行一次迭代，观察有无引发空指针异常，观察迭代是否已经终止</li>
</ul>
</li>
<li>
<p>类似地，采用这三个步骤也可解决“差 k 错误”</p>
</li>
</ul>
<ol start="4">
<li>
<p><strong>输入输出错误</strong></p>
<ul>
<li><strong>Scanner的nextLine问题</strong>：使用 <code>nextLine</code> 吸收换行符时，未及时处理会导致错误：</li>
</ul>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NextLineExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    System.out.println(<span class="string">&quot;请输入你的年龄：&quot;</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">age</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">    System.out.println(<span class="string">&quot;请输入你的姓名：&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> sc.next();</span><br><span class="line">    System.out.println(<span class="string">&quot;请输入你的工资：&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">salary</span> <span class="operator">=</span> sc.nextLine();<span class="comment">// 这里会吸收前一个输入的换行符，导致salary为空</span></span><br><span class="line">    System.out.println(<span class="string">&quot;你的信息如下：&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;姓名：&quot;</span>+name+<span class="string">&quot;\n&quot;</span>+<span class="string">&quot;年龄：&quot;</span>+age+<span class="string">&quot;\n&quot;</span>+<span class="string">&quot;工资：&quot;</span>+salary);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<ul>
<li><strong>next类方法</strong>
<ul>
<li>next, nextInt, nextDouble, nextFloat</li>
<li>扫描System.in直到获得了有效输入，并把有效输入之前的其他符号过滤掉（如空格和回车等）</li>
<li>无法获得带有空格的输入</li>
</ul>
</li>
<li><strong>nextLine方法</strong>
<ul>
<li>获得回车之前的整行输入（吸收回车）</li>
</ul>
</li>
<li>Bug原因：输入姓名后按下的回车不会被next吸收，nextLine 在吸收后直接返回</li>
<li>解决办法
<ul>
<li>next后添加一个 nextLine 方法</li>
<li>或者都使用next类方法</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>拷贝错误</strong></p>
<ul>
<li>Java中的对象传参是传递引用（即地址值），而非复制对象内容，导致对象被意外共享：
<ul>
<li>产生对象共享访问</li>
<li>一个对象可能被其他对象修改，导致状态变化</li>
</ul>
</li>
<li>如果这种对象状态变化是不受控制的，则需要限制对象共享
<ul>
<li>使用一个对象的拷贝来进行传递处理</li>
<li>Object类内置有clone 方法</li>
</ul>
</li>
<li>浅拷贝：对于对象中的引用类型属性，复制其引用值（地址值）
<ul>
<li>单层拷贝</li>
<li>默认的clone方法是浅拷贝</li>
</ul>
</li>
<li>深拷贝：对于对象中的引用类型属性，复制其内容（层次迭代）</li>
</ul>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Address</span> <span class="variable">addr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Address</span>(<span class="string">&quot;CityA&quot;</span>);</span><br><span class="line"><span class="type">Factory</span> <span class="variable">fact1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Factory</span>(<span class="string">&quot;Factory1&quot;</span>, addr);</span><br><span class="line"><span class="type">Factory</span> <span class="variable">clonedFact</span> <span class="operator">=</span> (Factory) fact1.clone();</span><br><span class="line">clonedFact.getAddress().setCity(<span class="string">&quot;CityB&quot;</span>);</span><br><span class="line"><span class="comment">// 修改了clonedFact的属性，fact1的属性也发生变化</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>String类使用不当</strong></p>
<ul>
<li>String是普遍使用的一个类
<ul>
<li>String s1 = “OOpre&quot;; // 直接创建</li>
<li>String s2 = “OOpre&quot;; // 直接创建</li>
<li>String s3 = s1; // 引用赋值</li>
<li>String s4 = new String(“OOpre&quot;); // String 对象创建</li>
<li>String s5 = new String(“OOpre&quot;); // String 对象创建</li>
</ul>
</li>
<li>这五个对象引用是否存在共享？<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202410101458427.png" alt></li>
<li><strong>equals与==的区别</strong>：<code>equals</code> 比较内容，<code>==</code> 比较引用地址。<code>String</code> 类是不可变对象，修改时返回新对象。</li>
</ul>
</li>
</ol>
<h4 id="错误捕捉与处理">错误捕捉与处理</h4>
<ol>
<li>
<p><strong>错误传播</strong></p>
<ul>
<li>程序运行时的错误可能会通过方法调用链传播，导致问题复杂化。因此需要通过 <code>try-catch</code> 来捕捉异常：</li>
</ul>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ExceptionExample</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">m</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">data</span> <span class="operator">=</span> <span class="number">50</span> / <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">n</span><span class="params">()</span> &#123;</span><br><span class="line">        m();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">p</span><span class="params">()</span> &#123;</span><br><span class="line">        n();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span> &#123;</span><br><span class="line">        <span class="type">ExceptionExample</span> <span class="variable">obj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ExceptionExample</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            obj.p();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>错误扩散与捕捉</strong></p>
<ul>
<li>如果对象的属性取值错误，访问该对象的所有方法都会受到影响。通过 <code>try-catch</code> 捕捉错误，防止扩散。</li>
</ul>
</li>
</ol>
<h4 id="黑盒测试">黑盒测试</h4>
<ol>
<li>
<p><strong>测试的重点</strong></p>
<ul>
<li>构造数据覆盖不同场景，验证程序的输入输出是否符合预期。黑盒测试关注程序的外部表现，不关注内部实现。</li>
</ul>
</li>
<li>
<p><strong>等价类划分</strong></p>
<ul>
<li>根据程序对输入的处理逻辑，将输入划分为若干等价类，每个等价类中的数据会触发相同的处理逻辑：
<ul>
<li>有效等价类 vs 无效等价类</li>
<li>通过划分等价类来减少测试工作量，提高测试效率。</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="调试方法">调试方法</h4>
<ol>
<li>
<p><strong>数据化简</strong></p>
<ul>
<li>问题的输入数据往往很大或复杂，需要化简数据，确保在最小数据集上仍能重现问题，以便于调试。</li>
</ul>
</li>
<li>
<p><strong>断点调试</strong></p>
<ul>
<li><strong>行断点</strong>：程序执行到某行时暂停。</li>
<li><strong>条件断点</strong>：满足特定条件时暂停。</li>
<li>断点反映调试人员的推理过程，动态调整断点位置可以帮助更好地发现问题。</li>
</ul>
</li>
<li>
<p><strong>打印语句调试</strong></p>
<ul>
<li>通过插入打印语句来监控程序执行过程中的变量状态和逻辑分支，辅助发现问题。</li>
</ul>
</li>
</ol>
]]></content>
      <categories>
        <category>学习</category>
        <category>OO</category>
        <category>先导</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>自存</tag>
        <tag>OO</tag>
      </tags>
  </entry>
  <entry>
    <title>OpenVLA，pi_0，pi_0-fast论文精读 [VLA]</title>
    <url>/2025/08/30/VLA-Paper/</url>
    <content><![CDATA[<h2 id="openvla">OpenVLA</h2>
<p><a href="https://arxiv.org/pdf/2406.09246">OpenVLA: An Open-Source Vision-Language-Action Model</a></p>
<ol>
<li>
<p>OpenVLA是<strong>首个完全开源的高性能VLA模型</strong>，提供了包括模型权重、训练代码和微调教程在内的全套工具链，极大地促进了VLA研究的透明度和可复现性。</p>
</li>
<li>
<p>OpenVLA-<strong>7B</strong> 在参数量远小于之前的闭源RT-2-X-<strong>55B</strong>，但在涵盖多种机器人和29个任务的综合评估中，其绝对成功率平均高出16.5%，除了语义泛化任务外性能都高于其他模型。证明了其融合DINOv2（空间特征）和SigLIP（语义特征）的双视觉编码器架构的优越性。</p>
</li>
<li>
<p><strong>动作离散化</strong>：将每个连续的动作维度离散化成 256 bins，再将256 个动作值覆盖了 Llama 词汇表中 256 个最不常用的 token</p>
</li>
</ol>
<blockquote>
<p>Following Brohan et al. [7], we discretize each dimension of the robot actions separately into one of 256 bins. … simply overwriting the 256 least used tokens in the Llama tokenizer’s vocabulary (which corresponds to the last 256 tokens) with our action tokens.</p>
</blockquote>
<ol start="4">
<li>提供了一套让VLA模型高效微调的方法，包括：
<ul>
<li><strong>参数高效微调</strong>：验证了LoRA技术在VLA上的有效性，仅需训练1.4%的参数就能达到完整微调的效果</li>
</ul>
<blockquote>
<p>we can fine-tune OpenVLA on a new task within 10-15 hours on a single A100 GPU an 8x reduction in compute compared to full fine-tuning.</p>
</blockquote>
<ul>
<li><strong>内存高效推理</strong>：通过4位量化技术，将推理所需的显存占用从16.8 GB减半至7.0 GB，且不牺牲任务成功率。虽然但是4-bit quantized models 也只有 3Hz on the A5000</li>
</ul>
<blockquote>
<p>Notably, 4-bit quantization results in similar performance as bfloat16 half-precision inference despits requiring less than half the amount of GPU memory.</p>
</blockquote>
</li>
</ol>
<h2 id="pi-0"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\pi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></h2>
<p><a href="https://arxiv.org/pdf/2410.24164"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\pi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: Α Vision-Language-Action Flow Model for General Robot Control</a></p>
<p>阅读代码参考：<a href="http://www.dtcms.com/a/61913.html?action=onClick">http://www.dtcms.com/a/61913.html?action=onClick</a></p>
<ol>
<li>
<p><strong>pre-training+post-training的机器人基础模型框架，验证数据规模大</strong>，训练基于一个包含超过 10,000 hours of robot data ，既有灵巧操作演示的私有数据集，并结合了OXE等大型公开数据集，是机器人操作领域迄今为止最大规模的预训练实验，为构建通用机器人模型树立了新的baseline。</p>
<ul>
<li>预训练 = 学习“是什么” (Acquiring Knowledge)</li>
<li>后训练/微调 = 学习“怎么做” (Learning Alignment)</li>
</ul>
<blockquote>
<p>It is generally recognized that most of the “knowledge” in such models is acquired in the pretraining phase, while the post-training phase serves to tell the model how it should leverage that knowledge to fulfill user commands. Our experiments imply that an analogous phenomenon might take place with robot foundation models, where pre-trained models have some zero-shot capabilities, but complex tasks like laundry following require fine-tuning with high-quality data. Training on only this high-quality data results in a brittle model that does not reliably recover from mistakes, while running the pre-trained model in zero shot does not always exhibit the fluent strategies demonstrated in the post-training data.<br>
I</p>
</blockquote>
</li>
<li>
<p><strong>将VLM与流匹配(Flow Matching)动作生成相结合</strong>。通过一个独立的 action expert 模块，使用流匹配技术直接在连续空间中生成最高50Hz的高频动作块，从而在需要高精度和流畅性的灵巧任务上表现出色（经典shirt folding）。在out-of-box的基准测试中，其性能远超采用自回归离散化方案的OpenVLA等模型。</p>
</li>
<li>
<p><strong>complex, multi-stage tasks 表现亮眼</strong>，端到端地完成过去方法无法解决的任务，模型能挑战并掌握此前难以企及的超复杂多阶段任务，灵巧性、泛化性和长时程行为能力都较之前模型有显著提升。</p>
</li>
</ol>
<blockquote>
<p>fine-tune π0 to a set of particularly complex tasks, including folding laundry and bussing a table. These tasks take between 5 and 20 minutes to complete.</p>
</blockquote>
<h2 id="fast">FAST</h2>
<p><a href="https://arxiv.org/pdf/2501.09747">FAST: Efficient Action Tokenization for Vision-Language-Action Models</a></p>
<p>阅读代码时，参考：<a href="https://zhuanlan.zhihu.com/p/1895856498615240391">https://zhuanlan.zhihu.com/p/1895856498615240391</a></p>
<ol>
<li>
<p><strong>对于高频控制提出全新动作分词法</strong>。先前VLA模型普遍采用的“朴素分箱”离散化方法，在处理高频、灵巧的机器人任务时，会因动作数据冗余导致学习信号消失，倾向于完全复制上一动作，从而完全失效。论文提出了频率空间动作序列分词 FAST，一种基于离散余弦变换 DCT +字节对编码 BPE 的压缩分词方案，将冗长的连续动作块高效地压缩为简短、信息密集的离散词元序列。</p>
</li>
<li>
<p>训练速度提升5倍。将FAST方法与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\pi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> VLA架构结合后，所得到的自回归模型在各项灵巧操作任务上的最终性能媲美最先进的扩散模型<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\pi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。最关键的是，其训练效率大幅提升，达到同等性能所需的计算量<strong>减少了5倍</strong>。</p>
</li>
<li>
<p>预训练了一个通用的动作分词器 FAST+，作为一个out-of-box的黑盒分词器，可以被直接应用于各种新的机器人平台和任务，且性能与为特定任务优化的FAST分词器相当。</p>
</li>
<li>
<p>对比两种主流VLA架构———自回归与扩散模型</p>
<ul>
<li>自回归 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\pi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>-FAST)：训练收敛速度快，且在遵循语言指令方面可能更具优势。但推理速度慢。</li>
</ul>
<blockquote>
<p>While π0-FAST matches the overall performance of diffusion π0, it is slower at inference time——the π0 model with FAST tokenization needs approximately 750ms of inference time per chunk</p>
</blockquote>
<ul>
<li>扩散 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\pi_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)：推理速度快，但训练收敛慢，计算成本高昂。</li>
</ul>
<blockquote>
<p>diffusion π0 model often ignores the language instructions, leading to a lower score.</p>
</blockquote>
</li>
</ol>
<table>
<thead>
<tr>
<th style="text-align:center">特征</th>
<th style="text-align:left">自回归模型 (使用FAST)</th>
<th style="text-align:left">扩散模型 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\pi_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>核心原理</strong></td>
<td style="text-align:left">逐个预测下一个<strong>离散词元</strong></td>
<td style="text-align:left">从噪声中迭代恢复<strong>整个连续动作块</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>生成性质</strong></td>
<td style="text-align:left">离散</td>
<td style="text-align:left">连续</td>
</tr>
<tr>
<td style="text-align:center"><strong>训练速度</strong></td>
<td style="text-align:left"><strong>更快</strong></td>
<td style="text-align:left">较慢</td>
</tr>
<tr>
<td style="text-align:center"><strong>推理速度</strong></td>
<td style="text-align:left"><strong>较慢</strong> (序列化生成)</td>
<td style="text-align:left">更快 (并行化处理)</td>
</tr>
<tr>
<td style="text-align:center"><strong>语言服从性</strong></td>
<td style="text-align:left"><strong>可能更强</strong></td>
<td style="text-align:left">可能较弱</td>
</tr>
<tr>
<td style="text-align:center"><strong>架构</strong></td>
<td style="text-align:left"><strong>可直接用标准LLM</strong></td>
<td style="text-align:left">需要<strong>专门设计的</strong>扩散解码器</td>
</tr>
<tr>
<td style="text-align:center"><strong>分词</strong></td>
<td style="text-align:left"><strong>强依赖</strong></td>
<td style="text-align:left"><strong>不依赖</strong></td>
</tr>
</tbody>
</table>
<h2 id="自回归模型-扩散模型生成过程">自回归模型&amp;扩散模型生成过程</h2>
<ul>
<li>扩散模型从纯粹的随机噪声到这个动作块，需要有十次循环降噪迭代。每次迭代内部从输入到输出，是内部并行的。</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">特征</th>
<th style="text-align:left">自回归模型</th>
<th style="text-align:left">扩散模型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>起点</strong></td>
<td style="text-align:left">一个特殊的“开始”词元，以及作为上下文的图像和文本指令。</td>
<td style="text-align:left">一整块与动作块形状相同的<strong>随机噪声</strong>，以及作为引导的图像和文本指令。</td>
</tr>
<tr>
<td style="text-align:center"><strong>操作</strong></td>
<td style="text-align:left"><strong>预测下一个离散词元</strong>：根据上下文和已生成的词元，从词汇表中预测概率最高的下一个词元。</td>
<td style="text-align:left"><strong>预测整体噪声</strong>：根据上下文和当前带噪的动作块，预测出其中包含的连续噪声。</td>
</tr>
<tr>
<td style="text-align:center"><strong>生成单位</strong></td>
<td style="text-align:left"><strong>一个离散的词元 Token</strong>：一次只生成序列中的一个“单词”。</td>
<td style="text-align:left"><strong>一整个连续的动作块 Action Chunk</strong>：内部并行化，生成完整动作块</td>
</tr>
<tr>
<td style="text-align:center"><strong>信息流</strong></td>
<td style="text-align:left"><strong>严格串行</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">T_{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 作为输入生成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td>
<td style="text-align:left"><strong>迭代优化</strong>：将第 <code>t</code> 步去噪后的整个动作块，作为第 <code>t+1</code> 步的输入，进行进一步去噪。</td>
</tr>
<tr>
<td style="text-align:center"><strong>并行性</strong></td>
<td style="text-align:left">由于严格的串行依赖，无法同时生成多个词元，因此<strong>推理速度慢</strong></td>
<td style="text-align:left"><strong>单步迭代内部并行</strong>：在任何一次去噪迭代中，对整个动作块的计算都是同时进行的</td>
</tr>
<tr>
<td style="text-align:center"><strong>step</strong></td>
<td style="text-align:left">等于最终序列的长度，通常为 <strong>30-60 toekns</strong></td>
<td style="text-align:left">一个固定的、较小的迭代次数，通常为 <strong>10 步</strong>。</td>
</tr>
<tr>
<td style="text-align:center"><strong>主要优点</strong></td>
<td style="text-align:left"><strong>训练收敛快</strong>（使用FAST时），可能<strong>更擅长遵循语言指令</strong></td>
<td style="text-align:left"><strong>推理速度快</strong>，生成质量高且平滑。</td>
</tr>
<tr>
<td style="text-align:center"><strong>主要缺点</strong></td>
<td style="text-align:left"><strong>推理速度慢</strong>，性能<strong>严重依赖分词方案</strong>的好坏（朴素分词）</td>
<td style="text-align:left"><strong>训练收敛慢</strong>，计算成本高，可能在精确语言控制上稍弱。</td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>VLA</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>VLA</tag>
        <tag>论文</tag>
      </tags>
  </entry>
  <entry>
    <title>VLA模型技术代码调研学习 [VLA]</title>
    <url>/2025/08/30/VLA-code/</url>
    <content><![CDATA[<h2 id="摘要">摘要</h2>
<ul>
<li>
<p>对 OpenVLA、LeRobot (diffusion+π₀)、PyTorch 版 openpi 和 jax 版 openpi 等主要的 VLA 代码库进行阅读学习。</p>
</li>
<li>
<p><strong>学习路径：</strong> PyTorch 框架的自回归（OpenVLA）和流匹配模型（LeRobot-π₀、openpi_pytorch）→ jax 框架基本学习 + PyTorch框架对比实现 → jax 版本 openpi 官方代码学习 → LIBERO</p>
</li>
<li>
<p><strong>重点：</strong> 不同技术路线的架构设计、核心代码实现、以及性能优化（jax）</p>
</li>
<li>
<p>阅读 <a href="https://github.com/Lifelong-Robot-Learning/LIBERO">LIBERO 仓库</a>，检索网上相关帖子（关键词：LIBERO VLA 仿真）</p>
</li>
<li>
<p><strong>jax框架学习参考：</strong> AI回复+B站视频<a href="https://www.bilibili.com/video/BV1dYphecEQn/?spm_id_from=333.337.search-card.all.click&amp;vd_source=ad387bf24e3219fa7c16fce8832f4c21">【研1基本功 JAX加速框架】pytorch太慢，我偶尔选jax~</a>、<a href="https://www.bilibili.com/video/BV1TppqeAEPN?spm_id_from=333.788.videopod.sections&amp;vd_source=ad387bf24e3219fa7c16fce8832f4c21">【研1基本功 JAX机器学习框架 2】 构建基本网络与训练器~ 上手啦！</a></p>
</li>
</ul>
<hr>
<h2 id="openvla">OpenVLA</h2>
<h3 id="核心创新：actiontokenizer">核心创新：<code>ActionTokenizer</code></h3>
<p><code>ActionTokenizer</code> 通过将连续的机器人动作映射到离散的词元空间（256 bins），将机器人控制转化为了一个语言任务。（与论文对应）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ActionTokenizer</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, tokenizer, bins=<span class="number">256</span>, min_action=-<span class="number">1</span>, max_action=<span class="number">1</span></span>):</span><br><span class="line">        self.tokenizer = tokenizer</span><br><span class="line">        self.bins = bins</span><br><span class="line">        <span class="comment"># 创建用于离散化的bin边界</span></span><br><span class="line">        self.bin_centers = np.linspace(min_action, max_action, bins)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, actions</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将连续动作编码为token序列&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 1. 量化：将动作值映射到最近的bin</span></span><br><span class="line">        action_bins = np.digitize(actions, self.bin_centers) - <span class="number">1</span></span><br><span class="line">        action_bins = np.clip(action_bins, <span class="number">0</span>, self.bins - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        action_tokens = []</span><br><span class="line">        <span class="keyword">for</span> bin_idx <span class="keyword">in</span> action_bins.flatten():</span><br><span class="line">            <span class="comment"># 2. token 化：将bin索引转换为特殊的文本token，如 &quot;&lt;action_025&gt;&quot;</span></span><br><span class="line">            token = <span class="string">f&quot;&lt;action_<span class="subst">&#123;bin_idx:03d&#125;</span>&gt;&quot;</span></span><br><span class="line">            action_tokens.append(self.tokenizer.convert_tokens_to_ids(token))</span><br><span class="line">        <span class="keyword">return</span> action_tokens</span><br></pre></td></tr></table></figure>
<ul>
<li>将连续动作空间量化为256个离散bins，并映射到LLM的词汇表中。</li>
<li>利用 pretrained LLM 来统一处理视觉、语言和动作。</li>
</ul>
<h3 id="端到端推理流程实现">端到端推理流程实现</h3>
<p><code>predict_action</code> 函数封装了完整的推理逻辑，从接收多模态输入到输出最终的机器人动作。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># AI 辅助</span></span><br><span class="line"><span class="meta">@torch.inference_mode()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">predict_action</span>(<span class="params"></span></span><br><span class="line"><span class="params">    self, image: Image, instruction: <span class="built_in">str</span>, unnorm_key: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>, **kwargs: <span class="built_in">str</span></span></span><br><span class="line"><span class="params"></span>) -&gt; np.ndarray:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    VLA推理的核心函数；将输入图像和任务指令映射为连续动作。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        image: PIL图像，格式为[高度, 宽度, 3]的RGB图像</span></span><br><span class="line"><span class="string">        instruction: 任务指令字符串，描述机器人应该执行的任务</span></span><br><span class="line"><span class="string">        unnorm_key: 可选的数据集名称，用于检索去归一化统计信息；</span></span><br><span class="line"><span class="string">                    如果为None，则检查模型是否仅在单个数据集上训练，并检索该统计信息</span></span><br><span class="line"><span class="string">        **kwargs: 传递给generate方法的额外参数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        np.ndarray: 去归一化的（连续）动作向量 --&gt; 末端执行器增量变化</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 获取视觉backbone的图像变换和语言模型的分词器</span></span><br><span class="line">    image_transform, tokenizer = self.vision_backbone.image_transform, self.llm_backbone.tokenizer</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构建VLA提示词</span></span><br><span class="line">    prompt_builder = self.get_prompt_builder()</span><br><span class="line">    prompt_builder.add_turn(role=<span class="string">&quot;human&quot;</span>, message=<span class="string">f&quot;What action should the robot take to <span class="subst">&#123;instruction.lower()&#125;</span>?&quot;</span>)</span><br><span class="line">    prompt_text = prompt_builder.get_prompt()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 准备输入数据</span></span><br><span class="line">    <span class="comment"># 将提示词文本转换为token IDs并移动到设备上</span></span><br><span class="line">    input_ids = tokenizer(prompt_text, truncation=<span class="literal">True</span>, return_tensors=<span class="string">&quot;pt&quot;</span>).input_ids.to(self.device)</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment"># 预处理图像</span></span><br><span class="line">    <span class="comment"># 应用图像变换（如缩放、归一化等）</span></span><br><span class="line">    pixel_values = image_transform(image)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(pixel_values, torch.Tensor):</span><br><span class="line">        <span class="comment"># 如果是张量，添加batch维度并移动到设备</span></span><br><span class="line">        pixel_values = pixel_values[<span class="literal">None</span>, ...].to(self.device)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(pixel_values, <span class="built_in">dict</span>):</span><br><span class="line">        <span class="comment"># 如果是字典（多分辨率等情况），对每个值添加batch维度并移动到设备</span></span><br><span class="line">        pixel_values = &#123;k: v[<span class="literal">None</span>, ...].to(self.device) <span class="keyword">for</span> k, v <span class="keyword">in</span> pixel_values.items()&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的像素值类型 = <span class="subst">&#123;<span class="built_in">type</span>(pixel_values)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 调用super().generate --&gt; 利用`GenerationMixin`，它会重定向到`forward()`方法</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="comment"># 根据掩码选择性地去归一化动作</span></span><br><span class="line">    <span class="comment"># 对于掩码为True的维度：从[-1,1]范围映射回原始动作范围</span></span><br><span class="line">    <span class="comment"># 对于掩码为False的维度：保持原始归一化值</span></span><br><span class="line">    actions = np.where(</span><br><span class="line">        mask,</span><br><span class="line">        <span class="number">0.5</span> * (normalized_actions + <span class="number">1</span>) * (action_high - action_low) + action_low,</span><br><span class="line">        normalized_actions,</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> actions</span><br></pre></td></tr></table></figure>
<p>通过动作即文本的方式，成功将机器人控制转化为文本生成任务。</p>
<hr>
<h2 id="openpi">openpi</h2>
<h3 id="流匹配算法与jax实现">流匹配算法与JAX实现</h3>
<p>π₀ 模型采用流匹配（类似扩散），直接学习从噪声到真实动作的向量场，并借助 jax 框架实现静态编译和高效并行化。</p>
<ul>
<li>流匹配核心公式：<code>x_t = t * noise + (1-t) * actions</code>，模型学习的是直接将噪声推向真实数据的速度场，比扩散模型路径更短。</li>
<li>jax优势：函数式编程范式、JIT（编译以及自动并行化能力，支持高效的GPU/TPU计算），以及自动微分，便于中间结果的缓存和复用。</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">step</span>(<span class="params">carry</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;单步扩散采样。&quot;&quot;&quot;</span></span><br><span class="line">    x_t, time = carry</span><br><span class="line">    <span class="comment"># 嵌入当前状态的动作序列</span></span><br><span class="line">    suffix_tokens, suffix_mask, suffix_ar_mask = self.embed_suffix(...)</span><br><span class="line">    <span class="comment"># `suffix_attn_mask`的形状为(b, suffix_len, suffix_len)，表示后缀令牌之间如何互相关注</span></span><br><span class="line">    suffix_attn_mask = make_attn_mask(suffix_mask, suffix_ar_mask)</span><br><span class="line">    <span class="comment"># `prefix_attn_mask`的形状为(b, suffix_len, prefix_len)，表示后缀令牌如何关注前缀令牌</span></span><br><span class="line">    prefix_attn_mask = einops.repeat(prefix_mask, <span class="string">&quot;b p -&gt; b s p&quot;</span>, s=suffix_tokens.shape[<span class="number">1</span>])</span><br><span class="line">    <span class="comment"># `full_attn_mask`的形状为(b, suffix_len, prefix_len + suffix_len)，表示后缀令牌（生成查询）</span></span><br><span class="line">    <span class="comment"># 如何关注完整的前缀+后缀序列（生成键和值）</span></span><br><span class="line">    full_attn_mask = jnp.concatenate([prefix_attn_mask, suffix_attn_mask], axis=-<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># `positions`的形状为(b, suffix_len)，表示后缀令牌的位置</span></span><br><span class="line">    positions = jnp.<span class="built_in">sum</span>(prefix_mask, axis=-<span class="number">1</span>)[:, <span class="literal">None</span>] + jnp.cumsum(suffix_mask, axis=-<span class="number">1</span>) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用KV缓存进行高效的Transformer推理</span></span><br><span class="line">    (prefix_out, suffix_out), _ = self.PaliGemma.llm(</span><br><span class="line">        [<span class="literal">None</span>, suffix_tokens], mask=full_attn_mask, positions=positions, kv_cache=kv_cache</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">assert</span> prefix_out <span class="keyword">is</span> <span class="literal">None</span></span><br><span class="line">    <span class="comment"># 预测向量场</span></span><br><span class="line">    v_t = self.action_out_proj(suffix_out[:, -self.action_horizon :])</span><br><span class="line">    <span class="comment"># 使用欧拉方法更新状态：x_&#123;t+dt&#125; = x_t + dt * v_t</span></span><br><span class="line">    <span class="keyword">return</span> x_t + dt * v_t, time + dt</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="并行化与分布式训练优化-lerobot-openpi-pytorch-openpi">并行化与分布式训练优化（lerobot, openpi_pytorch, openpi）</h2>
<h3 id="pytorch的并行优化">PyTorch的并行优化</h3>
<p>openpi_pytorch 中，通过 <code>einops</code> 库对多视图图像嵌入进行了并行优化。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># openpi_pytorch</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">embed_prefix</span>(<span class="params">self, images, img_masks, lang_tokens, lang_masks</span>):</span><br><span class="line">    <span class="comment"># 使用einops将多视图(n)合并到批次(b)维度，形成 (b*n) 的大批次</span></span><br><span class="line">    images = einops.rearrange(images, <span class="string">&quot;b n c h w -&gt; (b n) c h w&quot;</span>)</span><br><span class="line">    <span class="comment"># 一次性完成所有图像的嵌入，充分利用GPU并行</span></span><br><span class="line">    img_emb = self.paligemma_with_expert.embed_image(images)</span><br><span class="line">    <span class="comment"># 恢复维度</span></span><br><span class="line">    img_emb = einops.rearrange(img_emb, <span class="string">&quot;(b n) l d -&gt; b (n l) d&quot;</span>, b=bsize)</span><br><span class="line"></span><br><span class="line"><span class="comment"># lerobot</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">embed_prefix</span>(<span class="params">self, images, img_masks, lang_tokens, lang_masks</span>):</span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span> 避免Python中的列表和torch.cat；优先使用torch.empty预分配</span></span><br><span class="line">    embs = []</span><br><span class="line">    pad_masks = []</span><br><span class="line">    att_masks = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># <span class="doctag">TODO:</span> 移除for循环</span></span><br><span class="line">    <span class="keyword">for</span> (img, img_mask) <span class="keyword">in</span> <span class="built_in">zip</span>(images, img_masks, strict=<span class="literal">False</span>):</span><br><span class="line">        img_emb = self.paligemma_with_expert.embed_image(img)</span><br><span class="line">        <span class="comment"># 逐个处理每个图像</span></span><br></pre></td></tr></table></figure>
<h3 id="jax的自动分片与分布式策略">JAX的自动分片与分布式策略</h3>
<p>jax 通过 <code>Sharding</code> 机制，实现复杂的分布式训练策略。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># jax FSDP 自动分片策略</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fsdp_sharding</span>(<span class="params">pytree, mesh: jax.sharding.Mesh, *, min_size_mbytes: <span class="built_in">int</span> = <span class="number">4</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;智能分片：遍历模型参数，根据张量大小和设备网格自动分配&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shard_arr</span>(<span class="params">kp, array: jax.ShapeDtypeStruct</span>):</span><br><span class="line">        <span class="comment"># 优先在张量最大的维度上进行分片</span></span><br><span class="line">        axes = np.argsort(array.shape)[::-<span class="number">1</span>]</span><br><span class="line">        spec = [<span class="literal">None</span>] * <span class="built_in">len</span>(axes)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> axes:</span><br><span class="line">            <span class="keyword">if</span> array.shape[i] % mesh.shape[FSDP_AXIS] == <span class="number">0</span>:</span><br><span class="line">                spec[i] = FSDP_AXIS</span><br><span class="line">                <span class="keyword">return</span> jax.sharding.NamedSharding(mesh, jax.sharding.PartitionSpec(*spec))</span><br><span class="line">        <span class="comment"># 如果无法分片，则在所有设备上复制</span></span><br><span class="line">        <span class="keyword">return</span> jax.sharding.NamedSharding(mesh, jax.sharding.PartitionSpec())</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>jax</strong>：提供自动化并行策略，只需定义设备网格即可自动完成参数分片和通信。</li>
<li><strong>PyTorch</strong>：需要使用 <code>DistributedDataParallel</code> 或通过张量操作库 <code>einops</code> 来重组数据以提升并行效率。</li>
</ul>
<h3 id="kv缓存优化机制">KV缓存优化机制</h3>
<p>KV缓存能够提升多步采样的模型的推理速度。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># JAX版本的高效扩散采样</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sample_actions</span>(<span class="params">self, rng, observation, *, num_steps: <span class="built_in">int</span> = <span class="number">10</span></span>):</span><br><span class="line">    <span class="comment"># 首先通过前缀的前向传播填充KV缓存，这样后续步骤只需要处理后缀</span></span><br><span class="line">    prefix_tokens, prefix_mask, prefix_ar_mask = self.embed_prefix(observation)</span><br><span class="line">    prefix_attn_mask = make_attn_mask(prefix_mask, prefix_ar_mask)</span><br><span class="line">    positions = jnp.cumsum(prefix_mask, axis=<span class="number">1</span>) - <span class="number">1</span></span><br><span class="line">    <span class="comment"># 第一次前向传播，获取KV缓存</span></span><br><span class="line">    _, kv_cache = self.PaliGemma.llm([prefix_tokens, <span class="literal">None</span>], mask=prefix_attn_mask, positions=positions)</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">    <span class="comment"># 定义单步采样函数</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">step</span>(<span class="params">carry</span>):</span><br><span class="line">        x_t, time = carry</span><br><span class="line">        <span class="comment"># 复用缓存：在每一步采样时，只计算后缀（动作）部分的嵌入，并传入之前缓存的KV值</span></span><br><span class="line">        (prefix_out, suffix_out), _ = self.PaliGemma.llm(</span><br><span class="line">            [<span class="literal">None</span>, suffix_tokens],</span><br><span class="line">            mask=full_attn_mask,</span><br><span class="line">            positions=positions,</span><br><span class="line">            kv_cache=kv_cache <span class="comment"># 复用缓存</span></span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span> x_t + dt * v_t, time + dt</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment"># 使用jax.lax.while_loop，整个循环可被JIT编译</span></span><br><span class="line">    x_0, _ = jax.lax.while_loop(cond, step, (noise, <span class="number">1.0</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>缓存策略</strong>：视觉和语言等上下文特征是固定的，其KV值只需计算一次并被后续所有动作预测步骤复用，极大地减少了重复计算。</li>
<li><strong>编译优化</strong>：jax 能够将整个包含<code>while_loop</code>的采样函数JIT编译成一个单一计算图，性能更好。</li>
</ul>
]]></content>
      <categories>
        <category>VLA</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>笔记</tag>
        <tag>VLA</tag>
        <tag>论文</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown语法学习</title>
    <url>/2024/03/14/markdownnote/</url>
    <content><![CDATA[<h6 id="2024-1-21">2024.1.21</h6>
<p><strong>写在前面</strong>：不会就去查Markdown CommonMark<a href="spec.commonmark.org">标准文档</a><br>
<strong>学习参考</strong>：<a href="https://note.tonycrane.cc/">鹤翔万里的笔记本</a> &amp; <a href="https://www.bilibili.com/video/BV1t34y1g7YU/?spm_id_from=333.788">通往pro的第一步丨实用技能拾遗</a></p>
<span id="more"></span>
<h3 id="part-1-markdown概述">Part.1 Markdown概述</h3>
<h6 id="markdown是什么-为什么要学？">markdown是什么，为什么要学？</h6>
<ol>
<li>首先，如果UHO没学markdown <i>(如学)</i>，就不会有这篇文章了，因为本蒟蒻不会html，所以博客上的所有内容都是用markdown写的,这恰恰反映了markdown对于小白的帮助<br><s>伟大，无需多言</s></li>
<li>然后，markdown是一种文本标记语言，所以只需要用纯文本表示格式，语法实际上是很简单的，也易于学习(大概几个小时就能学会基本语法，只要<strong>多加练习</strong>，就能熟练掌握)。然后，像上面提到的能用markdown写博客，原因也在于markdown可以转换为HTML，比如：</li>
</ol>
<pre><code># heading                &lt;h1&gt;heading&lt;/h1&gt;
## sub-heading           &lt;h2&gt;sub-heading&lt;/h2&gt;
- *emphasis*          -&gt; &lt;li&gt;&lt;em&gt;emphasis&lt;/em&gt;&lt;/li&gt;
- **strong importance**
- `code`                 &lt;li&gt;&lt;code&gt;code&lt;code&gt;&lt;/li&gt;
- [links](url)           &lt;li&gt;&lt;a href=&quot;url&quot;&gt;links&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;
</code></pre>
<ol start="3">
<li>可以看出markdown实际上就是对与HTML的简化，<s>能够帮助笨人偷懒</s>有效提高了生产力(理论上来说可以用)。至于如何编辑markdown文档呢？<s>那当然是万能的记事本喽</s><br>个人觉得VScode里的<a href="https://marketplace.visualstudio.com/items?itemName=shd101wyy.markdown-preview-enhanced">MPE插件</a>就挺好<s>才不是因为本蒟蒻只用过这个捏</s><br></li>
</ol>
<hr>
<h3 id="part-2-markdown语法简介">Part.2 Markdown语法简介</h3>
<p><s>看这个干嘛，自己看官网自己试呗</s></p>
<h6 id="基本语法掌握之后可以多多尝试写文档深刻体会-最后写出美观且实用的markdown文档">基本语法掌握之后可以多多尝试写文档深刻体会，最后写出美观且实用的markdown文档</h6>
<ol>
<li><code># 一级标题</code> <code>## 二级标题</code> <code>### 三级标题</code><br> <code>#### 四级标题</code> <code>##### 五级标题</code> <code>###### 六级标题</code> 不同数量的<code>#</code>开头外加一个或多个空格就可以表示标题了~<br>然后<code>=====</code> <code>-----</code>任意多的<code>=</code> <code>-</code>也可以分别表示一级和二级标题.</li>
<li>至于段落，大概就是空格和换行，只不过也可以用HTML的语法来做到</li>
<li><code>&gt; 引言</code>一个<code>&gt;</code>后接空格和内容，内部也可以正常使用markdown语法，并且能多层嵌套，退出的时候要空行。</li>
<li>无序列表是<code>-</code> <code>+</code> <code>*</code>后接空格和内容，每一层级符号相同，下级要换行缩进，比如：</li>
</ol>
<ul>
<li>第一级
<ul>
<li>第二级
<ul>
<li>第三级</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="5">
<li>
<p>有序列表是任意数字加<code>.</code>表示，软件会自动处理序号。</p>
</li>
<li>
<p>分割线<code>***</code> <code>----</code> <code>___</code>至少重复三次，要和刚刚说的标题区分。</p>
</li>
<li>
<p>代码块可以是空行加缩进，也可以是<code>```或者~~~</code>加语言名称(加的话才能显示高亮)，行内代码则是<code>``</code>，在内部写就行。</p>
</li>
<li>
<p><code>*斜体*</code> <code>_也是斜体_ </code> <code>\*这不是斜体\*</code> <code>**粗体**</code> <code>__也是粗体__</code><br>
<code>***粗斜体***</code> <code>___也是粗斜体___</code> <code>~~删除线~~``&lt;u&gt;下划线&lt;/u&gt;</code>这些是行内的标记，除了行内代码其他都可以互相嵌套，<code>\*</code>转义使用<code>*</code>。</p>
</li>
<li>
<p>图片和链接都是<code>[]()</code>的形式只不过后面是分别是图片位置和链接，也可以单用<code>&lt;链接&gt;</code>显示出来。</p>
</li>
</ol>
<p><s>先去吃个饭</s></p>
<hr>
<ol start="10">
<li>
<p>表格的写法<br>
<code>    |表头|表头|表头|</code> <br><code> |:--|:--:|--:|</code> <br><code>    |居左|居中|居右|</code><br><code>    |abcde|fghij|klmno|</code><br><code>    |.......|.......|.......|</code></p>
</li>
<li>
<p>插入脚注<code>[^脚注名]</code> ,<br>
添加脚注<code>[^脚注名]:脚注内容</code></p>
</li>
<li>
<p>任务列表，使用<code>- [ ]</code>插入未完成任务，使用<code>- [x]</code>插入已完成任务</p>
</li>
</ol>
]]></content>
      <categories>
        <category>学习</category>
        <category>工具</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>教程</tag>
        <tag>笔记</tag>
        <tag>Markdown</tag>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title>shell学习笔记</title>
    <url>/2024/03/14/shelllearning/</url>
    <content><![CDATA[<h2 id="shell">shell</h2>
<ul>
<li>
<p>课程来源：<a href="https://www.bilibili.com/video/BV1ry4y1A7qo/?p=2&amp;spm_id_from=pageDriver&amp;vd_source=ad387bf24e3219fa7c16fce8832f4c21">b站浙大竺院辅学</a></p>
</li>
<li>
<p>工具：WSL,Ubuntu,zsh</p>
</li>
<li>
<p>插件及主题：<a href="https://github.com/zsh-users/zsh-syntax-highlighting/blob/master/INSTALL.md">zsh-syntax-highlighting</a>,<a href="https://github.com/romkatv/powerlevel10k?tab=readme-ov-file#installation">powerlevel10k</a>,<a href="https://github.com/zsh-users/zsh-autosuggestions/tree/master">zsh-autosuggestions</a><br>
<em>参看<a href="https://note.tonycrane.cc/cs/tools/shell/">鹤翔万里的shell备忘</a></em> <br></p>
</li>
</ul>
<span id="more"></span>
<ul>
<li>基础shell指令记录
<ol>
<li>
<p><code>pwd</code>获取当前路径(print working directory)</p>
</li>
<li>
<p><code>cd</code>切换路径(change directory)</p>
<ul>
<li><code>~</code>代表home，<code>.</code>代表当前路径，<code>..</code>代表上一级路径</li>
</ul>
</li>
<li>
<p><code>ls</code>列出当前路径下的文件和目录  <code>ls -a</code> 列出所有文件和目录，包括隐藏文件,<br>
<code>ls -l</code>列出详细信息(文件权限，大小，修改时间，…)<br>
<code>ls -al</code>上述功能</p>
</li>
<li>
<p><code>touch</code>创建一个文件</p>
<ul>
<li>如<code>touch 0.c</code></li>
</ul>
</li>
<li>
<p><code>mkdir</code>创建一个目录</p>
<ul>
<li>如<code>mkdir learning</code></li>
</ul>
</li>
<li>
<p><code>cp</code> <em>src</em> <em>dst</em>复制文件或目录(<code>cp -r</code>)</p>
<ul>
<li>如<code>cp 0.c 00.c</code>,<code>cp -r learning learning.0</code></li>
</ul>
</li>
<li>
<p><code>mv</code> <em>src</em> <em>dst</em>移动文件或目录(重命名)</p>
</li>
<li>
<p><code>rm</code>删除文件(<code>-r</code>递归删除目录；<code>-f</code>强制删除)</p>
<ul>
<li>如<code>rm 0.c</code></li>
</ul>
</li>
<li>
<p><code>find</code> <em>path</em> <code>-name</code> <em>pattern</em>在 path 下查找文件名匹配 pattern 的文件</p>
<ul>
<li>如<code>find . 0.c</code>, <code>find . '*.c'</code></li>
</ul>
</li>
<li>
<p><code>cat</code>输出与拼接文件(<code>-n</code>：带行号输出)</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">❯ cat a.c</span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;%</span><br><span class="line"></span><br><span class="line">❯ cat -n a.c</span><br><span class="line"><span class="number">1</span>  <span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="number">2</span>  <span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="number">3</span>  <span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="number">4</span>  <span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="number">5</span>  <span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">6  &#123;</span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">8</span>      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line"><span class="number">9</span>      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">10</span>  &#125;%</span><br></pre></td></tr></table></figure>
<ul>
<li>如<code>cat a.c b.c</code>将两个文件拼接起来</li>
</ul>
</li>
<li>
<p><code>head</code> <em>file</em> 输出 <em>file</em> 前 10 行<code>head file -n</code> <em>lines</em>  输出 <em>lines</em> 行<br>
<code>tail</code> <em>file</em> 输出 <em>file</em> 后10行 <code>tail file -n</code> <em>lines</em>   输出后 <em>lines</em> 行</p>
</li>
<li>
<p><code>more</code>/<code>less</code> <em>file</em> 分页输出 <em>file</em> 内容，空格翻页，回车下一行，q退出</p>
</li>
<li>
<p><code>hexdump</code> <em>file</em> 以十六进制输出文件内容(<code>-C</code>并排输出十六进制与 ASCII, <code>-n</code> N输出前 N 个字节)</p>
</li>
<li>
<p><code>man</code>：查看命令文档（manual）<br>
<code>echo</code>：输出字符串（常配合重定向 / 管道使用）<br>
<code>whoami</code>：获取当前用户<br>
<code>whereis/which/whence</code>：查找命令所在位置<br>
<code>clear</code>：清屏<br>
<code>chmod</code>：更改文件权限<br>
<code>ps</code>：显示进程信息<br>
<code>date</code>：获取当前日期时间<br>
<code>kill</code>：杀死进程（向进程发送信号）<br>
<code>grep</code>：搜索文件内容（常配合重定向 / 管道使用）<br>
<code>diff</code>：比较文件 / 目录内容<br>
<code>curl</code>：发送 HTTP 请求；<code>wget</code>：下载文件</p>
</li>
</ol>
</li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
        <category>工具</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>教程</tag>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>test</title>
    <url>/2024/05/15/test/</url>
    <content><![CDATA[<h3>这里是一个测试图片能否正常显示的博客
<p><img src="http://gitee.com/TheUHO/blog/raw/master/images/202407212237911.jpg" alt="测试"></p>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407212255295.jpg">
<img src="http://gitee.com/TheUHO/blog/raw/master/images/202407212237911.jpg">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407212255290.jpg">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407212255293.jpg">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407212255287.jpg">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407212255283.jpg">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407212255288.jpg">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407212255289.jpg">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407212255291.jpg">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407212255294.jpg">
</h3>]]></content>
      <categories>
        <category>测试</category>
      </categories>
      <tags>
        <tag>测试</tag>
      </tags>
  </entry>
  <entry>
    <title>第一篇博客！</title>
    <url>/2024/03/13/theFirstBlog/</url>
    <content><![CDATA[<h1 id="for-the-first-time">For the first time</h1>
<p>鼓掌鼓掌<br>
今天参考<a href="https://onlyar.site/2024/01/11/hexo-guide-1/">一个学长的博客</a>利用<strong>hexo</strong>和<strong>github</strong>在本地部署了<em>theUHO’sBlog</em><br>
特此纪念</p>
]]></content>
      <categories>
        <category>测试</category>
      </categories>
      <tags>
        <tag>测试</tag>
        <tag>随笔</tag>
      </tags>
  </entry>
  <entry>
    <title>二叉树学习笔记</title>
    <url>/2024/04/28/treelearning1/</url>
    <content><![CDATA[<h4 id="树和二叉树">树和二叉树</h4>
<p><strong>2024.4.25 DS笔记</strong></p>
<table>
<thead>
<tr>
<th>目录跳转</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#section1">1. 树的结构</a></td>
</tr>
<tr>
<td><a href="#section2">2. 树的储存结构</a></td>
</tr>
<tr>
<td><a href="#section3">3. 二叉树</a></td>
</tr>
<tr>
<td><a href="#section4">4. 二叉树的存储结构</a></td>
</tr>
<tr>
<td><a href="#section5">5. 二叉树的遍历</a></td>
</tr>
</tbody>
</table>
<p><a id="section1"></a></p>
<ol>
<li>
<h5 id="树的结构">树的结构</h5>
<ul>
<li><strong>结点</strong>：
<ul>
<li><strong>叶结点</strong>：度为0的结点 <em>(终端结点)</em>；</li>
<li><strong>分支结点</strong>：度非0的结点 <em>(非终端结点)</em>；</li>
<li><strong>结点的度</strong>：结点子树的数目；</li>
</ul>
  <span id="more"></span>
</li>
<li><strong>结点间关系</strong>：结点的子树的根称为该结点的孩子(child)，相应地，该结点称为孩子结点的父结点(或双亲，parent)同一个双亲的孩子之间互称兄弟;</li>
<li><strong>树的度</strong>：结点度的最大值</li>
<li><strong>树的层次</strong>：根结点为第一层，孩子结点依次加一；</li>
<li><strong>树的深度</strong>：树中结点所处的最大层数；</li>
<li><strong>路径</strong>：对于树中任意结点dj，若在树中存在一个结点序列d1，d2，…di，…，dj，使得di是di+1的双亲(1≤i&lt;j)，则称该结点序列是从d1到dj的一条路径，路径的长度为j-1；</li>
<li><strong>树林</strong>：m≥0 棵不相交的树组成的树的集合；</li>
<li><strong>树的有序性</strong>：若树中结点的子树的相对位置不能随意改变, 则称该树为有序树，否则称该树为无序树；</li>
</ul>
</li>
</ol>
<p><a id="sectio2"></a></p>
<ol start="2">
<li>
<h5 id="树的储存结构">树的储存结构</h5>
<ol>
<li><strong>多重链表结构</strong>
<ul>
<li>定长结点的多重链表结构<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135093.png" alt="定长结点链表结构"></li>
<li>不定长结点的多重链表结构<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135092.jpg" alt="不定长结点链表结构"></li>
</ul>
</li>
<li><strong>三重链表结构</strong><br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135094.png" alt="三重链表结构"><br>
<a id="section3"></a></li>
</ol>
</li>
<li>
<h5 id="二叉树">二叉树</h5>
<ol>
<li><font color="#BB1C1C">二叉树</font>是 n ≥ 0个结点的有穷集合D与D上关系的集合R构成的结构，记为T，二叉树是有序树，区分左右子树；</li>
<li>两种特殊形态的二叉树
<ul>
<li>满二叉树：二叉树中的结点,或者为叶结点， 或者具有两棵非空子树,并且叶结点都集中在二叉树的最下面一层；</li>
<li>完全二叉树：二叉树中只有最下面两层的结点的度可以小于2，并且最下面一层的结点(叶结点)都依次排列在该层从左至右的位置上；</li>
</ul>
</li>
<li>二叉树的性质
<ul>
<li>具有n个结点的非空二叉树共有<strong>n-1</strong>个分支；</li>
<li>非空二叉树的第 <strong>i</strong> 层最多有2<sup>i–1</sup>个结点( i ≥1)；</li>
<li>深度为 h 的非空二叉树最多有2<sup>h</sup> –1个结点；</li>
<li>若非空二叉树有n<SUB>0</SUB>个叶结点,有n<SUB>2</SUB>个度为2的结点,则 n<SUB>0</SUB>=n<SUB>2</SUB>+1;</li>
<li>具有n个结点的非空完全二叉树的深度为 h=⌊log<SUB>2</SUB>n⌋+1；</li>
<li>若对具有n个结点的完全二叉树按照层次从上到下,每层从左到右的顺序进行编号, 则编号为i的结点具有以下性质:
<ul>
<li>(1) 当i=1,则编号为i的结点为二叉树的根结点；若i &gt;1,则编号为i 的结点的双亲的编号为⌊i/2⌋；</li>
<li>(2) 若2i&gt;n,则编号为i的结点无左子树; 若2i≤n,则编号为i 的结点的左孩子的编号为2i；</li>
<li>(3) 若2i+1&gt;n,则编号为i 的结点无右子树; 若2i+1≤n,则编号为i 的结点的右孩子的编号为 2i+1。<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135095.png" alt="图示"></li>
</ul>
</li>
</ul>
</li>
<li>二叉树的基本操作
<ul>
<li><font color="#FF4500">INITIAL(T)</font> 初始(创建)一棵二叉树；</li>
<li><font color="#FF4500">ROOT(T)</font> 求二叉树T的根结点, 或求结点x 所在二叉树的根结点；</li>
<li><font color="#FF4500">PARENT(T,x)</font>  求二叉树T中结点x的双亲结点；</li>
<li><font color="#FF4500">LCHILD(T,x)</font>或<font color="#FF4500">RCHILD(T,x)</font>  分别求二叉树T中结点x的左孩子结点或右孩子结点；</li>
<li><font color="#FF4500"> LDELETE(T,x)</font>或<font color="#FF4500"> RDELETE(T,x)</font>   分别删除二叉树T中以结点x为根的左子树或右子树；</li>
<li><font color="#FF4500">TRAVERSE(T)</font>  按照某种次序(或原则)依次访问二叉树T中各个结点，得到由该二叉树的所有结点组成的序列；</li>
<li><font color="#FF4500">LAYER(T,x)</font> 求二叉树中结点x所处的层次；</li>
<li><font color="#FF4500">DEPTH(T)</font> 求二叉树T的深度；</li>
<li><font color="#FF4500">DESTROY(T)</font> 销毁一棵二叉树；</li>
</ul>
</li>
<li>二叉树与树、树林之间的转换*
<ul>
<li>树与二叉树的转换
<ol>
<li>在所有相邻的兄弟结点之间分别加一条连线；</li>
<li>对于每一个分支结点，除了其最左孩子外，删除该结点与其他孩子结点之间的连线；</li>
<li>以根结点为轴心，顺时针旋转45°；<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135086.png" alt="图示"></li>
</ol>
</li>
<li>树林与二叉树的转换
<ol>
<li>分别将树林中每一棵树转换为一棵二叉树；</li>
<li>从最后那一棵二叉树开始，依次将后一棵二叉树的根结点作为前一棵二叉树的根结点的右孩子，直到所有二叉树都这样处理。这样得到的二叉树的根结点是树林中第一棵二叉树的根结点；<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135088.png" alt="图示"></li>
</ol>
</li>
<li>二叉树还原成树
<ol>
<li>若某结点是其双亲结点的左孩子，则将该结点的右孩子以及当且仅当连续地沿此右孩子的右子树方向的所有结点都分别与该结点的双亲结点用一根虚线连接；</li>
<li>去掉二叉树中所有双亲结点与其右孩子的连线；</li>
<li>规整图形(即使各结点按照层次排列),并将虚线改成实线；<br>
<a id="section4"></a></li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
<li>
<h5 id="二叉树的存储结构">二叉树的存储结构</h5>
<ol>
<li>
<p>二叉树的顺序存储结构</p>
<ol>
<li>完全二叉树的顺序存储结构：对于深度为h的完全二叉树, 将树中所有结点的数据信息按照编号的顺序依次存储到一维数组BT[0…2<sup>h</sup>-2]中,由于编号与数组下标一一对应，该数组就是该完全二叉树的顺序存储结构</li>
<li>一般二叉树的顺序存储结构：对于一般二叉树, 只须在二叉树中“添加”一些实际上二叉树中并不存在的“虚结点” (可以认为这些结点的数据信息为空)， 使其在形式上成为一棵“完全二叉树”，然后按照完全二叉树的顺序存储结构的构造方法将所有结点的数据信息依次存放于数组BT[0…2<sup>h</sup>-2]中；</li>
</ol>
</li>
<li>
<p>二叉树的链式存储结构</p>
<ol>
<li>二叉链表 <code>lchild</code> <code>data</code> <code>rchild</code> 分别表示左子树的指针域、数据域、右子树的指针域；</li>
</ol>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">ElemType data;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">Node</span> *<span class="title">lchild</span>, *<span class="title">rchild</span>;</span></span><br><span class="line">&#125; BTNode, *BTNodeptr;</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135089.png" alt="图示"></p>
<ol start="2">
<li>二叉链表 <code>data</code> <code>parent</code> <code>lchild</code> <code>rchild</code> 分别表示数据域、双亲结点的指针域、左子树的指针域、右子树的指针域；</li>
</ol>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">ElemType data;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">Node</span> *<span class="title">parent</span>, *<span class="title">lchild</span>, *<span class="title">rchild</span>;</span></span><br><span class="line">&#125; BTNode, *BTNodeptr;</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135090.png" alt="图示"><br>
<a id="section5"></a></p>
</li>
</ol>
</li>
<li>
<h5 id="二叉树的遍历">二叉树的遍历</h5>
<ol>
<li>
<p>常用的遍历方法：</p>
<ol>
<li><a href="#qianxubianli"><font color="#FF4500">前序遍历DLR</font></a></li>
<li><a href="#zhongxubianli"><font color="#FF4500">中序遍历LDR</font></a></li>
<li><a href="#houxubianli"><font color="#FF4500">后序遍历LRD</font></a></li>
<li><a href="#cengcibianli"><font color="#FF4500">按层次遍历</font></a></li>
</ol>
</li>
<li>
<p>前序遍历<br>
<a id="qianxubianli"></a></p>
<ul>
<li>原则：若被遍历的二叉树非空, 则
<ol>
<li>访问根结点；</li>
<li>以前序遍历原则遍历根结点的左子树；</li>
<li>以前序遍历原则遍历根结点的右子树；<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135091.png" alt="图示"><br>
<font color="#3198FD">前序序列：</font><font color="#FF4500">A B D E C G H I F</font></li>
</ol>
</li>
<li>递归算法</li>
</ul>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">preorder</span><span class="params">(BTNodeptr t)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (t != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        VISIT(t);<span class="comment">//访问t结点</span></span><br><span class="line">        preorder(t-&gt;lchild);</span><br><span class="line">        preorder(t-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>中序遍历<br>
<a id="qianxubianli"></a></p>
<ul>
<li>原则：若被遍历的二叉树非空,则
<ol>
<li>以中序遍历原则遍历根结点的左子树；</li>
<li>访问根结点；</li>
<li>以中序遍历原则遍历根结点的右子树；<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135091.png" alt="图示"><br>
<font color="#3198FD">中序序列：</font><font color="#FF4500">D E B A H G I C F<br>
</font></li>
</ol>
</li>
<li>递归算法</li>
</ul>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">inorder</span><span class="params">(BTNodeptr t)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (t != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        inorder(t-&gt;lchild);</span><br><span class="line">        VISIT(t);<span class="comment">//访问t结点</span></span><br><span class="line">        inorder(t-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>后序遍历<br>
<a id="qianxubianli"></a></p>
<ul>
<li>原则：若被遍历的二叉树非空,则
<ol>
<li>以中序遍历原则遍历根结点的左子树；</li>
<li>访问根结点；</li>
<li>以中序遍历原则遍历根结点的右子树；<br>
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221135091.png" alt="图示"><br>
<font color="#3198FD">中序序列：</font><font color="#FF4500">D E B A H G I C F<br>
</font></li>
</ol>
</li>
<li>递归算法</li>
</ul>
 <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">inorder</span><span class="params">(BTNodeptr t)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (t != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        inorder(t-&gt;lchild);</span><br><span class="line">        VISIT(t);<span class="comment">//访问t结点</span></span><br><span class="line">        inorder(t-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
]]></content>
      <categories>
        <category>学习</category>
        <category>数据结构</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>数据结构</tag>
      </tags>
  </entry>
  <entry>
    <title>Vscode x vim，实现高效开发</title>
    <url>/2024/07/20/vim/</url>
    <content><![CDATA[<table>
<thead>
<tr>
<th>目录跳转</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#section1">1. vim简要介绍</a></td>
</tr>
<tr>
<td><a href="#section2">2. 为什么是vim</a></td>
</tr>
<tr>
<td><a href="#section3">3. vim插件下载及配置</a></td>
</tr>
<tr>
<td><a href="#section4">4. vim相关说明</a></td>
</tr>
<tr>
<td><a href="#section5">5. vim基本操作</a></td>
</tr>
<tr>
<td><a href="#section6">6. easymotion模式</a></td>
</tr>
<tr>
<td><a href="#section7">7. vim-surround插件easymotion模式</a></td>
</tr>
</tbody>
</table>
<h3 id="前言：关于vim-你需要知道的">前言：关于vim，你需要知道的</h3>
<h4 id="vim简要介绍">vim简要介绍</h4>
<p><a id="section1"></a></p>
<ul>
<li>vim 是一款经典的文本编辑器，最初是 Unix 系统上的一个工具，现在所有的类 Unix 系统（Linux、Mac）都安装了vim。它具有强大的文本编辑功能，可直接通过终端操作文本。</li>
<li>vim 是一个<strong>高度可定制</strong>的编辑器，我们可以通过修改配置文件来适应自己的使用习惯和需求。它支持多种编程语言和文件格式，可以方便地进行代码编辑和调试，有效 <s>使自己看上去更像一个CS人</s> 提升开发效率。</li>
<li>vim 是一个开源软件，可以在多种操作系统上运行，包括 Linux、Windows、Mac等。它可能是Linux用户最熟悉的软件之一。vim也能通过丰富的插件和扩展进一步增强其功能，也能基于其他编辑器（如Vscode）内的Vim插件辅助开发。<br>
<a id="section2"></a></li>
</ul>
<h4 id="为什么是vim">为什么是vim</h4>
<ul>
<li>vim 是一款轻量级的编辑器，不需要图形界面，可以在终端中运行，适合在服务器上使用。</li>
<li>vim 能够省略频繁的鼠标操作，在不离开键盘热区的情况下，通过键盘快捷键进行操作，提高开发效率。</li>
<li>vim 方便学习，它的上下限区别很大，可以满足不同用户的需求，从简单的文本编辑到复杂的代码编辑，都可以通过vim实现。你可以只掌握简单的<code>i</code>、<code>:wq</code>、<code>dd</code>、<code>ESC</code>便在日常开发中使用，也可以通过更多的快捷键和操作，摆脱鼠标的束缚。</li>
</ul>
<h3 id="vscode-x-vim插件">Vscode x vim插件</h3>
<ul>
<li>在Vscode中安装Vim插件，可以方便地使用vim的快捷键进行日常开发，提升个人效率。</li>
<li>在Vscode中配置vim插件，可以更好地平衡自己的使用习惯和需求，个性化配置vim，提升个人开发体验。</li>
<li>很多人认为vim的学习曲线高，学习成本大，需要记忆非常多的快捷键和操作，但是我最近体验下来，实际只需要掌握一些使用频率较高的快捷键，其余的可以自己制作一个速查表方便随时查阅。<br>
<a id="section3"></a></li>
</ul>
<h4 id="vim插件下载及配置">vim插件下载及配置</h4>
<ul>
<li>官网：<a href="https://github.com/VSCodeVim/Vim">https://github.com/VSCodeVim/Vim</a></li>
</ul>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407221042770.png"></div>
<p>
<ul>
<li>直接打开Vscode拓展搜索vim点击安装，Windows用户可以<strong>直接使用</strong>，Mac用户需要根据拓展说明在命令行执行对应语句。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ defaults write com.microsoft.VSCode ApplePressAndHoldEnabled -bool false              # For VS Code</span><br><span class="line">$ defaults write com.microsoft.VSCodeInsiders ApplePressAndHoldEnabled -bool false      # For VS Code Insider</span><br><span class="line">$ defaults write com.vscodium ApplePressAndHoldEnabled -bool false                      # For VS Codium</span><br><span class="line">$ defaults write com.microsoft.VSCodeExploration ApplePressAndHoldEnabled -bool false   # For VS Codium Exploration users</span><br><span class="line">$ defaults delete -g ApplePressAndHoldEnabled                                           # If necessary, reset global default</span><br></pre></td></tr></table></figure>
<ul>
<li>拷贝拓展说明中的配置文件到Vscode的配置文件中</li>
</ul>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5);box-sizing: border-box"><img src="https://gitee.com/TheUHO/blog/raw/master/images/202407231736736.png"></div> </p><p>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5); box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407231734848.png"></div> </p>
<ul>
<li>或者拷贝下面的配置文件到settings.json
<blockquote>
<p>这是我的个人配置，包含一些更改，比如保留了Vscode的<code>Ctrl</code>热键，<code>j</code> <code>k</code>替换<code>Esc</code>使用，仅供参考</p>
</blockquote>
</li>
</ul>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;vim.easymotion&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vim.incsearch&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vim.useSystemClipboard&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vim.useCtrlKeys&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vim.hlsearch&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vim.insertModeKeyBindings&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;before&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;j&quot;</span><span class="punctuation">,</span> <span class="string">&quot;k&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;after&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;Esc&gt;&quot;</span><span class="punctuation">]</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;before&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;Ctrl&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;c&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;after&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;y&quot;</span><span class="punctuation">]</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vim.normalModeKeyBindingsNonRecursive&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;before&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;leader&gt;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;d&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;after&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;d&quot;</span><span class="punctuation">,</span> <span class="string">&quot;d&quot;</span><span class="punctuation">]</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;before&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;&lt;C-n&gt;&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;commands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;:nohl&quot;</span><span class="punctuation">]</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;before&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;K&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;commands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;lineBreakInsert&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;silent&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vim.leader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;space&gt;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vim.handleKeys&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;&lt;C-a&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;&lt;C-c&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;&lt;C-x&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;&lt;C-f&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;&lt;C-h&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;&lt;C-s&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;&lt;C-z&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;&lt;C-y&gt;&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      </span><br><span class="line">        <span class="string">&quot;// To improve performance&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;extensions.experimental.affinity&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;vscodevim.vim&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><a id="section4"></a></p>
<h3 id="vim相关说明">vim相关说明</h3>
<ul>
<li>模式mode：vim中有四种常用的模式
<ul>
<li>normal模式：默认模式，用于移动光标、删除文本等操作；</li>
<li>insert模式：用于插入文本；</li>
<li>visual模式：用于选择文本；</li>
<li>command-line模式：用于执行命令。</li>
</ul>
</li>
<li>操作符operator：用于对文本进行操作，例如<code>d</code>删除、<code>y</code>复制、<code>p</code>粘贴等。</li>
<li>动作motion：用于指定操作的范围，例如<code>h</code> <code>j</code> <code>k</code> <code>l</code>移动光标、选择文本等。</li>
</ul>
<h3 id="学习资源">学习资源</h3>
<ul>
<li>vim安装后自带的教程vimtutor，在终端执行<code>vimtutot</code>即可进入。</li>
<li>b站视频<a href="https://www.bilibili.com/video/BV1z541177Jy?p=4&amp;spm_id_from=pageDriver&amp;vd_source=ad387bf24e3219fa7c16fce8832f4c21">指尖飞舞：vscode + vim 高效开发</a></li>
<li><a href="https://csdiy.wiki/%E5%BF%85%E5%AD%A6%E5%B7%A5%E5%85%B7/Vim/">CS自学指南</a></li>
<li>博客<a href="https://imageslr.com/2021/vim">vim入门笔记</a><br>
<a id="section5"></a></li>
</ul>
<h3 id="vim基本操作">vim基本操作</h3>
<ul>
<li>
<p><strong>模式相关操作</strong></p>
<ul>
<li><code>i</code> 进入插入模式, 光标在当前字符前</li>
<li><code>I</code> 进入插入模式，光标在当前行开头</li>
<li><code>a</code> 进入插入模式，光标在当前字符后</li>
<li><code>A</code> 进入插入模式，光标在当前行结尾</li>
<li><code>o</code> 进入插入模式，光标在当前行下方</li>
<li><code>O</code> 进入插入模式，光标在当前行上方</li>
<li><code>Esc</code>或<code>Ctrl</code>+<code>[</code> 退出插入模式，进入normal模式,也可用设置的快捷键 <em>(我设置的是<code>j</code> <code>k</code>,理由是因为<code>Esc</code>距离键盘热区较远)</em></li>
<li><code>:</code> 普通模式下进入命令模式，按<code>Esc</code>退出命令模式</li>
<li><code>:wq</code> 保存并退出</li>
<li><code>:q!</code> 不保存退出</li>
<li><code>:w</code> 保存</li>
<li><code>:q</code> 退出</li>
</ul>
</li>
<li>
<p><strong>光标移动相关操作</strong></p>
<ul>
<li><code>h</code> <code>j</code> <code>k</code> <code>l</code> ← ↓ ↑ →移动光标</li>
<li><code>w</code> 向后移动一个单词，到下一个单词的开头</li>
<li><code>b</code> 向前移动一个单词，到本单词或上一个单词开头</li>
<li><code>e</code> 向后移动一个单词，到本单词或下一个单词结尾</li>
<li><code>ge</code> 向前移动一个单词，到本单词或上一个单词结尾</li>
<li><code>W</code> 向后移动一个单词，到下一个单词的开头，忽略标点符号</li>
<li><code>B</code> 向前移动一个单词，到本单词或上一个单词开头，忽略标点符号</li>
<li><code>E</code> 向后移动一个单词，到本单词或下一个单词结尾，忽略标点符号</li>
<li><code>gE</code> 向前移动一个单词，到本单词或上一个单词结尾，忽略标点符号</li>
<li><code>0</code> 移动到当前行开头</li>
<li><code>$</code> 移动到当前行结尾</li>
<li><code>^</code> 移动到当前行开头第一个非空字符</li>
<li><code>gg</code> 移动到文件开头</li>
<li><code>G</code> 移动到文件结尾</li>
<li><code>H</code> 移动到屏幕顶部</li>
<li><code>M</code> 移动到屏幕中间</li>
<li><code>L</code> 移动到屏幕底部</li>
<li><code>f 字符</code> 光标移动到下一个字符所在位置</li>
<li><code>F 字符</code> 光标反向移动到上一个字符所在位置</li>
<li><code>t 字符</code> 光标移动到下一个字符之前的位置</li>
<li><code>T 字符</code> 光标反向移动到上一个字符之后的位置</li>
<li><code>;</code> 重复上一次的<code>f/F/t/T</code>操作</li>
<li><code>,</code> 反向重复上一次的<code>f/F/t/T</code>操作</li>
<li><code>%</code> 跳转到匹配的括号</li>
<li><code>n</code> 跳转到下一个匹配的字符</li>
<li><code>N</code> 跳转到上一个匹配的字符</li>
<li><code>Ctrl + d</code>、<code>Ctrl + u</code>或<code>Ctrl + b</code> 向下向上翻页</li>
<li><code>Ctrl + e</code> <code>Ctrl + y</code> 向下向上滚动一行</li>
<li><code>Ctrl + g</code> 显示当前行号和文件信息</li>
</ul>
</li>
<li>
<p><strong>动作motion相关操作(需结合操作符使用)</strong></p>
<ul>
<li><code>i</code> 表示inner，内部，表示操作对象是字符的内部</li>
<li><code>a</code> 表示around，周围，表示操作对象是字符的周围</li>
</ul>
</li>
</ul>
<blockquote>
<p>如<code>diw</code>删除当前单词，<code>ciw</code> 修改当前单词，<code>yiw</code> 复制当前单词，<code>viw</code> 选择当前单词，也可用<code>i(</code>或<code>ib</code>、<code>i&quot;</code>、<code>i&#123;</code>或<code>iB</code>、<code>it</code>等表示特殊符号包含的内容；而<code>daw</code>删除当前单词及之前的空格，<code>a(</code>或<code>ab</code>、<code>a&quot;</code>、<code>a&#123;</code>或<code>aB</code>、<code>at</code>等表示特殊符号本身及包含的内容</p>
</blockquote>
<ul>
<li>
<p><strong>操作符operator</strong></p>
<ul>
<li><code>d</code> 删除delete</li>
<li><code>c</code> 修改(删除并进入插入模式)change</li>
<li><code>r</code> 替换replace</li>
<li><code>y</code> 复制yank</li>
<li><code>p</code> 粘贴put</li>
<li><code>u</code> 撤销</li>
<li><code>v</code> 选择(选中并进入visual模式)</li>
<li><code>~</code> 切换当前字母大小写 <code>n~</code>切换光标位置开始的n个字母大小写</li>
<li><code>g~</code> 切换当前行字母大小写</li>
<li><code>gu</code> 切换为小写，后接动作motion，如<code>guu</code>将当前行字母改为小写，<code>guiw</code>将光标所在单词改为小写等</li>
<li><code>gU</code> 切换为大写，后接动作motion，如<code>gUU</code>将当前行字母改为大写，<code>guiw</code>将光标所在单词改为大写等</li>
<li><code>&gt;</code> 增加缩进</li>
<li><code>&lt;</code> 减少缩进</li>
<li><code>=</code> 自动缩进</li>
</ul>
</li>
<li>
<p><strong>其他操作</strong></p>
<ul>
<li><code>gd</code> 跳转到定义go to definition</li>
<li><code>gD</code> 跳转到全局定义</li>
<li><code>Ctrl o</code>退出定义</li>
<li><code>g h</code> 悬浮显示定义</li>
<li><code>g t</code> 跳转下一个标签页，<code>n g t</code> 跳转到向后第n个标签页</li>
<li><code>g T</code> 跳转上一个标签页，<code>n g T</code> 跳转到向前第n个标签页</li>
<li><code>Ctrl 0</code> 将光标移动到侧边栏</li>
<li><code>Ctrl 1</code> 将光标移动到编辑器/将光标移动到组1</li>
<li><code>Space</code>或<code>Enter</code> 展开或进入文件夹/打开文件</li>
<li><code>Ctrl n</code> 打开组n/将光标移动到组n</li>
<li><code>:noh</code> 取消高亮</li>
<li><code>:set number</code> 显示行号</li>
<li><code>:set nonumber</code> 取消显示行号</li>
<li><code>:set hlsearch</code> 高亮搜索结果</li>
<li><code>:set nohlsearch</code> 取消高亮搜索结果</li>
<li><code>:set ignorecase</code> 忽略大小写</li>
</ul>
</li>
</ul>
<p><a id="section6"></a></p>
<h3 id="easymotion模式">easymotion模式</h3>
<ul>
<li><a href="https://github.com/easymotion/vim-easymotion">vim-easymotion</a>插件</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">Motion Command</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>&lt;leader&gt; &lt;leader&gt; s &lt;char&gt;</code></td>
<td style="text-align:left">搜索指定的字符</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; f &lt;char&gt;</code></td>
<td style="text-align:left">向前查找指定的字符</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; F &lt;char&gt;</code></td>
<td style="text-align:left">向后查找指定的字符</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; t &lt;char&gt;</code></td>
<td style="text-align:left">向前查找直到指定的字符</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; T &lt;char&gt;</code></td>
<td style="text-align:left">向后查找直到指定的字符</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; w</code></td>
<td style="text-align:left">向前移动到单词的开头</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; b</code></td>
<td style="text-align:left">向后移动到单词的开头</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; l</code></td>
<td style="text-align:left">匹配单词的开始和结束，驼峰命名法，在 <code>_</code> 后，在 <code>#</code> 后向前</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; h</code></td>
<td style="text-align:left">匹配单词的开始和结束，驼峰命名法，在 <code>_</code> 后，在 <code>#</code> 后向后</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; e</code></td>
<td style="text-align:left">向前移动到单词的结尾</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; ge</code></td>
<td style="text-align:left">向后移动到单词的结尾</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; j</code></td>
<td style="text-align:left">向前移动到行的开头</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; k</code></td>
<td style="text-align:left">向后移动到行的开头</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt; / &lt;char&gt;... &lt;CR&gt;</code></td>
<td style="text-align:left">搜索n个字符</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt;&lt;leader&gt; bdt</code></td>
<td style="text-align:left">向前移动到指定的字符</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt;&lt;leader&gt; bdw</code></td>
<td style="text-align:left">向前移动到单词的开头</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt;&lt;leader&gt; bde</code></td>
<td style="text-align:left">向前移动到单词的结尾</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt;&lt;leader&gt; bdjk</code></td>
<td style="text-align:left">向前移动到行的开头</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;leader&gt;&lt;leader&gt;&lt;leader&gt; j</code></td>
<td style="text-align:left">JumpToAnywhere 动作；默认行为匹配单词的开始和结束，驼峰命名法，在 <code>_</code> 后，在 <code>#</code> 后向前</td>
</tr>
</tbody>
</table>
<ul>
<li>在Vscode配置文件<code>settings.json</code>中将<code>&lt;leader&gt;</code>设置为<code>&lt;space&gt;</code>，两次空格进入easymotion模式</li>
</ul>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;vim.leader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;space&gt;&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5); box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407232204348.png"></div> <p></p>
<p><a id="section1"></a></p>
<h3 id="vim-surround插件">vim-surround插件</h3>
<div style="box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.5); box-sizing: border-box">
<img src="https://gitee.com/TheUHO/blog/raw/master/images/202407232208576.png"></div> <p></p>
<p>例如，对于下面的代码</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(hello world);</span><br></pre></td></tr></table></figure>
<p>在normal模式下，输入<code>ysi(&quot;</code>，就可以将<code>hello world</code>用括号括起来，变成</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;hello world&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>在normal模式下，输入<code>ds&quot;</code>，就可以将<code>&quot;hello world&quot;</code>中的双引号删除，变成</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(hello world);</span><br></pre></td></tr></table></figure>
<p>在normal模式下，输入<code>cs&quot;&lt;char&gt;</code>，就可以将<code>&quot;hello world&quot;</code>中的双引号替换成指定的字符，例如<code>&lt;char&gt;</code>为<code>'</code>，就可以将双引号替换成单引号，变成</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="结语">结语</h3>
<p><strong>最后我想说的是，学习vim最需要的不是记忆这些快捷键，而是尝试干掉鼠标。忘记是在哪里看到的一句话，程序员需要做的，就是尽可能减少双手离开键盘的时间。</strong></p>
]]></content>
      <categories>
        <category>学习</category>
        <category>工具</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>教程</tag>
        <tag>笔记</tag>
        <tag>vim</tag>
        <tag>工具</tag>
        <tag>vscode</tag>
        <tag>编辑器</tag>
      </tags>
  </entry>
</search>
